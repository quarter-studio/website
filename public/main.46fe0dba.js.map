{"version":3,"sources":["../../../node_modules/lodash/_apply.js","../../../node_modules/lodash/identity.js","../../../node_modules/lodash/_overRest.js","../../../node_modules/lodash/constant.js","../../../node_modules/lodash/_freeGlobal.js","../../../node_modules/lodash/_root.js","../../../node_modules/lodash/_Symbol.js","../../../node_modules/lodash/_getRawTag.js","../../../node_modules/lodash/_objectToString.js","../../../node_modules/lodash/_baseGetTag.js","../../../node_modules/lodash/isObject.js","../../../node_modules/lodash/isFunction.js","../../../node_modules/lodash/_coreJsData.js","../../../node_modules/lodash/_isMasked.js","../../../node_modules/lodash/_toSource.js","../../../node_modules/lodash/_baseIsNative.js","../../../node_modules/lodash/_getValue.js","../../../node_modules/lodash/_getNative.js","../../../node_modules/lodash/_defineProperty.js","../../../node_modules/lodash/_baseSetToString.js","../../../node_modules/lodash/_shortOut.js","../../../node_modules/lodash/_setToString.js","../../../node_modules/lodash/_baseRest.js","../../../node_modules/lodash/_listCacheClear.js","../../../node_modules/lodash/eq.js","../../../node_modules/lodash/_assocIndexOf.js","../../../node_modules/lodash/_listCacheDelete.js","../../../node_modules/lodash/_listCacheGet.js","../../../node_modules/lodash/_listCacheHas.js","../../../node_modules/lodash/_listCacheSet.js","../../../node_modules/lodash/_ListCache.js","../../../node_modules/lodash/_stackClear.js","../../../node_modules/lodash/_stackDelete.js","../../../node_modules/lodash/_stackGet.js","../../../node_modules/lodash/_stackHas.js","../../../node_modules/lodash/_Map.js","../../../node_modules/lodash/_nativeCreate.js","../../../node_modules/lodash/_hashClear.js","../../../node_modules/lodash/_hashDelete.js","../../../node_modules/lodash/_hashGet.js","../../../node_modules/lodash/_hashHas.js","../../../node_modules/lodash/_hashSet.js","../../../node_modules/lodash/_Hash.js","../../../node_modules/lodash/_mapCacheClear.js","../../../node_modules/lodash/_isKeyable.js","../../../node_modules/lodash/_getMapData.js","../../../node_modules/lodash/_mapCacheDelete.js","../../../node_modules/lodash/_mapCacheGet.js","../../../node_modules/lodash/_mapCacheHas.js","../../../node_modules/lodash/_mapCacheSet.js","../../../node_modules/lodash/_MapCache.js","../../../node_modules/lodash/_stackSet.js","../../../node_modules/lodash/_Stack.js","../../../node_modules/lodash/_baseAssignValue.js","../../../node_modules/lodash/_assignMergeValue.js","../../../node_modules/lodash/_createBaseFor.js","../../../node_modules/lodash/_baseFor.js","../../../node_modules/lodash/_cloneBuffer.js","../../../node_modules/lodash/_Uint8Array.js","../../../node_modules/lodash/_cloneArrayBuffer.js","../../../node_modules/lodash/_cloneTypedArray.js","../../../node_modules/lodash/_copyArray.js","../../../node_modules/lodash/_baseCreate.js","../../../node_modules/lodash/_overArg.js","../../../node_modules/lodash/_getPrototype.js","../../../node_modules/lodash/_isPrototype.js","../../../node_modules/lodash/_initCloneObject.js","../../../node_modules/lodash/isObjectLike.js","../../../node_modules/lodash/_baseIsArguments.js","../../../node_modules/lodash/isArguments.js","../../../node_modules/lodash/isArray.js","../../../node_modules/lodash/isLength.js","../../../node_modules/lodash/isArrayLike.js","../../../node_modules/lodash/isArrayLikeObject.js","../../../node_modules/lodash/stubFalse.js","../../../node_modules/lodash/isBuffer.js","../../../node_modules/lodash/isPlainObject.js","../../../node_modules/lodash/_baseIsTypedArray.js","../../../node_modules/lodash/_baseUnary.js","../../../node_modules/lodash/_nodeUtil.js","../../../node_modules/lodash/isTypedArray.js","../../../node_modules/lodash/_safeGet.js","../../../node_modules/lodash/_assignValue.js","../../../node_modules/lodash/_copyObject.js","../../../node_modules/lodash/_baseTimes.js","../../../node_modules/lodash/_isIndex.js","../../../node_modules/lodash/_arrayLikeKeys.js","../../../node_modules/lodash/_nativeKeysIn.js","../../../node_modules/lodash/_baseKeysIn.js","../../../node_modules/lodash/keysIn.js","../../../node_modules/lodash/toPlainObject.js","../../../node_modules/lodash/_baseMergeDeep.js","../../../node_modules/lodash/_baseMerge.js","../../../node_modules/lodash/_customDefaultsMerge.js","../../../node_modules/lodash/_isIterateeCall.js","../../../node_modules/lodash/_createAssigner.js","../../../node_modules/lodash/mergeWith.js","../../../node_modules/lodash/defaultsDeep.js","../../assets/scripts/editor/config.js","../../assets/scripts/animation/shaders/noise.fs","../../assets/scripts/animation/shaders/noise.vs","../../assets/scripts/animation/animation.js","../../../node_modules/vue/dist/vue.runtime.esm.js","../../../node_modules/tslib/tslib.es6.js","../src/constants.ts","../src/assert.ts","../src/crypt.ts","../src/deepCopy.ts","../src/deferred.ts","../src/environment.ts","../src/errors.ts","../src/json.ts","../src/jwt.ts","../src/obj.ts","../src/query.ts","../src/sha1.ts","../src/subscribe.ts","../src/validation.ts","../src/utf8.ts","../index.ts","../src/logger.ts","../src/firebaseApp.ts","../src/firebaseNamespaceCore.ts","../src/firebaseNamespace.ts","../../assets/scripts/editor/firebase/firebase.js","../../../node_modules/process/browser.js","../src/core/storage/DOMStorageWrapper.ts","../src/core/storage/MemoryStorage.ts","../src/core/storage/storage.ts","../src/core/util/util.ts","../src/core/util/Path.ts","../src/realtime/Constants.ts","../src/core/RepoInfo.ts","../src/core/util/libs/parser.ts","../src/core/util/validation.ts","../src/api/onDisconnect.ts","../src/api/TransactionResult.ts","../src/core/util/NextPushId.ts","../src/core/snap/Node.ts","../src/core/snap/indexes/Index.ts","../src/core/snap/indexes/KeyIndex.ts","../src/core/snap/snap.ts","../src/core/snap/LeafNode.ts","../src/core/snap/indexes/PriorityIndex.ts","../src/core/util/SortedMap.ts","../src/core/snap/childSet.ts","../src/core/snap/IndexMap.ts","../src/core/snap/comparators.ts","../src/core/snap/ChildrenNode.ts","../src/core/snap/nodeFromJSON.ts","../src/core/snap/indexes/ValueIndex.ts","../src/core/snap/indexes/PathIndex.ts","../src/api/DataSnapshot.ts","../src/core/view/Event.ts","../src/core/view/EventRegistration.ts","../src/api/Query.ts","../src/core/util/CountedSet.ts","../src/core/SparseSnapshotTree.ts","../src/core/util/ServerValues.ts","../src/core/operation/Operation.ts","../src/core/operation/AckUserWrite.ts","../src/core/util/ImmutableTree.ts","../src/core/operation/ListenComplete.ts","../src/core/operation/Overwrite.ts","../src/core/operation/Merge.ts","../src/core/view/CacheNode.ts","../src/core/view/ViewCache.ts","../src/core/view/Change.ts","../src/core/view/filter/IndexedFilter.ts","../src/core/view/ChildChangeAccumulator.ts","../src/core/view/CompleteChildSource.ts","../src/core/view/ViewProcessor.ts","../src/core/view/EventGenerator.ts","../src/core/view/View.ts","../src/core/SyncPoint.ts","../src/core/CompoundWrite.ts","../src/core/WriteTree.ts","../src/core/SyncTree.ts","../src/core/SnapshotHolder.ts","../src/core/AuthTokenProvider.ts","../src/core/stats/StatsCollection.ts","../src/core/stats/StatsManager.ts","../src/core/stats/StatsListener.ts","../src/core/stats/StatsReporter.ts","../src/core/view/EventQueue.ts","../src/core/util/EventEmitter.ts","../src/core/util/VisibilityMonitor.ts","../src/core/util/OnlineMonitor.ts","../src/realtime/polling/PacketReceiver.ts","../src/realtime/BrowserPollConnection.ts","../src/realtime/WebSocketConnection.ts","../src/realtime/TransportManager.ts","../src/realtime/Connection.ts","../src/core/ServerActions.ts","../src/core/PersistentConnection.ts","../src/core/ReadonlyRestClient.ts","../src/core/Repo.ts","../src/core/view/filter/RangedFilter.ts","../src/core/view/filter/LimitedFilter.ts","../src/core/view/QueryParams.ts","../src/api/Reference.ts","../src/core/util/Tree.ts","../src/core/Repo_transaction.ts","../src/core/RepoManager.ts","../src/api/Database.ts","../src/api/internal.ts","../src/api/test_access.ts","../../assets/scripts/editor/firebase/database.js","../../../node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../node_modules/parcel-bundler/src/builtins/css-loader.js","../../../node_modules/vue-hot-reload-api/dist/index.js","../../assets/scripts/editor/views/slider.vue","../../../node_modules/lodash/merge.js","../../assets/scripts/editor/views/editor.vue","../../assets/scripts/editor/editor.js","../../assets/scripts/main.js","../../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["defaultConfig","knob","name","min","max","value","ambience","scale","depth","seed","zoom","fov","config","default","use","get","key","range","Math","abs","requestAnimationFrame","render","canvas","document","getElementById","webgl","getContext","alpha","m4","twgl","isMobileDevice","window","orientation","undefined","navigator","userAgent","indexOf","aspectRatio","clientWidth","clientHeight","pixelRatio","devicePixelRatio","vertices","stretchX","stretchY","position","indices","normal","x","z","push","buffers","createBufferInfoFromArrays","numComponents","data","shader","createProgramInfo","vs","fs","textures","createTextures","noise","src","img","mag","LINEAR","resizeCanvasToDisplaySize","setBuffersAndAttributes","useProgram","program","clearColor","frontFace","CW","viewport","width","height","target","eye","up","camera","lookAt","uniforms","view","inverse","model","identity","u_direction","u_mouse","u_noise","u_resolution","dest","current","elapse","animate","duration","start","time","progress","ease","getBoundingClientRect","bottom","fieldOfView","PI","projection","perspective","console","log","u_knob","u_time","sin","u_depth","u_lightPos","u_lightColor","u_ambientLightColor","u_ambientIntensity","u_specularIntensity","u_scale","u_seed","setUniforms","drawBufferInfo","TRIANGLE_STRIP","addEventListener","event","bounds","clientX","left","y","clientY","top","emptyObject","Object","freeze","isUndef","v","isDef","isTrue","isFalse","isPrimitive","isObject","obj","_toString","prototype","toString","toRawType","call","slice","isPlainObject","isRegExp","isValidArrayIndex","val","n","parseFloat","String","floor","isFinite","isPromise","then","catch","Array","isArray","JSON","stringify","toNumber","isNaN","makeMap","str","expectsLowerCase","map","create","list","split","i","length","toLowerCase","isBuiltInTag","isReservedAttribute","remove","arr","item","index","splice","hasOwnProperty","hasOwn","cached","fn","cache","cachedFn","hit","camelizeRE","camelize","replace","_","c","toUpperCase","capitalize","charAt","hyphenateRE","hyphenate","polyfillBind","ctx","boundFn","a","l","arguments","apply","_length","nativeBind","bind","Function","toArray","ret","extend","to","_from","toObject","res","noop","b","no","looseEqual","isObjectA","isObjectB","isArrayA","isArrayB","every","e","Date","getTime","keysA","keys","keysB","looseIndexOf","once","called","SSR_ATTR","ASSET_TYPES","LIFECYCLE_HOOKS","optionMergeStrategies","silent","productionTip","devtools","performance","errorHandler","warnHandler","ignoredElements","keyCodes","isReservedTag","isReservedAttr","isUnknownElement","getTagNamespace","parsePlatformTagName","mustUseProp","async","_lifecycleHooks","unicodeRegExp","isReserved","charCodeAt","def","enumerable","defineProperty","writable","configurable","bailRE","RegExp","source","parsePath","path","test","segments","hasProto","inBrowser","inWeex","WXEnvironment","platform","weexPlatform","UA","isIE","isIE9","isEdge","isAndroid","isIOS","isChrome","isPhantomJS","isFF","match","nativeWatch","watch","supportsPassive","opts","_isServer","isServerRendering","global","env","VUE_ENV","__VUE_DEVTOOLS_GLOBAL_HOOK__","isNative","Ctor","hasSymbol","Symbol","Reflect","ownKeys","_Set","Set","set","has","add","clear","warn","tip","generateComponentTrace","formatComponentName","hasConsole","classifyRE","classify","msg","vm","trace","error","includeFile","$root","options","cid","_isVue","$options","constructor","_componentTag","file","__file","repeat","$parent","tree","currentRecursiveSequence","last","join","uid","Dep","id","subs","addSub","sub","removeSub","depend","addDep","notify","sort","update","targetStack","pushTarget","popTarget","pop","VNode","tag","children","text","elm","context","componentOptions","asyncFactory","ns","fnContext","fnOptions","fnScopeId","componentInstance","parent","raw","isStatic","isRootInsert","isComment","isCloned","isOnce","asyncMeta","isAsyncPlaceholder","prototypeAccessors","child","defineProperties","createEmptyVNode","node","createTextVNode","cloneVNode","vnode","cloned","arrayProto","arrayMethods","methodsToPatch","forEach","method","original","mutator","args","len","result","ob","__ob__","inserted","observeArray","dep","arrayKeys","getOwnPropertyNames","shouldObserve","toggleObserving","Observer","vmCount","protoAugment","copyAugment","walk","defineReactive$$1","items","observe","__proto__","asRootData","isExtensible","customSetter","shallow","property","getOwnPropertyDescriptor","getter","setter","childOb","reactiveGetter","dependArray","reactiveSetter","newVal","del","strats","el","propsData","defaultStrat","mergeData","from","toVal","fromVal","mergeDataOrFn","parentVal","childVal","mergedDataFn","mergedInstanceDataFn","instanceData","defaultData","mergeHook","concat","dedupeHooks","hooks","hook","mergeAssets","assertObjectType","type","key$1","props","methods","inject","computed","provide","checkComponents","components","validateComponentName","normalizeProps","normalizeInject","normalized","normalizeDirectives","dirs","directives","def$$1","mergeOptions","_base","extends","mixins","mergeField","strat","resolveAsset","warnMissing","assets","camelizedId","PascalCaseId","validateProp","propOptions","prop","absent","booleanIndex","getTypeIndex","Boolean","stringIndex","getPropDefaultValue","prevShouldObserve","assertProp","_props","getType","required","valid","expectedTypes","assertedType","assertType","expectedType","getInvalidTypeMessage","validator","simpleCheckRE","t","isSameType","message","receivedType","expectedValue","styleValue","receivedValue","isExplicable","isBoolean","Number","explicitTypes","some","elem","handleError","err","info","cur","errorCaptured","capture","globalHandleError","invokeWithErrorHandling","handler","_handled","logError","isUsingMicroTask","callbacks","pending","flushCallbacks","copies","timerFunc","Promise","p","resolve","setTimeout","MutationObserver","counter","observer","textNode","createTextNode","characterData","setImmediate","nextTick","cb","_resolve","initProxy","allowedGlobals","warnNonPresent","warnReservedPrefix","hasProxy","Proxy","isBuiltInModifier","hasHandler","isAllowed","$data","getHandler","handlers","_withStripped","_renderProxy","seenObjects","traverse","_traverse","seen","isA","isFrozen","depId","mark","measure","perf","clearMarks","clearMeasures","startTag","endTag","normalizeEvent","passive","once$$1","createFnInvoker","fns","invoker","arguments$1","updateListeners","on","oldOn","remove$$1","createOnceHandler","old","params","mergeVNodeHook","hookKey","oldHook","wrappedHook","merged","extractPropsFromVNodeData","attrs","altKey","keyInLowerCase","checkProp","hash","preserve","simpleNormalizeChildren","normalizeChildren","normalizeArrayChildren","isTextNode","nestedIndex","lastIndex","shift","_isVList","initProvide","_provided","initInjections","resolveInject","provideKey","provideDefault","resolveSlots","slots","slot","name$1","isWhitespace","normalizeScopedSlots","normalSlots","prevSlots","hasNormalSlots","isStable","$stable","$key","_normalized","$hasNormal","normalizeScopedSlot","key$2","proxyNormalSlot","proxy","renderList","iterator","next","done","renderSlot","fallback","bindObject","scopedSlotFn","$scopedSlots","nodes","$slots","$createElement","resolveFilter","isKeyNotMatch","expect","actual","checkKeyCodes","eventKeyCode","builtInKeyCode","eventKeyName","builtInKeyName","mappedKeyCode","bindObjectProps","asProp","isSync","loop","domProps","camelizedKey","hyphenatedKey","$event","renderStatic","isInFor","_staticTrees","staticRenderFns","markStatic","markOnce","markStaticNode","bindObjectListeners","existing","ours","resolveScopedSlots","hasDynamicKeys","contentHashKey","bindDynamicKeys","baseObj","values","prependModifier","symbol","installRenderHelpers","_o","_n","_s","_l","_t","_q","_i","_m","_f","_k","_b","_v","_e","_u","_g","_d","_p","FunctionalRenderContext","this$1","contextVm","_original","isCompiled","_compiled","needNormalization","listeners","injections","scopedSlots","_scopeId","_c","d","createElement","createFunctionalComponent","mergeProps","renderContext","cloneAndMarkFunctionalResult","vnodes","clone","devtoolsMeta","componentVNodeHooks","init","hydrating","_isDestroyed","keepAlive","mountedNode","prepatch","createComponentInstanceForVnode","activeInstance","$mount","oldVnode","updateChildComponent","insert","_isMounted","callHook","queueActivatedComponent","activateChildComponent","destroy","$destroy","deactivateChildComponent","hooksToMerge","createComponent","baseCtor","resolveAsyncComponent","createAsyncPlaceholder","resolveConstructorOptions","transformModel","functional","nativeOn","abstract","installComponentHooks","_isComponent","_parentVnode","inlineTemplate","toMerge","_merged","mergeHook$1","f1","f2","callback","SIMPLE_NORMALIZE","ALWAYS_NORMALIZE","normalizationType","alwaysNormalize","_createElement","is","$vnode","pre","applyNS","registerDeepBindings","force","style","class","initRender","_vnode","parentVnode","_renderChildren","parentData","isUpdatingChildComponent","_parentListeners","currentRenderingInstance","renderMixin","Vue","$nextTick","_render","ref","renderError","ensureCtor","comp","base","__esModule","toStringTag","factory","errorComp","resolved","owner","owners","loading","loadingComp","sync","timerLoading","timerTimeout","$on","forceRender","renderCompleted","$forceUpdate","clearTimeout","reject","reason","component","delay","timeout","getFirstComponentChild","initEvents","_events","_hasHookEvent","updateComponentListeners","remove$1","$off","_target","onceHandler","oldListeners","eventsMixin","hookRE","$once","i$1","cbs","$emit","lowerCaseEvent","setActiveInstance","prevActiveInstance","initLifecycle","$children","$refs","_watcher","_inactive","_directInactive","_isBeingDestroyed","lifecycleMixin","_update","prevEl","$el","prevVnode","restoreActiveInstance","__patch__","__vue__","teardown","_watchers","_data","mountComponent","template","updateComponent","_name","_uid","Watcher","before","renderChildren","newScopedSlots","oldScopedSlots","hasDynamicScopedSlot","needsForceUpdate","$attrs","$listeners","propKeys","_propKeys","isInInactiveTree","direct","j","MAX_UPDATE_COUNT","queue","activatedChildren","circular","waiting","flushing","resetSchedulerState","currentFlushTimestamp","getNow","now","createEvent","timeStamp","flushSchedulerQueue","watcher","run","user","expression","activatedQueue","updatedQueue","callActivatedHooks","callUpdatedHooks","emit","queueWatcher","uid$2","expOrFn","isRenderWatcher","deep","lazy","active","dirty","deps","newDeps","depIds","newDepIds","cleanupDeps","tmp","oldValue","evaluate","sharedPropertyDefinition","sourceKey","proxyGetter","proxySetter","initState","initProps","initMethods","initData","initComputed","initWatch","propsOptions","isRoot","getData","computedWatcherOptions","watchers","_computedWatchers","isSSR","userDef","defineComputed","shouldCache","createComputedGetter","createGetterInvoker","computedGetter","createWatcher","$watch","stateMixin","dataDef","propsDef","$set","$delete","immediate","unwatchFn","uid$3","initMixin","_init","initInternalComponent","_self","vnodeComponentOptions","super","superOptions","cachedSuperOptions","modifiedOptions","resolveModifiedOptions","extendOptions","modified","latest","sealed","sealedOptions","initUse","plugin","installedPlugins","_installedPlugins","unshift","install","initMixin$1","mixin","initExtend","Super","SuperId","cachedCtors","_Ctor","Sub","VueComponent","initProps$1","initComputed$1","Comp","initAssetRegisters","definition","getComponentName","matches","pattern","pruneCache","keepAliveInstance","filter","cachedNode","pruneCacheEntry","cached$$1","patternTypes","KeepAlive","include","exclude","created","destroyed","mounted","ref$1","parseInt","builtInComponents","initGlobalAPI","configDef","util","defineReactive","delete","observable","ssrContext","version","acceptValue","attr","isEnumeratedAttr","isValidContentEditableValue","convertEnumeratedValue","isFalsyAttrValue","isBooleanAttr","xlinkNS","isXlink","getXlinkProp","genClassForVnode","parentNode","childNode","mergeClassData","renderClass","staticClass","dynamicClass","stringifyClass","stringifyArray","stringifyObject","stringified","namespaceMap","svg","math","isHTMLTag","isSVG","unknownElementCache","HTMLUnknownElement","HTMLElement","isTextInputType","query","selected","querySelector","createElement$1","tagName","multiple","setAttribute","createElementNS","namespace","createComment","insertBefore","newNode","referenceNode","removeChild","appendChild","nextSibling","setTextContent","textContent","setStyleScope","scopeId","nodeOps","registerRef","isRemoval","refs","refInFor","emptyNode","sameVnode","sameInputType","typeA","typeB","createKeyToOldIdx","beginIdx","endIdx","createPatchFunction","backend","modules","emptyNodeAt","createRmCb","childElm","removeNode","isUnknownElement$$1","inVPre","ignore","creatingElmInVPre","createElm","insertedVnodeQueue","parentElm","refElm","nested","ownerArray","setScope","createChildren","invokeCreateHooks","isReactivated","initComponent","reactivateComponent","pendingInsert","isPatchable","innerNode","transition","activate","ref$$1","checkDuplicateKeys","ancestor","addVnodes","startIdx","invokeDestroyHook","removeVnodes","ch","removeAndInvokeRemoveHook","rm","updateChildren","oldCh","newCh","removeOnly","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","oldKeyToIdx","idxInOld","vnodeToMove","canMove","patchVnode","findIdxInOld","seenKeys","end","hydrate","postpatch","invokeInsertHook","initial","hydrationBailed","isRenderedModule","assertNodeMatch","hasChildNodes","innerHTML","childrenMatch","firstChild","childNodes","fullInvoke","nodeType","patch","isInitialPatch","isRealElement","hasAttribute","removeAttribute","oldElm","_leaveCb","patchable","i$2","updateDirectives","unbindDirectives","isCreate","isDestroy","oldDirs","normalizeDirectives$1","newDirs","dirsWithInsert","dirsWithPostpatch","oldDir","dir","callHook$1","oldArg","arg","componentUpdated","callInsert","emptyModifiers","modifiers","getRawDirName","rawName","baseModules","updateAttrs","inheritAttrs","oldAttrs","setAttr","removeAttributeNS","baseSetAttr","setAttributeNS","__ieph","blocker","stopImmediatePropagation","removeEventListener","updateClass","oldData","cls","transitionClass","_transitionClasses","_prevClass","klass","RANGE_TOKEN","CHECKBOX_RADIO_TOKEN","normalizeEvents","change","target$1","createOnceHandler$1","remove$2","useMicrotaskFix","add$1","attachedTimestamp","_wrapper","currentTarget","ownerDocument","updateDOMListeners","events","svgContainer","updateDOMProps","oldProps","_value","strCur","shouldUpdateValue","checkVal","composing","isNotInFocusAndDirty","isDirtyWithModifiers","notInFocus","activeElement","_vModifiers","number","trim","parseStyleText","cssText","listDelimiter","propertyDelimiter","normalizeStyleData","normalizeStyleBinding","staticStyle","bindingStyle","getStyle","checkChild","styleData","cssVarRE","importantRE","setProp","setProperty","normalizedName","normalize","vendorNames","emptyStyle","capName","updateStyle","oldStaticStyle","oldStyleBinding","normalizedStyle","oldStyle","newStyle","whitespaceRE","addClass","classList","getAttribute","removeClass","tar","resolveTransition","css","autoCssTransition","enterClass","enterToClass","enterActiveClass","leaveClass","leaveToClass","leaveActiveClass","hasTransition","TRANSITION","ANIMATION","transitionProp","transitionEndEvent","animationProp","animationEndEvent","ontransitionend","onwebkittransitionend","onanimationend","onwebkitanimationend","raf","nextFrame","addTransitionClass","transitionClasses","removeTransitionClass","whenTransitionEnds","getTransitionInfo","propCount","ended","onEnd","transformRE","styles","getComputedStyle","transitionDelays","transitionDurations","transitionTimeout","getTimeout","animationDelays","animationDurations","animationTimeout","hasTransform","delays","durations","toMs","s","enter","toggleDisplay","cancelled","_enterCb","appearClass","appearToClass","appearActiveClass","beforeEnter","afterEnter","enterCancelled","beforeAppear","appear","afterAppear","appearCancelled","transitionNode","isAppear","startClass","activeClass","toClass","beforeEnterHook","enterHook","afterEnterHook","enterCancelledHook","explicitEnterDuration","checkDuration","expectsCSS","userWantsControl","getHookArgumentsLength","show","pendingNode","_pending","isValidDuration","leave","beforeLeave","afterLeave","leaveCancelled","delayLeave","explicitLeaveDuration","performLeave","invokerFns","_enter","platformModules","vmodel","trigger","directive","binding","_vOptions","setSelected","getValue","onCompositionStart","onCompositionEnd","prevOptions","curOptions","o","needReset","hasNoMatchingOption","actuallySetSelected","isMultiple","option","selectedIndex","initEvent","dispatchEvent","locateNode","transition$$1","originalDisplay","__vOriginalDisplay","display","unbind","platformDirectives","transitionProps","mode","getRealChild","compOptions","extractTransitionData","placeholder","h","rawChild","hasParentTransition","isSameChild","oldChild","isNotTextNode","isVShowDirective","Transition","_leaving","oldRawChild","delayedLeave","moveClass","TransitionGroup","beforeMount","kept","prevChildren","rawChildren","transitionData","removed","c$1","pos","updated","hasMove","callPendingCbs","recordPosition","applyTranslation","_reflow","body","offsetHeight","moved","transform","WebkitTransform","transitionDuration","_moveCb","propertyName","_hasMove","cloneNode","newPos","oldPos","dx","dy","platformComponents","extendStatics","setPrototypeOf","__extends","__","__assign","assign","__rest","getOwnPropertySymbols","__decorate","decorators","desc","r","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","rejected","__generator","label","sent","trys","ops","f","g","verb","op","TypeError","__exportStar","m","exports","__values","__read","ar","__spread","__await","__asyncGenerator","asyncIterator","q","resume","settle","fulfill","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","__importStar","mod","k","__importDefault","tslib_1.__extends","stringToByteArray","ErrorFactory","deepCopy","deepExtend","contains","Logger","isBrowser","isNode","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","process","module","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","Item","array","title","argv","versions","addListener","off","removeListener","removeAllListeners","prependListener","prependOnceListener","cwd","chdir","umask","jsonEval","Sha1","base64","assert","LogLevel","isNodeSdk","stringLength","errorPrefixFxn","validateArgCount","validateCallback","Deferred","assertionError","MAX_NODE","setMaxNode","safeGet","setPriorityMaxNode","nodeFromJSON","getCount","getAnyKey","validateContextObject","errorPrefix","isEmpty","getValues","__referenceConstructor","findValue","findKey","isMobileCordova","base64Encode","ENV_CONSTANTS","isAdmin","isValidFormat","CONSTANTS","isReactNative","querystring","database","bundleURL","getBundleURLCached","getBundleURL","stack","getBaseURL","url","bundle","require","updateLink","link","newLink","onload","href","cssTimeout","reloadCSS","links","querySelectorAll","editor","OVERLAY_ID","OldModule","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","parse","handled","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","overlay","createErrorOverlay","stackTrace","innerText","getParents","parents"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1BA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC9BA;;;;AAEA,IAAIA,aAAa,GAAG;AAClBC,EAAAA,IAAI,EAAE;A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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;eC9QA;AACA,EAAA,IAAA,EAAA,QADA;AAGA,EAAA,KAAA,EAAA;AACA,IAAA,MAAA,EAAA,MADA;AAEA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AAFA,GAHA;AAWA,EAAA,QAAA,EAAA;AACA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","file":"main.46fe0dba.js","sourceRoot":"../resources/views/pages","sourcesContent":["/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignMergeValue;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nmodule.exports = safeGet;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nmodule.exports = toPlainObject;\n","var assignMergeValue = require('./_assignMergeValue'),\n    cloneBuffer = require('./_cloneBuffer'),\n    cloneTypedArray = require('./_cloneTypedArray'),\n    copyArray = require('./_copyArray'),\n    initCloneObject = require('./_initCloneObject'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isPlainObject = require('./isPlainObject'),\n    isTypedArray = require('./isTypedArray'),\n    safeGet = require('./_safeGet'),\n    toPlainObject = require('./toPlainObject');\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nmodule.exports = baseMergeDeep;\n","var Stack = require('./_Stack'),\n    assignMergeValue = require('./_assignMergeValue'),\n    baseFor = require('./_baseFor'),\n    baseMergeDeep = require('./_baseMergeDeep'),\n    isObject = require('./isObject'),\n    keysIn = require('./keysIn'),\n    safeGet = require('./_safeGet');\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    if (isObject(srcValue)) {\n      stack || (stack = new Stack);\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nmodule.exports = baseMerge;\n","var baseMerge = require('./_baseMerge'),\n    isObject = require('./isObject');\n\n/**\n * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n * objects into destination objects that are passed thru.\n *\n * @private\n * @param {*} objValue The destination value.\n * @param {*} srcValue The source value.\n * @param {string} key The key of the property to merge.\n * @param {Object} object The parent object of `objValue`.\n * @param {Object} source The parent object of `srcValue`.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n * @returns {*} Returns the value to assign.\n */\nfunction customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n  if (isObject(objValue) && isObject(srcValue)) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, objValue);\n    baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n    stack['delete'](srcValue);\n  }\n  return objValue;\n}\n\nmodule.exports = customDefaultsMerge;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","var baseMerge = require('./_baseMerge'),\n    createAssigner = require('./_createAssigner');\n\n/**\n * This method is like `_.merge` except that it accepts `customizer` which\n * is invoked to produce the merged values of the destination and source\n * properties. If `customizer` returns `undefined`, merging is handled by the\n * method instead. The `customizer` is invoked with six arguments:\n * (objValue, srcValue, key, object, source, stack).\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} sources The source objects.\n * @param {Function} customizer The function to customize assigned values.\n * @returns {Object} Returns `object`.\n * @example\n *\n * function customizer(objValue, srcValue) {\n *   if (_.isArray(objValue)) {\n *     return objValue.concat(srcValue);\n *   }\n * }\n *\n * var object = { 'a': [1], 'b': [2] };\n * var other = { 'a': [3], 'b': [4] };\n *\n * _.mergeWith(object, other, customizer);\n * // => { 'a': [1, 3], 'b': [2, 4] }\n */\nvar mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n  baseMerge(object, source, srcIndex, customizer);\n});\n\nmodule.exports = mergeWith;\n","var apply = require('./_apply'),\n    baseRest = require('./_baseRest'),\n    customDefaultsMerge = require('./_customDefaultsMerge'),\n    mergeWith = require('./mergeWith');\n\n/**\n * This method is like `_.defaults` except that it recursively assigns\n * default properties.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 3.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.defaults\n * @example\n *\n * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n * // => { 'a': { 'b': 2, 'c': 3 } }\n */\nvar defaultsDeep = baseRest(function(args) {\n  args.push(undefined, customDefaultsMerge);\n  return apply(mergeWith, undefined, args);\n});\n\nmodule.exports = defaultsDeep;\n","import defaultsDeep from 'lodash/defaultsDeep'\n\nvar defaultConfig = {\n  knob: { name: 'Test Knob', min: 0, max: 1, value: 0.5 },\n  ambience: { name: 'Ambience', min: 0, max: 1, value: 0.4 },\n  scale: { name: 'Scale', min: 0, max: 4, value: 0.25 },\n  depth: { name: 'Height', min: 1, max: 400, value: 0.175 },\n  seed: { name: 'Seed', min: 0, max: 1, value: 0.175 },\n  zoom: { name: 'Zoom', min: 0, max: 120, value: 0.25 },\n  fov: { name: 'Field of view', min: 50, max: 250, value: 0.4 }\n}\n\nvar config = defaultConfig\n\nexport default {\n  default () {\n    return defaultConfig\n  },\n\n  use (value) {\n    return config = defaultsDeep(value, defaultConfig)\n  },\n\n  get (key) {\n    var value = config[key];\n    var range = Math.abs(value.max - value.min);\n    return value.min + range * value.value;\n  }\n}\n","module.exports = atob('Ly8gQXV0aG9yOiBUb2JpYXMgVG9mdAovLyBUaXRsZTogTW91bnRhaW4gcmlkZ2VzIGZvciBRdWFydGVyIFN0dWRpbywgdi4gMC4wLjIKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnVuaWZvcm0gbWF0NCB2aWV3Owp1bmlmb3JtIHZlYzMgdV9saWdodFBvczsKdW5pZm9ybSBmbG9hdCB1X2FtYmllbnRJbnRlbnNpdHk7CnVuaWZvcm0gZmxvYXQgdV9zcGVjdWxhckludGVuc2l0eTsKdW5pZm9ybSB2ZWMzIHVfYW1iaWVudExpZ2h0Q29sb3I7CnVuaWZvcm0gdmVjMyB1X2xpZ2h0Q29sb3I7CnVuaWZvcm0gdmVjMiB1X3Jlc29sdXRpb247CnVuaWZvcm0gc2FtcGxlcjJEIHVfbm9pc2U7CnVuaWZvcm0gZmxvYXQgdV9kZXB0aDsKdW5pZm9ybSB2ZWMyIHVfbW91c2U7CnZhcnlpbmcgdmVjMyB2X25vcm1hbDsKdmFyeWluZyB2ZWMzIHZfZnJhZ1BvczsKdmFyeWluZyB2ZWMyIHZfdGV4Q29vcmQ7CgpmbG9hdCB3aGl0ZU5vaXNlKGluIHZlYzIgcCl7CiAgdmVjMiB0diA9IHAgKiB1X3Jlc29sdXRpb24gLyAyNTYuOwogIHJldHVybiB0ZXh0dXJlMkQodV9ub2lzZSwgdHYpLnI7Cn0KCnZlYzQgSyA9IHZlYzQoMS4wLCAyLjAgLyAzLjAsIDEuMCAvIDMuMCwgMy4wKTsKdmVjMyBoc3YycmdiKHZlYzMgYyl7CiAgdmVjMyBwID0gYWJzKGZyYWN0KGMueHh4ICsgSy54eXopICogNi4wIC0gSy53d3cpOwogIHJldHVybiBjLnogKiBtaXgoSy54eHgsIGNsYW1wKHAgLSBLLnh4eCwgMC4wLCAxLjApLCBjLnkpOwp9CgpmbG9hdCBnZXREZXB0aChmbG9hdCBuLCBmbG9hdCBjdXRvZmYsIGZsb2F0IHN0ZXBzKXsKICBmbG9hdCBkID0gKG4tY3V0b2ZmKS8oMS4tY3V0b2ZmKTsKICBkID0gZmxvb3IoZCpzdGVwcykvc3RlcHM7CiAgcmV0dXJuIGQ7Cn0KCmZsb2F0IG1hcFJhbmdlKGZsb2F0IHZhbCwgZmxvYXQgbG93MSwgZmxvYXQgaGlnaDEsIGZsb2F0IGxvdzIsIGZsb2F0IGhpZ2gyKXsKICByZXR1cm4gbG93MiArICh2YWwgLSBsb3cxKSAqIChoaWdoMiAtIGxvdzIpIC8gKGhpZ2gxIC0gbG93MSk7Cn0KCnZvaWQgbWFpbigpewogIHZlYzIgdXYgPSBnbF9GcmFnQ29vcmQueHkgLyB1X3Jlc29sdXRpb247CiAgZmxvYXQgeVBvcyA9IHZfZnJhZ1Bvcy55IC8gdV9kZXB0aDsgLy95IHBvc2l0aW9uIGluIDAuLjEgcmFuZ2UKICB2ZWMzIGxpZ2h0Q29sb3IgPSB1X2xpZ2h0Q29sb3I7CiAgdmVjMyBhbWJpZW50TGlnaHRDb2xvciA9IHVfYW1iaWVudExpZ2h0Q29sb3I7CgogIC8vIFNsaWNlIGhpbGxzIGludG8gbGF5ZXJzCiAgY29uc3QgaW50IHN0ZXBzID0gMzsgLy9udW1iZXIgb2YgbGF5ZXJzCiAgY29uc3QgaW50IG9mZnNldCA9IDA7IC8vc3RhcnQgY291bnRpbmcgbiBsYXllcnMgd2l0aCBhbiBvZmZzZXQKCiAgLy8gU2V0IHBpeGVsIGNvbG9yCiAgZmxvYXQgaCA9IDAuMDsKICBmbG9hdCBzID0gMC4wOwogIGZsb2F0IHYgPSAwLjA7CgogIGZsb2F0IGQgPSBnZXREZXB0aCh5UG9zLCAwLjAsIGZsb2F0KHN0ZXBzKSk7CiAgZmxvYXQgdGhpY2tuZXNzID0gMC4wODsgLy9mb3IgbWFraW5nIHNpbXBsZSBncmFkaWVudHMKCiAgZm9yIChpbnQgaSA9IG9mZnNldDsgaTxzdGVwczsgaSsrKXsKICAgIGZsb2F0IHZhbHVlID0gZmxvYXQoaSkgLyBmbG9hdChzdGVwcyk7CgogICAgaWYgKHlQb3MgPD0gdmFsdWUgJiYgeVBvcyA+IHZhbHVlIC0gdGhpY2tuZXNzKXsKICAgICAgdiArPSBtYXBSYW5nZSh5UG9zLCB2YWx1ZSAtIHRoaWNrbmVzcywgdmFsdWUsIDAuMCwgMC43KTsKCiAgICB9CgogICAgaWYgKHlQb3MgPD0gdmFsdWUgJiYgeVBvcyA+IHZhbHVlIC0gMC4wMDMpIHsKICAgICAgdiA9IDEuOwogICAgfQogIH0KCiAgdiAqPSBmbG9vcigod2hpdGVOb2lzZSh1dikgKiB2KSArIC44NSk7CiAgdiArPSBmbG9vciggKHdoaXRlTm9pc2UodXYgKiAzLikgKyAuNCkgKiBmbG9vcih2ICsgLjkpICk7CiAgdiA9IGNsYW1wKHYsIDAuLCAxLik7CgogIC8vIEFkZCBsaWdodGluZwogIHZlYzMgYW1iaWVuY2UgPSB1X2FtYmllbnRJbnRlbnNpdHkgKiBhbWJpZW50TGlnaHRDb2xvcjsKICB2ZWMzIGxpZ2h0UG9zID0gdV9saWdodFBvczsKICB2ZWMzIG5vcm1hbGl6ZWQgPSBub3JtYWxpemUodl9ub3JtYWwpOwogIHZlYzMgbGlnaHREaXJlY3Rpb24gPSBub3JtYWxpemUobGlnaHRQb3MgLSB2X2ZyYWdQb3MpOwogIHZlYzMgZGlmZnVzZSA9IG1heChkb3Qobm9ybWFsaXplZCwgbGlnaHREaXJlY3Rpb24pLCAwLikgKiBsaWdodENvbG9yOwoKICB2ZWMzIHBvc2l0aW9uID0gdmVjMygtdV9tb3VzZS54ICogdV9yZXNvbHV0aW9uLngvNS4sIC01MDAuMCwgdV9tb3VzZS55ICogdV9yZXNvbHV0aW9uLnkvNS4pOyAvL3NldCBsaWdodCBvcmlnaW4KICB2ZWMzIHZpZXdEaXJlY3Rpb24gPSBub3JtYWxpemUocG9zaXRpb24gLSB2X2ZyYWdQb3MpOwogIHZlYzMgcmVmbGVjdGlvbkRpcmVjdGlvbiA9IHJlZmxlY3QoLWxpZ2h0RGlyZWN0aW9uLCBub3JtYWxpemVkKTsKCiAgZmxvYXQgc3BlYyA9IHBvdyhtYXgoZG90KHZpZXdEaXJlY3Rpb24sIHJlZmxlY3Rpb25EaXJlY3Rpb24pLCAwLjApLCA0Lik7CiAgdmVjMyBzcGVjdWxhciA9IHVfc3BlY3VsYXJJbnRlbnNpdHkgKiBzcGVjICogbGlnaHRDb2xvcjsKCiAgdmVjMyBsaWdodGluZyA9IGRpZmZ1c2UgKyBhbWJpZW5jZSArIHNwZWN1bGFyOwoKICAvLyBTZXQgZGlmZnVzZSBjb2xvcgogIHZlYzMgZGlmZnVzZUNvbG9yID0gaHN2MnJnYih2ZWMzKGgsIHMsIHYpKTsKICB2ZWMzIGNvbCA9IGRpZmZ1c2VDb2xvciAqIGxpZ2h0aW5nOyAvL2FkZCBsaWdodGluZwoKICAvLyBQb3N0LWxpZ2h0aW5nIG5vaXNlCiAgLy8gQWRkIG5vaXNlIGFuZCBjbGFtcCB2YWx1ZXMKICAvL2NvbCA9IGZsb29yKCh3aGl0ZU5vaXNlKHV2KSAqIHYpICsgY29sICsgMC40KTsgLy9tb25vIG5vaXNlCiAgLy9jb2wgKj0gZmxvb3IoKHdoaXRlTm9pc2UodXYpICogdikgKyAwLjg1KTsgLy9ncmV5IG5vaXNlCiAgLy9jb2wgKz0gICh3aGl0ZU5vaXNlKHV2ICogMy4pICsgMC40KSAqIGZsb29yKGNvbCArIDAuOCkgKiAwLjI7IC8vc2Vjb25kIGxheWVyCiAgLy9jb2wgPSBjbGFtcChjb2wsIDAuMCwgMS4wKTsKCiAgLy8gQWRkIHZlcnRpY2FsIGdyYWRpZW50CiAgY29sICo9IDAuMzUgKyB1di55ICogMC42NTsKCiAgdmVjNCBmaW5hbENvbG9yID0gdmVjNChjb2wsIDEuMCk7CiAgLy9maW5hbENvbG9yICs9IHZlYzQoMS4wLCAoMS4teVBvcyksICgxLi15UG9zKSAqIDAuNCwgMS4wKTsgLy9kZWJ1ZyBvdmVycmlkZQogIGdsX0ZyYWdDb2xvciA9IGZpbmFsQ29sb3I7Cn0=');","module.exports = atob('cHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMyIHRleGNvb3JkOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIHBvc2l0aW9uOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIG5vcm1hbHM7CnVuaWZvcm0gbWVkaXVtcCBmbG9hdCB1X2tub2I7CnVuaWZvcm0gbWVkaXVtcCBmbG9hdCB1X3NjYWxlOwp1bmlmb3JtIG1lZGl1bXAgZmxvYXQgdV9kZXB0aDsKdW5pZm9ybSBtZWRpdW1wIGZsb2F0IHVfdGltZTsKdW5pZm9ybSBtZWRpdW1wIGZsb2F0IHVfc2VlZDsKdW5pZm9ybSBtZWRpdW1wIG1hdDQgcHJvamVjdGlvbjsKdW5pZm9ybSBtZWRpdW1wIG1hdDQgbW9kZWw7CnVuaWZvcm0gbWVkaXVtcCBtYXQ0IHZpZXc7CnVuaWZvcm0gbWVkaXVtcCB2ZWMyIHVfcmVzb2x1dGlvbjsKdW5pZm9ybSBtZWRpdW1wIHZlYzIgdV9kaXJlY3Rpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWMyIHZfdGV4Q29vcmQ7CnZhcnlpbmcgbWVkaXVtcCB2ZWMzIHZfZnJhZ1BvczsKdmFyeWluZyBtZWRpdW1wIHZlYzMgdl9ub3JtYWw7Cgpjb25zdCB2ZWM0IEMgPSB2ZWM0KAogIDAuMjExMzI0ODY1NDA1MTg3LAogIDAuMzY2MDI1NDAzNzg0NDM5LAogIC0wLjU3NzM1MDI2OTE4OTYyNiwKICAwLjAyNDM5MDI0MzkwMjQzOQopOwoKdmVjMyBtb2QyODkgKHZlYzMgeCkgewogIHJldHVybiB4IC0gZmxvb3IoeCAqICgxLiAvIDI4OS4pKSAqIDI4OS47Cn0KCnZlYzMgcGVybXV0ZSAodmVjMyB4KSB7CiAgcmV0dXJuIG1vZDI4OSgoKHgqMzQuKSsxLikqeCk7Cn0KCmZsb2F0IHNub2lzZSAodmVjMiB2KSB7CiAgLy8gRmlyc3QgY29ybmVyCiAgdmVjMiBpICA9IGZsb29yKHYgKyBkb3QodiwgQy55eSkpOwogIHZlYzIgeDAgPSB2IC0gaSArIGRvdChpLCBDLnh4KTsKCiAgLy8gT3RoZXIgY29ybmVycwogIHZlYzIgaTEgPSB4MC54ID4geDAueSA/IHZlYzIoMS4sIDAuKSA6IHZlYzIoMC4sIDEuKTsKICB2ZWM0IHgxMiA9IHgwLnh5eHkgKyBDLnh4eno7CiAgeDEyLnh5IC09IGkxOwoKICAvLyBQZXJtdXRhdGlvbnMKICBpID0gaSAtIGZsb29yKGkgKiAoMS4gLyAyODkuKSkgKiAyODkuOyAvLyBBdm9pZCB0cnVuY2F0aW9uIGVmZmVjdHMgaW4gcGVybXV0YXRpb24KICB2ZWMzIHAgPSBwZXJtdXRlKCBwZXJtdXRlKCBpLnkgKyB2ZWMzKDAuMCwgaTEueSwgMS4wICkpICsgaS54ICsgdmVjMygwLjAsIGkxLngsIDEuMCApKTsKCiAgdmVjMyBtID0gbWF4KDAuNSAtIHZlYzMoZG90KHgwLHgwKSwgZG90KHgxMi54eSx4MTIueHkpLCBkb3QoeDEyLnp3LHgxMi56dykpLCAwLjApOwogIG0gPSBtKm07CiAgbSA9IG0qbTsKCiAgLy8gR3JhZGllbnRzOiA0MSBwb2ludHMgdW5pZm9ybWx5IG92ZXIgYSBsaW5lLCBtYXBwZWQgb250byBhIGRpYW1vbmQuCiAgLy8gVGhlIHJpbmcgc2l6ZSAxNyoxNyA9IDI4OSBpcyBjbG9zZSB0byBhIG11bHRpcGxlIG9mIDQxICg0MSo3ID0gMjg3KQogIHZlYzMgeCA9IDIuMCAqIGZyYWN0KHAgKiBDLnd3dykgLSAxLjA7CiAgdmVjMyBoID0gYWJzKHgpIC0gMC41OwogIHZlYzMgb3ggPSBmbG9vcih4ICsgMC41KTsKICB2ZWMzIGEwID0geCAtIG94OwoKICAvLyBOb3JtYWxpc2UgZ3JhZGllbnRzIGltcGxpY2l0bHkgYnkgc2NhbGluZyBtCiAgLy8gQXBwcm94aW1hdGlvbiBvZjogbSAqPSBpbnZlcnNlc3FydCggYTAqYTAgKyBoKmggKTsKICBtICo9IDEuNzkyODQyOTE0MDAxNTkgLSAwLjg1MzczNDcyMDk1MzE0ICogKCBhMCphMCArIGgqaCApOwoKICAvLyBDb21wdXRlIGZpbmFsIG5vaXNlIHZhbHVlIGF0IFAKICB2ZWMzIGc7CiAgZy54ICA9IGEwLnggICogeDAueCAgKyBoLnggICogeDAueTsKICBnLnl6ID0gYTAueXogKiB4MTIueHogKyBoLnl6ICogeDEyLnl3OwogIHJldHVybiAxMzAuMCAqIGRvdChtLCBnKTsKfQoKLy8tLS0gRW5kIG9mIEFzaGltYSBTaW1wbGV4IG5vaXNlCgp2b2lkIG1haW4gKCkgewogIGZsb2F0IGFzcGVjdCA9IHVfcmVzb2x1dGlvbi54IC8gdV9yZXNvbHV0aW9uLnk7CgogIHZlYzIgdXYgPSBwb3NpdGlvbi54eiAvIHVfcmVzb2x1dGlvbjsKCiAgdmVjMiBzY2FsZSA9IHZlYzIoNS4gKiBhc3BlY3QgKiAxLiAvIHVfc2NhbGUsIDUuICogMS4gLyB1X3NjYWxlKTsKCiAgdmVjMiBkaXJlY3Rpb24gPSB1X2RpcmVjdGlvbiAqIHVfdGltZTsKICAvLyB2ZWMyIGRpcmVjdGlvbiA9IHZlYzIodV9kaXJlY3Rpb24ueCAqIHVfdGltZSwgdV9kaXJlY3Rpb24ueSAqIHVfdGltZSk7CgogIHZlYzQgbW92ZW1lbnQgPSB2ZWM0KHBvc2l0aW9uLCAxLik7CiAgCiAgZmxvYXQgbm9pc2UxID0gc25vaXNlKCB1X3NlZWQgKyB2ZWMyKHV2LnggKiBzY2FsZS54ICsgZGlyZWN0aW9uLngsIHV2LnkgKiBzY2FsZS55ICsgZGlyZWN0aW9uLnkgKSk7CiAgZmxvYXQgbm9pc2UyID0gc25vaXNlKCB1X3NlZWQgKyB2ZWMyKHV2LnggKiBzY2FsZS54ICsgZGlyZWN0aW9uLngsIHV2LnkgKiBzY2FsZS55ICsgZGlyZWN0aW9uLnkgLyAzLiApICogMy4pOyAvL3dvYmJsZXMKCiAgbW92ZW1lbnQueSA9IG1peChub2lzZTEsIG5vaXNlMiwgMC4yKSAqIHVfZGVwdGg7CgogIHZfbm9ybWFsID0gbm9ybWFsczsKICB2X2ZyYWdQb3MgPSB2ZWMzKG1vZGVsICogbW92ZW1lbnQpOwogIHZfdGV4Q29vcmQgPSB0ZXhjb29yZDsKICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb24gKiB2aWV3ICogbW9kZWwgKiBtb3ZlbWVudDsKfQ==');","import config from '../editor/config.js';\nimport img from '../../images/noise.png';\nimport fs from './shaders/noise.fs';\nimport vs from './shaders/noise.vs';\n\nrequestAnimationFrame(render);\n\nvar canvas = document.getElementById('animation');\nvar webgl = canvas.getContext('webgl', { alpha: false });\nvar m4 = twgl.m4;\n\nvar isMobileDevice = window.orientation !== undefined || navigator.userAgent.indexOf('IEMobile') !== -1;\nvar aspectRatio = canvas.clientWidth / canvas.clientHeight;\nvar pixelRatio = isMobileDevice ? 1 : window.devicePixelRatio;\nvar vertices = 256;\nvar stretchX = 2.2;\nvar stretchY = 2.6;\nlet position = [];\nlet indices = [];\nlet normal = [];\n\nfor(let x = 0; x < vertices; x++) {\n  for(let z = 0; z < vertices; z++) {\n    position.push((x * aspectRatio * stretchX) - (vertices * stretchX * aspectRatio / 2));\n    position.push(0);\n    position.push((z * stretchY) - (vertices * stretchY / 2));\n    normal.push(0, 0, 1);\n  }\n}\n\nfor (let z = 0; z < vertices - 1; z++) {\n  if (z > 0) {\n    indices.push(z * vertices);\n  }\n\n  for (let x = 0; x < vertices; x++) {\n    indices.push(z * vertices + x);\n    indices.push((z + 1) * vertices + x);\n  }\n\n  if (z < vertices - 2) {\n    indices.push((z + 1) * vertices + vertices - 1);\n  }\n}\n\nvar buffers = twgl.createBufferInfoFromArrays(webgl, {\n  position: { numComponents: 3, data: position },\n  normal: { numComponents: 3, data: normal },\n  indices: { numComponents: 1, data: indices }\n});\n\nvar shader = twgl.createProgramInfo(webgl, [vs, fs]);\nvar textures = twgl.createTextures(webgl, {\n  noise: { src: img, mag: webgl.LINEAR }\n});\n\ntwgl.resizeCanvasToDisplaySize(canvas, pixelRatio);\ntwgl.setBuffersAndAttributes(webgl, shader, buffers);\nwebgl.useProgram(shader.program);\nwebgl.clearColor(0, 0, 0, 1);\nwebgl.frontFace(webgl.CW);\nwebgl.viewport(0, 0, canvas.width, canvas.height);\n\nvar target = [0, 0, 0];\nvar eye = [0, 500, -1];\nvar up = [0, 1, 0];\nvar camera = m4.lookAt(eye, target, up);\nvar uniforms = {\n  view: m4.inverse(camera),\n  model: m4.identity(),\n  u_direction: [0.0, -1.0],\n  u_mouse: [0, 0.5],\n  u_noise: textures.noise,\n  u_resolution: [canvas.width, canvas.height],\n};\n\nvar dest = 100\nvar current = 0\nvar elapse = 0\n\nfunction animate (duration, start = 0) {\n  return function (time) {\n    var elapse = time - start;\n    var progress = Math.min(1, elapse / duration);\n\n    if (progress === 1) {\n      start += duration\n    }\n\n    return progress\n  }\n}\n\nvar ease = animate(1000)\n\nfunction render(time) {\n  requestAnimationFrame(render);\n\n  if (canvas.getBoundingClientRect().bottom) {\n    var fieldOfView = config.get('zoom') * Math.PI / config.get('fov');\n    uniforms.projection = m4.perspective(fieldOfView, aspectRatio, 1, 10000);\n\n    var target = [config.get('knob'), 0, 0];\n    var eye = [config.get('knob'), 500, -1];\n    var up = [0, 1, 0];\n    var camera = m4.lookAt(eye, target, up);\n    uniforms.view = m4.inverse(camera);\n    uniforms.model = m4.identity();\n    \n    if (ease(time) === 1) {\n      console.log('cool')\n    }\n\n\n    // movement = elapse + \n    // time += 1000000000000;\n    // time %= 31400\n    uniforms.u_knob = config.get('knob');\n    uniforms.u_time = Math.sin(time / 30000); // use to slow time up or down\n    uniforms.u_depth = config.get('depth'); // Math.sin(time/200) * 100; // 70 // wobbly mountains\n    uniforms.u_lightPos = [0, 200, 0]; //origin of spotlight\n    uniforms.u_lightColor = [1, 1, 1]; // color of spotlight in RGB\n    uniforms.u_ambientLightColor = [1, 1, 1], // ambient light color in RGB\n    uniforms.u_ambientIntensity = config.get('ambience'); // ambient light intensity [0...1]\n    uniforms.u_specularIntensity = 0.5; // specular intensity of spotlight [0...1]\n    uniforms.u_scale = config.get('scale'); // scale of the simplex noise\n    uniforms.u_seed = config.get('seed');\n    uniforms.u_direction[0] += uniforms.u_mouse[0]*0.001;\n    uniforms.u_direction[1] += uniforms.u_mouse[1]*0.001;\n\n    twgl.setUniforms(shader, uniforms);\n    twgl.drawBufferInfo(webgl, webgl.TRIANGLE_STRIP, buffers);\n  }\n}\n\nwindow.addEventListener('mousemove', function (event) {\n  var bounds = canvas.getBoundingClientRect();\n  var x = (event.clientX - bounds.left) * canvas.width / canvas.clientWidth / canvas.width * 2 - 1;\n  var y = (event.clientY - bounds.top) * canvas.height / canvas.clientHeight / canvas.height * 2 - 1;\n  // uniforms.u_direction = [x, y];\n  uniforms.u_mouse = [x, y];\n});\n\n","/*!\n * Vue.js v2.6.10\n * (c) 2014-2019 Evan You\n * Released under the MIT License.\n */\n/*  */\n\nvar emptyObject = Object.freeze({});\n\n// These helpers produce better VM code in JS engines due to their\n// explicitness and function inlining.\nfunction isUndef (v) {\n  return v === undefined || v === null\n}\n\nfunction isDef (v) {\n  return v !== undefined && v !== null\n}\n\nfunction isTrue (v) {\n  return v === true\n}\n\nfunction isFalse (v) {\n  return v === false\n}\n\n/**\n * Check if value is primitive.\n */\nfunction isPrimitive (value) {\n  return (\n    typeof value === 'string' ||\n    typeof value === 'number' ||\n    // $flow-disable-line\n    typeof value === 'symbol' ||\n    typeof value === 'boolean'\n  )\n}\n\n/**\n * Quick object check - this is primarily used to tell\n * Objects from primitive values when we know the value\n * is a JSON-compliant type.\n */\nfunction isObject (obj) {\n  return obj !== null && typeof obj === 'object'\n}\n\n/**\n * Get the raw type string of a value, e.g., [object Object].\n */\nvar _toString = Object.prototype.toString;\n\nfunction toRawType (value) {\n  return _toString.call(value).slice(8, -1)\n}\n\n/**\n * Strict object type check. Only returns true\n * for plain JavaScript objects.\n */\nfunction isPlainObject (obj) {\n  return _toString.call(obj) === '[object Object]'\n}\n\nfunction isRegExp (v) {\n  return _toString.call(v) === '[object RegExp]'\n}\n\n/**\n * Check if val is a valid array index.\n */\nfunction isValidArrayIndex (val) {\n  var n = parseFloat(String(val));\n  return n >= 0 && Math.floor(n) === n && isFinite(val)\n}\n\nfunction isPromise (val) {\n  return (\n    isDef(val) &&\n    typeof val.then === 'function' &&\n    typeof val.catch === 'function'\n  )\n}\n\n/**\n * Convert a value to a string that is actually rendered.\n */\nfunction toString (val) {\n  return val == null\n    ? ''\n    : Array.isArray(val) || (isPlainObject(val) && val.toString === _toString)\n      ? JSON.stringify(val, null, 2)\n      : String(val)\n}\n\n/**\n * Convert an input value to a number for persistence.\n * If the conversion fails, return original string.\n */\nfunction toNumber (val) {\n  var n = parseFloat(val);\n  return isNaN(n) ? val : n\n}\n\n/**\n * Make a map and return a function for checking if a key\n * is in that map.\n */\nfunction makeMap (\n  str,\n  expectsLowerCase\n) {\n  var map = Object.create(null);\n  var list = str.split(',');\n  for (var i = 0; i < list.length; i++) {\n    map[list[i]] = true;\n  }\n  return expectsLowerCase\n    ? function (val) { return map[val.toLowerCase()]; }\n    : function (val) { return map[val]; }\n}\n\n/**\n * Check if a tag is a built-in tag.\n */\nvar isBuiltInTag = makeMap('slot,component', true);\n\n/**\n * Check if an attribute is a reserved attribute.\n */\nvar isReservedAttribute = makeMap('key,ref,slot,slot-scope,is');\n\n/**\n * Remove an item from an array.\n */\nfunction remove (arr, item) {\n  if (arr.length) {\n    var index = arr.indexOf(item);\n    if (index > -1) {\n      return arr.splice(index, 1)\n    }\n  }\n}\n\n/**\n * Check whether an object has the property.\n */\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn (obj, key) {\n  return hasOwnProperty.call(obj, key)\n}\n\n/**\n * Create a cached version of a pure function.\n */\nfunction cached (fn) {\n  var cache = Object.create(null);\n  return (function cachedFn (str) {\n    var hit = cache[str];\n    return hit || (cache[str] = fn(str))\n  })\n}\n\n/**\n * Camelize a hyphen-delimited string.\n */\nvar camelizeRE = /-(\\w)/g;\nvar camelize = cached(function (str) {\n  return str.replace(camelizeRE, function (_, c) { return c ? c.toUpperCase() : ''; })\n});\n\n/**\n * Capitalize a string.\n */\nvar capitalize = cached(function (str) {\n  return str.charAt(0).toUpperCase() + str.slice(1)\n});\n\n/**\n * Hyphenate a camelCase string.\n */\nvar hyphenateRE = /\\B([A-Z])/g;\nvar hyphenate = cached(function (str) {\n  return str.replace(hyphenateRE, '-$1').toLowerCase()\n});\n\n/**\n * Simple bind polyfill for environments that do not support it,\n * e.g., PhantomJS 1.x. Technically, we don't need this anymore\n * since native bind is now performant enough in most browsers.\n * But removing it would mean breaking code that was able to run in\n * PhantomJS 1.x, so this must be kept for backward compatibility.\n */\n\n/* istanbul ignore next */\nfunction polyfillBind (fn, ctx) {\n  function boundFn (a) {\n    var l = arguments.length;\n    return l\n      ? l > 1\n        ? fn.apply(ctx, arguments)\n        : fn.call(ctx, a)\n      : fn.call(ctx)\n  }\n\n  boundFn._length = fn.length;\n  return boundFn\n}\n\nfunction nativeBind (fn, ctx) {\n  return fn.bind(ctx)\n}\n\nvar bind = Function.prototype.bind\n  ? nativeBind\n  : polyfillBind;\n\n/**\n * Convert an Array-like object to a real Array.\n */\nfunction toArray (list, start) {\n  start = start || 0;\n  var i = list.length - start;\n  var ret = new Array(i);\n  while (i--) {\n    ret[i] = list[i + start];\n  }\n  return ret\n}\n\n/**\n * Mix properties into target object.\n */\nfunction extend (to, _from) {\n  for (var key in _from) {\n    to[key] = _from[key];\n  }\n  return to\n}\n\n/**\n * Merge an Array of Objects into a single Object.\n */\nfunction toObject (arr) {\n  var res = {};\n  for (var i = 0; i < arr.length; i++) {\n    if (arr[i]) {\n      extend(res, arr[i]);\n    }\n  }\n  return res\n}\n\n/* eslint-disable no-unused-vars */\n\n/**\n * Perform no operation.\n * Stubbing args to make Flow happy without leaving useless transpiled code\n * with ...rest (https://flow.org/blog/2017/05/07/Strict-Function-Call-Arity/).\n */\nfunction noop (a, b, c) {}\n\n/**\n * Always return false.\n */\nvar no = function (a, b, c) { return false; };\n\n/* eslint-enable no-unused-vars */\n\n/**\n * Return the same value.\n */\nvar identity = function (_) { return _; };\n\n/**\n * Check if two values are loosely equal - that is,\n * if they are plain objects, do they have the same shape?\n */\nfunction looseEqual (a, b) {\n  if (a === b) { return true }\n  var isObjectA = isObject(a);\n  var isObjectB = isObject(b);\n  if (isObjectA && isObjectB) {\n    try {\n      var isArrayA = Array.isArray(a);\n      var isArrayB = Array.isArray(b);\n      if (isArrayA && isArrayB) {\n        return a.length === b.length && a.every(function (e, i) {\n          return looseEqual(e, b[i])\n        })\n      } else if (a instanceof Date && b instanceof Date) {\n        return a.getTime() === b.getTime()\n      } else if (!isArrayA && !isArrayB) {\n        var keysA = Object.keys(a);\n        var keysB = Object.keys(b);\n        return keysA.length === keysB.length && keysA.every(function (key) {\n          return looseEqual(a[key], b[key])\n        })\n      } else {\n        /* istanbul ignore next */\n        return false\n      }\n    } catch (e) {\n      /* istanbul ignore next */\n      return false\n    }\n  } else if (!isObjectA && !isObjectB) {\n    return String(a) === String(b)\n  } else {\n    return false\n  }\n}\n\n/**\n * Return the first index at which a loosely equal value can be\n * found in the array (if value is a plain object, the array must\n * contain an object of the same shape), or -1 if it is not present.\n */\nfunction looseIndexOf (arr, val) {\n  for (var i = 0; i < arr.length; i++) {\n    if (looseEqual(arr[i], val)) { return i }\n  }\n  return -1\n}\n\n/**\n * Ensure a function is called only once.\n */\nfunction once (fn) {\n  var called = false;\n  return function () {\n    if (!called) {\n      called = true;\n      fn.apply(this, arguments);\n    }\n  }\n}\n\nvar SSR_ATTR = 'data-server-rendered';\n\nvar ASSET_TYPES = [\n  'component',\n  'directive',\n  'filter'\n];\n\nvar LIFECYCLE_HOOKS = [\n  'beforeCreate',\n  'created',\n  'beforeMount',\n  'mounted',\n  'beforeUpdate',\n  'updated',\n  'beforeDestroy',\n  'destroyed',\n  'activated',\n  'deactivated',\n  'errorCaptured',\n  'serverPrefetch'\n];\n\n/*  */\n\n\n\nvar config = ({\n  /**\n   * Option merge strategies (used in core/util/options)\n   */\n  // $flow-disable-line\n  optionMergeStrategies: Object.create(null),\n\n  /**\n   * Whether to suppress warnings.\n   */\n  silent: false,\n\n  /**\n   * Show production mode tip message on boot?\n   */\n  productionTip: process.env.NODE_ENV !== 'production',\n\n  /**\n   * Whether to enable devtools\n   */\n  devtools: process.env.NODE_ENV !== 'production',\n\n  /**\n   * Whether to record perf\n   */\n  performance: false,\n\n  /**\n   * Error handler for watcher errors\n   */\n  errorHandler: null,\n\n  /**\n   * Warn handler for watcher warns\n   */\n  warnHandler: null,\n\n  /**\n   * Ignore certain custom elements\n   */\n  ignoredElements: [],\n\n  /**\n   * Custom user key aliases for v-on\n   */\n  // $flow-disable-line\n  keyCodes: Object.create(null),\n\n  /**\n   * Check if a tag is reserved so that it cannot be registered as a\n   * component. This is platform-dependent and may be overwritten.\n   */\n  isReservedTag: no,\n\n  /**\n   * Check if an attribute is reserved so that it cannot be used as a component\n   * prop. This is platform-dependent and may be overwritten.\n   */\n  isReservedAttr: no,\n\n  /**\n   * Check if a tag is an unknown element.\n   * Platform-dependent.\n   */\n  isUnknownElement: no,\n\n  /**\n   * Get the namespace of an element\n   */\n  getTagNamespace: noop,\n\n  /**\n   * Parse the real tag name for the specific platform.\n   */\n  parsePlatformTagName: identity,\n\n  /**\n   * Check if an attribute must be bound using property, e.g. value\n   * Platform-dependent.\n   */\n  mustUseProp: no,\n\n  /**\n   * Perform updates asynchronously. Intended to be used by Vue Test Utils\n   * This will significantly reduce performance if set to false.\n   */\n  async: true,\n\n  /**\n   * Exposed for legacy reasons\n   */\n  _lifecycleHooks: LIFECYCLE_HOOKS\n});\n\n/*  */\n\n/**\n * unicode letters used for parsing html tags, component names and property paths.\n * using https://www.w3.org/TR/html53/semantics-scripting.html#potentialcustomelementname\n * skipping \\u10000-\\uEFFFF due to it freezing up PhantomJS\n */\nvar unicodeRegExp = /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/;\n\n/**\n * Check if a string starts with $ or _\n */\nfunction isReserved (str) {\n  var c = (str + '').charCodeAt(0);\n  return c === 0x24 || c === 0x5F\n}\n\n/**\n * Define a property.\n */\nfunction def (obj, key, val, enumerable) {\n  Object.defineProperty(obj, key, {\n    value: val,\n    enumerable: !!enumerable,\n    writable: true,\n    configurable: true\n  });\n}\n\n/**\n * Parse simple path.\n */\nvar bailRE = new RegExp((\"[^\" + (unicodeRegExp.source) + \".$_\\\\d]\"));\nfunction parsePath (path) {\n  if (bailRE.test(path)) {\n    return\n  }\n  var segments = path.split('.');\n  return function (obj) {\n    for (var i = 0; i < segments.length; i++) {\n      if (!obj) { return }\n      obj = obj[segments[i]];\n    }\n    return obj\n  }\n}\n\n/*  */\n\n// can we use __proto__?\nvar hasProto = '__proto__' in {};\n\n// Browser environment sniffing\nvar inBrowser = typeof window !== 'undefined';\nvar inWeex = typeof WXEnvironment !== 'undefined' && !!WXEnvironment.platform;\nvar weexPlatform = inWeex && WXEnvironment.platform.toLowerCase();\nvar UA = inBrowser && window.navigator.userAgent.toLowerCase();\nvar isIE = UA && /msie|trident/.test(UA);\nvar isIE9 = UA && UA.indexOf('msie 9.0') > 0;\nvar isEdge = UA && UA.indexOf('edge/') > 0;\nvar isAndroid = (UA && UA.indexOf('android') > 0) || (weexPlatform === 'android');\nvar isIOS = (UA && /iphone|ipad|ipod|ios/.test(UA)) || (weexPlatform === 'ios');\nvar isChrome = UA && /chrome\\/\\d+/.test(UA) && !isEdge;\nvar isPhantomJS = UA && /phantomjs/.test(UA);\nvar isFF = UA && UA.match(/firefox\\/(\\d+)/);\n\n// Firefox has a \"watch\" function on Object.prototype...\nvar nativeWatch = ({}).watch;\n\nvar supportsPassive = false;\nif (inBrowser) {\n  try {\n    var opts = {};\n    Object.defineProperty(opts, 'passive', ({\n      get: function get () {\n        /* istanbul ignore next */\n        supportsPassive = true;\n      }\n    })); // https://github.com/facebook/flow/issues/285\n    window.addEventListener('test-passive', null, opts);\n  } catch (e) {}\n}\n\n// this needs to be lazy-evaled because vue may be required before\n// vue-server-renderer can set VUE_ENV\nvar _isServer;\nvar isServerRendering = function () {\n  if (_isServer === undefined) {\n    /* istanbul ignore if */\n    if (!inBrowser && !inWeex && typeof global !== 'undefined') {\n      // detect presence of vue-server-renderer and avoid\n      // Webpack shimming the process\n      _isServer = global['process'] && global['process'].env.VUE_ENV === 'server';\n    } else {\n      _isServer = false;\n    }\n  }\n  return _isServer\n};\n\n// detect devtools\nvar devtools = inBrowser && window.__VUE_DEVTOOLS_GLOBAL_HOOK__;\n\n/* istanbul ignore next */\nfunction isNative (Ctor) {\n  return typeof Ctor === 'function' && /native code/.test(Ctor.toString())\n}\n\nvar hasSymbol =\n  typeof Symbol !== 'undefined' && isNative(Symbol) &&\n  typeof Reflect !== 'undefined' && isNative(Reflect.ownKeys);\n\nvar _Set;\n/* istanbul ignore if */ // $flow-disable-line\nif (typeof Set !== 'undefined' && isNative(Set)) {\n  // use native Set when available.\n  _Set = Set;\n} else {\n  // a non-standard Set polyfill that only works with primitive keys.\n  _Set = /*@__PURE__*/(function () {\n    function Set () {\n      this.set = Object.create(null);\n    }\n    Set.prototype.has = function has (key) {\n      return this.set[key] === true\n    };\n    Set.prototype.add = function add (key) {\n      this.set[key] = true;\n    };\n    Set.prototype.clear = function clear () {\n      this.set = Object.create(null);\n    };\n\n    return Set;\n  }());\n}\n\n/*  */\n\nvar warn = noop;\nvar tip = noop;\nvar generateComponentTrace = (noop); // work around flow check\nvar formatComponentName = (noop);\n\nif (process.env.NODE_ENV !== 'production') {\n  var hasConsole = typeof console !== 'undefined';\n  var classifyRE = /(?:^|[-_])(\\w)/g;\n  var classify = function (str) { return str\n    .replace(classifyRE, function (c) { return c.toUpperCase(); })\n    .replace(/[-_]/g, ''); };\n\n  warn = function (msg, vm) {\n    var trace = vm ? generateComponentTrace(vm) : '';\n\n    if (config.warnHandler) {\n      config.warnHandler.call(null, msg, vm, trace);\n    } else if (hasConsole && (!config.silent)) {\n      console.error((\"[Vue warn]: \" + msg + trace));\n    }\n  };\n\n  tip = function (msg, vm) {\n    if (hasConsole && (!config.silent)) {\n      console.warn(\"[Vue tip]: \" + msg + (\n        vm ? generateComponentTrace(vm) : ''\n      ));\n    }\n  };\n\n  formatComponentName = function (vm, includeFile) {\n    if (vm.$root === vm) {\n      return '<Root>'\n    }\n    var options = typeof vm === 'function' && vm.cid != null\n      ? vm.options\n      : vm._isVue\n        ? vm.$options || vm.constructor.options\n        : vm;\n    var name = options.name || options._componentTag;\n    var file = options.__file;\n    if (!name && file) {\n      var match = file.match(/([^/\\\\]+)\\.vue$/);\n      name = match && match[1];\n    }\n\n    return (\n      (name ? (\"<\" + (classify(name)) + \">\") : \"<Anonymous>\") +\n      (file && includeFile !== false ? (\" at \" + file) : '')\n    )\n  };\n\n  var repeat = function (str, n) {\n    var res = '';\n    while (n) {\n      if (n % 2 === 1) { res += str; }\n      if (n > 1) { str += str; }\n      n >>= 1;\n    }\n    return res\n  };\n\n  generateComponentTrace = function (vm) {\n    if (vm._isVue && vm.$parent) {\n      var tree = [];\n      var currentRecursiveSequence = 0;\n      while (vm) {\n        if (tree.length > 0) {\n          var last = tree[tree.length - 1];\n          if (last.constructor === vm.constructor) {\n            currentRecursiveSequence++;\n            vm = vm.$parent;\n            continue\n          } else if (currentRecursiveSequence > 0) {\n            tree[tree.length - 1] = [last, currentRecursiveSequence];\n            currentRecursiveSequence = 0;\n          }\n        }\n        tree.push(vm);\n        vm = vm.$parent;\n      }\n      return '\\n\\nfound in\\n\\n' + tree\n        .map(function (vm, i) { return (\"\" + (i === 0 ? '---> ' : repeat(' ', 5 + i * 2)) + (Array.isArray(vm)\n            ? ((formatComponentName(vm[0])) + \"... (\" + (vm[1]) + \" recursive calls)\")\n            : formatComponentName(vm))); })\n        .join('\\n')\n    } else {\n      return (\"\\n\\n(found in \" + (formatComponentName(vm)) + \")\")\n    }\n  };\n}\n\n/*  */\n\nvar uid = 0;\n\n/**\n * A dep is an observable that can have multiple\n * directives subscribing to it.\n */\nvar Dep = function Dep () {\n  this.id = uid++;\n  this.subs = [];\n};\n\nDep.prototype.addSub = function addSub (sub) {\n  this.subs.push(sub);\n};\n\nDep.prototype.removeSub = function removeSub (sub) {\n  remove(this.subs, sub);\n};\n\nDep.prototype.depend = function depend () {\n  if (Dep.target) {\n    Dep.target.addDep(this);\n  }\n};\n\nDep.prototype.notify = function notify () {\n  // stabilize the subscriber list first\n  var subs = this.subs.slice();\n  if (process.env.NODE_ENV !== 'production' && !config.async) {\n    // subs aren't sorted in scheduler if not running async\n    // we need to sort them now to make sure they fire in correct\n    // order\n    subs.sort(function (a, b) { return a.id - b.id; });\n  }\n  for (var i = 0, l = subs.length; i < l; i++) {\n    subs[i].update();\n  }\n};\n\n// The current target watcher being evaluated.\n// This is globally unique because only one watcher\n// can be evaluated at a time.\nDep.target = null;\nvar targetStack = [];\n\nfunction pushTarget (target) {\n  targetStack.push(target);\n  Dep.target = target;\n}\n\nfunction popTarget () {\n  targetStack.pop();\n  Dep.target = targetStack[targetStack.length - 1];\n}\n\n/*  */\n\nvar VNode = function VNode (\n  tag,\n  data,\n  children,\n  text,\n  elm,\n  context,\n  componentOptions,\n  asyncFactory\n) {\n  this.tag = tag;\n  this.data = data;\n  this.children = children;\n  this.text = text;\n  this.elm = elm;\n  this.ns = undefined;\n  this.context = context;\n  this.fnContext = undefined;\n  this.fnOptions = undefined;\n  this.fnScopeId = undefined;\n  this.key = data && data.key;\n  this.componentOptions = componentOptions;\n  this.componentInstance = undefined;\n  this.parent = undefined;\n  this.raw = false;\n  this.isStatic = false;\n  this.isRootInsert = true;\n  this.isComment = false;\n  this.isCloned = false;\n  this.isOnce = false;\n  this.asyncFactory = asyncFactory;\n  this.asyncMeta = undefined;\n  this.isAsyncPlaceholder = false;\n};\n\nvar prototypeAccessors = { child: { configurable: true } };\n\n// DEPRECATED: alias for componentInstance for backwards compat.\n/* istanbul ignore next */\nprototypeAccessors.child.get = function () {\n  return this.componentInstance\n};\n\nObject.defineProperties( VNode.prototype, prototypeAccessors );\n\nvar createEmptyVNode = function (text) {\n  if ( text === void 0 ) text = '';\n\n  var node = new VNode();\n  node.text = text;\n  node.isComment = true;\n  return node\n};\n\nfunction createTextVNode (val) {\n  return new VNode(undefined, undefined, undefined, String(val))\n}\n\n// optimized shallow clone\n// used for static nodes and slot nodes because they may be reused across\n// multiple renders, cloning them avoids errors when DOM manipulations rely\n// on their elm reference.\nfunction cloneVNode (vnode) {\n  var cloned = new VNode(\n    vnode.tag,\n    vnode.data,\n    // #7975\n    // clone children array to avoid mutating original in case of cloning\n    // a child.\n    vnode.children && vnode.children.slice(),\n    vnode.text,\n    vnode.elm,\n    vnode.context,\n    vnode.componentOptions,\n    vnode.asyncFactory\n  );\n  cloned.ns = vnode.ns;\n  cloned.isStatic = vnode.isStatic;\n  cloned.key = vnode.key;\n  cloned.isComment = vnode.isComment;\n  cloned.fnContext = vnode.fnContext;\n  cloned.fnOptions = vnode.fnOptions;\n  cloned.fnScopeId = vnode.fnScopeId;\n  cloned.asyncMeta = vnode.asyncMeta;\n  cloned.isCloned = true;\n  return cloned\n}\n\n/*\n * not type checking this file because flow doesn't play well with\n * dynamically accessing methods on Array prototype\n */\n\nvar arrayProto = Array.prototype;\nvar arrayMethods = Object.create(arrayProto);\n\nvar methodsToPatch = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse'\n];\n\n/**\n * Intercept mutating methods and emit events\n */\nmethodsToPatch.forEach(function (method) {\n  // cache original method\n  var original = arrayProto[method];\n  def(arrayMethods, method, function mutator () {\n    var args = [], len = arguments.length;\n    while ( len-- ) args[ len ] = arguments[ len ];\n\n    var result = original.apply(this, args);\n    var ob = this.__ob__;\n    var inserted;\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args;\n        break\n      case 'splice':\n        inserted = args.slice(2);\n        break\n    }\n    if (inserted) { ob.observeArray(inserted); }\n    // notify change\n    ob.dep.notify();\n    return result\n  });\n});\n\n/*  */\n\nvar arrayKeys = Object.getOwnPropertyNames(arrayMethods);\n\n/**\n * In some cases we may want to disable observation inside a component's\n * update computation.\n */\nvar shouldObserve = true;\n\nfunction toggleObserving (value) {\n  shouldObserve = value;\n}\n\n/**\n * Observer class that is attached to each observed\n * object. Once attached, the observer converts the target\n * object's property keys into getter/setters that\n * collect dependencies and dispatch updates.\n */\nvar Observer = function Observer (value) {\n  this.value = value;\n  this.dep = new Dep();\n  this.vmCount = 0;\n  def(value, '__ob__', this);\n  if (Array.isArray(value)) {\n    if (hasProto) {\n      protoAugment(value, arrayMethods);\n    } else {\n      copyAugment(value, arrayMethods, arrayKeys);\n    }\n    this.observeArray(value);\n  } else {\n    this.walk(value);\n  }\n};\n\n/**\n * Walk through all properties and convert them into\n * getter/setters. This method should only be called when\n * value type is Object.\n */\nObserver.prototype.walk = function walk (obj) {\n  var keys = Object.keys(obj);\n  for (var i = 0; i < keys.length; i++) {\n    defineReactive$$1(obj, keys[i]);\n  }\n};\n\n/**\n * Observe a list of Array items.\n */\nObserver.prototype.observeArray = function observeArray (items) {\n  for (var i = 0, l = items.length; i < l; i++) {\n    observe(items[i]);\n  }\n};\n\n// helpers\n\n/**\n * Augment a target Object or Array by intercepting\n * the prototype chain using __proto__\n */\nfunction protoAugment (target, src) {\n  /* eslint-disable no-proto */\n  target.__proto__ = src;\n  /* eslint-enable no-proto */\n}\n\n/**\n * Augment a target Object or Array by defining\n * hidden properties.\n */\n/* istanbul ignore next */\nfunction copyAugment (target, src, keys) {\n  for (var i = 0, l = keys.length; i < l; i++) {\n    var key = keys[i];\n    def(target, key, src[key]);\n  }\n}\n\n/**\n * Attempt to create an observer instance for a value,\n * returns the new observer if successfully observed,\n * or the existing observer if the value already has one.\n */\nfunction observe (value, asRootData) {\n  if (!isObject(value) || value instanceof VNode) {\n    return\n  }\n  var ob;\n  if (hasOwn(value, '__ob__') && value.__ob__ instanceof Observer) {\n    ob = value.__ob__;\n  } else if (\n    shouldObserve &&\n    !isServerRendering() &&\n    (Array.isArray(value) || isPlainObject(value)) &&\n    Object.isExtensible(value) &&\n    !value._isVue\n  ) {\n    ob = new Observer(value);\n  }\n  if (asRootData && ob) {\n    ob.vmCount++;\n  }\n  return ob\n}\n\n/**\n * Define a reactive property on an Object.\n */\nfunction defineReactive$$1 (\n  obj,\n  key,\n  val,\n  customSetter,\n  shallow\n) {\n  var dep = new Dep();\n\n  var property = Object.getOwnPropertyDescriptor(obj, key);\n  if (property && property.configurable === false) {\n    return\n  }\n\n  // cater for pre-defined getter/setters\n  var getter = property && property.get;\n  var setter = property && property.set;\n  if ((!getter || setter) && arguments.length === 2) {\n    val = obj[key];\n  }\n\n  var childOb = !shallow && observe(val);\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: function reactiveGetter () {\n      var value = getter ? getter.call(obj) : val;\n      if (Dep.target) {\n        dep.depend();\n        if (childOb) {\n          childOb.dep.depend();\n          if (Array.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      return value\n    },\n    set: function reactiveSetter (newVal) {\n      var value = getter ? getter.call(obj) : val;\n      /* eslint-disable no-self-compare */\n      if (newVal === value || (newVal !== newVal && value !== value)) {\n        return\n      }\n      /* eslint-enable no-self-compare */\n      if (process.env.NODE_ENV !== 'production' && customSetter) {\n        customSetter();\n      }\n      // #7981: for accessor properties without setter\n      if (getter && !setter) { return }\n      if (setter) {\n        setter.call(obj, newVal);\n      } else {\n        val = newVal;\n      }\n      childOb = !shallow && observe(newVal);\n      dep.notify();\n    }\n  });\n}\n\n/**\n * Set a property on an object. Adds the new property and\n * triggers change notification if the property doesn't\n * already exist.\n */\nfunction set (target, key, val) {\n  if (process.env.NODE_ENV !== 'production' &&\n    (isUndef(target) || isPrimitive(target))\n  ) {\n    warn((\"Cannot set reactive property on undefined, null, or primitive value: \" + ((target))));\n  }\n  if (Array.isArray(target) && isValidArrayIndex(key)) {\n    target.length = Math.max(target.length, key);\n    target.splice(key, 1, val);\n    return val\n  }\n  if (key in target && !(key in Object.prototype)) {\n    target[key] = val;\n    return val\n  }\n  var ob = (target).__ob__;\n  if (target._isVue || (ob && ob.vmCount)) {\n    process.env.NODE_ENV !== 'production' && warn(\n      'Avoid adding reactive properties to a Vue instance or its root $data ' +\n      'at runtime - declare it upfront in the data option.'\n    );\n    return val\n  }\n  if (!ob) {\n    target[key] = val;\n    return val\n  }\n  defineReactive$$1(ob.value, key, val);\n  ob.dep.notify();\n  return val\n}\n\n/**\n * Delete a property and trigger change if necessary.\n */\nfunction del (target, key) {\n  if (process.env.NODE_ENV !== 'production' &&\n    (isUndef(target) || isPrimitive(target))\n  ) {\n    warn((\"Cannot delete reactive property on undefined, null, or primitive value: \" + ((target))));\n  }\n  if (Array.isArray(target) && isValidArrayIndex(key)) {\n    target.splice(key, 1);\n    return\n  }\n  var ob = (target).__ob__;\n  if (target._isVue || (ob && ob.vmCount)) {\n    process.env.NODE_ENV !== 'production' && warn(\n      'Avoid deleting properties on a Vue instance or its root $data ' +\n      '- just set it to null.'\n    );\n    return\n  }\n  if (!hasOwn(target, key)) {\n    return\n  }\n  delete target[key];\n  if (!ob) {\n    return\n  }\n  ob.dep.notify();\n}\n\n/**\n * Collect dependencies on array elements when the array is touched, since\n * we cannot intercept array element access like property getters.\n */\nfunction dependArray (value) {\n  for (var e = (void 0), i = 0, l = value.length; i < l; i++) {\n    e = value[i];\n    e && e.__ob__ && e.__ob__.dep.depend();\n    if (Array.isArray(e)) {\n      dependArray(e);\n    }\n  }\n}\n\n/*  */\n\n/**\n * Option overwriting strategies are functions that handle\n * how to merge a parent option value and a child option\n * value into the final value.\n */\nvar strats = config.optionMergeStrategies;\n\n/**\n * Options with restrictions\n */\nif (process.env.NODE_ENV !== 'production') {\n  strats.el = strats.propsData = function (parent, child, vm, key) {\n    if (!vm) {\n      warn(\n        \"option \\\"\" + key + \"\\\" can only be used during instance \" +\n        'creation with the `new` keyword.'\n      );\n    }\n    return defaultStrat(parent, child)\n  };\n}\n\n/**\n * Helper that recursively merges two data objects together.\n */\nfunction mergeData (to, from) {\n  if (!from) { return to }\n  var key, toVal, fromVal;\n\n  var keys = hasSymbol\n    ? Reflect.ownKeys(from)\n    : Object.keys(from);\n\n  for (var i = 0; i < keys.length; i++) {\n    key = keys[i];\n    // in case the object is already observed...\n    if (key === '__ob__') { continue }\n    toVal = to[key];\n    fromVal = from[key];\n    if (!hasOwn(to, key)) {\n      set(to, key, fromVal);\n    } else if (\n      toVal !== fromVal &&\n      isPlainObject(toVal) &&\n      isPlainObject(fromVal)\n    ) {\n      mergeData(toVal, fromVal);\n    }\n  }\n  return to\n}\n\n/**\n * Data\n */\nfunction mergeDataOrFn (\n  parentVal,\n  childVal,\n  vm\n) {\n  if (!vm) {\n    // in a Vue.extend merge, both should be functions\n    if (!childVal) {\n      return parentVal\n    }\n    if (!parentVal) {\n      return childVal\n    }\n    // when parentVal & childVal are both present,\n    // we need to return a function that returns the\n    // merged result of both functions... no need to\n    // check if parentVal is a function here because\n    // it has to be a function to pass previous merges.\n    return function mergedDataFn () {\n      return mergeData(\n        typeof childVal === 'function' ? childVal.call(this, this) : childVal,\n        typeof parentVal === 'function' ? parentVal.call(this, this) : parentVal\n      )\n    }\n  } else {\n    return function mergedInstanceDataFn () {\n      // instance merge\n      var instanceData = typeof childVal === 'function'\n        ? childVal.call(vm, vm)\n        : childVal;\n      var defaultData = typeof parentVal === 'function'\n        ? parentVal.call(vm, vm)\n        : parentVal;\n      if (instanceData) {\n        return mergeData(instanceData, defaultData)\n      } else {\n        return defaultData\n      }\n    }\n  }\n}\n\nstrats.data = function (\n  parentVal,\n  childVal,\n  vm\n) {\n  if (!vm) {\n    if (childVal && typeof childVal !== 'function') {\n      process.env.NODE_ENV !== 'production' && warn(\n        'The \"data\" option should be a function ' +\n        'that returns a per-instance value in component ' +\n        'definitions.',\n        vm\n      );\n\n      return parentVal\n    }\n    return mergeDataOrFn(parentVal, childVal)\n  }\n\n  return mergeDataOrFn(parentVal, childVal, vm)\n};\n\n/**\n * Hooks and props are merged as arrays.\n */\nfunction mergeHook (\n  parentVal,\n  childVal\n) {\n  var res = childVal\n    ? parentVal\n      ? parentVal.concat(childVal)\n      : Array.isArray(childVal)\n        ? childVal\n        : [childVal]\n    : parentVal;\n  return res\n    ? dedupeHooks(res)\n    : res\n}\n\nfunction dedupeHooks (hooks) {\n  var res = [];\n  for (var i = 0; i < hooks.length; i++) {\n    if (res.indexOf(hooks[i]) === -1) {\n      res.push(hooks[i]);\n    }\n  }\n  return res\n}\n\nLIFECYCLE_HOOKS.forEach(function (hook) {\n  strats[hook] = mergeHook;\n});\n\n/**\n * Assets\n *\n * When a vm is present (instance creation), we need to do\n * a three-way merge between constructor options, instance\n * options and parent options.\n */\nfunction mergeAssets (\n  parentVal,\n  childVal,\n  vm,\n  key\n) {\n  var res = Object.create(parentVal || null);\n  if (childVal) {\n    process.env.NODE_ENV !== 'production' && assertObjectType(key, childVal, vm);\n    return extend(res, childVal)\n  } else {\n    return res\n  }\n}\n\nASSET_TYPES.forEach(function (type) {\n  strats[type + 's'] = mergeAssets;\n});\n\n/**\n * Watchers.\n *\n * Watchers hashes should not overwrite one\n * another, so we merge them as arrays.\n */\nstrats.watch = function (\n  parentVal,\n  childVal,\n  vm,\n  key\n) {\n  // work around Firefox's Object.prototype.watch...\n  if (parentVal === nativeWatch) { parentVal = undefined; }\n  if (childVal === nativeWatch) { childVal = undefined; }\n  /* istanbul ignore if */\n  if (!childVal) { return Object.create(parentVal || null) }\n  if (process.env.NODE_ENV !== 'production') {\n    assertObjectType(key, childVal, vm);\n  }\n  if (!parentVal) { return childVal }\n  var ret = {};\n  extend(ret, parentVal);\n  for (var key$1 in childVal) {\n    var parent = ret[key$1];\n    var child = childVal[key$1];\n    if (parent && !Array.isArray(parent)) {\n      parent = [parent];\n    }\n    ret[key$1] = parent\n      ? parent.concat(child)\n      : Array.isArray(child) ? child : [child];\n  }\n  return ret\n};\n\n/**\n * Other object hashes.\n */\nstrats.props =\nstrats.methods =\nstrats.inject =\nstrats.computed = function (\n  parentVal,\n  childVal,\n  vm,\n  key\n) {\n  if (childVal && process.env.NODE_ENV !== 'production') {\n    assertObjectType(key, childVal, vm);\n  }\n  if (!parentVal) { return childVal }\n  var ret = Object.create(null);\n  extend(ret, parentVal);\n  if (childVal) { extend(ret, childVal); }\n  return ret\n};\nstrats.provide = mergeDataOrFn;\n\n/**\n * Default strategy.\n */\nvar defaultStrat = function (parentVal, childVal) {\n  return childVal === undefined\n    ? parentVal\n    : childVal\n};\n\n/**\n * Validate component names\n */\nfunction checkComponents (options) {\n  for (var key in options.components) {\n    validateComponentName(key);\n  }\n}\n\nfunction validateComponentName (name) {\n  if (!new RegExp((\"^[a-zA-Z][\\\\-\\\\.0-9_\" + (unicodeRegExp.source) + \"]*$\")).test(name)) {\n    warn(\n      'Invalid component name: \"' + name + '\". Component names ' +\n      'should conform to valid custom element name in html5 specification.'\n    );\n  }\n  if (isBuiltInTag(name) || config.isReservedTag(name)) {\n    warn(\n      'Do not use built-in or reserved HTML elements as component ' +\n      'id: ' + name\n    );\n  }\n}\n\n/**\n * Ensure all props option syntax are normalized into the\n * Object-based format.\n */\nfunction normalizeProps (options, vm) {\n  var props = options.props;\n  if (!props) { return }\n  var res = {};\n  var i, val, name;\n  if (Array.isArray(props)) {\n    i = props.length;\n    while (i--) {\n      val = props[i];\n      if (typeof val === 'string') {\n        name = camelize(val);\n        res[name] = { type: null };\n      } else if (process.env.NODE_ENV !== 'production') {\n        warn('props must be strings when using array syntax.');\n      }\n    }\n  } else if (isPlainObject(props)) {\n    for (var key in props) {\n      val = props[key];\n      name = camelize(key);\n      res[name] = isPlainObject(val)\n        ? val\n        : { type: val };\n    }\n  } else if (process.env.NODE_ENV !== 'production') {\n    warn(\n      \"Invalid value for option \\\"props\\\": expected an Array or an Object, \" +\n      \"but got \" + (toRawType(props)) + \".\",\n      vm\n    );\n  }\n  options.props = res;\n}\n\n/**\n * Normalize all injections into Object-based format\n */\nfunction normalizeInject (options, vm) {\n  var inject = options.inject;\n  if (!inject) { return }\n  var normalized = options.inject = {};\n  if (Array.isArray(inject)) {\n    for (var i = 0; i < inject.length; i++) {\n      normalized[inject[i]] = { from: inject[i] };\n    }\n  } else if (isPlainObject(inject)) {\n    for (var key in inject) {\n      var val = inject[key];\n      normalized[key] = isPlainObject(val)\n        ? extend({ from: key }, val)\n        : { from: val };\n    }\n  } else if (process.env.NODE_ENV !== 'production') {\n    warn(\n      \"Invalid value for option \\\"inject\\\": expected an Array or an Object, \" +\n      \"but got \" + (toRawType(inject)) + \".\",\n      vm\n    );\n  }\n}\n\n/**\n * Normalize raw function directives into object format.\n */\nfunction normalizeDirectives (options) {\n  var dirs = options.directives;\n  if (dirs) {\n    for (var key in dirs) {\n      var def$$1 = dirs[key];\n      if (typeof def$$1 === 'function') {\n        dirs[key] = { bind: def$$1, update: def$$1 };\n      }\n    }\n  }\n}\n\nfunction assertObjectType (name, value, vm) {\n  if (!isPlainObject(value)) {\n    warn(\n      \"Invalid value for option \\\"\" + name + \"\\\": expected an Object, \" +\n      \"but got \" + (toRawType(value)) + \".\",\n      vm\n    );\n  }\n}\n\n/**\n * Merge two option objects into a new one.\n * Core utility used in both instantiation and inheritance.\n */\nfunction mergeOptions (\n  parent,\n  child,\n  vm\n) {\n  if (process.env.NODE_ENV !== 'production') {\n    checkComponents(child);\n  }\n\n  if (typeof child === 'function') {\n    child = child.options;\n  }\n\n  normalizeProps(child, vm);\n  normalizeInject(child, vm);\n  normalizeDirectives(child);\n\n  // Apply extends and mixins on the child options,\n  // but only if it is a raw options object that isn't\n  // the result of another mergeOptions call.\n  // Only merged options has the _base property.\n  if (!child._base) {\n    if (child.extends) {\n      parent = mergeOptions(parent, child.extends, vm);\n    }\n    if (child.mixins) {\n      for (var i = 0, l = child.mixins.length; i < l; i++) {\n        parent = mergeOptions(parent, child.mixins[i], vm);\n      }\n    }\n  }\n\n  var options = {};\n  var key;\n  for (key in parent) {\n    mergeField(key);\n  }\n  for (key in child) {\n    if (!hasOwn(parent, key)) {\n      mergeField(key);\n    }\n  }\n  function mergeField (key) {\n    var strat = strats[key] || defaultStrat;\n    options[key] = strat(parent[key], child[key], vm, key);\n  }\n  return options\n}\n\n/**\n * Resolve an asset.\n * This function is used because child instances need access\n * to assets defined in its ancestor chain.\n */\nfunction resolveAsset (\n  options,\n  type,\n  id,\n  warnMissing\n) {\n  /* istanbul ignore if */\n  if (typeof id !== 'string') {\n    return\n  }\n  var assets = options[type];\n  // check local registration variations first\n  if (hasOwn(assets, id)) { return assets[id] }\n  var camelizedId = camelize(id);\n  if (hasOwn(assets, camelizedId)) { return assets[camelizedId] }\n  var PascalCaseId = capitalize(camelizedId);\n  if (hasOwn(assets, PascalCaseId)) { return assets[PascalCaseId] }\n  // fallback to prototype chain\n  var res = assets[id] || assets[camelizedId] || assets[PascalCaseId];\n  if (process.env.NODE_ENV !== 'production' && warnMissing && !res) {\n    warn(\n      'Failed to resolve ' + type.slice(0, -1) + ': ' + id,\n      options\n    );\n  }\n  return res\n}\n\n/*  */\n\n\n\nfunction validateProp (\n  key,\n  propOptions,\n  propsData,\n  vm\n) {\n  var prop = propOptions[key];\n  var absent = !hasOwn(propsData, key);\n  var value = propsData[key];\n  // boolean casting\n  var booleanIndex = getTypeIndex(Boolean, prop.type);\n  if (booleanIndex > -1) {\n    if (absent && !hasOwn(prop, 'default')) {\n      value = false;\n    } else if (value === '' || value === hyphenate(key)) {\n      // only cast empty string / same name to boolean if\n      // boolean has higher priority\n      var stringIndex = getTypeIndex(String, prop.type);\n      if (stringIndex < 0 || booleanIndex < stringIndex) {\n        value = true;\n      }\n    }\n  }\n  // check default value\n  if (value === undefined) {\n    value = getPropDefaultValue(vm, prop, key);\n    // since the default value is a fresh copy,\n    // make sure to observe it.\n    var prevShouldObserve = shouldObserve;\n    toggleObserving(true);\n    observe(value);\n    toggleObserving(prevShouldObserve);\n  }\n  if (\n    process.env.NODE_ENV !== 'production' &&\n    // skip validation for weex recycle-list child component props\n    !(false)\n  ) {\n    assertProp(prop, key, value, vm, absent);\n  }\n  return value\n}\n\n/**\n * Get the default value of a prop.\n */\nfunction getPropDefaultValue (vm, prop, key) {\n  // no default, return undefined\n  if (!hasOwn(prop, 'default')) {\n    return undefined\n  }\n  var def = prop.default;\n  // warn against non-factory defaults for Object & Array\n  if (process.env.NODE_ENV !== 'production' && isObject(def)) {\n    warn(\n      'Invalid default value for prop \"' + key + '\": ' +\n      'Props with type Object/Array must use a factory function ' +\n      'to return the default value.',\n      vm\n    );\n  }\n  // the raw prop value was also undefined from previous render,\n  // return previous default value to avoid unnecessary watcher trigger\n  if (vm && vm.$options.propsData &&\n    vm.$options.propsData[key] === undefined &&\n    vm._props[key] !== undefined\n  ) {\n    return vm._props[key]\n  }\n  // call factory function for non-Function types\n  // a value is Function if its prototype is function even across different execution context\n  return typeof def === 'function' && getType(prop.type) !== 'Function'\n    ? def.call(vm)\n    : def\n}\n\n/**\n * Assert whether a prop is valid.\n */\nfunction assertProp (\n  prop,\n  name,\n  value,\n  vm,\n  absent\n) {\n  if (prop.required && absent) {\n    warn(\n      'Missing required prop: \"' + name + '\"',\n      vm\n    );\n    return\n  }\n  if (value == null && !prop.required) {\n    return\n  }\n  var type = prop.type;\n  var valid = !type || type === true;\n  var expectedTypes = [];\n  if (type) {\n    if (!Array.isArray(type)) {\n      type = [type];\n    }\n    for (var i = 0; i < type.length && !valid; i++) {\n      var assertedType = assertType(value, type[i]);\n      expectedTypes.push(assertedType.expectedType || '');\n      valid = assertedType.valid;\n    }\n  }\n\n  if (!valid) {\n    warn(\n      getInvalidTypeMessage(name, value, expectedTypes),\n      vm\n    );\n    return\n  }\n  var validator = prop.validator;\n  if (validator) {\n    if (!validator(value)) {\n      warn(\n        'Invalid prop: custom validator check failed for prop \"' + name + '\".',\n        vm\n      );\n    }\n  }\n}\n\nvar simpleCheckRE = /^(String|Number|Boolean|Function|Symbol)$/;\n\nfunction assertType (value, type) {\n  var valid;\n  var expectedType = getType(type);\n  if (simpleCheckRE.test(expectedType)) {\n    var t = typeof value;\n    valid = t === expectedType.toLowerCase();\n    // for primitive wrapper objects\n    if (!valid && t === 'object') {\n      valid = value instanceof type;\n    }\n  } else if (expectedType === 'Object') {\n    valid = isPlainObject(value);\n  } else if (expectedType === 'Array') {\n    valid = Array.isArray(value);\n  } else {\n    valid = value instanceof type;\n  }\n  return {\n    valid: valid,\n    expectedType: expectedType\n  }\n}\n\n/**\n * Use function string name to check built-in types,\n * because a simple equality check will fail when running\n * across different vms / iframes.\n */\nfunction getType (fn) {\n  var match = fn && fn.toString().match(/^\\s*function (\\w+)/);\n  return match ? match[1] : ''\n}\n\nfunction isSameType (a, b) {\n  return getType(a) === getType(b)\n}\n\nfunction getTypeIndex (type, expectedTypes) {\n  if (!Array.isArray(expectedTypes)) {\n    return isSameType(expectedTypes, type) ? 0 : -1\n  }\n  for (var i = 0, len = expectedTypes.length; i < len; i++) {\n    if (isSameType(expectedTypes[i], type)) {\n      return i\n    }\n  }\n  return -1\n}\n\nfunction getInvalidTypeMessage (name, value, expectedTypes) {\n  var message = \"Invalid prop: type check failed for prop \\\"\" + name + \"\\\".\" +\n    \" Expected \" + (expectedTypes.map(capitalize).join(', '));\n  var expectedType = expectedTypes[0];\n  var receivedType = toRawType(value);\n  var expectedValue = styleValue(value, expectedType);\n  var receivedValue = styleValue(value, receivedType);\n  // check if we need to specify expected value\n  if (expectedTypes.length === 1 &&\n      isExplicable(expectedType) &&\n      !isBoolean(expectedType, receivedType)) {\n    message += \" with value \" + expectedValue;\n  }\n  message += \", got \" + receivedType + \" \";\n  // check if we need to specify received value\n  if (isExplicable(receivedType)) {\n    message += \"with value \" + receivedValue + \".\";\n  }\n  return message\n}\n\nfunction styleValue (value, type) {\n  if (type === 'String') {\n    return (\"\\\"\" + value + \"\\\"\")\n  } else if (type === 'Number') {\n    return (\"\" + (Number(value)))\n  } else {\n    return (\"\" + value)\n  }\n}\n\nfunction isExplicable (value) {\n  var explicitTypes = ['string', 'number', 'boolean'];\n  return explicitTypes.some(function (elem) { return value.toLowerCase() === elem; })\n}\n\nfunction isBoolean () {\n  var args = [], len = arguments.length;\n  while ( len-- ) args[ len ] = arguments[ len ];\n\n  return args.some(function (elem) { return elem.toLowerCase() === 'boolean'; })\n}\n\n/*  */\n\nfunction handleError (err, vm, info) {\n  // Deactivate deps tracking while processing error handler to avoid possible infinite rendering.\n  // See: https://github.com/vuejs/vuex/issues/1505\n  pushTarget();\n  try {\n    if (vm) {\n      var cur = vm;\n      while ((cur = cur.$parent)) {\n        var hooks = cur.$options.errorCaptured;\n        if (hooks) {\n          for (var i = 0; i < hooks.length; i++) {\n            try {\n              var capture = hooks[i].call(cur, err, vm, info) === false;\n              if (capture) { return }\n            } catch (e) {\n              globalHandleError(e, cur, 'errorCaptured hook');\n            }\n          }\n        }\n      }\n    }\n    globalHandleError(err, vm, info);\n  } finally {\n    popTarget();\n  }\n}\n\nfunction invokeWithErrorHandling (\n  handler,\n  context,\n  args,\n  vm,\n  info\n) {\n  var res;\n  try {\n    res = args ? handler.apply(context, args) : handler.call(context);\n    if (res && !res._isVue && isPromise(res) && !res._handled) {\n      res.catch(function (e) { return handleError(e, vm, info + \" (Promise/async)\"); });\n      // issue #9511\n      // avoid catch triggering multiple times when nested calls\n      res._handled = true;\n    }\n  } catch (e) {\n    handleError(e, vm, info);\n  }\n  return res\n}\n\nfunction globalHandleError (err, vm, info) {\n  if (config.errorHandler) {\n    try {\n      return config.errorHandler.call(null, err, vm, info)\n    } catch (e) {\n      // if the user intentionally throws the original error in the handler,\n      // do not log it twice\n      if (e !== err) {\n        logError(e, null, 'config.errorHandler');\n      }\n    }\n  }\n  logError(err, vm, info);\n}\n\nfunction logError (err, vm, info) {\n  if (process.env.NODE_ENV !== 'production') {\n    warn((\"Error in \" + info + \": \\\"\" + (err.toString()) + \"\\\"\"), vm);\n  }\n  /* istanbul ignore else */\n  if ((inBrowser || inWeex) && typeof console !== 'undefined') {\n    console.error(err);\n  } else {\n    throw err\n  }\n}\n\n/*  */\n\nvar isUsingMicroTask = false;\n\nvar callbacks = [];\nvar pending = false;\n\nfunction flushCallbacks () {\n  pending = false;\n  var copies = callbacks.slice(0);\n  callbacks.length = 0;\n  for (var i = 0; i < copies.length; i++) {\n    copies[i]();\n  }\n}\n\n// Here we have async deferring wrappers using microtasks.\n// In 2.5 we used (macro) tasks (in combination with microtasks).\n// However, it has subtle problems when state is changed right before repaint\n// (e.g. #6813, out-in transitions).\n// Also, using (macro) tasks in event handler would cause some weird behaviors\n// that cannot be circumvented (e.g. #7109, #7153, #7546, #7834, #8109).\n// So we now use microtasks everywhere, again.\n// A major drawback of this tradeoff is that there are some scenarios\n// where microtasks have too high a priority and fire in between supposedly\n// sequential events (e.g. #4521, #6690, which have workarounds)\n// or even between bubbling of the same event (#6566).\nvar timerFunc;\n\n// The nextTick behavior leverages the microtask queue, which can be accessed\n// via either native Promise.then or MutationObserver.\n// MutationObserver has wider support, however it is seriously bugged in\n// UIWebView in iOS >= 9.3.3 when triggered in touch event handlers. It\n// completely stops working after triggering a few times... so, if native\n// Promise is available, we will use it:\n/* istanbul ignore next, $flow-disable-line */\nif (typeof Promise !== 'undefined' && isNative(Promise)) {\n  var p = Promise.resolve();\n  timerFunc = function () {\n    p.then(flushCallbacks);\n    // In problematic UIWebViews, Promise.then doesn't completely break, but\n    // it can get stuck in a weird state where callbacks are pushed into the\n    // microtask queue but the queue isn't being flushed, until the browser\n    // needs to do some other work, e.g. handle a timer. Therefore we can\n    // \"force\" the microtask queue to be flushed by adding an empty timer.\n    if (isIOS) { setTimeout(noop); }\n  };\n  isUsingMicroTask = true;\n} else if (!isIE && typeof MutationObserver !== 'undefined' && (\n  isNative(MutationObserver) ||\n  // PhantomJS and iOS 7.x\n  MutationObserver.toString() === '[object MutationObserverConstructor]'\n)) {\n  // Use MutationObserver where native Promise is not available,\n  // e.g. PhantomJS, iOS7, Android 4.4\n  // (#6466 MutationObserver is unreliable in IE11)\n  var counter = 1;\n  var observer = new MutationObserver(flushCallbacks);\n  var textNode = document.createTextNode(String(counter));\n  observer.observe(textNode, {\n    characterData: true\n  });\n  timerFunc = function () {\n    counter = (counter + 1) % 2;\n    textNode.data = String(counter);\n  };\n  isUsingMicroTask = true;\n} else if (typeof setImmediate !== 'undefined' && isNative(setImmediate)) {\n  // Fallback to setImmediate.\n  // Techinically it leverages the (macro) task queue,\n  // but it is still a better choice than setTimeout.\n  timerFunc = function () {\n    setImmediate(flushCallbacks);\n  };\n} else {\n  // Fallback to setTimeout.\n  timerFunc = function () {\n    setTimeout(flushCallbacks, 0);\n  };\n}\n\nfunction nextTick (cb, ctx) {\n  var _resolve;\n  callbacks.push(function () {\n    if (cb) {\n      try {\n        cb.call(ctx);\n      } catch (e) {\n        handleError(e, ctx, 'nextTick');\n      }\n    } else if (_resolve) {\n      _resolve(ctx);\n    }\n  });\n  if (!pending) {\n    pending = true;\n    timerFunc();\n  }\n  // $flow-disable-line\n  if (!cb && typeof Promise !== 'undefined') {\n    return new Promise(function (resolve) {\n      _resolve = resolve;\n    })\n  }\n}\n\n/*  */\n\n/* not type checking this file because flow doesn't play well with Proxy */\n\nvar initProxy;\n\nif (process.env.NODE_ENV !== 'production') {\n  var allowedGlobals = makeMap(\n    'Infinity,undefined,NaN,isFinite,isNaN,' +\n    'parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,' +\n    'Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,' +\n    'require' // for Webpack/Browserify\n  );\n\n  var warnNonPresent = function (target, key) {\n    warn(\n      \"Property or method \\\"\" + key + \"\\\" is not defined on the instance but \" +\n      'referenced during render. Make sure that this property is reactive, ' +\n      'either in the data option, or for class-based components, by ' +\n      'initializing the property. ' +\n      'See: https://vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.',\n      target\n    );\n  };\n\n  var warnReservedPrefix = function (target, key) {\n    warn(\n      \"Property \\\"\" + key + \"\\\" must be accessed with \\\"$data.\" + key + \"\\\" because \" +\n      'properties starting with \"$\" or \"_\" are not proxied in the Vue instance to ' +\n      'prevent conflicts with Vue internals' +\n      'See: https://vuejs.org/v2/api/#data',\n      target\n    );\n  };\n\n  var hasProxy =\n    typeof Proxy !== 'undefined' && isNative(Proxy);\n\n  if (hasProxy) {\n    var isBuiltInModifier = makeMap('stop,prevent,self,ctrl,shift,alt,meta,exact');\n    config.keyCodes = new Proxy(config.keyCodes, {\n      set: function set (target, key, value) {\n        if (isBuiltInModifier(key)) {\n          warn((\"Avoid overwriting built-in modifier in config.keyCodes: .\" + key));\n          return false\n        } else {\n          target[key] = value;\n          return true\n        }\n      }\n    });\n  }\n\n  var hasHandler = {\n    has: function has (target, key) {\n      var has = key in target;\n      var isAllowed = allowedGlobals(key) ||\n        (typeof key === 'string' && key.charAt(0) === '_' && !(key in target.$data));\n      if (!has && !isAllowed) {\n        if (key in target.$data) { warnReservedPrefix(target, key); }\n        else { warnNonPresent(target, key); }\n      }\n      return has || !isAllowed\n    }\n  };\n\n  var getHandler = {\n    get: function get (target, key) {\n      if (typeof key === 'string' && !(key in target)) {\n        if (key in target.$data) { warnReservedPrefix(target, key); }\n        else { warnNonPresent(target, key); }\n      }\n      return target[key]\n    }\n  };\n\n  initProxy = function initProxy (vm) {\n    if (hasProxy) {\n      // determine which proxy handler to use\n      var options = vm.$options;\n      var handlers = options.render && options.render._withStripped\n        ? getHandler\n        : hasHandler;\n      vm._renderProxy = new Proxy(vm, handlers);\n    } else {\n      vm._renderProxy = vm;\n    }\n  };\n}\n\n/*  */\n\nvar seenObjects = new _Set();\n\n/**\n * Recursively traverse an object to evoke all converted\n * getters, so that every nested property inside the object\n * is collected as a \"deep\" dependency.\n */\nfunction traverse (val) {\n  _traverse(val, seenObjects);\n  seenObjects.clear();\n}\n\nfunction _traverse (val, seen) {\n  var i, keys;\n  var isA = Array.isArray(val);\n  if ((!isA && !isObject(val)) || Object.isFrozen(val) || val instanceof VNode) {\n    return\n  }\n  if (val.__ob__) {\n    var depId = val.__ob__.dep.id;\n    if (seen.has(depId)) {\n      return\n    }\n    seen.add(depId);\n  }\n  if (isA) {\n    i = val.length;\n    while (i--) { _traverse(val[i], seen); }\n  } else {\n    keys = Object.keys(val);\n    i = keys.length;\n    while (i--) { _traverse(val[keys[i]], seen); }\n  }\n}\n\nvar mark;\nvar measure;\n\nif (process.env.NODE_ENV !== 'production') {\n  var perf = inBrowser && window.performance;\n  /* istanbul ignore if */\n  if (\n    perf &&\n    perf.mark &&\n    perf.measure &&\n    perf.clearMarks &&\n    perf.clearMeasures\n  ) {\n    mark = function (tag) { return perf.mark(tag); };\n    measure = function (name, startTag, endTag) {\n      perf.measure(name, startTag, endTag);\n      perf.clearMarks(startTag);\n      perf.clearMarks(endTag);\n      // perf.clearMeasures(name)\n    };\n  }\n}\n\n/*  */\n\nvar normalizeEvent = cached(function (name) {\n  var passive = name.charAt(0) === '&';\n  name = passive ? name.slice(1) : name;\n  var once$$1 = name.charAt(0) === '~'; // Prefixed last, checked first\n  name = once$$1 ? name.slice(1) : name;\n  var capture = name.charAt(0) === '!';\n  name = capture ? name.slice(1) : name;\n  return {\n    name: name,\n    once: once$$1,\n    capture: capture,\n    passive: passive\n  }\n});\n\nfunction createFnInvoker (fns, vm) {\n  function invoker () {\n    var arguments$1 = arguments;\n\n    var fns = invoker.fns;\n    if (Array.isArray(fns)) {\n      var cloned = fns.slice();\n      for (var i = 0; i < cloned.length; i++) {\n        invokeWithErrorHandling(cloned[i], null, arguments$1, vm, \"v-on handler\");\n      }\n    } else {\n      // return handler return value for single handlers\n      return invokeWithErrorHandling(fns, null, arguments, vm, \"v-on handler\")\n    }\n  }\n  invoker.fns = fns;\n  return invoker\n}\n\nfunction updateListeners (\n  on,\n  oldOn,\n  add,\n  remove$$1,\n  createOnceHandler,\n  vm\n) {\n  var name, def$$1, cur, old, event;\n  for (name in on) {\n    def$$1 = cur = on[name];\n    old = oldOn[name];\n    event = normalizeEvent(name);\n    if (isUndef(cur)) {\n      process.env.NODE_ENV !== 'production' && warn(\n        \"Invalid handler for event \\\"\" + (event.name) + \"\\\": got \" + String(cur),\n        vm\n      );\n    } else if (isUndef(old)) {\n      if (isUndef(cur.fns)) {\n        cur = on[name] = createFnInvoker(cur, vm);\n      }\n      if (isTrue(event.once)) {\n        cur = on[name] = createOnceHandler(event.name, cur, event.capture);\n      }\n      add(event.name, cur, event.capture, event.passive, event.params);\n    } else if (cur !== old) {\n      old.fns = cur;\n      on[name] = old;\n    }\n  }\n  for (name in oldOn) {\n    if (isUndef(on[name])) {\n      event = normalizeEvent(name);\n      remove$$1(event.name, oldOn[name], event.capture);\n    }\n  }\n}\n\n/*  */\n\nfunction mergeVNodeHook (def, hookKey, hook) {\n  if (def instanceof VNode) {\n    def = def.data.hook || (def.data.hook = {});\n  }\n  var invoker;\n  var oldHook = def[hookKey];\n\n  function wrappedHook () {\n    hook.apply(this, arguments);\n    // important: remove merged hook to ensure it's called only once\n    // and prevent memory leak\n    remove(invoker.fns, wrappedHook);\n  }\n\n  if (isUndef(oldHook)) {\n    // no existing hook\n    invoker = createFnInvoker([wrappedHook]);\n  } else {\n    /* istanbul ignore if */\n    if (isDef(oldHook.fns) && isTrue(oldHook.merged)) {\n      // already a merged invoker\n      invoker = oldHook;\n      invoker.fns.push(wrappedHook);\n    } else {\n      // existing plain hook\n      invoker = createFnInvoker([oldHook, wrappedHook]);\n    }\n  }\n\n  invoker.merged = true;\n  def[hookKey] = invoker;\n}\n\n/*  */\n\nfunction extractPropsFromVNodeData (\n  data,\n  Ctor,\n  tag\n) {\n  // we are only extracting raw values here.\n  // validation and default values are handled in the child\n  // component itself.\n  var propOptions = Ctor.options.props;\n  if (isUndef(propOptions)) {\n    return\n  }\n  var res = {};\n  var attrs = data.attrs;\n  var props = data.props;\n  if (isDef(attrs) || isDef(props)) {\n    for (var key in propOptions) {\n      var altKey = hyphenate(key);\n      if (process.env.NODE_ENV !== 'production') {\n        var keyInLowerCase = key.toLowerCase();\n        if (\n          key !== keyInLowerCase &&\n          attrs && hasOwn(attrs, keyInLowerCase)\n        ) {\n          tip(\n            \"Prop \\\"\" + keyInLowerCase + \"\\\" is passed to component \" +\n            (formatComponentName(tag || Ctor)) + \", but the declared prop name is\" +\n            \" \\\"\" + key + \"\\\". \" +\n            \"Note that HTML attributes are case-insensitive and camelCased \" +\n            \"props need to use their kebab-case equivalents when using in-DOM \" +\n            \"templates. You should probably use \\\"\" + altKey + \"\\\" instead of \\\"\" + key + \"\\\".\"\n          );\n        }\n      }\n      checkProp(res, props, key, altKey, true) ||\n      checkProp(res, attrs, key, altKey, false);\n    }\n  }\n  return res\n}\n\nfunction checkProp (\n  res,\n  hash,\n  key,\n  altKey,\n  preserve\n) {\n  if (isDef(hash)) {\n    if (hasOwn(hash, key)) {\n      res[key] = hash[key];\n      if (!preserve) {\n        delete hash[key];\n      }\n      return true\n    } else if (hasOwn(hash, altKey)) {\n      res[key] = hash[altKey];\n      if (!preserve) {\n        delete hash[altKey];\n      }\n      return true\n    }\n  }\n  return false\n}\n\n/*  */\n\n// The template compiler attempts to minimize the need for normalization by\n// statically analyzing the template at compile time.\n//\n// For plain HTML markup, normalization can be completely skipped because the\n// generated render function is guaranteed to return Array<VNode>. There are\n// two cases where extra normalization is needed:\n\n// 1. When the children contains components - because a functional component\n// may return an Array instead of a single root. In this case, just a simple\n// normalization is needed - if any child is an Array, we flatten the whole\n// thing with Array.prototype.concat. It is guaranteed to be only 1-level deep\n// because functional components already normalize their own children.\nfunction simpleNormalizeChildren (children) {\n  for (var i = 0; i < children.length; i++) {\n    if (Array.isArray(children[i])) {\n      return Array.prototype.concat.apply([], children)\n    }\n  }\n  return children\n}\n\n// 2. When the children contains constructs that always generated nested Arrays,\n// e.g. <template>, <slot>, v-for, or when the children is provided by user\n// with hand-written render functions / JSX. In such cases a full normalization\n// is needed to cater to all possible types of children values.\nfunction normalizeChildren (children) {\n  return isPrimitive(children)\n    ? [createTextVNode(children)]\n    : Array.isArray(children)\n      ? normalizeArrayChildren(children)\n      : undefined\n}\n\nfunction isTextNode (node) {\n  return isDef(node) && isDef(node.text) && isFalse(node.isComment)\n}\n\nfunction normalizeArrayChildren (children, nestedIndex) {\n  var res = [];\n  var i, c, lastIndex, last;\n  for (i = 0; i < children.length; i++) {\n    c = children[i];\n    if (isUndef(c) || typeof c === 'boolean') { continue }\n    lastIndex = res.length - 1;\n    last = res[lastIndex];\n    //  nested\n    if (Array.isArray(c)) {\n      if (c.length > 0) {\n        c = normalizeArrayChildren(c, ((nestedIndex || '') + \"_\" + i));\n        // merge adjacent text nodes\n        if (isTextNode(c[0]) && isTextNode(last)) {\n          res[lastIndex] = createTextVNode(last.text + (c[0]).text);\n          c.shift();\n        }\n        res.push.apply(res, c);\n      }\n    } else if (isPrimitive(c)) {\n      if (isTextNode(last)) {\n        // merge adjacent text nodes\n        // this is necessary for SSR hydration because text nodes are\n        // essentially merged when rendered to HTML strings\n        res[lastIndex] = createTextVNode(last.text + c);\n      } else if (c !== '') {\n        // convert primitive to vnode\n        res.push(createTextVNode(c));\n      }\n    } else {\n      if (isTextNode(c) && isTextNode(last)) {\n        // merge adjacent text nodes\n        res[lastIndex] = createTextVNode(last.text + c.text);\n      } else {\n        // default key for nested array children (likely generated by v-for)\n        if (isTrue(children._isVList) &&\n          isDef(c.tag) &&\n          isUndef(c.key) &&\n          isDef(nestedIndex)) {\n          c.key = \"__vlist\" + nestedIndex + \"_\" + i + \"__\";\n        }\n        res.push(c);\n      }\n    }\n  }\n  return res\n}\n\n/*  */\n\nfunction initProvide (vm) {\n  var provide = vm.$options.provide;\n  if (provide) {\n    vm._provided = typeof provide === 'function'\n      ? provide.call(vm)\n      : provide;\n  }\n}\n\nfunction initInjections (vm) {\n  var result = resolveInject(vm.$options.inject, vm);\n  if (result) {\n    toggleObserving(false);\n    Object.keys(result).forEach(function (key) {\n      /* istanbul ignore else */\n      if (process.env.NODE_ENV !== 'production') {\n        defineReactive$$1(vm, key, result[key], function () {\n          warn(\n            \"Avoid mutating an injected value directly since the changes will be \" +\n            \"overwritten whenever the provided component re-renders. \" +\n            \"injection being mutated: \\\"\" + key + \"\\\"\",\n            vm\n          );\n        });\n      } else {\n        defineReactive$$1(vm, key, result[key]);\n      }\n    });\n    toggleObserving(true);\n  }\n}\n\nfunction resolveInject (inject, vm) {\n  if (inject) {\n    // inject is :any because flow is not smart enough to figure out cached\n    var result = Object.create(null);\n    var keys = hasSymbol\n      ? Reflect.ownKeys(inject)\n      : Object.keys(inject);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      // #6574 in case the inject object is observed...\n      if (key === '__ob__') { continue }\n      var provideKey = inject[key].from;\n      var source = vm;\n      while (source) {\n        if (source._provided && hasOwn(source._provided, provideKey)) {\n          result[key] = source._provided[provideKey];\n          break\n        }\n        source = source.$parent;\n      }\n      if (!source) {\n        if ('default' in inject[key]) {\n          var provideDefault = inject[key].default;\n          result[key] = typeof provideDefault === 'function'\n            ? provideDefault.call(vm)\n            : provideDefault;\n        } else if (process.env.NODE_ENV !== 'production') {\n          warn((\"Injection \\\"\" + key + \"\\\" not found\"), vm);\n        }\n      }\n    }\n    return result\n  }\n}\n\n/*  */\n\n\n\n/**\n * Runtime helper for resolving raw children VNodes into a slot object.\n */\nfunction resolveSlots (\n  children,\n  context\n) {\n  if (!children || !children.length) {\n    return {}\n  }\n  var slots = {};\n  for (var i = 0, l = children.length; i < l; i++) {\n    var child = children[i];\n    var data = child.data;\n    // remove slot attribute if the node is resolved as a Vue slot node\n    if (data && data.attrs && data.attrs.slot) {\n      delete data.attrs.slot;\n    }\n    // named slots should only be respected if the vnode was rendered in the\n    // same context.\n    if ((child.context === context || child.fnContext === context) &&\n      data && data.slot != null\n    ) {\n      var name = data.slot;\n      var slot = (slots[name] || (slots[name] = []));\n      if (child.tag === 'template') {\n        slot.push.apply(slot, child.children || []);\n      } else {\n        slot.push(child);\n      }\n    } else {\n      (slots.default || (slots.default = [])).push(child);\n    }\n  }\n  // ignore slots that contains only whitespace\n  for (var name$1 in slots) {\n    if (slots[name$1].every(isWhitespace)) {\n      delete slots[name$1];\n    }\n  }\n  return slots\n}\n\nfunction isWhitespace (node) {\n  return (node.isComment && !node.asyncFactory) || node.text === ' '\n}\n\n/*  */\n\nfunction normalizeScopedSlots (\n  slots,\n  normalSlots,\n  prevSlots\n) {\n  var res;\n  var hasNormalSlots = Object.keys(normalSlots).length > 0;\n  var isStable = slots ? !!slots.$stable : !hasNormalSlots;\n  var key = slots && slots.$key;\n  if (!slots) {\n    res = {};\n  } else if (slots._normalized) {\n    // fast path 1: child component re-render only, parent did not change\n    return slots._normalized\n  } else if (\n    isStable &&\n    prevSlots &&\n    prevSlots !== emptyObject &&\n    key === prevSlots.$key &&\n    !hasNormalSlots &&\n    !prevSlots.$hasNormal\n  ) {\n    // fast path 2: stable scoped slots w/ no normal slots to proxy,\n    // only need to normalize once\n    return prevSlots\n  } else {\n    res = {};\n    for (var key$1 in slots) {\n      if (slots[key$1] && key$1[0] !== '$') {\n        res[key$1] = normalizeScopedSlot(normalSlots, key$1, slots[key$1]);\n      }\n    }\n  }\n  // expose normal slots on scopedSlots\n  for (var key$2 in normalSlots) {\n    if (!(key$2 in res)) {\n      res[key$2] = proxyNormalSlot(normalSlots, key$2);\n    }\n  }\n  // avoriaz seems to mock a non-extensible $scopedSlots object\n  // and when that is passed down this would cause an error\n  if (slots && Object.isExtensible(slots)) {\n    (slots)._normalized = res;\n  }\n  def(res, '$stable', isStable);\n  def(res, '$key', key);\n  def(res, '$hasNormal', hasNormalSlots);\n  return res\n}\n\nfunction normalizeScopedSlot(normalSlots, key, fn) {\n  var normalized = function () {\n    var res = arguments.length ? fn.apply(null, arguments) : fn({});\n    res = res && typeof res === 'object' && !Array.isArray(res)\n      ? [res] // single vnode\n      : normalizeChildren(res);\n    return res && (\n      res.length === 0 ||\n      (res.length === 1 && res[0].isComment) // #9658\n    ) ? undefined\n      : res\n  };\n  // this is a slot using the new v-slot syntax without scope. although it is\n  // compiled as a scoped slot, render fn users would expect it to be present\n  // on this.$slots because the usage is semantically a normal slot.\n  if (fn.proxy) {\n    Object.defineProperty(normalSlots, key, {\n      get: normalized,\n      enumerable: true,\n      configurable: true\n    });\n  }\n  return normalized\n}\n\nfunction proxyNormalSlot(slots, key) {\n  return function () { return slots[key]; }\n}\n\n/*  */\n\n/**\n * Runtime helper for rendering v-for lists.\n */\nfunction renderList (\n  val,\n  render\n) {\n  var ret, i, l, keys, key;\n  if (Array.isArray(val) || typeof val === 'string') {\n    ret = new Array(val.length);\n    for (i = 0, l = val.length; i < l; i++) {\n      ret[i] = render(val[i], i);\n    }\n  } else if (typeof val === 'number') {\n    ret = new Array(val);\n    for (i = 0; i < val; i++) {\n      ret[i] = render(i + 1, i);\n    }\n  } else if (isObject(val)) {\n    if (hasSymbol && val[Symbol.iterator]) {\n      ret = [];\n      var iterator = val[Symbol.iterator]();\n      var result = iterator.next();\n      while (!result.done) {\n        ret.push(render(result.value, ret.length));\n        result = iterator.next();\n      }\n    } else {\n      keys = Object.keys(val);\n      ret = new Array(keys.length);\n      for (i = 0, l = keys.length; i < l; i++) {\n        key = keys[i];\n        ret[i] = render(val[key], key, i);\n      }\n    }\n  }\n  if (!isDef(ret)) {\n    ret = [];\n  }\n  (ret)._isVList = true;\n  return ret\n}\n\n/*  */\n\n/**\n * Runtime helper for rendering <slot>\n */\nfunction renderSlot (\n  name,\n  fallback,\n  props,\n  bindObject\n) {\n  var scopedSlotFn = this.$scopedSlots[name];\n  var nodes;\n  if (scopedSlotFn) { // scoped slot\n    props = props || {};\n    if (bindObject) {\n      if (process.env.NODE_ENV !== 'production' && !isObject(bindObject)) {\n        warn(\n          'slot v-bind without argument expects an Object',\n          this\n        );\n      }\n      props = extend(extend({}, bindObject), props);\n    }\n    nodes = scopedSlotFn(props) || fallback;\n  } else {\n    nodes = this.$slots[name] || fallback;\n  }\n\n  var target = props && props.slot;\n  if (target) {\n    return this.$createElement('template', { slot: target }, nodes)\n  } else {\n    return nodes\n  }\n}\n\n/*  */\n\n/**\n * Runtime helper for resolving filters\n */\nfunction resolveFilter (id) {\n  return resolveAsset(this.$options, 'filters', id, true) || identity\n}\n\n/*  */\n\nfunction isKeyNotMatch (expect, actual) {\n  if (Array.isArray(expect)) {\n    return expect.indexOf(actual) === -1\n  } else {\n    return expect !== actual\n  }\n}\n\n/**\n * Runtime helper for checking keyCodes from config.\n * exposed as Vue.prototype._k\n * passing in eventKeyName as last argument separately for backwards compat\n */\nfunction checkKeyCodes (\n  eventKeyCode,\n  key,\n  builtInKeyCode,\n  eventKeyName,\n  builtInKeyName\n) {\n  var mappedKeyCode = config.keyCodes[key] || builtInKeyCode;\n  if (builtInKeyName && eventKeyName && !config.keyCodes[key]) {\n    return isKeyNotMatch(builtInKeyName, eventKeyName)\n  } else if (mappedKeyCode) {\n    return isKeyNotMatch(mappedKeyCode, eventKeyCode)\n  } else if (eventKeyName) {\n    return hyphenate(eventKeyName) !== key\n  }\n}\n\n/*  */\n\n/**\n * Runtime helper for merging v-bind=\"object\" into a VNode's data.\n */\nfunction bindObjectProps (\n  data,\n  tag,\n  value,\n  asProp,\n  isSync\n) {\n  if (value) {\n    if (!isObject(value)) {\n      process.env.NODE_ENV !== 'production' && warn(\n        'v-bind without argument expects an Object or Array value',\n        this\n      );\n    } else {\n      if (Array.isArray(value)) {\n        value = toObject(value);\n      }\n      var hash;\n      var loop = function ( key ) {\n        if (\n          key === 'class' ||\n          key === 'style' ||\n          isReservedAttribute(key)\n        ) {\n          hash = data;\n        } else {\n          var type = data.attrs && data.attrs.type;\n          hash = asProp || config.mustUseProp(tag, type, key)\n            ? data.domProps || (data.domProps = {})\n            : data.attrs || (data.attrs = {});\n        }\n        var camelizedKey = camelize(key);\n        var hyphenatedKey = hyphenate(key);\n        if (!(camelizedKey in hash) && !(hyphenatedKey in hash)) {\n          hash[key] = value[key];\n\n          if (isSync) {\n            var on = data.on || (data.on = {});\n            on[(\"update:\" + key)] = function ($event) {\n              value[key] = $event;\n            };\n          }\n        }\n      };\n\n      for (var key in value) loop( key );\n    }\n  }\n  return data\n}\n\n/*  */\n\n/**\n * Runtime helper for rendering static trees.\n */\nfunction renderStatic (\n  index,\n  isInFor\n) {\n  var cached = this._staticTrees || (this._staticTrees = []);\n  var tree = cached[index];\n  // if has already-rendered static tree and not inside v-for,\n  // we can reuse the same tree.\n  if (tree && !isInFor) {\n    return tree\n  }\n  // otherwise, render a fresh tree.\n  tree = cached[index] = this.$options.staticRenderFns[index].call(\n    this._renderProxy,\n    null,\n    this // for render fns generated for functional component templates\n  );\n  markStatic(tree, (\"__static__\" + index), false);\n  return tree\n}\n\n/**\n * Runtime helper for v-once.\n * Effectively it means marking the node as static with a unique key.\n */\nfunction markOnce (\n  tree,\n  index,\n  key\n) {\n  markStatic(tree, (\"__once__\" + index + (key ? (\"_\" + key) : \"\")), true);\n  return tree\n}\n\nfunction markStatic (\n  tree,\n  key,\n  isOnce\n) {\n  if (Array.isArray(tree)) {\n    for (var i = 0; i < tree.length; i++) {\n      if (tree[i] && typeof tree[i] !== 'string') {\n        markStaticNode(tree[i], (key + \"_\" + i), isOnce);\n      }\n    }\n  } else {\n    markStaticNode(tree, key, isOnce);\n  }\n}\n\nfunction markStaticNode (node, key, isOnce) {\n  node.isStatic = true;\n  node.key = key;\n  node.isOnce = isOnce;\n}\n\n/*  */\n\nfunction bindObjectListeners (data, value) {\n  if (value) {\n    if (!isPlainObject(value)) {\n      process.env.NODE_ENV !== 'production' && warn(\n        'v-on without argument expects an Object value',\n        this\n      );\n    } else {\n      var on = data.on = data.on ? extend({}, data.on) : {};\n      for (var key in value) {\n        var existing = on[key];\n        var ours = value[key];\n        on[key] = existing ? [].concat(existing, ours) : ours;\n      }\n    }\n  }\n  return data\n}\n\n/*  */\n\nfunction resolveScopedSlots (\n  fns, // see flow/vnode\n  res,\n  // the following are added in 2.6\n  hasDynamicKeys,\n  contentHashKey\n) {\n  res = res || { $stable: !hasDynamicKeys };\n  for (var i = 0; i < fns.length; i++) {\n    var slot = fns[i];\n    if (Array.isArray(slot)) {\n      resolveScopedSlots(slot, res, hasDynamicKeys);\n    } else if (slot) {\n      // marker for reverse proxying v-slot without scope on this.$slots\n      if (slot.proxy) {\n        slot.fn.proxy = true;\n      }\n      res[slot.key] = slot.fn;\n    }\n  }\n  if (contentHashKey) {\n    (res).$key = contentHashKey;\n  }\n  return res\n}\n\n/*  */\n\nfunction bindDynamicKeys (baseObj, values) {\n  for (var i = 0; i < values.length; i += 2) {\n    var key = values[i];\n    if (typeof key === 'string' && key) {\n      baseObj[values[i]] = values[i + 1];\n    } else if (process.env.NODE_ENV !== 'production' && key !== '' && key !== null) {\n      // null is a speical value for explicitly removing a binding\n      warn(\n        (\"Invalid value for dynamic directive argument (expected string or null): \" + key),\n        this\n      );\n    }\n  }\n  return baseObj\n}\n\n// helper to dynamically append modifier runtime markers to event names.\n// ensure only append when value is already string, otherwise it will be cast\n// to string and cause the type check to miss.\nfunction prependModifier (value, symbol) {\n  return typeof value === 'string' ? symbol + value : value\n}\n\n/*  */\n\nfunction installRenderHelpers (target) {\n  target._o = markOnce;\n  target._n = toNumber;\n  target._s = toString;\n  target._l = renderList;\n  target._t = renderSlot;\n  target._q = looseEqual;\n  target._i = looseIndexOf;\n  target._m = renderStatic;\n  target._f = resolveFilter;\n  target._k = checkKeyCodes;\n  target._b = bindObjectProps;\n  target._v = createTextVNode;\n  target._e = createEmptyVNode;\n  target._u = resolveScopedSlots;\n  target._g = bindObjectListeners;\n  target._d = bindDynamicKeys;\n  target._p = prependModifier;\n}\n\n/*  */\n\nfunction FunctionalRenderContext (\n  data,\n  props,\n  children,\n  parent,\n  Ctor\n) {\n  var this$1 = this;\n\n  var options = Ctor.options;\n  // ensure the createElement function in functional components\n  // gets a unique context - this is necessary for correct named slot check\n  var contextVm;\n  if (hasOwn(parent, '_uid')) {\n    contextVm = Object.create(parent);\n    // $flow-disable-line\n    contextVm._original = parent;\n  } else {\n    // the context vm passed in is a functional context as well.\n    // in this case we want to make sure we are able to get a hold to the\n    // real context instance.\n    contextVm = parent;\n    // $flow-disable-line\n    parent = parent._original;\n  }\n  var isCompiled = isTrue(options._compiled);\n  var needNormalization = !isCompiled;\n\n  this.data = data;\n  this.props = props;\n  this.children = children;\n  this.parent = parent;\n  this.listeners = data.on || emptyObject;\n  this.injections = resolveInject(options.inject, parent);\n  this.slots = function () {\n    if (!this$1.$slots) {\n      normalizeScopedSlots(\n        data.scopedSlots,\n        this$1.$slots = resolveSlots(children, parent)\n      );\n    }\n    return this$1.$slots\n  };\n\n  Object.defineProperty(this, 'scopedSlots', ({\n    enumerable: true,\n    get: function get () {\n      return normalizeScopedSlots(data.scopedSlots, this.slots())\n    }\n  }));\n\n  // support for compiled functional template\n  if (isCompiled) {\n    // exposing $options for renderStatic()\n    this.$options = options;\n    // pre-resolve slots for renderSlot()\n    this.$slots = this.slots();\n    this.$scopedSlots = normalizeScopedSlots(data.scopedSlots, this.$slots);\n  }\n\n  if (options._scopeId) {\n    this._c = function (a, b, c, d) {\n      var vnode = createElement(contextVm, a, b, c, d, needNormalization);\n      if (vnode && !Array.isArray(vnode)) {\n        vnode.fnScopeId = options._scopeId;\n        vnode.fnContext = parent;\n      }\n      return vnode\n    };\n  } else {\n    this._c = function (a, b, c, d) { return createElement(contextVm, a, b, c, d, needNormalization); };\n  }\n}\n\ninstallRenderHelpers(FunctionalRenderContext.prototype);\n\nfunction createFunctionalComponent (\n  Ctor,\n  propsData,\n  data,\n  contextVm,\n  children\n) {\n  var options = Ctor.options;\n  var props = {};\n  var propOptions = options.props;\n  if (isDef(propOptions)) {\n    for (var key in propOptions) {\n      props[key] = validateProp(key, propOptions, propsData || emptyObject);\n    }\n  } else {\n    if (isDef(data.attrs)) { mergeProps(props, data.attrs); }\n    if (isDef(data.props)) { mergeProps(props, data.props); }\n  }\n\n  var renderContext = new FunctionalRenderContext(\n    data,\n    props,\n    children,\n    contextVm,\n    Ctor\n  );\n\n  var vnode = options.render.call(null, renderContext._c, renderContext);\n\n  if (vnode instanceof VNode) {\n    return cloneAndMarkFunctionalResult(vnode, data, renderContext.parent, options, renderContext)\n  } else if (Array.isArray(vnode)) {\n    var vnodes = normalizeChildren(vnode) || [];\n    var res = new Array(vnodes.length);\n    for (var i = 0; i < vnodes.length; i++) {\n      res[i] = cloneAndMarkFunctionalResult(vnodes[i], data, renderContext.parent, options, renderContext);\n    }\n    return res\n  }\n}\n\nfunction cloneAndMarkFunctionalResult (vnode, data, contextVm, options, renderContext) {\n  // #7817 clone node before setting fnContext, otherwise if the node is reused\n  // (e.g. it was from a cached normal slot) the fnContext causes named slots\n  // that should not be matched to match.\n  var clone = cloneVNode(vnode);\n  clone.fnContext = contextVm;\n  clone.fnOptions = options;\n  if (process.env.NODE_ENV !== 'production') {\n    (clone.devtoolsMeta = clone.devtoolsMeta || {}).renderContext = renderContext;\n  }\n  if (data.slot) {\n    (clone.data || (clone.data = {})).slot = data.slot;\n  }\n  return clone\n}\n\nfunction mergeProps (to, from) {\n  for (var key in from) {\n    to[camelize(key)] = from[key];\n  }\n}\n\n/*  */\n\n/*  */\n\n/*  */\n\n/*  */\n\n// inline hooks to be invoked on component VNodes during patch\nvar componentVNodeHooks = {\n  init: function init (vnode, hydrating) {\n    if (\n      vnode.componentInstance &&\n      !vnode.componentInstance._isDestroyed &&\n      vnode.data.keepAlive\n    ) {\n      // kept-alive components, treat as a patch\n      var mountedNode = vnode; // work around flow\n      componentVNodeHooks.prepatch(mountedNode, mountedNode);\n    } else {\n      var child = vnode.componentInstance = createComponentInstanceForVnode(\n        vnode,\n        activeInstance\n      );\n      child.$mount(hydrating ? vnode.elm : undefined, hydrating);\n    }\n  },\n\n  prepatch: function prepatch (oldVnode, vnode) {\n    var options = vnode.componentOptions;\n    var child = vnode.componentInstance = oldVnode.componentInstance;\n    updateChildComponent(\n      child,\n      options.propsData, // updated props\n      options.listeners, // updated listeners\n      vnode, // new parent vnode\n      options.children // new children\n    );\n  },\n\n  insert: function insert (vnode) {\n    var context = vnode.context;\n    var componentInstance = vnode.componentInstance;\n    if (!componentInstance._isMounted) {\n      componentInstance._isMounted = true;\n      callHook(componentInstance, 'mounted');\n    }\n    if (vnode.data.keepAlive) {\n      if (context._isMounted) {\n        // vue-router#1212\n        // During updates, a kept-alive component's child components may\n        // change, so directly walking the tree here may call activated hooks\n        // on incorrect children. Instead we push them into a queue which will\n        // be processed after the whole patch process ended.\n        queueActivatedComponent(componentInstance);\n      } else {\n        activateChildComponent(componentInstance, true /* direct */);\n      }\n    }\n  },\n\n  destroy: function destroy (vnode) {\n    var componentInstance = vnode.componentInstance;\n    if (!componentInstance._isDestroyed) {\n      if (!vnode.data.keepAlive) {\n        componentInstance.$destroy();\n      } else {\n        deactivateChildComponent(componentInstance, true /* direct */);\n      }\n    }\n  }\n};\n\nvar hooksToMerge = Object.keys(componentVNodeHooks);\n\nfunction createComponent (\n  Ctor,\n  data,\n  context,\n  children,\n  tag\n) {\n  if (isUndef(Ctor)) {\n    return\n  }\n\n  var baseCtor = context.$options._base;\n\n  // plain options object: turn it into a constructor\n  if (isObject(Ctor)) {\n    Ctor = baseCtor.extend(Ctor);\n  }\n\n  // if at this stage it's not a constructor or an async component factory,\n  // reject.\n  if (typeof Ctor !== 'function') {\n    if (process.env.NODE_ENV !== 'production') {\n      warn((\"Invalid Component definition: \" + (String(Ctor))), context);\n    }\n    return\n  }\n\n  // async component\n  var asyncFactory;\n  if (isUndef(Ctor.cid)) {\n    asyncFactory = Ctor;\n    Ctor = resolveAsyncComponent(asyncFactory, baseCtor);\n    if (Ctor === undefined) {\n      // return a placeholder node for async component, which is rendered\n      // as a comment node but preserves all the raw information for the node.\n      // the information will be used for async server-rendering and hydration.\n      return createAsyncPlaceholder(\n        asyncFactory,\n        data,\n        context,\n        children,\n        tag\n      )\n    }\n  }\n\n  data = data || {};\n\n  // resolve constructor options in case global mixins are applied after\n  // component constructor creation\n  resolveConstructorOptions(Ctor);\n\n  // transform component v-model data into props & events\n  if (isDef(data.model)) {\n    transformModel(Ctor.options, data);\n  }\n\n  // extract props\n  var propsData = extractPropsFromVNodeData(data, Ctor, tag);\n\n  // functional component\n  if (isTrue(Ctor.options.functional)) {\n    return createFunctionalComponent(Ctor, propsData, data, context, children)\n  }\n\n  // extract listeners, since these needs to be treated as\n  // child component listeners instead of DOM listeners\n  var listeners = data.on;\n  // replace with listeners with .native modifier\n  // so it gets processed during parent component patch.\n  data.on = data.nativeOn;\n\n  if (isTrue(Ctor.options.abstract)) {\n    // abstract components do not keep anything\n    // other than props & listeners & slot\n\n    // work around flow\n    var slot = data.slot;\n    data = {};\n    if (slot) {\n      data.slot = slot;\n    }\n  }\n\n  // install component management hooks onto the placeholder node\n  installComponentHooks(data);\n\n  // return a placeholder vnode\n  var name = Ctor.options.name || tag;\n  var vnode = new VNode(\n    (\"vue-component-\" + (Ctor.cid) + (name ? (\"-\" + name) : '')),\n    data, undefined, undefined, undefined, context,\n    { Ctor: Ctor, propsData: propsData, listeners: listeners, tag: tag, children: children },\n    asyncFactory\n  );\n\n  return vnode\n}\n\nfunction createComponentInstanceForVnode (\n  vnode, // we know it's MountedComponentVNode but flow doesn't\n  parent // activeInstance in lifecycle state\n) {\n  var options = {\n    _isComponent: true,\n    _parentVnode: vnode,\n    parent: parent\n  };\n  // check inline-template render functions\n  var inlineTemplate = vnode.data.inlineTemplate;\n  if (isDef(inlineTemplate)) {\n    options.render = inlineTemplate.render;\n    options.staticRenderFns = inlineTemplate.staticRenderFns;\n  }\n  return new vnode.componentOptions.Ctor(options)\n}\n\nfunction installComponentHooks (data) {\n  var hooks = data.hook || (data.hook = {});\n  for (var i = 0; i < hooksToMerge.length; i++) {\n    var key = hooksToMerge[i];\n    var existing = hooks[key];\n    var toMerge = componentVNodeHooks[key];\n    if (existing !== toMerge && !(existing && existing._merged)) {\n      hooks[key] = existing ? mergeHook$1(toMerge, existing) : toMerge;\n    }\n  }\n}\n\nfunction mergeHook$1 (f1, f2) {\n  var merged = function (a, b) {\n    // flow complains about extra args which is why we use any\n    f1(a, b);\n    f2(a, b);\n  };\n  merged._merged = true;\n  return merged\n}\n\n// transform component v-model info (value and callback) into\n// prop and event handler respectively.\nfunction transformModel (options, data) {\n  var prop = (options.model && options.model.prop) || 'value';\n  var event = (options.model && options.model.event) || 'input'\n  ;(data.attrs || (data.attrs = {}))[prop] = data.model.value;\n  var on = data.on || (data.on = {});\n  var existing = on[event];\n  var callback = data.model.callback;\n  if (isDef(existing)) {\n    if (\n      Array.isArray(existing)\n        ? existing.indexOf(callback) === -1\n        : existing !== callback\n    ) {\n      on[event] = [callback].concat(existing);\n    }\n  } else {\n    on[event] = callback;\n  }\n}\n\n/*  */\n\nvar SIMPLE_NORMALIZE = 1;\nvar ALWAYS_NORMALIZE = 2;\n\n// wrapper function for providing a more flexible interface\n// without getting yelled at by flow\nfunction createElement (\n  context,\n  tag,\n  data,\n  children,\n  normalizationType,\n  alwaysNormalize\n) {\n  if (Array.isArray(data) || isPrimitive(data)) {\n    normalizationType = children;\n    children = data;\n    data = undefined;\n  }\n  if (isTrue(alwaysNormalize)) {\n    normalizationType = ALWAYS_NORMALIZE;\n  }\n  return _createElement(context, tag, data, children, normalizationType)\n}\n\nfunction _createElement (\n  context,\n  tag,\n  data,\n  children,\n  normalizationType\n) {\n  if (isDef(data) && isDef((data).__ob__)) {\n    process.env.NODE_ENV !== 'production' && warn(\n      \"Avoid using observed data object as vnode data: \" + (JSON.stringify(data)) + \"\\n\" +\n      'Always create fresh vnode data objects in each render!',\n      context\n    );\n    return createEmptyVNode()\n  }\n  // object syntax in v-bind\n  if (isDef(data) && isDef(data.is)) {\n    tag = data.is;\n  }\n  if (!tag) {\n    // in case of component :is set to falsy value\n    return createEmptyVNode()\n  }\n  // warn against non-primitive key\n  if (process.env.NODE_ENV !== 'production' &&\n    isDef(data) && isDef(data.key) && !isPrimitive(data.key)\n  ) {\n    {\n      warn(\n        'Avoid using non-primitive value as key, ' +\n        'use string/number value instead.',\n        context\n      );\n    }\n  }\n  // support single function children as default scoped slot\n  if (Array.isArray(children) &&\n    typeof children[0] === 'function'\n  ) {\n    data = data || {};\n    data.scopedSlots = { default: children[0] };\n    children.length = 0;\n  }\n  if (normalizationType === ALWAYS_NORMALIZE) {\n    children = normalizeChildren(children);\n  } else if (normalizationType === SIMPLE_NORMALIZE) {\n    children = simpleNormalizeChildren(children);\n  }\n  var vnode, ns;\n  if (typeof tag === 'string') {\n    var Ctor;\n    ns = (context.$vnode && context.$vnode.ns) || config.getTagNamespace(tag);\n    if (config.isReservedTag(tag)) {\n      // platform built-in elements\n      vnode = new VNode(\n        config.parsePlatformTagName(tag), data, children,\n        undefined, undefined, context\n      );\n    } else if ((!data || !data.pre) && isDef(Ctor = resolveAsset(context.$options, 'components', tag))) {\n      // component\n      vnode = createComponent(Ctor, data, context, children, tag);\n    } else {\n      // unknown or unlisted namespaced elements\n      // check at runtime because it may get assigned a namespace when its\n      // parent normalizes children\n      vnode = new VNode(\n        tag, data, children,\n        undefined, undefined, context\n      );\n    }\n  } else {\n    // direct component options / constructor\n    vnode = createComponent(tag, data, context, children);\n  }\n  if (Array.isArray(vnode)) {\n    return vnode\n  } else if (isDef(vnode)) {\n    if (isDef(ns)) { applyNS(vnode, ns); }\n    if (isDef(data)) { registerDeepBindings(data); }\n    return vnode\n  } else {\n    return createEmptyVNode()\n  }\n}\n\nfunction applyNS (vnode, ns, force) {\n  vnode.ns = ns;\n  if (vnode.tag === 'foreignObject') {\n    // use default namespace inside foreignObject\n    ns = undefined;\n    force = true;\n  }\n  if (isDef(vnode.children)) {\n    for (var i = 0, l = vnode.children.length; i < l; i++) {\n      var child = vnode.children[i];\n      if (isDef(child.tag) && (\n        isUndef(child.ns) || (isTrue(force) && child.tag !== 'svg'))) {\n        applyNS(child, ns, force);\n      }\n    }\n  }\n}\n\n// ref #5318\n// necessary to ensure parent re-render when deep bindings like :style and\n// :class are used on slot nodes\nfunction registerDeepBindings (data) {\n  if (isObject(data.style)) {\n    traverse(data.style);\n  }\n  if (isObject(data.class)) {\n    traverse(data.class);\n  }\n}\n\n/*  */\n\nfunction initRender (vm) {\n  vm._vnode = null; // the root of the child tree\n  vm._staticTrees = null; // v-once cached trees\n  var options = vm.$options;\n  var parentVnode = vm.$vnode = options._parentVnode; // the placeholder node in parent tree\n  var renderContext = parentVnode && parentVnode.context;\n  vm.$slots = resolveSlots(options._renderChildren, renderContext);\n  vm.$scopedSlots = emptyObject;\n  // bind the createElement fn to this instance\n  // so that we get proper render context inside it.\n  // args order: tag, data, children, normalizationType, alwaysNormalize\n  // internal version is used by render functions compiled from templates\n  vm._c = function (a, b, c, d) { return createElement(vm, a, b, c, d, false); };\n  // normalization is always applied for the public version, used in\n  // user-written render functions.\n  vm.$createElement = function (a, b, c, d) { return createElement(vm, a, b, c, d, true); };\n\n  // $attrs & $listeners are exposed for easier HOC creation.\n  // they need to be reactive so that HOCs using them are always updated\n  var parentData = parentVnode && parentVnode.data;\n\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== 'production') {\n    defineReactive$$1(vm, '$attrs', parentData && parentData.attrs || emptyObject, function () {\n      !isUpdatingChildComponent && warn(\"$attrs is readonly.\", vm);\n    }, true);\n    defineReactive$$1(vm, '$listeners', options._parentListeners || emptyObject, function () {\n      !isUpdatingChildComponent && warn(\"$listeners is readonly.\", vm);\n    }, true);\n  } else {\n    defineReactive$$1(vm, '$attrs', parentData && parentData.attrs || emptyObject, null, true);\n    defineReactive$$1(vm, '$listeners', options._parentListeners || emptyObject, null, true);\n  }\n}\n\nvar currentRenderingInstance = null;\n\nfunction renderMixin (Vue) {\n  // install runtime convenience helpers\n  installRenderHelpers(Vue.prototype);\n\n  Vue.prototype.$nextTick = function (fn) {\n    return nextTick(fn, this)\n  };\n\n  Vue.prototype._render = function () {\n    var vm = this;\n    var ref = vm.$options;\n    var render = ref.render;\n    var _parentVnode = ref._parentVnode;\n\n    if (_parentVnode) {\n      vm.$scopedSlots = normalizeScopedSlots(\n        _parentVnode.data.scopedSlots,\n        vm.$slots,\n        vm.$scopedSlots\n      );\n    }\n\n    // set parent vnode. this allows render functions to have access\n    // to the data on the placeholder node.\n    vm.$vnode = _parentVnode;\n    // render self\n    var vnode;\n    try {\n      // There's no need to maintain a stack becaues all render fns are called\n      // separately from one another. Nested component's render fns are called\n      // when parent component is patched.\n      currentRenderingInstance = vm;\n      vnode = render.call(vm._renderProxy, vm.$createElement);\n    } catch (e) {\n      handleError(e, vm, \"render\");\n      // return error render result,\n      // or previous vnode to prevent render error causing blank component\n      /* istanbul ignore else */\n      if (process.env.NODE_ENV !== 'production' && vm.$options.renderError) {\n        try {\n          vnode = vm.$options.renderError.call(vm._renderProxy, vm.$createElement, e);\n        } catch (e) {\n          handleError(e, vm, \"renderError\");\n          vnode = vm._vnode;\n        }\n      } else {\n        vnode = vm._vnode;\n      }\n    } finally {\n      currentRenderingInstance = null;\n    }\n    // if the returned array contains only a single node, allow it\n    if (Array.isArray(vnode) && vnode.length === 1) {\n      vnode = vnode[0];\n    }\n    // return empty vnode in case the render function errored out\n    if (!(vnode instanceof VNode)) {\n      if (process.env.NODE_ENV !== 'production' && Array.isArray(vnode)) {\n        warn(\n          'Multiple root nodes returned from render function. Render function ' +\n          'should return a single root node.',\n          vm\n        );\n      }\n      vnode = createEmptyVNode();\n    }\n    // set parent\n    vnode.parent = _parentVnode;\n    return vnode\n  };\n}\n\n/*  */\n\nfunction ensureCtor (comp, base) {\n  if (\n    comp.__esModule ||\n    (hasSymbol && comp[Symbol.toStringTag] === 'Module')\n  ) {\n    comp = comp.default;\n  }\n  return isObject(comp)\n    ? base.extend(comp)\n    : comp\n}\n\nfunction createAsyncPlaceholder (\n  factory,\n  data,\n  context,\n  children,\n  tag\n) {\n  var node = createEmptyVNode();\n  node.asyncFactory = factory;\n  node.asyncMeta = { data: data, context: context, children: children, tag: tag };\n  return node\n}\n\nfunction resolveAsyncComponent (\n  factory,\n  baseCtor\n) {\n  if (isTrue(factory.error) && isDef(factory.errorComp)) {\n    return factory.errorComp\n  }\n\n  if (isDef(factory.resolved)) {\n    return factory.resolved\n  }\n\n  var owner = currentRenderingInstance;\n  if (owner && isDef(factory.owners) && factory.owners.indexOf(owner) === -1) {\n    // already pending\n    factory.owners.push(owner);\n  }\n\n  if (isTrue(factory.loading) && isDef(factory.loadingComp)) {\n    return factory.loadingComp\n  }\n\n  if (owner && !isDef(factory.owners)) {\n    var owners = factory.owners = [owner];\n    var sync = true;\n    var timerLoading = null;\n    var timerTimeout = null\n\n    ;(owner).$on('hook:destroyed', function () { return remove(owners, owner); });\n\n    var forceRender = function (renderCompleted) {\n      for (var i = 0, l = owners.length; i < l; i++) {\n        (owners[i]).$forceUpdate();\n      }\n\n      if (renderCompleted) {\n        owners.length = 0;\n        if (timerLoading !== null) {\n          clearTimeout(timerLoading);\n          timerLoading = null;\n        }\n        if (timerTimeout !== null) {\n          clearTimeout(timerTimeout);\n          timerTimeout = null;\n        }\n      }\n    };\n\n    var resolve = once(function (res) {\n      // cache resolved\n      factory.resolved = ensureCtor(res, baseCtor);\n      // invoke callbacks only if this is not a synchronous resolve\n      // (async resolves are shimmed as synchronous during SSR)\n      if (!sync) {\n        forceRender(true);\n      } else {\n        owners.length = 0;\n      }\n    });\n\n    var reject = once(function (reason) {\n      process.env.NODE_ENV !== 'production' && warn(\n        \"Failed to resolve async component: \" + (String(factory)) +\n        (reason ? (\"\\nReason: \" + reason) : '')\n      );\n      if (isDef(factory.errorComp)) {\n        factory.error = true;\n        forceRender(true);\n      }\n    });\n\n    var res = factory(resolve, reject);\n\n    if (isObject(res)) {\n      if (isPromise(res)) {\n        // () => Promise\n        if (isUndef(factory.resolved)) {\n          res.then(resolve, reject);\n        }\n      } else if (isPromise(res.component)) {\n        res.component.then(resolve, reject);\n\n        if (isDef(res.error)) {\n          factory.errorComp = ensureCtor(res.error, baseCtor);\n        }\n\n        if (isDef(res.loading)) {\n          factory.loadingComp = ensureCtor(res.loading, baseCtor);\n          if (res.delay === 0) {\n            factory.loading = true;\n          } else {\n            timerLoading = setTimeout(function () {\n              timerLoading = null;\n              if (isUndef(factory.resolved) && isUndef(factory.error)) {\n                factory.loading = true;\n                forceRender(false);\n              }\n            }, res.delay || 200);\n          }\n        }\n\n        if (isDef(res.timeout)) {\n          timerTimeout = setTimeout(function () {\n            timerTimeout = null;\n            if (isUndef(factory.resolved)) {\n              reject(\n                process.env.NODE_ENV !== 'production'\n                  ? (\"timeout (\" + (res.timeout) + \"ms)\")\n                  : null\n              );\n            }\n          }, res.timeout);\n        }\n      }\n    }\n\n    sync = false;\n    // return in case resolved synchronously\n    return factory.loading\n      ? factory.loadingComp\n      : factory.resolved\n  }\n}\n\n/*  */\n\nfunction isAsyncPlaceholder (node) {\n  return node.isComment && node.asyncFactory\n}\n\n/*  */\n\nfunction getFirstComponentChild (children) {\n  if (Array.isArray(children)) {\n    for (var i = 0; i < children.length; i++) {\n      var c = children[i];\n      if (isDef(c) && (isDef(c.componentOptions) || isAsyncPlaceholder(c))) {\n        return c\n      }\n    }\n  }\n}\n\n/*  */\n\n/*  */\n\nfunction initEvents (vm) {\n  vm._events = Object.create(null);\n  vm._hasHookEvent = false;\n  // init parent attached events\n  var listeners = vm.$options._parentListeners;\n  if (listeners) {\n    updateComponentListeners(vm, listeners);\n  }\n}\n\nvar target;\n\nfunction add (event, fn) {\n  target.$on(event, fn);\n}\n\nfunction remove$1 (event, fn) {\n  target.$off(event, fn);\n}\n\nfunction createOnceHandler (event, fn) {\n  var _target = target;\n  return function onceHandler () {\n    var res = fn.apply(null, arguments);\n    if (res !== null) {\n      _target.$off(event, onceHandler);\n    }\n  }\n}\n\nfunction updateComponentListeners (\n  vm,\n  listeners,\n  oldListeners\n) {\n  target = vm;\n  updateListeners(listeners, oldListeners || {}, add, remove$1, createOnceHandler, vm);\n  target = undefined;\n}\n\nfunction eventsMixin (Vue) {\n  var hookRE = /^hook:/;\n  Vue.prototype.$on = function (event, fn) {\n    var vm = this;\n    if (Array.isArray(event)) {\n      for (var i = 0, l = event.length; i < l; i++) {\n        vm.$on(event[i], fn);\n      }\n    } else {\n      (vm._events[event] || (vm._events[event] = [])).push(fn);\n      // optimize hook:event cost by using a boolean flag marked at registration\n      // instead of a hash lookup\n      if (hookRE.test(event)) {\n        vm._hasHookEvent = true;\n      }\n    }\n    return vm\n  };\n\n  Vue.prototype.$once = function (event, fn) {\n    var vm = this;\n    function on () {\n      vm.$off(event, on);\n      fn.apply(vm, arguments);\n    }\n    on.fn = fn;\n    vm.$on(event, on);\n    return vm\n  };\n\n  Vue.prototype.$off = function (event, fn) {\n    var vm = this;\n    // all\n    if (!arguments.length) {\n      vm._events = Object.create(null);\n      return vm\n    }\n    // array of events\n    if (Array.isArray(event)) {\n      for (var i$1 = 0, l = event.length; i$1 < l; i$1++) {\n        vm.$off(event[i$1], fn);\n      }\n      return vm\n    }\n    // specific event\n    var cbs = vm._events[event];\n    if (!cbs) {\n      return vm\n    }\n    if (!fn) {\n      vm._events[event] = null;\n      return vm\n    }\n    // specific handler\n    var cb;\n    var i = cbs.length;\n    while (i--) {\n      cb = cbs[i];\n      if (cb === fn || cb.fn === fn) {\n        cbs.splice(i, 1);\n        break\n      }\n    }\n    return vm\n  };\n\n  Vue.prototype.$emit = function (event) {\n    var vm = this;\n    if (process.env.NODE_ENV !== 'production') {\n      var lowerCaseEvent = event.toLowerCase();\n      if (lowerCaseEvent !== event && vm._events[lowerCaseEvent]) {\n        tip(\n          \"Event \\\"\" + lowerCaseEvent + \"\\\" is emitted in component \" +\n          (formatComponentName(vm)) + \" but the handler is registered for \\\"\" + event + \"\\\". \" +\n          \"Note that HTML attributes are case-insensitive and you cannot use \" +\n          \"v-on to listen to camelCase events when using in-DOM templates. \" +\n          \"You should probably use \\\"\" + (hyphenate(event)) + \"\\\" instead of \\\"\" + event + \"\\\".\"\n        );\n      }\n    }\n    var cbs = vm._events[event];\n    if (cbs) {\n      cbs = cbs.length > 1 ? toArray(cbs) : cbs;\n      var args = toArray(arguments, 1);\n      var info = \"event handler for \\\"\" + event + \"\\\"\";\n      for (var i = 0, l = cbs.length; i < l; i++) {\n        invokeWithErrorHandling(cbs[i], vm, args, vm, info);\n      }\n    }\n    return vm\n  };\n}\n\n/*  */\n\nvar activeInstance = null;\nvar isUpdatingChildComponent = false;\n\nfunction setActiveInstance(vm) {\n  var prevActiveInstance = activeInstance;\n  activeInstance = vm;\n  return function () {\n    activeInstance = prevActiveInstance;\n  }\n}\n\nfunction initLifecycle (vm) {\n  var options = vm.$options;\n\n  // locate first non-abstract parent\n  var parent = options.parent;\n  if (parent && !options.abstract) {\n    while (parent.$options.abstract && parent.$parent) {\n      parent = parent.$parent;\n    }\n    parent.$children.push(vm);\n  }\n\n  vm.$parent = parent;\n  vm.$root = parent ? parent.$root : vm;\n\n  vm.$children = [];\n  vm.$refs = {};\n\n  vm._watcher = null;\n  vm._inactive = null;\n  vm._directInactive = false;\n  vm._isMounted = false;\n  vm._isDestroyed = false;\n  vm._isBeingDestroyed = false;\n}\n\nfunction lifecycleMixin (Vue) {\n  Vue.prototype._update = function (vnode, hydrating) {\n    var vm = this;\n    var prevEl = vm.$el;\n    var prevVnode = vm._vnode;\n    var restoreActiveInstance = setActiveInstance(vm);\n    vm._vnode = vnode;\n    // Vue.prototype.__patch__ is injected in entry points\n    // based on the rendering backend used.\n    if (!prevVnode) {\n      // initial render\n      vm.$el = vm.__patch__(vm.$el, vnode, hydrating, false /* removeOnly */);\n    } else {\n      // updates\n      vm.$el = vm.__patch__(prevVnode, vnode);\n    }\n    restoreActiveInstance();\n    // update __vue__ reference\n    if (prevEl) {\n      prevEl.__vue__ = null;\n    }\n    if (vm.$el) {\n      vm.$el.__vue__ = vm;\n    }\n    // if parent is an HOC, update its $el as well\n    if (vm.$vnode && vm.$parent && vm.$vnode === vm.$parent._vnode) {\n      vm.$parent.$el = vm.$el;\n    }\n    // updated hook is called by the scheduler to ensure that children are\n    // updated in a parent's updated hook.\n  };\n\n  Vue.prototype.$forceUpdate = function () {\n    var vm = this;\n    if (vm._watcher) {\n      vm._watcher.update();\n    }\n  };\n\n  Vue.prototype.$destroy = function () {\n    var vm = this;\n    if (vm._isBeingDestroyed) {\n      return\n    }\n    callHook(vm, 'beforeDestroy');\n    vm._isBeingDestroyed = true;\n    // remove self from parent\n    var parent = vm.$parent;\n    if (parent && !parent._isBeingDestroyed && !vm.$options.abstract) {\n      remove(parent.$children, vm);\n    }\n    // teardown watchers\n    if (vm._watcher) {\n      vm._watcher.teardown();\n    }\n    var i = vm._watchers.length;\n    while (i--) {\n      vm._watchers[i].teardown();\n    }\n    // remove reference from data ob\n    // frozen object may not have observer.\n    if (vm._data.__ob__) {\n      vm._data.__ob__.vmCount--;\n    }\n    // call the last hook...\n    vm._isDestroyed = true;\n    // invoke destroy hooks on current rendered tree\n    vm.__patch__(vm._vnode, null);\n    // fire destroyed hook\n    callHook(vm, 'destroyed');\n    // turn off all instance listeners.\n    vm.$off();\n    // remove __vue__ reference\n    if (vm.$el) {\n      vm.$el.__vue__ = null;\n    }\n    // release circular reference (#6759)\n    if (vm.$vnode) {\n      vm.$vnode.parent = null;\n    }\n  };\n}\n\nfunction mountComponent (\n  vm,\n  el,\n  hydrating\n) {\n  vm.$el = el;\n  if (!vm.$options.render) {\n    vm.$options.render = createEmptyVNode;\n    if (process.env.NODE_ENV !== 'production') {\n      /* istanbul ignore if */\n      if ((vm.$options.template && vm.$options.template.charAt(0) !== '#') ||\n        vm.$options.el || el) {\n        warn(\n          'You are using the runtime-only build of Vue where the template ' +\n          'compiler is not available. Either pre-compile the templates into ' +\n          'render functions, or use the compiler-included build.',\n          vm\n        );\n      } else {\n        warn(\n          'Failed to mount component: template or render function not defined.',\n          vm\n        );\n      }\n    }\n  }\n  callHook(vm, 'beforeMount');\n\n  var updateComponent;\n  /* istanbul ignore if */\n  if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n    updateComponent = function () {\n      var name = vm._name;\n      var id = vm._uid;\n      var startTag = \"vue-perf-start:\" + id;\n      var endTag = \"vue-perf-end:\" + id;\n\n      mark(startTag);\n      var vnode = vm._render();\n      mark(endTag);\n      measure((\"vue \" + name + \" render\"), startTag, endTag);\n\n      mark(startTag);\n      vm._update(vnode, hydrating);\n      mark(endTag);\n      measure((\"vue \" + name + \" patch\"), startTag, endTag);\n    };\n  } else {\n    updateComponent = function () {\n      vm._update(vm._render(), hydrating);\n    };\n  }\n\n  // we set this to vm._watcher inside the watcher's constructor\n  // since the watcher's initial patch may call $forceUpdate (e.g. inside child\n  // component's mounted hook), which relies on vm._watcher being already defined\n  new Watcher(vm, updateComponent, noop, {\n    before: function before () {\n      if (vm._isMounted && !vm._isDestroyed) {\n        callHook(vm, 'beforeUpdate');\n      }\n    }\n  }, true /* isRenderWatcher */);\n  hydrating = false;\n\n  // manually mounted instance, call mounted on self\n  // mounted is called for render-created child components in its inserted hook\n  if (vm.$vnode == null) {\n    vm._isMounted = true;\n    callHook(vm, 'mounted');\n  }\n  return vm\n}\n\nfunction updateChildComponent (\n  vm,\n  propsData,\n  listeners,\n  parentVnode,\n  renderChildren\n) {\n  if (process.env.NODE_ENV !== 'production') {\n    isUpdatingChildComponent = true;\n  }\n\n  // determine whether component has slot children\n  // we need to do this before overwriting $options._renderChildren.\n\n  // check if there are dynamic scopedSlots (hand-written or compiled but with\n  // dynamic slot names). Static scoped slots compiled from template has the\n  // \"$stable\" marker.\n  var newScopedSlots = parentVnode.data.scopedSlots;\n  var oldScopedSlots = vm.$scopedSlots;\n  var hasDynamicScopedSlot = !!(\n    (newScopedSlots && !newScopedSlots.$stable) ||\n    (oldScopedSlots !== emptyObject && !oldScopedSlots.$stable) ||\n    (newScopedSlots && vm.$scopedSlots.$key !== newScopedSlots.$key)\n  );\n\n  // Any static slot children from the parent may have changed during parent's\n  // update. Dynamic scoped slots may also have changed. In such cases, a forced\n  // update is necessary to ensure correctness.\n  var needsForceUpdate = !!(\n    renderChildren ||               // has new static slots\n    vm.$options._renderChildren ||  // has old static slots\n    hasDynamicScopedSlot\n  );\n\n  vm.$options._parentVnode = parentVnode;\n  vm.$vnode = parentVnode; // update vm's placeholder node without re-render\n\n  if (vm._vnode) { // update child tree's parent\n    vm._vnode.parent = parentVnode;\n  }\n  vm.$options._renderChildren = renderChildren;\n\n  // update $attrs and $listeners hash\n  // these are also reactive so they may trigger child update if the child\n  // used them during render\n  vm.$attrs = parentVnode.data.attrs || emptyObject;\n  vm.$listeners = listeners || emptyObject;\n\n  // update props\n  if (propsData && vm.$options.props) {\n    toggleObserving(false);\n    var props = vm._props;\n    var propKeys = vm.$options._propKeys || [];\n    for (var i = 0; i < propKeys.length; i++) {\n      var key = propKeys[i];\n      var propOptions = vm.$options.props; // wtf flow?\n      props[key] = validateProp(key, propOptions, propsData, vm);\n    }\n    toggleObserving(true);\n    // keep a copy of raw propsData\n    vm.$options.propsData = propsData;\n  }\n\n  // update listeners\n  listeners = listeners || emptyObject;\n  var oldListeners = vm.$options._parentListeners;\n  vm.$options._parentListeners = listeners;\n  updateComponentListeners(vm, listeners, oldListeners);\n\n  // resolve slots + force update if has children\n  if (needsForceUpdate) {\n    vm.$slots = resolveSlots(renderChildren, parentVnode.context);\n    vm.$forceUpdate();\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    isUpdatingChildComponent = false;\n  }\n}\n\nfunction isInInactiveTree (vm) {\n  while (vm && (vm = vm.$parent)) {\n    if (vm._inactive) { return true }\n  }\n  return false\n}\n\nfunction activateChildComponent (vm, direct) {\n  if (direct) {\n    vm._directInactive = false;\n    if (isInInactiveTree(vm)) {\n      return\n    }\n  } else if (vm._directInactive) {\n    return\n  }\n  if (vm._inactive || vm._inactive === null) {\n    vm._inactive = false;\n    for (var i = 0; i < vm.$children.length; i++) {\n      activateChildComponent(vm.$children[i]);\n    }\n    callHook(vm, 'activated');\n  }\n}\n\nfunction deactivateChildComponent (vm, direct) {\n  if (direct) {\n    vm._directInactive = true;\n    if (isInInactiveTree(vm)) {\n      return\n    }\n  }\n  if (!vm._inactive) {\n    vm._inactive = true;\n    for (var i = 0; i < vm.$children.length; i++) {\n      deactivateChildComponent(vm.$children[i]);\n    }\n    callHook(vm, 'deactivated');\n  }\n}\n\nfunction callHook (vm, hook) {\n  // #7573 disable dep collection when invoking lifecycle hooks\n  pushTarget();\n  var handlers = vm.$options[hook];\n  var info = hook + \" hook\";\n  if (handlers) {\n    for (var i = 0, j = handlers.length; i < j; i++) {\n      invokeWithErrorHandling(handlers[i], vm, null, vm, info);\n    }\n  }\n  if (vm._hasHookEvent) {\n    vm.$emit('hook:' + hook);\n  }\n  popTarget();\n}\n\n/*  */\n\nvar MAX_UPDATE_COUNT = 100;\n\nvar queue = [];\nvar activatedChildren = [];\nvar has = {};\nvar circular = {};\nvar waiting = false;\nvar flushing = false;\nvar index = 0;\n\n/**\n * Reset the scheduler's state.\n */\nfunction resetSchedulerState () {\n  index = queue.length = activatedChildren.length = 0;\n  has = {};\n  if (process.env.NODE_ENV !== 'production') {\n    circular = {};\n  }\n  waiting = flushing = false;\n}\n\n// Async edge case #6566 requires saving the timestamp when event listeners are\n// attached. However, calling performance.now() has a perf overhead especially\n// if the page has thousands of event listeners. Instead, we take a timestamp\n// every time the scheduler flushes and use that for all event listeners\n// attached during that flush.\nvar currentFlushTimestamp = 0;\n\n// Async edge case fix requires storing an event listener's attach timestamp.\nvar getNow = Date.now;\n\n// Determine what event timestamp the browser is using. Annoyingly, the\n// timestamp can either be hi-res (relative to page load) or low-res\n// (relative to UNIX epoch), so in order to compare time we have to use the\n// same timestamp type when saving the flush timestamp.\n// All IE versions use low-res event timestamps, and have problematic clock\n// implementations (#9632)\nif (inBrowser && !isIE) {\n  var performance = window.performance;\n  if (\n    performance &&\n    typeof performance.now === 'function' &&\n    getNow() > document.createEvent('Event').timeStamp\n  ) {\n    // if the event timestamp, although evaluated AFTER the Date.now(), is\n    // smaller than it, it means the event is using a hi-res timestamp,\n    // and we need to use the hi-res version for event listener timestamps as\n    // well.\n    getNow = function () { return performance.now(); };\n  }\n}\n\n/**\n * Flush both queues and run the watchers.\n */\nfunction flushSchedulerQueue () {\n  currentFlushTimestamp = getNow();\n  flushing = true;\n  var watcher, id;\n\n  // Sort queue before flush.\n  // This ensures that:\n  // 1. Components are updated from parent to child. (because parent is always\n  //    created before the child)\n  // 2. A component's user watchers are run before its render watcher (because\n  //    user watchers are created before the render watcher)\n  // 3. If a component is destroyed during a parent component's watcher run,\n  //    its watchers can be skipped.\n  queue.sort(function (a, b) { return a.id - b.id; });\n\n  // do not cache length because more watchers might be pushed\n  // as we run existing watchers\n  for (index = 0; index < queue.length; index++) {\n    watcher = queue[index];\n    if (watcher.before) {\n      watcher.before();\n    }\n    id = watcher.id;\n    has[id] = null;\n    watcher.run();\n    // in dev build, check and stop circular updates.\n    if (process.env.NODE_ENV !== 'production' && has[id] != null) {\n      circular[id] = (circular[id] || 0) + 1;\n      if (circular[id] > MAX_UPDATE_COUNT) {\n        warn(\n          'You may have an infinite update loop ' + (\n            watcher.user\n              ? (\"in watcher with expression \\\"\" + (watcher.expression) + \"\\\"\")\n              : \"in a component render function.\"\n          ),\n          watcher.vm\n        );\n        break\n      }\n    }\n  }\n\n  // keep copies of post queues before resetting state\n  var activatedQueue = activatedChildren.slice();\n  var updatedQueue = queue.slice();\n\n  resetSchedulerState();\n\n  // call component updated and activated hooks\n  callActivatedHooks(activatedQueue);\n  callUpdatedHooks(updatedQueue);\n\n  // devtool hook\n  /* istanbul ignore if */\n  if (devtools && config.devtools) {\n    devtools.emit('flush');\n  }\n}\n\nfunction callUpdatedHooks (queue) {\n  var i = queue.length;\n  while (i--) {\n    var watcher = queue[i];\n    var vm = watcher.vm;\n    if (vm._watcher === watcher && vm._isMounted && !vm._isDestroyed) {\n      callHook(vm, 'updated');\n    }\n  }\n}\n\n/**\n * Queue a kept-alive component that was activated during patch.\n * The queue will be processed after the entire tree has been patched.\n */\nfunction queueActivatedComponent (vm) {\n  // setting _inactive to false here so that a render function can\n  // rely on checking whether it's in an inactive tree (e.g. router-view)\n  vm._inactive = false;\n  activatedChildren.push(vm);\n}\n\nfunction callActivatedHooks (queue) {\n  for (var i = 0; i < queue.length; i++) {\n    queue[i]._inactive = true;\n    activateChildComponent(queue[i], true /* true */);\n  }\n}\n\n/**\n * Push a watcher into the watcher queue.\n * Jobs with duplicate IDs will be skipped unless it's\n * pushed when the queue is being flushed.\n */\nfunction queueWatcher (watcher) {\n  var id = watcher.id;\n  if (has[id] == null) {\n    has[id] = true;\n    if (!flushing) {\n      queue.push(watcher);\n    } else {\n      // if already flushing, splice the watcher based on its id\n      // if already past its id, it will be run next immediately.\n      var i = queue.length - 1;\n      while (i > index && queue[i].id > watcher.id) {\n        i--;\n      }\n      queue.splice(i + 1, 0, watcher);\n    }\n    // queue the flush\n    if (!waiting) {\n      waiting = true;\n\n      if (process.env.NODE_ENV !== 'production' && !config.async) {\n        flushSchedulerQueue();\n        return\n      }\n      nextTick(flushSchedulerQueue);\n    }\n  }\n}\n\n/*  */\n\n\n\nvar uid$2 = 0;\n\n/**\n * A watcher parses an expression, collects dependencies,\n * and fires callback when the expression value changes.\n * This is used for both the $watch() api and directives.\n */\nvar Watcher = function Watcher (\n  vm,\n  expOrFn,\n  cb,\n  options,\n  isRenderWatcher\n) {\n  this.vm = vm;\n  if (isRenderWatcher) {\n    vm._watcher = this;\n  }\n  vm._watchers.push(this);\n  // options\n  if (options) {\n    this.deep = !!options.deep;\n    this.user = !!options.user;\n    this.lazy = !!options.lazy;\n    this.sync = !!options.sync;\n    this.before = options.before;\n  } else {\n    this.deep = this.user = this.lazy = this.sync = false;\n  }\n  this.cb = cb;\n  this.id = ++uid$2; // uid for batching\n  this.active = true;\n  this.dirty = this.lazy; // for lazy watchers\n  this.deps = [];\n  this.newDeps = [];\n  this.depIds = new _Set();\n  this.newDepIds = new _Set();\n  this.expression = process.env.NODE_ENV !== 'production'\n    ? expOrFn.toString()\n    : '';\n  // parse expression for getter\n  if (typeof expOrFn === 'function') {\n    this.getter = expOrFn;\n  } else {\n    this.getter = parsePath(expOrFn);\n    if (!this.getter) {\n      this.getter = noop;\n      process.env.NODE_ENV !== 'production' && warn(\n        \"Failed watching path: \\\"\" + expOrFn + \"\\\" \" +\n        'Watcher only accepts simple dot-delimited paths. ' +\n        'For full control, use a function instead.',\n        vm\n      );\n    }\n  }\n  this.value = this.lazy\n    ? undefined\n    : this.get();\n};\n\n/**\n * Evaluate the getter, and re-collect dependencies.\n */\nWatcher.prototype.get = function get () {\n  pushTarget(this);\n  var value;\n  var vm = this.vm;\n  try {\n    value = this.getter.call(vm, vm);\n  } catch (e) {\n    if (this.user) {\n      handleError(e, vm, (\"getter for watcher \\\"\" + (this.expression) + \"\\\"\"));\n    } else {\n      throw e\n    }\n  } finally {\n    // \"touch\" every property so they are all tracked as\n    // dependencies for deep watching\n    if (this.deep) {\n      traverse(value);\n    }\n    popTarget();\n    this.cleanupDeps();\n  }\n  return value\n};\n\n/**\n * Add a dependency to this directive.\n */\nWatcher.prototype.addDep = function addDep (dep) {\n  var id = dep.id;\n  if (!this.newDepIds.has(id)) {\n    this.newDepIds.add(id);\n    this.newDeps.push(dep);\n    if (!this.depIds.has(id)) {\n      dep.addSub(this);\n    }\n  }\n};\n\n/**\n * Clean up for dependency collection.\n */\nWatcher.prototype.cleanupDeps = function cleanupDeps () {\n  var i = this.deps.length;\n  while (i--) {\n    var dep = this.deps[i];\n    if (!this.newDepIds.has(dep.id)) {\n      dep.removeSub(this);\n    }\n  }\n  var tmp = this.depIds;\n  this.depIds = this.newDepIds;\n  this.newDepIds = tmp;\n  this.newDepIds.clear();\n  tmp = this.deps;\n  this.deps = this.newDeps;\n  this.newDeps = tmp;\n  this.newDeps.length = 0;\n};\n\n/**\n * Subscriber interface.\n * Will be called when a dependency changes.\n */\nWatcher.prototype.update = function update () {\n  /* istanbul ignore else */\n  if (this.lazy) {\n    this.dirty = true;\n  } else if (this.sync) {\n    this.run();\n  } else {\n    queueWatcher(this);\n  }\n};\n\n/**\n * Scheduler job interface.\n * Will be called by the scheduler.\n */\nWatcher.prototype.run = function run () {\n  if (this.active) {\n    var value = this.get();\n    if (\n      value !== this.value ||\n      // Deep watchers and watchers on Object/Arrays should fire even\n      // when the value is the same, because the value may\n      // have mutated.\n      isObject(value) ||\n      this.deep\n    ) {\n      // set new value\n      var oldValue = this.value;\n      this.value = value;\n      if (this.user) {\n        try {\n          this.cb.call(this.vm, value, oldValue);\n        } catch (e) {\n          handleError(e, this.vm, (\"callback for watcher \\\"\" + (this.expression) + \"\\\"\"));\n        }\n      } else {\n        this.cb.call(this.vm, value, oldValue);\n      }\n    }\n  }\n};\n\n/**\n * Evaluate the value of the watcher.\n * This only gets called for lazy watchers.\n */\nWatcher.prototype.evaluate = function evaluate () {\n  this.value = this.get();\n  this.dirty = false;\n};\n\n/**\n * Depend on all deps collected by this watcher.\n */\nWatcher.prototype.depend = function depend () {\n  var i = this.deps.length;\n  while (i--) {\n    this.deps[i].depend();\n  }\n};\n\n/**\n * Remove self from all dependencies' subscriber list.\n */\nWatcher.prototype.teardown = function teardown () {\n  if (this.active) {\n    // remove self from vm's watcher list\n    // this is a somewhat expensive operation so we skip it\n    // if the vm is being destroyed.\n    if (!this.vm._isBeingDestroyed) {\n      remove(this.vm._watchers, this);\n    }\n    var i = this.deps.length;\n    while (i--) {\n      this.deps[i].removeSub(this);\n    }\n    this.active = false;\n  }\n};\n\n/*  */\n\nvar sharedPropertyDefinition = {\n  enumerable: true,\n  configurable: true,\n  get: noop,\n  set: noop\n};\n\nfunction proxy (target, sourceKey, key) {\n  sharedPropertyDefinition.get = function proxyGetter () {\n    return this[sourceKey][key]\n  };\n  sharedPropertyDefinition.set = function proxySetter (val) {\n    this[sourceKey][key] = val;\n  };\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nfunction initState (vm) {\n  vm._watchers = [];\n  var opts = vm.$options;\n  if (opts.props) { initProps(vm, opts.props); }\n  if (opts.methods) { initMethods(vm, opts.methods); }\n  if (opts.data) {\n    initData(vm);\n  } else {\n    observe(vm._data = {}, true /* asRootData */);\n  }\n  if (opts.computed) { initComputed(vm, opts.computed); }\n  if (opts.watch && opts.watch !== nativeWatch) {\n    initWatch(vm, opts.watch);\n  }\n}\n\nfunction initProps (vm, propsOptions) {\n  var propsData = vm.$options.propsData || {};\n  var props = vm._props = {};\n  // cache prop keys so that future props updates can iterate using Array\n  // instead of dynamic object key enumeration.\n  var keys = vm.$options._propKeys = [];\n  var isRoot = !vm.$parent;\n  // root instance props should be converted\n  if (!isRoot) {\n    toggleObserving(false);\n  }\n  var loop = function ( key ) {\n    keys.push(key);\n    var value = validateProp(key, propsOptions, propsData, vm);\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== 'production') {\n      var hyphenatedKey = hyphenate(key);\n      if (isReservedAttribute(hyphenatedKey) ||\n          config.isReservedAttr(hyphenatedKey)) {\n        warn(\n          (\"\\\"\" + hyphenatedKey + \"\\\" is a reserved attribute and cannot be used as component prop.\"),\n          vm\n        );\n      }\n      defineReactive$$1(props, key, value, function () {\n        if (!isRoot && !isUpdatingChildComponent) {\n          warn(\n            \"Avoid mutating a prop directly since the value will be \" +\n            \"overwritten whenever the parent component re-renders. \" +\n            \"Instead, use a data or computed property based on the prop's \" +\n            \"value. Prop being mutated: \\\"\" + key + \"\\\"\",\n            vm\n          );\n        }\n      });\n    } else {\n      defineReactive$$1(props, key, value);\n    }\n    // static props are already proxied on the component's prototype\n    // during Vue.extend(). We only need to proxy props defined at\n    // instantiation here.\n    if (!(key in vm)) {\n      proxy(vm, \"_props\", key);\n    }\n  };\n\n  for (var key in propsOptions) loop( key );\n  toggleObserving(true);\n}\n\nfunction initData (vm) {\n  var data = vm.$options.data;\n  data = vm._data = typeof data === 'function'\n    ? getData(data, vm)\n    : data || {};\n  if (!isPlainObject(data)) {\n    data = {};\n    process.env.NODE_ENV !== 'production' && warn(\n      'data functions should return an object:\\n' +\n      'https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function',\n      vm\n    );\n  }\n  // proxy data on instance\n  var keys = Object.keys(data);\n  var props = vm.$options.props;\n  var methods = vm.$options.methods;\n  var i = keys.length;\n  while (i--) {\n    var key = keys[i];\n    if (process.env.NODE_ENV !== 'production') {\n      if (methods && hasOwn(methods, key)) {\n        warn(\n          (\"Method \\\"\" + key + \"\\\" has already been defined as a data property.\"),\n          vm\n        );\n      }\n    }\n    if (props && hasOwn(props, key)) {\n      process.env.NODE_ENV !== 'production' && warn(\n        \"The data property \\\"\" + key + \"\\\" is already declared as a prop. \" +\n        \"Use prop default value instead.\",\n        vm\n      );\n    } else if (!isReserved(key)) {\n      proxy(vm, \"_data\", key);\n    }\n  }\n  // observe data\n  observe(data, true /* asRootData */);\n}\n\nfunction getData (data, vm) {\n  // #7573 disable dep collection when invoking data getters\n  pushTarget();\n  try {\n    return data.call(vm, vm)\n  } catch (e) {\n    handleError(e, vm, \"data()\");\n    return {}\n  } finally {\n    popTarget();\n  }\n}\n\nvar computedWatcherOptions = { lazy: true };\n\nfunction initComputed (vm, computed) {\n  // $flow-disable-line\n  var watchers = vm._computedWatchers = Object.create(null);\n  // computed properties are just getters during SSR\n  var isSSR = isServerRendering();\n\n  for (var key in computed) {\n    var userDef = computed[key];\n    var getter = typeof userDef === 'function' ? userDef : userDef.get;\n    if (process.env.NODE_ENV !== 'production' && getter == null) {\n      warn(\n        (\"Getter is missing for computed property \\\"\" + key + \"\\\".\"),\n        vm\n      );\n    }\n\n    if (!isSSR) {\n      // create internal watcher for the computed property.\n      watchers[key] = new Watcher(\n        vm,\n        getter || noop,\n        noop,\n        computedWatcherOptions\n      );\n    }\n\n    // component-defined computed properties are already defined on the\n    // component prototype. We only need to define computed properties defined\n    // at instantiation here.\n    if (!(key in vm)) {\n      defineComputed(vm, key, userDef);\n    } else if (process.env.NODE_ENV !== 'production') {\n      if (key in vm.$data) {\n        warn((\"The computed property \\\"\" + key + \"\\\" is already defined in data.\"), vm);\n      } else if (vm.$options.props && key in vm.$options.props) {\n        warn((\"The computed property \\\"\" + key + \"\\\" is already defined as a prop.\"), vm);\n      }\n    }\n  }\n}\n\nfunction defineComputed (\n  target,\n  key,\n  userDef\n) {\n  var shouldCache = !isServerRendering();\n  if (typeof userDef === 'function') {\n    sharedPropertyDefinition.get = shouldCache\n      ? createComputedGetter(key)\n      : createGetterInvoker(userDef);\n    sharedPropertyDefinition.set = noop;\n  } else {\n    sharedPropertyDefinition.get = userDef.get\n      ? shouldCache && userDef.cache !== false\n        ? createComputedGetter(key)\n        : createGetterInvoker(userDef.get)\n      : noop;\n    sharedPropertyDefinition.set = userDef.set || noop;\n  }\n  if (process.env.NODE_ENV !== 'production' &&\n      sharedPropertyDefinition.set === noop) {\n    sharedPropertyDefinition.set = function () {\n      warn(\n        (\"Computed property \\\"\" + key + \"\\\" was assigned to but it has no setter.\"),\n        this\n      );\n    };\n  }\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nfunction createComputedGetter (key) {\n  return function computedGetter () {\n    var watcher = this._computedWatchers && this._computedWatchers[key];\n    if (watcher) {\n      if (watcher.dirty) {\n        watcher.evaluate();\n      }\n      if (Dep.target) {\n        watcher.depend();\n      }\n      return watcher.value\n    }\n  }\n}\n\nfunction createGetterInvoker(fn) {\n  return function computedGetter () {\n    return fn.call(this, this)\n  }\n}\n\nfunction initMethods (vm, methods) {\n  var props = vm.$options.props;\n  for (var key in methods) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof methods[key] !== 'function') {\n        warn(\n          \"Method \\\"\" + key + \"\\\" has type \\\"\" + (typeof methods[key]) + \"\\\" in the component definition. \" +\n          \"Did you reference the function correctly?\",\n          vm\n        );\n      }\n      if (props && hasOwn(props, key)) {\n        warn(\n          (\"Method \\\"\" + key + \"\\\" has already been defined as a prop.\"),\n          vm\n        );\n      }\n      if ((key in vm) && isReserved(key)) {\n        warn(\n          \"Method \\\"\" + key + \"\\\" conflicts with an existing Vue instance method. \" +\n          \"Avoid defining component methods that start with _ or $.\"\n        );\n      }\n    }\n    vm[key] = typeof methods[key] !== 'function' ? noop : bind(methods[key], vm);\n  }\n}\n\nfunction initWatch (vm, watch) {\n  for (var key in watch) {\n    var handler = watch[key];\n    if (Array.isArray(handler)) {\n      for (var i = 0; i < handler.length; i++) {\n        createWatcher(vm, key, handler[i]);\n      }\n    } else {\n      createWatcher(vm, key, handler);\n    }\n  }\n}\n\nfunction createWatcher (\n  vm,\n  expOrFn,\n  handler,\n  options\n) {\n  if (isPlainObject(handler)) {\n    options = handler;\n    handler = handler.handler;\n  }\n  if (typeof handler === 'string') {\n    handler = vm[handler];\n  }\n  return vm.$watch(expOrFn, handler, options)\n}\n\nfunction stateMixin (Vue) {\n  // flow somehow has problems with directly declared definition object\n  // when using Object.defineProperty, so we have to procedurally build up\n  // the object here.\n  var dataDef = {};\n  dataDef.get = function () { return this._data };\n  var propsDef = {};\n  propsDef.get = function () { return this._props };\n  if (process.env.NODE_ENV !== 'production') {\n    dataDef.set = function () {\n      warn(\n        'Avoid replacing instance root $data. ' +\n        'Use nested data properties instead.',\n        this\n      );\n    };\n    propsDef.set = function () {\n      warn(\"$props is readonly.\", this);\n    };\n  }\n  Object.defineProperty(Vue.prototype, '$data', dataDef);\n  Object.defineProperty(Vue.prototype, '$props', propsDef);\n\n  Vue.prototype.$set = set;\n  Vue.prototype.$delete = del;\n\n  Vue.prototype.$watch = function (\n    expOrFn,\n    cb,\n    options\n  ) {\n    var vm = this;\n    if (isPlainObject(cb)) {\n      return createWatcher(vm, expOrFn, cb, options)\n    }\n    options = options || {};\n    options.user = true;\n    var watcher = new Watcher(vm, expOrFn, cb, options);\n    if (options.immediate) {\n      try {\n        cb.call(vm, watcher.value);\n      } catch (error) {\n        handleError(error, vm, (\"callback for immediate watcher \\\"\" + (watcher.expression) + \"\\\"\"));\n      }\n    }\n    return function unwatchFn () {\n      watcher.teardown();\n    }\n  };\n}\n\n/*  */\n\nvar uid$3 = 0;\n\nfunction initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    var vm = this;\n    // a uid\n    vm._uid = uid$3++;\n\n    var startTag, endTag;\n    /* istanbul ignore if */\n    if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n      startTag = \"vue-perf-start:\" + (vm._uid);\n      endTag = \"vue-perf-end:\" + (vm._uid);\n      mark(startTag);\n    }\n\n    // a flag to avoid this being observed\n    vm._isVue = true;\n    // merge options\n    if (options && options._isComponent) {\n      // optimize internal component instantiation\n      // since dynamic options merging is pretty slow, and none of the\n      // internal component options needs special treatment.\n      initInternalComponent(vm, options);\n    } else {\n      vm.$options = mergeOptions(\n        resolveConstructorOptions(vm.constructor),\n        options || {},\n        vm\n      );\n    }\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== 'production') {\n      initProxy(vm);\n    } else {\n      vm._renderProxy = vm;\n    }\n    // expose real self\n    vm._self = vm;\n    initLifecycle(vm);\n    initEvents(vm);\n    initRender(vm);\n    callHook(vm, 'beforeCreate');\n    initInjections(vm); // resolve injections before data/props\n    initState(vm);\n    initProvide(vm); // resolve provide after data/props\n    callHook(vm, 'created');\n\n    /* istanbul ignore if */\n    if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n      vm._name = formatComponentName(vm, false);\n      mark(endTag);\n      measure((\"vue \" + (vm._name) + \" init\"), startTag, endTag);\n    }\n\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el);\n    }\n  };\n}\n\nfunction initInternalComponent (vm, options) {\n  var opts = vm.$options = Object.create(vm.constructor.options);\n  // doing this because it's faster than dynamic enumeration.\n  var parentVnode = options._parentVnode;\n  opts.parent = options.parent;\n  opts._parentVnode = parentVnode;\n\n  var vnodeComponentOptions = parentVnode.componentOptions;\n  opts.propsData = vnodeComponentOptions.propsData;\n  opts._parentListeners = vnodeComponentOptions.listeners;\n  opts._renderChildren = vnodeComponentOptions.children;\n  opts._componentTag = vnodeComponentOptions.tag;\n\n  if (options.render) {\n    opts.render = options.render;\n    opts.staticRenderFns = options.staticRenderFns;\n  }\n}\n\nfunction resolveConstructorOptions (Ctor) {\n  var options = Ctor.options;\n  if (Ctor.super) {\n    var superOptions = resolveConstructorOptions(Ctor.super);\n    var cachedSuperOptions = Ctor.superOptions;\n    if (superOptions !== cachedSuperOptions) {\n      // super option changed,\n      // need to resolve new options.\n      Ctor.superOptions = superOptions;\n      // check if there are any late-modified/attached options (#4976)\n      var modifiedOptions = resolveModifiedOptions(Ctor);\n      // update base extend options\n      if (modifiedOptions) {\n        extend(Ctor.extendOptions, modifiedOptions);\n      }\n      options = Ctor.options = mergeOptions(superOptions, Ctor.extendOptions);\n      if (options.name) {\n        options.components[options.name] = Ctor;\n      }\n    }\n  }\n  return options\n}\n\nfunction resolveModifiedOptions (Ctor) {\n  var modified;\n  var latest = Ctor.options;\n  var sealed = Ctor.sealedOptions;\n  for (var key in latest) {\n    if (latest[key] !== sealed[key]) {\n      if (!modified) { modified = {}; }\n      modified[key] = latest[key];\n    }\n  }\n  return modified\n}\n\nfunction Vue (options) {\n  if (process.env.NODE_ENV !== 'production' &&\n    !(this instanceof Vue)\n  ) {\n    warn('Vue is a constructor and should be called with the `new` keyword');\n  }\n  this._init(options);\n}\n\ninitMixin(Vue);\nstateMixin(Vue);\neventsMixin(Vue);\nlifecycleMixin(Vue);\nrenderMixin(Vue);\n\n/*  */\n\nfunction initUse (Vue) {\n  Vue.use = function (plugin) {\n    var installedPlugins = (this._installedPlugins || (this._installedPlugins = []));\n    if (installedPlugins.indexOf(plugin) > -1) {\n      return this\n    }\n\n    // additional parameters\n    var args = toArray(arguments, 1);\n    args.unshift(this);\n    if (typeof plugin.install === 'function') {\n      plugin.install.apply(plugin, args);\n    } else if (typeof plugin === 'function') {\n      plugin.apply(null, args);\n    }\n    installedPlugins.push(plugin);\n    return this\n  };\n}\n\n/*  */\n\nfunction initMixin$1 (Vue) {\n  Vue.mixin = function (mixin) {\n    this.options = mergeOptions(this.options, mixin);\n    return this\n  };\n}\n\n/*  */\n\nfunction initExtend (Vue) {\n  /**\n   * Each instance constructor, including Vue, has a unique\n   * cid. This enables us to create wrapped \"child\n   * constructors\" for prototypal inheritance and cache them.\n   */\n  Vue.cid = 0;\n  var cid = 1;\n\n  /**\n   * Class inheritance\n   */\n  Vue.extend = function (extendOptions) {\n    extendOptions = extendOptions || {};\n    var Super = this;\n    var SuperId = Super.cid;\n    var cachedCtors = extendOptions._Ctor || (extendOptions._Ctor = {});\n    if (cachedCtors[SuperId]) {\n      return cachedCtors[SuperId]\n    }\n\n    var name = extendOptions.name || Super.options.name;\n    if (process.env.NODE_ENV !== 'production' && name) {\n      validateComponentName(name);\n    }\n\n    var Sub = function VueComponent (options) {\n      this._init(options);\n    };\n    Sub.prototype = Object.create(Super.prototype);\n    Sub.prototype.constructor = Sub;\n    Sub.cid = cid++;\n    Sub.options = mergeOptions(\n      Super.options,\n      extendOptions\n    );\n    Sub['super'] = Super;\n\n    // For props and computed properties, we define the proxy getters on\n    // the Vue instances at extension time, on the extended prototype. This\n    // avoids Object.defineProperty calls for each instance created.\n    if (Sub.options.props) {\n      initProps$1(Sub);\n    }\n    if (Sub.options.computed) {\n      initComputed$1(Sub);\n    }\n\n    // allow further extension/mixin/plugin usage\n    Sub.extend = Super.extend;\n    Sub.mixin = Super.mixin;\n    Sub.use = Super.use;\n\n    // create asset registers, so extended classes\n    // can have their private assets too.\n    ASSET_TYPES.forEach(function (type) {\n      Sub[type] = Super[type];\n    });\n    // enable recursive self-lookup\n    if (name) {\n      Sub.options.components[name] = Sub;\n    }\n\n    // keep a reference to the super options at extension time.\n    // later at instantiation we can check if Super's options have\n    // been updated.\n    Sub.superOptions = Super.options;\n    Sub.extendOptions = extendOptions;\n    Sub.sealedOptions = extend({}, Sub.options);\n\n    // cache constructor\n    cachedCtors[SuperId] = Sub;\n    return Sub\n  };\n}\n\nfunction initProps$1 (Comp) {\n  var props = Comp.options.props;\n  for (var key in props) {\n    proxy(Comp.prototype, \"_props\", key);\n  }\n}\n\nfunction initComputed$1 (Comp) {\n  var computed = Comp.options.computed;\n  for (var key in computed) {\n    defineComputed(Comp.prototype, key, computed[key]);\n  }\n}\n\n/*  */\n\nfunction initAssetRegisters (Vue) {\n  /**\n   * Create asset registration methods.\n   */\n  ASSET_TYPES.forEach(function (type) {\n    Vue[type] = function (\n      id,\n      definition\n    ) {\n      if (!definition) {\n        return this.options[type + 's'][id]\n      } else {\n        /* istanbul ignore if */\n        if (process.env.NODE_ENV !== 'production' && type === 'component') {\n          validateComponentName(id);\n        }\n        if (type === 'component' && isPlainObject(definition)) {\n          definition.name = definition.name || id;\n          definition = this.options._base.extend(definition);\n        }\n        if (type === 'directive' && typeof definition === 'function') {\n          definition = { bind: definition, update: definition };\n        }\n        this.options[type + 's'][id] = definition;\n        return definition\n      }\n    };\n  });\n}\n\n/*  */\n\n\n\nfunction getComponentName (opts) {\n  return opts && (opts.Ctor.options.name || opts.tag)\n}\n\nfunction matches (pattern, name) {\n  if (Array.isArray(pattern)) {\n    return pattern.indexOf(name) > -1\n  } else if (typeof pattern === 'string') {\n    return pattern.split(',').indexOf(name) > -1\n  } else if (isRegExp(pattern)) {\n    return pattern.test(name)\n  }\n  /* istanbul ignore next */\n  return false\n}\n\nfunction pruneCache (keepAliveInstance, filter) {\n  var cache = keepAliveInstance.cache;\n  var keys = keepAliveInstance.keys;\n  var _vnode = keepAliveInstance._vnode;\n  for (var key in cache) {\n    var cachedNode = cache[key];\n    if (cachedNode) {\n      var name = getComponentName(cachedNode.componentOptions);\n      if (name && !filter(name)) {\n        pruneCacheEntry(cache, key, keys, _vnode);\n      }\n    }\n  }\n}\n\nfunction pruneCacheEntry (\n  cache,\n  key,\n  keys,\n  current\n) {\n  var cached$$1 = cache[key];\n  if (cached$$1 && (!current || cached$$1.tag !== current.tag)) {\n    cached$$1.componentInstance.$destroy();\n  }\n  cache[key] = null;\n  remove(keys, key);\n}\n\nvar patternTypes = [String, RegExp, Array];\n\nvar KeepAlive = {\n  name: 'keep-alive',\n  abstract: true,\n\n  props: {\n    include: patternTypes,\n    exclude: patternTypes,\n    max: [String, Number]\n  },\n\n  created: function created () {\n    this.cache = Object.create(null);\n    this.keys = [];\n  },\n\n  destroyed: function destroyed () {\n    for (var key in this.cache) {\n      pruneCacheEntry(this.cache, key, this.keys);\n    }\n  },\n\n  mounted: function mounted () {\n    var this$1 = this;\n\n    this.$watch('include', function (val) {\n      pruneCache(this$1, function (name) { return matches(val, name); });\n    });\n    this.$watch('exclude', function (val) {\n      pruneCache(this$1, function (name) { return !matches(val, name); });\n    });\n  },\n\n  render: function render () {\n    var slot = this.$slots.default;\n    var vnode = getFirstComponentChild(slot);\n    var componentOptions = vnode && vnode.componentOptions;\n    if (componentOptions) {\n      // check pattern\n      var name = getComponentName(componentOptions);\n      var ref = this;\n      var include = ref.include;\n      var exclude = ref.exclude;\n      if (\n        // not included\n        (include && (!name || !matches(include, name))) ||\n        // excluded\n        (exclude && name && matches(exclude, name))\n      ) {\n        return vnode\n      }\n\n      var ref$1 = this;\n      var cache = ref$1.cache;\n      var keys = ref$1.keys;\n      var key = vnode.key == null\n        // same constructor may get registered as different local components\n        // so cid alone is not enough (#3269)\n        ? componentOptions.Ctor.cid + (componentOptions.tag ? (\"::\" + (componentOptions.tag)) : '')\n        : vnode.key;\n      if (cache[key]) {\n        vnode.componentInstance = cache[key].componentInstance;\n        // make current key freshest\n        remove(keys, key);\n        keys.push(key);\n      } else {\n        cache[key] = vnode;\n        keys.push(key);\n        // prune oldest entry\n        if (this.max && keys.length > parseInt(this.max)) {\n          pruneCacheEntry(cache, keys[0], keys, this._vnode);\n        }\n      }\n\n      vnode.data.keepAlive = true;\n    }\n    return vnode || (slot && slot[0])\n  }\n};\n\nvar builtInComponents = {\n  KeepAlive: KeepAlive\n};\n\n/*  */\n\nfunction initGlobalAPI (Vue) {\n  // config\n  var configDef = {};\n  configDef.get = function () { return config; };\n  if (process.env.NODE_ENV !== 'production') {\n    configDef.set = function () {\n      warn(\n        'Do not replace the Vue.config object, set individual fields instead.'\n      );\n    };\n  }\n  Object.defineProperty(Vue, 'config', configDef);\n\n  // exposed util methods.\n  // NOTE: these are not considered part of the public API - avoid relying on\n  // them unless you are aware of the risk.\n  Vue.util = {\n    warn: warn,\n    extend: extend,\n    mergeOptions: mergeOptions,\n    defineReactive: defineReactive$$1\n  };\n\n  Vue.set = set;\n  Vue.delete = del;\n  Vue.nextTick = nextTick;\n\n  // 2.6 explicit observable API\n  Vue.observable = function (obj) {\n    observe(obj);\n    return obj\n  };\n\n  Vue.options = Object.create(null);\n  ASSET_TYPES.forEach(function (type) {\n    Vue.options[type + 's'] = Object.create(null);\n  });\n\n  // this is used to identify the \"base\" constructor to extend all plain-object\n  // components with in Weex's multi-instance scenarios.\n  Vue.options._base = Vue;\n\n  extend(Vue.options.components, builtInComponents);\n\n  initUse(Vue);\n  initMixin$1(Vue);\n  initExtend(Vue);\n  initAssetRegisters(Vue);\n}\n\ninitGlobalAPI(Vue);\n\nObject.defineProperty(Vue.prototype, '$isServer', {\n  get: isServerRendering\n});\n\nObject.defineProperty(Vue.prototype, '$ssrContext', {\n  get: function get () {\n    /* istanbul ignore next */\n    return this.$vnode && this.$vnode.ssrContext\n  }\n});\n\n// expose FunctionalRenderContext for ssr runtime helper installation\nObject.defineProperty(Vue, 'FunctionalRenderContext', {\n  value: FunctionalRenderContext\n});\n\nVue.version = '2.6.10';\n\n/*  */\n\n// these are reserved for web because they are directly compiled away\n// during template compilation\nvar isReservedAttr = makeMap('style,class');\n\n// attributes that should be using props for binding\nvar acceptValue = makeMap('input,textarea,option,select,progress');\nvar mustUseProp = function (tag, type, attr) {\n  return (\n    (attr === 'value' && acceptValue(tag)) && type !== 'button' ||\n    (attr === 'selected' && tag === 'option') ||\n    (attr === 'checked' && tag === 'input') ||\n    (attr === 'muted' && tag === 'video')\n  )\n};\n\nvar isEnumeratedAttr = makeMap('contenteditable,draggable,spellcheck');\n\nvar isValidContentEditableValue = makeMap('events,caret,typing,plaintext-only');\n\nvar convertEnumeratedValue = function (key, value) {\n  return isFalsyAttrValue(value) || value === 'false'\n    ? 'false'\n    // allow arbitrary string value for contenteditable\n    : key === 'contenteditable' && isValidContentEditableValue(value)\n      ? value\n      : 'true'\n};\n\nvar isBooleanAttr = makeMap(\n  'allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,' +\n  'default,defaultchecked,defaultmuted,defaultselected,defer,disabled,' +\n  'enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,' +\n  'muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,' +\n  'required,reversed,scoped,seamless,selected,sortable,translate,' +\n  'truespeed,typemustmatch,visible'\n);\n\nvar xlinkNS = 'http://www.w3.org/1999/xlink';\n\nvar isXlink = function (name) {\n  return name.charAt(5) === ':' && name.slice(0, 5) === 'xlink'\n};\n\nvar getXlinkProp = function (name) {\n  return isXlink(name) ? name.slice(6, name.length) : ''\n};\n\nvar isFalsyAttrValue = function (val) {\n  return val == null || val === false\n};\n\n/*  */\n\nfunction genClassForVnode (vnode) {\n  var data = vnode.data;\n  var parentNode = vnode;\n  var childNode = vnode;\n  while (isDef(childNode.componentInstance)) {\n    childNode = childNode.componentInstance._vnode;\n    if (childNode && childNode.data) {\n      data = mergeClassData(childNode.data, data);\n    }\n  }\n  while (isDef(parentNode = parentNode.parent)) {\n    if (parentNode && parentNode.data) {\n      data = mergeClassData(data, parentNode.data);\n    }\n  }\n  return renderClass(data.staticClass, data.class)\n}\n\nfunction mergeClassData (child, parent) {\n  return {\n    staticClass: concat(child.staticClass, parent.staticClass),\n    class: isDef(child.class)\n      ? [child.class, parent.class]\n      : parent.class\n  }\n}\n\nfunction renderClass (\n  staticClass,\n  dynamicClass\n) {\n  if (isDef(staticClass) || isDef(dynamicClass)) {\n    return concat(staticClass, stringifyClass(dynamicClass))\n  }\n  /* istanbul ignore next */\n  return ''\n}\n\nfunction concat (a, b) {\n  return a ? b ? (a + ' ' + b) : a : (b || '')\n}\n\nfunction stringifyClass (value) {\n  if (Array.isArray(value)) {\n    return stringifyArray(value)\n  }\n  if (isObject(value)) {\n    return stringifyObject(value)\n  }\n  if (typeof value === 'string') {\n    return value\n  }\n  /* istanbul ignore next */\n  return ''\n}\n\nfunction stringifyArray (value) {\n  var res = '';\n  var stringified;\n  for (var i = 0, l = value.length; i < l; i++) {\n    if (isDef(stringified = stringifyClass(value[i])) && stringified !== '') {\n      if (res) { res += ' '; }\n      res += stringified;\n    }\n  }\n  return res\n}\n\nfunction stringifyObject (value) {\n  var res = '';\n  for (var key in value) {\n    if (value[key]) {\n      if (res) { res += ' '; }\n      res += key;\n    }\n  }\n  return res\n}\n\n/*  */\n\nvar namespaceMap = {\n  svg: 'http://www.w3.org/2000/svg',\n  math: 'http://www.w3.org/1998/Math/MathML'\n};\n\nvar isHTMLTag = makeMap(\n  'html,body,base,head,link,meta,style,title,' +\n  'address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,' +\n  'div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,' +\n  'a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,' +\n  's,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,' +\n  'embed,object,param,source,canvas,script,noscript,del,ins,' +\n  'caption,col,colgroup,table,thead,tbody,td,th,tr,' +\n  'button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,' +\n  'output,progress,select,textarea,' +\n  'details,dialog,menu,menuitem,summary,' +\n  'content,element,shadow,template,blockquote,iframe,tfoot'\n);\n\n// this map is intentionally selective, only covering SVG elements that may\n// contain child elements.\nvar isSVG = makeMap(\n  'svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,' +\n  'foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,' +\n  'polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view',\n  true\n);\n\nvar isReservedTag = function (tag) {\n  return isHTMLTag(tag) || isSVG(tag)\n};\n\nfunction getTagNamespace (tag) {\n  if (isSVG(tag)) {\n    return 'svg'\n  }\n  // basic support for MathML\n  // note it doesn't support other MathML elements being component roots\n  if (tag === 'math') {\n    return 'math'\n  }\n}\n\nvar unknownElementCache = Object.create(null);\nfunction isUnknownElement (tag) {\n  /* istanbul ignore if */\n  if (!inBrowser) {\n    return true\n  }\n  if (isReservedTag(tag)) {\n    return false\n  }\n  tag = tag.toLowerCase();\n  /* istanbul ignore if */\n  if (unknownElementCache[tag] != null) {\n    return unknownElementCache[tag]\n  }\n  var el = document.createElement(tag);\n  if (tag.indexOf('-') > -1) {\n    // http://stackoverflow.com/a/28210364/1070244\n    return (unknownElementCache[tag] = (\n      el.constructor === window.HTMLUnknownElement ||\n      el.constructor === window.HTMLElement\n    ))\n  } else {\n    return (unknownElementCache[tag] = /HTMLUnknownElement/.test(el.toString()))\n  }\n}\n\nvar isTextInputType = makeMap('text,number,password,search,email,tel,url');\n\n/*  */\n\n/**\n * Query an element selector if it's not an element already.\n */\nfunction query (el) {\n  if (typeof el === 'string') {\n    var selected = document.querySelector(el);\n    if (!selected) {\n      process.env.NODE_ENV !== 'production' && warn(\n        'Cannot find element: ' + el\n      );\n      return document.createElement('div')\n    }\n    return selected\n  } else {\n    return el\n  }\n}\n\n/*  */\n\nfunction createElement$1 (tagName, vnode) {\n  var elm = document.createElement(tagName);\n  if (tagName !== 'select') {\n    return elm\n  }\n  // false or null will remove the attribute but undefined will not\n  if (vnode.data && vnode.data.attrs && vnode.data.attrs.multiple !== undefined) {\n    elm.setAttribute('multiple', 'multiple');\n  }\n  return elm\n}\n\nfunction createElementNS (namespace, tagName) {\n  return document.createElementNS(namespaceMap[namespace], tagName)\n}\n\nfunction createTextNode (text) {\n  return document.createTextNode(text)\n}\n\nfunction createComment (text) {\n  return document.createComment(text)\n}\n\nfunction insertBefore (parentNode, newNode, referenceNode) {\n  parentNode.insertBefore(newNode, referenceNode);\n}\n\nfunction removeChild (node, child) {\n  node.removeChild(child);\n}\n\nfunction appendChild (node, child) {\n  node.appendChild(child);\n}\n\nfunction parentNode (node) {\n  return node.parentNode\n}\n\nfunction nextSibling (node) {\n  return node.nextSibling\n}\n\nfunction tagName (node) {\n  return node.tagName\n}\n\nfunction setTextContent (node, text) {\n  node.textContent = text;\n}\n\nfunction setStyleScope (node, scopeId) {\n  node.setAttribute(scopeId, '');\n}\n\nvar nodeOps = /*#__PURE__*/Object.freeze({\n  createElement: createElement$1,\n  createElementNS: createElementNS,\n  createTextNode: createTextNode,\n  createComment: createComment,\n  insertBefore: insertBefore,\n  removeChild: removeChild,\n  appendChild: appendChild,\n  parentNode: parentNode,\n  nextSibling: nextSibling,\n  tagName: tagName,\n  setTextContent: setTextContent,\n  setStyleScope: setStyleScope\n});\n\n/*  */\n\nvar ref = {\n  create: function create (_, vnode) {\n    registerRef(vnode);\n  },\n  update: function update (oldVnode, vnode) {\n    if (oldVnode.data.ref !== vnode.data.ref) {\n      registerRef(oldVnode, true);\n      registerRef(vnode);\n    }\n  },\n  destroy: function destroy (vnode) {\n    registerRef(vnode, true);\n  }\n};\n\nfunction registerRef (vnode, isRemoval) {\n  var key = vnode.data.ref;\n  if (!isDef(key)) { return }\n\n  var vm = vnode.context;\n  var ref = vnode.componentInstance || vnode.elm;\n  var refs = vm.$refs;\n  if (isRemoval) {\n    if (Array.isArray(refs[key])) {\n      remove(refs[key], ref);\n    } else if (refs[key] === ref) {\n      refs[key] = undefined;\n    }\n  } else {\n    if (vnode.data.refInFor) {\n      if (!Array.isArray(refs[key])) {\n        refs[key] = [ref];\n      } else if (refs[key].indexOf(ref) < 0) {\n        // $flow-disable-line\n        refs[key].push(ref);\n      }\n    } else {\n      refs[key] = ref;\n    }\n  }\n}\n\n/**\n * Virtual DOM patching algorithm based on Snabbdom by\n * Simon Friis Vindum (@paldepind)\n * Licensed under the MIT License\n * https://github.com/paldepind/snabbdom/blob/master/LICENSE\n *\n * modified by Evan You (@yyx990803)\n *\n * Not type-checking this because this file is perf-critical and the cost\n * of making flow understand it is not worth it.\n */\n\nvar emptyNode = new VNode('', {}, []);\n\nvar hooks = ['create', 'activate', 'update', 'remove', 'destroy'];\n\nfunction sameVnode (a, b) {\n  return (\n    a.key === b.key && (\n      (\n        a.tag === b.tag &&\n        a.isComment === b.isComment &&\n        isDef(a.data) === isDef(b.data) &&\n        sameInputType(a, b)\n      ) || (\n        isTrue(a.isAsyncPlaceholder) &&\n        a.asyncFactory === b.asyncFactory &&\n        isUndef(b.asyncFactory.error)\n      )\n    )\n  )\n}\n\nfunction sameInputType (a, b) {\n  if (a.tag !== 'input') { return true }\n  var i;\n  var typeA = isDef(i = a.data) && isDef(i = i.attrs) && i.type;\n  var typeB = isDef(i = b.data) && isDef(i = i.attrs) && i.type;\n  return typeA === typeB || isTextInputType(typeA) && isTextInputType(typeB)\n}\n\nfunction createKeyToOldIdx (children, beginIdx, endIdx) {\n  var i, key;\n  var map = {};\n  for (i = beginIdx; i <= endIdx; ++i) {\n    key = children[i].key;\n    if (isDef(key)) { map[key] = i; }\n  }\n  return map\n}\n\nfunction createPatchFunction (backend) {\n  var i, j;\n  var cbs = {};\n\n  var modules = backend.modules;\n  var nodeOps = backend.nodeOps;\n\n  for (i = 0; i < hooks.length; ++i) {\n    cbs[hooks[i]] = [];\n    for (j = 0; j < modules.length; ++j) {\n      if (isDef(modules[j][hooks[i]])) {\n        cbs[hooks[i]].push(modules[j][hooks[i]]);\n      }\n    }\n  }\n\n  function emptyNodeAt (elm) {\n    return new VNode(nodeOps.tagName(elm).toLowerCase(), {}, [], undefined, elm)\n  }\n\n  function createRmCb (childElm, listeners) {\n    function remove$$1 () {\n      if (--remove$$1.listeners === 0) {\n        removeNode(childElm);\n      }\n    }\n    remove$$1.listeners = listeners;\n    return remove$$1\n  }\n\n  function removeNode (el) {\n    var parent = nodeOps.parentNode(el);\n    // element may have already been removed due to v-html / v-text\n    if (isDef(parent)) {\n      nodeOps.removeChild(parent, el);\n    }\n  }\n\n  function isUnknownElement$$1 (vnode, inVPre) {\n    return (\n      !inVPre &&\n      !vnode.ns &&\n      !(\n        config.ignoredElements.length &&\n        config.ignoredElements.some(function (ignore) {\n          return isRegExp(ignore)\n            ? ignore.test(vnode.tag)\n            : ignore === vnode.tag\n        })\n      ) &&\n      config.isUnknownElement(vnode.tag)\n    )\n  }\n\n  var creatingElmInVPre = 0;\n\n  function createElm (\n    vnode,\n    insertedVnodeQueue,\n    parentElm,\n    refElm,\n    nested,\n    ownerArray,\n    index\n  ) {\n    if (isDef(vnode.elm) && isDef(ownerArray)) {\n      // This vnode was used in a previous render!\n      // now it's used as a new node, overwriting its elm would cause\n      // potential patch errors down the road when it's used as an insertion\n      // reference node. Instead, we clone the node on-demand before creating\n      // associated DOM element for it.\n      vnode = ownerArray[index] = cloneVNode(vnode);\n    }\n\n    vnode.isRootInsert = !nested; // for transition enter check\n    if (createComponent(vnode, insertedVnodeQueue, parentElm, refElm)) {\n      return\n    }\n\n    var data = vnode.data;\n    var children = vnode.children;\n    var tag = vnode.tag;\n    if (isDef(tag)) {\n      if (process.env.NODE_ENV !== 'production') {\n        if (data && data.pre) {\n          creatingElmInVPre++;\n        }\n        if (isUnknownElement$$1(vnode, creatingElmInVPre)) {\n          warn(\n            'Unknown custom element: <' + tag + '> - did you ' +\n            'register the component correctly? For recursive components, ' +\n            'make sure to provide the \"name\" option.',\n            vnode.context\n          );\n        }\n      }\n\n      vnode.elm = vnode.ns\n        ? nodeOps.createElementNS(vnode.ns, tag)\n        : nodeOps.createElement(tag, vnode);\n      setScope(vnode);\n\n      /* istanbul ignore if */\n      {\n        createChildren(vnode, children, insertedVnodeQueue);\n        if (isDef(data)) {\n          invokeCreateHooks(vnode, insertedVnodeQueue);\n        }\n        insert(parentElm, vnode.elm, refElm);\n      }\n\n      if (process.env.NODE_ENV !== 'production' && data && data.pre) {\n        creatingElmInVPre--;\n      }\n    } else if (isTrue(vnode.isComment)) {\n      vnode.elm = nodeOps.createComment(vnode.text);\n      insert(parentElm, vnode.elm, refElm);\n    } else {\n      vnode.elm = nodeOps.createTextNode(vnode.text);\n      insert(parentElm, vnode.elm, refElm);\n    }\n  }\n\n  function createComponent (vnode, insertedVnodeQueue, parentElm, refElm) {\n    var i = vnode.data;\n    if (isDef(i)) {\n      var isReactivated = isDef(vnode.componentInstance) && i.keepAlive;\n      if (isDef(i = i.hook) && isDef(i = i.init)) {\n        i(vnode, false /* hydrating */);\n      }\n      // after calling the init hook, if the vnode is a child component\n      // it should've created a child instance and mounted it. the child\n      // component also has set the placeholder vnode's elm.\n      // in that case we can just return the element and be done.\n      if (isDef(vnode.componentInstance)) {\n        initComponent(vnode, insertedVnodeQueue);\n        insert(parentElm, vnode.elm, refElm);\n        if (isTrue(isReactivated)) {\n          reactivateComponent(vnode, insertedVnodeQueue, parentElm, refElm);\n        }\n        return true\n      }\n    }\n  }\n\n  function initComponent (vnode, insertedVnodeQueue) {\n    if (isDef(vnode.data.pendingInsert)) {\n      insertedVnodeQueue.push.apply(insertedVnodeQueue, vnode.data.pendingInsert);\n      vnode.data.pendingInsert = null;\n    }\n    vnode.elm = vnode.componentInstance.$el;\n    if (isPatchable(vnode)) {\n      invokeCreateHooks(vnode, insertedVnodeQueue);\n      setScope(vnode);\n    } else {\n      // empty component root.\n      // skip all element-related modules except for ref (#3455)\n      registerRef(vnode);\n      // make sure to invoke the insert hook\n      insertedVnodeQueue.push(vnode);\n    }\n  }\n\n  function reactivateComponent (vnode, insertedVnodeQueue, parentElm, refElm) {\n    var i;\n    // hack for #4339: a reactivated component with inner transition\n    // does not trigger because the inner node's created hooks are not called\n    // again. It's not ideal to involve module-specific logic in here but\n    // there doesn't seem to be a better way to do it.\n    var innerNode = vnode;\n    while (innerNode.componentInstance) {\n      innerNode = innerNode.componentInstance._vnode;\n      if (isDef(i = innerNode.data) && isDef(i = i.transition)) {\n        for (i = 0; i < cbs.activate.length; ++i) {\n          cbs.activate[i](emptyNode, innerNode);\n        }\n        insertedVnodeQueue.push(innerNode);\n        break\n      }\n    }\n    // unlike a newly created component,\n    // a reactivated keep-alive component doesn't insert itself\n    insert(parentElm, vnode.elm, refElm);\n  }\n\n  function insert (parent, elm, ref$$1) {\n    if (isDef(parent)) {\n      if (isDef(ref$$1)) {\n        if (nodeOps.parentNode(ref$$1) === parent) {\n          nodeOps.insertBefore(parent, elm, ref$$1);\n        }\n      } else {\n        nodeOps.appendChild(parent, elm);\n      }\n    }\n  }\n\n  function createChildren (vnode, children, insertedVnodeQueue) {\n    if (Array.isArray(children)) {\n      if (process.env.NODE_ENV !== 'production') {\n        checkDuplicateKeys(children);\n      }\n      for (var i = 0; i < children.length; ++i) {\n        createElm(children[i], insertedVnodeQueue, vnode.elm, null, true, children, i);\n      }\n    } else if (isPrimitive(vnode.text)) {\n      nodeOps.appendChild(vnode.elm, nodeOps.createTextNode(String(vnode.text)));\n    }\n  }\n\n  function isPatchable (vnode) {\n    while (vnode.componentInstance) {\n      vnode = vnode.componentInstance._vnode;\n    }\n    return isDef(vnode.tag)\n  }\n\n  function invokeCreateHooks (vnode, insertedVnodeQueue) {\n    for (var i$1 = 0; i$1 < cbs.create.length; ++i$1) {\n      cbs.create[i$1](emptyNode, vnode);\n    }\n    i = vnode.data.hook; // Reuse variable\n    if (isDef(i)) {\n      if (isDef(i.create)) { i.create(emptyNode, vnode); }\n      if (isDef(i.insert)) { insertedVnodeQueue.push(vnode); }\n    }\n  }\n\n  // set scope id attribute for scoped CSS.\n  // this is implemented as a special case to avoid the overhead\n  // of going through the normal attribute patching process.\n  function setScope (vnode) {\n    var i;\n    if (isDef(i = vnode.fnScopeId)) {\n      nodeOps.setStyleScope(vnode.elm, i);\n    } else {\n      var ancestor = vnode;\n      while (ancestor) {\n        if (isDef(i = ancestor.context) && isDef(i = i.$options._scopeId)) {\n          nodeOps.setStyleScope(vnode.elm, i);\n        }\n        ancestor = ancestor.parent;\n      }\n    }\n    // for slot content they should also get the scopeId from the host instance.\n    if (isDef(i = activeInstance) &&\n      i !== vnode.context &&\n      i !== vnode.fnContext &&\n      isDef(i = i.$options._scopeId)\n    ) {\n      nodeOps.setStyleScope(vnode.elm, i);\n    }\n  }\n\n  function addVnodes (parentElm, refElm, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n    for (; startIdx <= endIdx; ++startIdx) {\n      createElm(vnodes[startIdx], insertedVnodeQueue, parentElm, refElm, false, vnodes, startIdx);\n    }\n  }\n\n  function invokeDestroyHook (vnode) {\n    var i, j;\n    var data = vnode.data;\n    if (isDef(data)) {\n      if (isDef(i = data.hook) && isDef(i = i.destroy)) { i(vnode); }\n      for (i = 0; i < cbs.destroy.length; ++i) { cbs.destroy[i](vnode); }\n    }\n    if (isDef(i = vnode.children)) {\n      for (j = 0; j < vnode.children.length; ++j) {\n        invokeDestroyHook(vnode.children[j]);\n      }\n    }\n  }\n\n  function removeVnodes (parentElm, vnodes, startIdx, endIdx) {\n    for (; startIdx <= endIdx; ++startIdx) {\n      var ch = vnodes[startIdx];\n      if (isDef(ch)) {\n        if (isDef(ch.tag)) {\n          removeAndInvokeRemoveHook(ch);\n          invokeDestroyHook(ch);\n        } else { // Text node\n          removeNode(ch.elm);\n        }\n      }\n    }\n  }\n\n  function removeAndInvokeRemoveHook (vnode, rm) {\n    if (isDef(rm) || isDef(vnode.data)) {\n      var i;\n      var listeners = cbs.remove.length + 1;\n      if (isDef(rm)) {\n        // we have a recursively passed down rm callback\n        // increase the listeners count\n        rm.listeners += listeners;\n      } else {\n        // directly removing\n        rm = createRmCb(vnode.elm, listeners);\n      }\n      // recursively invoke hooks on child component root node\n      if (isDef(i = vnode.componentInstance) && isDef(i = i._vnode) && isDef(i.data)) {\n        removeAndInvokeRemoveHook(i, rm);\n      }\n      for (i = 0; i < cbs.remove.length; ++i) {\n        cbs.remove[i](vnode, rm);\n      }\n      if (isDef(i = vnode.data.hook) && isDef(i = i.remove)) {\n        i(vnode, rm);\n      } else {\n        rm();\n      }\n    } else {\n      removeNode(vnode.elm);\n    }\n  }\n\n  function updateChildren (parentElm, oldCh, newCh, insertedVnodeQueue, removeOnly) {\n    var oldStartIdx = 0;\n    var newStartIdx = 0;\n    var oldEndIdx = oldCh.length - 1;\n    var oldStartVnode = oldCh[0];\n    var oldEndVnode = oldCh[oldEndIdx];\n    var newEndIdx = newCh.length - 1;\n    var newStartVnode = newCh[0];\n    var newEndVnode = newCh[newEndIdx];\n    var oldKeyToIdx, idxInOld, vnodeToMove, refElm;\n\n    // removeOnly is a special flag used only by <transition-group>\n    // to ensure removed elements stay in correct relative positions\n    // during leaving transitions\n    var canMove = !removeOnly;\n\n    if (process.env.NODE_ENV !== 'production') {\n      checkDuplicateKeys(newCh);\n    }\n\n    while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n      if (isUndef(oldStartVnode)) {\n        oldStartVnode = oldCh[++oldStartIdx]; // Vnode has been moved left\n      } else if (isUndef(oldEndVnode)) {\n        oldEndVnode = oldCh[--oldEndIdx];\n      } else if (sameVnode(oldStartVnode, newStartVnode)) {\n        patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n        oldStartVnode = oldCh[++oldStartIdx];\n        newStartVnode = newCh[++newStartIdx];\n      } else if (sameVnode(oldEndVnode, newEndVnode)) {\n        patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx);\n        oldEndVnode = oldCh[--oldEndIdx];\n        newEndVnode = newCh[--newEndIdx];\n      } else if (sameVnode(oldStartVnode, newEndVnode)) { // Vnode moved right\n        patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx);\n        canMove && nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm));\n        oldStartVnode = oldCh[++oldStartIdx];\n        newEndVnode = newCh[--newEndIdx];\n      } else if (sameVnode(oldEndVnode, newStartVnode)) { // Vnode moved left\n        patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n        canMove && nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);\n        oldEndVnode = oldCh[--oldEndIdx];\n        newStartVnode = newCh[++newStartIdx];\n      } else {\n        if (isUndef(oldKeyToIdx)) { oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx); }\n        idxInOld = isDef(newStartVnode.key)\n          ? oldKeyToIdx[newStartVnode.key]\n          : findIdxInOld(newStartVnode, oldCh, oldStartIdx, oldEndIdx);\n        if (isUndef(idxInOld)) { // New element\n          createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, false, newCh, newStartIdx);\n        } else {\n          vnodeToMove = oldCh[idxInOld];\n          if (sameVnode(vnodeToMove, newStartVnode)) {\n            patchVnode(vnodeToMove, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n            oldCh[idxInOld] = undefined;\n            canMove && nodeOps.insertBefore(parentElm, vnodeToMove.elm, oldStartVnode.elm);\n          } else {\n            // same key but different element. treat as new element\n            createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, false, newCh, newStartIdx);\n          }\n        }\n        newStartVnode = newCh[++newStartIdx];\n      }\n    }\n    if (oldStartIdx > oldEndIdx) {\n      refElm = isUndef(newCh[newEndIdx + 1]) ? null : newCh[newEndIdx + 1].elm;\n      addVnodes(parentElm, refElm, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n    } else if (newStartIdx > newEndIdx) {\n      removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\n    }\n  }\n\n  function checkDuplicateKeys (children) {\n    var seenKeys = {};\n    for (var i = 0; i < children.length; i++) {\n      var vnode = children[i];\n      var key = vnode.key;\n      if (isDef(key)) {\n        if (seenKeys[key]) {\n          warn(\n            (\"Duplicate keys detected: '\" + key + \"'. This may cause an update error.\"),\n            vnode.context\n          );\n        } else {\n          seenKeys[key] = true;\n        }\n      }\n    }\n  }\n\n  function findIdxInOld (node, oldCh, start, end) {\n    for (var i = start; i < end; i++) {\n      var c = oldCh[i];\n      if (isDef(c) && sameVnode(node, c)) { return i }\n    }\n  }\n\n  function patchVnode (\n    oldVnode,\n    vnode,\n    insertedVnodeQueue,\n    ownerArray,\n    index,\n    removeOnly\n  ) {\n    if (oldVnode === vnode) {\n      return\n    }\n\n    if (isDef(vnode.elm) && isDef(ownerArray)) {\n      // clone reused vnode\n      vnode = ownerArray[index] = cloneVNode(vnode);\n    }\n\n    var elm = vnode.elm = oldVnode.elm;\n\n    if (isTrue(oldVnode.isAsyncPlaceholder)) {\n      if (isDef(vnode.asyncFactory.resolved)) {\n        hydrate(oldVnode.elm, vnode, insertedVnodeQueue);\n      } else {\n        vnode.isAsyncPlaceholder = true;\n      }\n      return\n    }\n\n    // reuse element for static trees.\n    // note we only do this if the vnode is cloned -\n    // if the new node is not cloned it means the render functions have been\n    // reset by the hot-reload-api and we need to do a proper re-render.\n    if (isTrue(vnode.isStatic) &&\n      isTrue(oldVnode.isStatic) &&\n      vnode.key === oldVnode.key &&\n      (isTrue(vnode.isCloned) || isTrue(vnode.isOnce))\n    ) {\n      vnode.componentInstance = oldVnode.componentInstance;\n      return\n    }\n\n    var i;\n    var data = vnode.data;\n    if (isDef(data) && isDef(i = data.hook) && isDef(i = i.prepatch)) {\n      i(oldVnode, vnode);\n    }\n\n    var oldCh = oldVnode.children;\n    var ch = vnode.children;\n    if (isDef(data) && isPatchable(vnode)) {\n      for (i = 0; i < cbs.update.length; ++i) { cbs.update[i](oldVnode, vnode); }\n      if (isDef(i = data.hook) && isDef(i = i.update)) { i(oldVnode, vnode); }\n    }\n    if (isUndef(vnode.text)) {\n      if (isDef(oldCh) && isDef(ch)) {\n        if (oldCh !== ch) { updateChildren(elm, oldCh, ch, insertedVnodeQueue, removeOnly); }\n      } else if (isDef(ch)) {\n        if (process.env.NODE_ENV !== 'production') {\n          checkDuplicateKeys(ch);\n        }\n        if (isDef(oldVnode.text)) { nodeOps.setTextContent(elm, ''); }\n        addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n      } else if (isDef(oldCh)) {\n        removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n      } else if (isDef(oldVnode.text)) {\n        nodeOps.setTextContent(elm, '');\n      }\n    } else if (oldVnode.text !== vnode.text) {\n      nodeOps.setTextContent(elm, vnode.text);\n    }\n    if (isDef(data)) {\n      if (isDef(i = data.hook) && isDef(i = i.postpatch)) { i(oldVnode, vnode); }\n    }\n  }\n\n  function invokeInsertHook (vnode, queue, initial) {\n    // delay insert hooks for component root nodes, invoke them after the\n    // element is really inserted\n    if (isTrue(initial) && isDef(vnode.parent)) {\n      vnode.parent.data.pendingInsert = queue;\n    } else {\n      for (var i = 0; i < queue.length; ++i) {\n        queue[i].data.hook.insert(queue[i]);\n      }\n    }\n  }\n\n  var hydrationBailed = false;\n  // list of modules that can skip create hook during hydration because they\n  // are already rendered on the client or has no need for initialization\n  // Note: style is excluded because it relies on initial clone for future\n  // deep updates (#7063).\n  var isRenderedModule = makeMap('attrs,class,staticClass,staticStyle,key');\n\n  // Note: this is a browser-only function so we can assume elms are DOM nodes.\n  function hydrate (elm, vnode, insertedVnodeQueue, inVPre) {\n    var i;\n    var tag = vnode.tag;\n    var data = vnode.data;\n    var children = vnode.children;\n    inVPre = inVPre || (data && data.pre);\n    vnode.elm = elm;\n\n    if (isTrue(vnode.isComment) && isDef(vnode.asyncFactory)) {\n      vnode.isAsyncPlaceholder = true;\n      return true\n    }\n    // assert node match\n    if (process.env.NODE_ENV !== 'production') {\n      if (!assertNodeMatch(elm, vnode, inVPre)) {\n        return false\n      }\n    }\n    if (isDef(data)) {\n      if (isDef(i = data.hook) && isDef(i = i.init)) { i(vnode, true /* hydrating */); }\n      if (isDef(i = vnode.componentInstance)) {\n        // child component. it should have hydrated its own tree.\n        initComponent(vnode, insertedVnodeQueue);\n        return true\n      }\n    }\n    if (isDef(tag)) {\n      if (isDef(children)) {\n        // empty element, allow client to pick up and populate children\n        if (!elm.hasChildNodes()) {\n          createChildren(vnode, children, insertedVnodeQueue);\n        } else {\n          // v-html and domProps: innerHTML\n          if (isDef(i = data) && isDef(i = i.domProps) && isDef(i = i.innerHTML)) {\n            if (i !== elm.innerHTML) {\n              /* istanbul ignore if */\n              if (process.env.NODE_ENV !== 'production' &&\n                typeof console !== 'undefined' &&\n                !hydrationBailed\n              ) {\n                hydrationBailed = true;\n                console.warn('Parent: ', elm);\n                console.warn('server innerHTML: ', i);\n                console.warn('client innerHTML: ', elm.innerHTML);\n              }\n              return false\n            }\n          } else {\n            // iterate and compare children lists\n            var childrenMatch = true;\n            var childNode = elm.firstChild;\n            for (var i$1 = 0; i$1 < children.length; i$1++) {\n              if (!childNode || !hydrate(childNode, children[i$1], insertedVnodeQueue, inVPre)) {\n                childrenMatch = false;\n                break\n              }\n              childNode = childNode.nextSibling;\n            }\n            // if childNode is not null, it means the actual childNodes list is\n            // longer than the virtual children list.\n            if (!childrenMatch || childNode) {\n              /* istanbul ignore if */\n              if (process.env.NODE_ENV !== 'production' &&\n                typeof console !== 'undefined' &&\n                !hydrationBailed\n              ) {\n                hydrationBailed = true;\n                console.warn('Parent: ', elm);\n                console.warn('Mismatching childNodes vs. VNodes: ', elm.childNodes, children);\n              }\n              return false\n            }\n          }\n        }\n      }\n      if (isDef(data)) {\n        var fullInvoke = false;\n        for (var key in data) {\n          if (!isRenderedModule(key)) {\n            fullInvoke = true;\n            invokeCreateHooks(vnode, insertedVnodeQueue);\n            break\n          }\n        }\n        if (!fullInvoke && data['class']) {\n          // ensure collecting deps for deep class bindings for future updates\n          traverse(data['class']);\n        }\n      }\n    } else if (elm.data !== vnode.text) {\n      elm.data = vnode.text;\n    }\n    return true\n  }\n\n  function assertNodeMatch (node, vnode, inVPre) {\n    if (isDef(vnode.tag)) {\n      return vnode.tag.indexOf('vue-component') === 0 || (\n        !isUnknownElement$$1(vnode, inVPre) &&\n        vnode.tag.toLowerCase() === (node.tagName && node.tagName.toLowerCase())\n      )\n    } else {\n      return node.nodeType === (vnode.isComment ? 8 : 3)\n    }\n  }\n\n  return function patch (oldVnode, vnode, hydrating, removeOnly) {\n    if (isUndef(vnode)) {\n      if (isDef(oldVnode)) { invokeDestroyHook(oldVnode); }\n      return\n    }\n\n    var isInitialPatch = false;\n    var insertedVnodeQueue = [];\n\n    if (isUndef(oldVnode)) {\n      // empty mount (likely as component), create new root element\n      isInitialPatch = true;\n      createElm(vnode, insertedVnodeQueue);\n    } else {\n      var isRealElement = isDef(oldVnode.nodeType);\n      if (!isRealElement && sameVnode(oldVnode, vnode)) {\n        // patch existing root node\n        patchVnode(oldVnode, vnode, insertedVnodeQueue, null, null, removeOnly);\n      } else {\n        if (isRealElement) {\n          // mounting to a real element\n          // check if this is server-rendered content and if we can perform\n          // a successful hydration.\n          if (oldVnode.nodeType === 1 && oldVnode.hasAttribute(SSR_ATTR)) {\n            oldVnode.removeAttribute(SSR_ATTR);\n            hydrating = true;\n          }\n          if (isTrue(hydrating)) {\n            if (hydrate(oldVnode, vnode, insertedVnodeQueue)) {\n              invokeInsertHook(vnode, insertedVnodeQueue, true);\n              return oldVnode\n            } else if (process.env.NODE_ENV !== 'production') {\n              warn(\n                'The client-side rendered virtual DOM tree is not matching ' +\n                'server-rendered content. This is likely caused by incorrect ' +\n                'HTML markup, for example nesting block-level elements inside ' +\n                '<p>, or missing <tbody>. Bailing hydration and performing ' +\n                'full client-side render.'\n              );\n            }\n          }\n          // either not server-rendered, or hydration failed.\n          // create an empty node and replace it\n          oldVnode = emptyNodeAt(oldVnode);\n        }\n\n        // replacing existing element\n        var oldElm = oldVnode.elm;\n        var parentElm = nodeOps.parentNode(oldElm);\n\n        // create new node\n        createElm(\n          vnode,\n          insertedVnodeQueue,\n          // extremely rare edge case: do not insert if old element is in a\n          // leaving transition. Only happens when combining transition +\n          // keep-alive + HOCs. (#4590)\n          oldElm._leaveCb ? null : parentElm,\n          nodeOps.nextSibling(oldElm)\n        );\n\n        // update parent placeholder node element, recursively\n        if (isDef(vnode.parent)) {\n          var ancestor = vnode.parent;\n          var patchable = isPatchable(vnode);\n          while (ancestor) {\n            for (var i = 0; i < cbs.destroy.length; ++i) {\n              cbs.destroy[i](ancestor);\n            }\n            ancestor.elm = vnode.elm;\n            if (patchable) {\n              for (var i$1 = 0; i$1 < cbs.create.length; ++i$1) {\n                cbs.create[i$1](emptyNode, ancestor);\n              }\n              // #6513\n              // invoke insert hooks that may have been merged by create hooks.\n              // e.g. for directives that uses the \"inserted\" hook.\n              var insert = ancestor.data.hook.insert;\n              if (insert.merged) {\n                // start at index 1 to avoid re-invoking component mounted hook\n                for (var i$2 = 1; i$2 < insert.fns.length; i$2++) {\n                  insert.fns[i$2]();\n                }\n              }\n            } else {\n              registerRef(ancestor);\n            }\n            ancestor = ancestor.parent;\n          }\n        }\n\n        // destroy old node\n        if (isDef(parentElm)) {\n          removeVnodes(parentElm, [oldVnode], 0, 0);\n        } else if (isDef(oldVnode.tag)) {\n          invokeDestroyHook(oldVnode);\n        }\n      }\n    }\n\n    invokeInsertHook(vnode, insertedVnodeQueue, isInitialPatch);\n    return vnode.elm\n  }\n}\n\n/*  */\n\nvar directives = {\n  create: updateDirectives,\n  update: updateDirectives,\n  destroy: function unbindDirectives (vnode) {\n    updateDirectives(vnode, emptyNode);\n  }\n};\n\nfunction updateDirectives (oldVnode, vnode) {\n  if (oldVnode.data.directives || vnode.data.directives) {\n    _update(oldVnode, vnode);\n  }\n}\n\nfunction _update (oldVnode, vnode) {\n  var isCreate = oldVnode === emptyNode;\n  var isDestroy = vnode === emptyNode;\n  var oldDirs = normalizeDirectives$1(oldVnode.data.directives, oldVnode.context);\n  var newDirs = normalizeDirectives$1(vnode.data.directives, vnode.context);\n\n  var dirsWithInsert = [];\n  var dirsWithPostpatch = [];\n\n  var key, oldDir, dir;\n  for (key in newDirs) {\n    oldDir = oldDirs[key];\n    dir = newDirs[key];\n    if (!oldDir) {\n      // new directive, bind\n      callHook$1(dir, 'bind', vnode, oldVnode);\n      if (dir.def && dir.def.inserted) {\n        dirsWithInsert.push(dir);\n      }\n    } else {\n      // existing directive, update\n      dir.oldValue = oldDir.value;\n      dir.oldArg = oldDir.arg;\n      callHook$1(dir, 'update', vnode, oldVnode);\n      if (dir.def && dir.def.componentUpdated) {\n        dirsWithPostpatch.push(dir);\n      }\n    }\n  }\n\n  if (dirsWithInsert.length) {\n    var callInsert = function () {\n      for (var i = 0; i < dirsWithInsert.length; i++) {\n        callHook$1(dirsWithInsert[i], 'inserted', vnode, oldVnode);\n      }\n    };\n    if (isCreate) {\n      mergeVNodeHook(vnode, 'insert', callInsert);\n    } else {\n      callInsert();\n    }\n  }\n\n  if (dirsWithPostpatch.length) {\n    mergeVNodeHook(vnode, 'postpatch', function () {\n      for (var i = 0; i < dirsWithPostpatch.length; i++) {\n        callHook$1(dirsWithPostpatch[i], 'componentUpdated', vnode, oldVnode);\n      }\n    });\n  }\n\n  if (!isCreate) {\n    for (key in oldDirs) {\n      if (!newDirs[key]) {\n        // no longer present, unbind\n        callHook$1(oldDirs[key], 'unbind', oldVnode, oldVnode, isDestroy);\n      }\n    }\n  }\n}\n\nvar emptyModifiers = Object.create(null);\n\nfunction normalizeDirectives$1 (\n  dirs,\n  vm\n) {\n  var res = Object.create(null);\n  if (!dirs) {\n    // $flow-disable-line\n    return res\n  }\n  var i, dir;\n  for (i = 0; i < dirs.length; i++) {\n    dir = dirs[i];\n    if (!dir.modifiers) {\n      // $flow-disable-line\n      dir.modifiers = emptyModifiers;\n    }\n    res[getRawDirName(dir)] = dir;\n    dir.def = resolveAsset(vm.$options, 'directives', dir.name, true);\n  }\n  // $flow-disable-line\n  return res\n}\n\nfunction getRawDirName (dir) {\n  return dir.rawName || ((dir.name) + \".\" + (Object.keys(dir.modifiers || {}).join('.')))\n}\n\nfunction callHook$1 (dir, hook, vnode, oldVnode, isDestroy) {\n  var fn = dir.def && dir.def[hook];\n  if (fn) {\n    try {\n      fn(vnode.elm, dir, vnode, oldVnode, isDestroy);\n    } catch (e) {\n      handleError(e, vnode.context, (\"directive \" + (dir.name) + \" \" + hook + \" hook\"));\n    }\n  }\n}\n\nvar baseModules = [\n  ref,\n  directives\n];\n\n/*  */\n\nfunction updateAttrs (oldVnode, vnode) {\n  var opts = vnode.componentOptions;\n  if (isDef(opts) && opts.Ctor.options.inheritAttrs === false) {\n    return\n  }\n  if (isUndef(oldVnode.data.attrs) && isUndef(vnode.data.attrs)) {\n    return\n  }\n  var key, cur, old;\n  var elm = vnode.elm;\n  var oldAttrs = oldVnode.data.attrs || {};\n  var attrs = vnode.data.attrs || {};\n  // clone observed objects, as the user probably wants to mutate it\n  if (isDef(attrs.__ob__)) {\n    attrs = vnode.data.attrs = extend({}, attrs);\n  }\n\n  for (key in attrs) {\n    cur = attrs[key];\n    old = oldAttrs[key];\n    if (old !== cur) {\n      setAttr(elm, key, cur);\n    }\n  }\n  // #4391: in IE9, setting type can reset value for input[type=radio]\n  // #6666: IE/Edge forces progress value down to 1 before setting a max\n  /* istanbul ignore if */\n  if ((isIE || isEdge) && attrs.value !== oldAttrs.value) {\n    setAttr(elm, 'value', attrs.value);\n  }\n  for (key in oldAttrs) {\n    if (isUndef(attrs[key])) {\n      if (isXlink(key)) {\n        elm.removeAttributeNS(xlinkNS, getXlinkProp(key));\n      } else if (!isEnumeratedAttr(key)) {\n        elm.removeAttribute(key);\n      }\n    }\n  }\n}\n\nfunction setAttr (el, key, value) {\n  if (el.tagName.indexOf('-') > -1) {\n    baseSetAttr(el, key, value);\n  } else if (isBooleanAttr(key)) {\n    // set attribute for blank value\n    // e.g. <option disabled>Select one</option>\n    if (isFalsyAttrValue(value)) {\n      el.removeAttribute(key);\n    } else {\n      // technically allowfullscreen is a boolean attribute for <iframe>,\n      // but Flash expects a value of \"true\" when used on <embed> tag\n      value = key === 'allowfullscreen' && el.tagName === 'EMBED'\n        ? 'true'\n        : key;\n      el.setAttribute(key, value);\n    }\n  } else if (isEnumeratedAttr(key)) {\n    el.setAttribute(key, convertEnumeratedValue(key, value));\n  } else if (isXlink(key)) {\n    if (isFalsyAttrValue(value)) {\n      el.removeAttributeNS(xlinkNS, getXlinkProp(key));\n    } else {\n      el.setAttributeNS(xlinkNS, key, value);\n    }\n  } else {\n    baseSetAttr(el, key, value);\n  }\n}\n\nfunction baseSetAttr (el, key, value) {\n  if (isFalsyAttrValue(value)) {\n    el.removeAttribute(key);\n  } else {\n    // #7138: IE10 & 11 fires input event when setting placeholder on\n    // <textarea>... block the first input event and remove the blocker\n    // immediately.\n    /* istanbul ignore if */\n    if (\n      isIE && !isIE9 &&\n      el.tagName === 'TEXTAREA' &&\n      key === 'placeholder' && value !== '' && !el.__ieph\n    ) {\n      var blocker = function (e) {\n        e.stopImmediatePropagation();\n        el.removeEventListener('input', blocker);\n      };\n      el.addEventListener('input', blocker);\n      // $flow-disable-line\n      el.__ieph = true; /* IE placeholder patched */\n    }\n    el.setAttribute(key, value);\n  }\n}\n\nvar attrs = {\n  create: updateAttrs,\n  update: updateAttrs\n};\n\n/*  */\n\nfunction updateClass (oldVnode, vnode) {\n  var el = vnode.elm;\n  var data = vnode.data;\n  var oldData = oldVnode.data;\n  if (\n    isUndef(data.staticClass) &&\n    isUndef(data.class) && (\n      isUndef(oldData) || (\n        isUndef(oldData.staticClass) &&\n        isUndef(oldData.class)\n      )\n    )\n  ) {\n    return\n  }\n\n  var cls = genClassForVnode(vnode);\n\n  // handle transition classes\n  var transitionClass = el._transitionClasses;\n  if (isDef(transitionClass)) {\n    cls = concat(cls, stringifyClass(transitionClass));\n  }\n\n  // set the class\n  if (cls !== el._prevClass) {\n    el.setAttribute('class', cls);\n    el._prevClass = cls;\n  }\n}\n\nvar klass = {\n  create: updateClass,\n  update: updateClass\n};\n\n/*  */\n\n/*  */\n\n/*  */\n\n/*  */\n\n// in some cases, the event used has to be determined at runtime\n// so we used some reserved tokens during compile.\nvar RANGE_TOKEN = '__r';\nvar CHECKBOX_RADIO_TOKEN = '__c';\n\n/*  */\n\n// normalize v-model event tokens that can only be determined at runtime.\n// it's important to place the event as the first in the array because\n// the whole point is ensuring the v-model callback gets called before\n// user-attached handlers.\nfunction normalizeEvents (on) {\n  /* istanbul ignore if */\n  if (isDef(on[RANGE_TOKEN])) {\n    // IE input[type=range] only supports `change` event\n    var event = isIE ? 'change' : 'input';\n    on[event] = [].concat(on[RANGE_TOKEN], on[event] || []);\n    delete on[RANGE_TOKEN];\n  }\n  // This was originally intended to fix #4521 but no longer necessary\n  // after 2.5. Keeping it for backwards compat with generated code from < 2.4\n  /* istanbul ignore if */\n  if (isDef(on[CHECKBOX_RADIO_TOKEN])) {\n    on.change = [].concat(on[CHECKBOX_RADIO_TOKEN], on.change || []);\n    delete on[CHECKBOX_RADIO_TOKEN];\n  }\n}\n\nvar target$1;\n\nfunction createOnceHandler$1 (event, handler, capture) {\n  var _target = target$1; // save current target element in closure\n  return function onceHandler () {\n    var res = handler.apply(null, arguments);\n    if (res !== null) {\n      remove$2(event, onceHandler, capture, _target);\n    }\n  }\n}\n\n// #9446: Firefox <= 53 (in particular, ESR 52) has incorrect Event.timeStamp\n// implementation and does not fire microtasks in between event propagation, so\n// safe to exclude.\nvar useMicrotaskFix = isUsingMicroTask && !(isFF && Number(isFF[1]) <= 53);\n\nfunction add$1 (\n  name,\n  handler,\n  capture,\n  passive\n) {\n  // async edge case #6566: inner click event triggers patch, event handler\n  // attached to outer element during patch, and triggered again. This\n  // happens because browsers fire microtask ticks between event propagation.\n  // the solution is simple: we save the timestamp when a handler is attached,\n  // and the handler would only fire if the event passed to it was fired\n  // AFTER it was attached.\n  if (useMicrotaskFix) {\n    var attachedTimestamp = currentFlushTimestamp;\n    var original = handler;\n    handler = original._wrapper = function (e) {\n      if (\n        // no bubbling, should always fire.\n        // this is just a safety net in case event.timeStamp is unreliable in\n        // certain weird environments...\n        e.target === e.currentTarget ||\n        // event is fired after handler attachment\n        e.timeStamp >= attachedTimestamp ||\n        // bail for environments that have buggy event.timeStamp implementations\n        // #9462 iOS 9 bug: event.timeStamp is 0 after history.pushState\n        // #9681 QtWebEngine event.timeStamp is negative value\n        e.timeStamp <= 0 ||\n        // #9448 bail if event is fired in another document in a multi-page\n        // electron/nw.js app, since event.timeStamp will be using a different\n        // starting reference\n        e.target.ownerDocument !== document\n      ) {\n        return original.apply(this, arguments)\n      }\n    };\n  }\n  target$1.addEventListener(\n    name,\n    handler,\n    supportsPassive\n      ? { capture: capture, passive: passive }\n      : capture\n  );\n}\n\nfunction remove$2 (\n  name,\n  handler,\n  capture,\n  _target\n) {\n  (_target || target$1).removeEventListener(\n    name,\n    handler._wrapper || handler,\n    capture\n  );\n}\n\nfunction updateDOMListeners (oldVnode, vnode) {\n  if (isUndef(oldVnode.data.on) && isUndef(vnode.data.on)) {\n    return\n  }\n  var on = vnode.data.on || {};\n  var oldOn = oldVnode.data.on || {};\n  target$1 = vnode.elm;\n  normalizeEvents(on);\n  updateListeners(on, oldOn, add$1, remove$2, createOnceHandler$1, vnode.context);\n  target$1 = undefined;\n}\n\nvar events = {\n  create: updateDOMListeners,\n  update: updateDOMListeners\n};\n\n/*  */\n\nvar svgContainer;\n\nfunction updateDOMProps (oldVnode, vnode) {\n  if (isUndef(oldVnode.data.domProps) && isUndef(vnode.data.domProps)) {\n    return\n  }\n  var key, cur;\n  var elm = vnode.elm;\n  var oldProps = oldVnode.data.domProps || {};\n  var props = vnode.data.domProps || {};\n  // clone observed objects, as the user probably wants to mutate it\n  if (isDef(props.__ob__)) {\n    props = vnode.data.domProps = extend({}, props);\n  }\n\n  for (key in oldProps) {\n    if (!(key in props)) {\n      elm[key] = '';\n    }\n  }\n\n  for (key in props) {\n    cur = props[key];\n    // ignore children if the node has textContent or innerHTML,\n    // as these will throw away existing DOM nodes and cause removal errors\n    // on subsequent patches (#3360)\n    if (key === 'textContent' || key === 'innerHTML') {\n      if (vnode.children) { vnode.children.length = 0; }\n      if (cur === oldProps[key]) { continue }\n      // #6601 work around Chrome version <= 55 bug where single textNode\n      // replaced by innerHTML/textContent retains its parentNode property\n      if (elm.childNodes.length === 1) {\n        elm.removeChild(elm.childNodes[0]);\n      }\n    }\n\n    if (key === 'value' && elm.tagName !== 'PROGRESS') {\n      // store value as _value as well since\n      // non-string values will be stringified\n      elm._value = cur;\n      // avoid resetting cursor position when value is the same\n      var strCur = isUndef(cur) ? '' : String(cur);\n      if (shouldUpdateValue(elm, strCur)) {\n        elm.value = strCur;\n      }\n    } else if (key === 'innerHTML' && isSVG(elm.tagName) && isUndef(elm.innerHTML)) {\n      // IE doesn't support innerHTML for SVG elements\n      svgContainer = svgContainer || document.createElement('div');\n      svgContainer.innerHTML = \"<svg>\" + cur + \"</svg>\";\n      var svg = svgContainer.firstChild;\n      while (elm.firstChild) {\n        elm.removeChild(elm.firstChild);\n      }\n      while (svg.firstChild) {\n        elm.appendChild(svg.firstChild);\n      }\n    } else if (\n      // skip the update if old and new VDOM state is the same.\n      // `value` is handled separately because the DOM value may be temporarily\n      // out of sync with VDOM state due to focus, composition and modifiers.\n      // This  #4521 by skipping the unnecesarry `checked` update.\n      cur !== oldProps[key]\n    ) {\n      // some property updates can throw\n      // e.g. `value` on <progress> w/ non-finite value\n      try {\n        elm[key] = cur;\n      } catch (e) {}\n    }\n  }\n}\n\n// check platforms/web/util/attrs.js acceptValue\n\n\nfunction shouldUpdateValue (elm, checkVal) {\n  return (!elm.composing && (\n    elm.tagName === 'OPTION' ||\n    isNotInFocusAndDirty(elm, checkVal) ||\n    isDirtyWithModifiers(elm, checkVal)\n  ))\n}\n\nfunction isNotInFocusAndDirty (elm, checkVal) {\n  // return true when textbox (.number and .trim) loses focus and its value is\n  // not equal to the updated value\n  var notInFocus = true;\n  // #6157\n  // work around IE bug when accessing document.activeElement in an iframe\n  try { notInFocus = document.activeElement !== elm; } catch (e) {}\n  return notInFocus && elm.value !== checkVal\n}\n\nfunction isDirtyWithModifiers (elm, newVal) {\n  var value = elm.value;\n  var modifiers = elm._vModifiers; // injected by v-model runtime\n  if (isDef(modifiers)) {\n    if (modifiers.number) {\n      return toNumber(value) !== toNumber(newVal)\n    }\n    if (modifiers.trim) {\n      return value.trim() !== newVal.trim()\n    }\n  }\n  return value !== newVal\n}\n\nvar domProps = {\n  create: updateDOMProps,\n  update: updateDOMProps\n};\n\n/*  */\n\nvar parseStyleText = cached(function (cssText) {\n  var res = {};\n  var listDelimiter = /;(?![^(]*\\))/g;\n  var propertyDelimiter = /:(.+)/;\n  cssText.split(listDelimiter).forEach(function (item) {\n    if (item) {\n      var tmp = item.split(propertyDelimiter);\n      tmp.length > 1 && (res[tmp[0].trim()] = tmp[1].trim());\n    }\n  });\n  return res\n});\n\n// merge static and dynamic style data on the same vnode\nfunction normalizeStyleData (data) {\n  var style = normalizeStyleBinding(data.style);\n  // static style is pre-processed into an object during compilation\n  // and is always a fresh object, so it's safe to merge into it\n  return data.staticStyle\n    ? extend(data.staticStyle, style)\n    : style\n}\n\n// normalize possible array / string values into Object\nfunction normalizeStyleBinding (bindingStyle) {\n  if (Array.isArray(bindingStyle)) {\n    return toObject(bindingStyle)\n  }\n  if (typeof bindingStyle === 'string') {\n    return parseStyleText(bindingStyle)\n  }\n  return bindingStyle\n}\n\n/**\n * parent component style should be after child's\n * so that parent component's style could override it\n */\nfunction getStyle (vnode, checkChild) {\n  var res = {};\n  var styleData;\n\n  if (checkChild) {\n    var childNode = vnode;\n    while (childNode.componentInstance) {\n      childNode = childNode.componentInstance._vnode;\n      if (\n        childNode && childNode.data &&\n        (styleData = normalizeStyleData(childNode.data))\n      ) {\n        extend(res, styleData);\n      }\n    }\n  }\n\n  if ((styleData = normalizeStyleData(vnode.data))) {\n    extend(res, styleData);\n  }\n\n  var parentNode = vnode;\n  while ((parentNode = parentNode.parent)) {\n    if (parentNode.data && (styleData = normalizeStyleData(parentNode.data))) {\n      extend(res, styleData);\n    }\n  }\n  return res\n}\n\n/*  */\n\nvar cssVarRE = /^--/;\nvar importantRE = /\\s*!important$/;\nvar setProp = function (el, name, val) {\n  /* istanbul ignore if */\n  if (cssVarRE.test(name)) {\n    el.style.setProperty(name, val);\n  } else if (importantRE.test(val)) {\n    el.style.setProperty(hyphenate(name), val.replace(importantRE, ''), 'important');\n  } else {\n    var normalizedName = normalize(name);\n    if (Array.isArray(val)) {\n      // Support values array created by autoprefixer, e.g.\n      // {display: [\"-webkit-box\", \"-ms-flexbox\", \"flex\"]}\n      // Set them one by one, and the browser will only set those it can recognize\n      for (var i = 0, len = val.length; i < len; i++) {\n        el.style[normalizedName] = val[i];\n      }\n    } else {\n      el.style[normalizedName] = val;\n    }\n  }\n};\n\nvar vendorNames = ['Webkit', 'Moz', 'ms'];\n\nvar emptyStyle;\nvar normalize = cached(function (prop) {\n  emptyStyle = emptyStyle || document.createElement('div').style;\n  prop = camelize(prop);\n  if (prop !== 'filter' && (prop in emptyStyle)) {\n    return prop\n  }\n  var capName = prop.charAt(0).toUpperCase() + prop.slice(1);\n  for (var i = 0; i < vendorNames.length; i++) {\n    var name = vendorNames[i] + capName;\n    if (name in emptyStyle) {\n      return name\n    }\n  }\n});\n\nfunction updateStyle (oldVnode, vnode) {\n  var data = vnode.data;\n  var oldData = oldVnode.data;\n\n  if (isUndef(data.staticStyle) && isUndef(data.style) &&\n    isUndef(oldData.staticStyle) && isUndef(oldData.style)\n  ) {\n    return\n  }\n\n  var cur, name;\n  var el = vnode.elm;\n  var oldStaticStyle = oldData.staticStyle;\n  var oldStyleBinding = oldData.normalizedStyle || oldData.style || {};\n\n  // if static style exists, stylebinding already merged into it when doing normalizeStyleData\n  var oldStyle = oldStaticStyle || oldStyleBinding;\n\n  var style = normalizeStyleBinding(vnode.data.style) || {};\n\n  // store normalized style under a different key for next diff\n  // make sure to clone it if it's reactive, since the user likely wants\n  // to mutate it.\n  vnode.data.normalizedStyle = isDef(style.__ob__)\n    ? extend({}, style)\n    : style;\n\n  var newStyle = getStyle(vnode, true);\n\n  for (name in oldStyle) {\n    if (isUndef(newStyle[name])) {\n      setProp(el, name, '');\n    }\n  }\n  for (name in newStyle) {\n    cur = newStyle[name];\n    if (cur !== oldStyle[name]) {\n      // ie9 setting to null has no effect, must use empty string\n      setProp(el, name, cur == null ? '' : cur);\n    }\n  }\n}\n\nvar style = {\n  create: updateStyle,\n  update: updateStyle\n};\n\n/*  */\n\nvar whitespaceRE = /\\s+/;\n\n/**\n * Add class with compatibility for SVG since classList is not supported on\n * SVG elements in IE\n */\nfunction addClass (el, cls) {\n  /* istanbul ignore if */\n  if (!cls || !(cls = cls.trim())) {\n    return\n  }\n\n  /* istanbul ignore else */\n  if (el.classList) {\n    if (cls.indexOf(' ') > -1) {\n      cls.split(whitespaceRE).forEach(function (c) { return el.classList.add(c); });\n    } else {\n      el.classList.add(cls);\n    }\n  } else {\n    var cur = \" \" + (el.getAttribute('class') || '') + \" \";\n    if (cur.indexOf(' ' + cls + ' ') < 0) {\n      el.setAttribute('class', (cur + cls).trim());\n    }\n  }\n}\n\n/**\n * Remove class with compatibility for SVG since classList is not supported on\n * SVG elements in IE\n */\nfunction removeClass (el, cls) {\n  /* istanbul ignore if */\n  if (!cls || !(cls = cls.trim())) {\n    return\n  }\n\n  /* istanbul ignore else */\n  if (el.classList) {\n    if (cls.indexOf(' ') > -1) {\n      cls.split(whitespaceRE).forEach(function (c) { return el.classList.remove(c); });\n    } else {\n      el.classList.remove(cls);\n    }\n    if (!el.classList.length) {\n      el.removeAttribute('class');\n    }\n  } else {\n    var cur = \" \" + (el.getAttribute('class') || '') + \" \";\n    var tar = ' ' + cls + ' ';\n    while (cur.indexOf(tar) >= 0) {\n      cur = cur.replace(tar, ' ');\n    }\n    cur = cur.trim();\n    if (cur) {\n      el.setAttribute('class', cur);\n    } else {\n      el.removeAttribute('class');\n    }\n  }\n}\n\n/*  */\n\nfunction resolveTransition (def$$1) {\n  if (!def$$1) {\n    return\n  }\n  /* istanbul ignore else */\n  if (typeof def$$1 === 'object') {\n    var res = {};\n    if (def$$1.css !== false) {\n      extend(res, autoCssTransition(def$$1.name || 'v'));\n    }\n    extend(res, def$$1);\n    return res\n  } else if (typeof def$$1 === 'string') {\n    return autoCssTransition(def$$1)\n  }\n}\n\nvar autoCssTransition = cached(function (name) {\n  return {\n    enterClass: (name + \"-enter\"),\n    enterToClass: (name + \"-enter-to\"),\n    enterActiveClass: (name + \"-enter-active\"),\n    leaveClass: (name + \"-leave\"),\n    leaveToClass: (name + \"-leave-to\"),\n    leaveActiveClass: (name + \"-leave-active\")\n  }\n});\n\nvar hasTransition = inBrowser && !isIE9;\nvar TRANSITION = 'transition';\nvar ANIMATION = 'animation';\n\n// Transition property/event sniffing\nvar transitionProp = 'transition';\nvar transitionEndEvent = 'transitionend';\nvar animationProp = 'animation';\nvar animationEndEvent = 'animationend';\nif (hasTransition) {\n  /* istanbul ignore if */\n  if (window.ontransitionend === undefined &&\n    window.onwebkittransitionend !== undefined\n  ) {\n    transitionProp = 'WebkitTransition';\n    transitionEndEvent = 'webkitTransitionEnd';\n  }\n  if (window.onanimationend === undefined &&\n    window.onwebkitanimationend !== undefined\n  ) {\n    animationProp = 'WebkitAnimation';\n    animationEndEvent = 'webkitAnimationEnd';\n  }\n}\n\n// binding to window is necessary to make hot reload work in IE in strict mode\nvar raf = inBrowser\n  ? window.requestAnimationFrame\n    ? window.requestAnimationFrame.bind(window)\n    : setTimeout\n  : /* istanbul ignore next */ function (fn) { return fn(); };\n\nfunction nextFrame (fn) {\n  raf(function () {\n    raf(fn);\n  });\n}\n\nfunction addTransitionClass (el, cls) {\n  var transitionClasses = el._transitionClasses || (el._transitionClasses = []);\n  if (transitionClasses.indexOf(cls) < 0) {\n    transitionClasses.push(cls);\n    addClass(el, cls);\n  }\n}\n\nfunction removeTransitionClass (el, cls) {\n  if (el._transitionClasses) {\n    remove(el._transitionClasses, cls);\n  }\n  removeClass(el, cls);\n}\n\nfunction whenTransitionEnds (\n  el,\n  expectedType,\n  cb\n) {\n  var ref = getTransitionInfo(el, expectedType);\n  var type = ref.type;\n  var timeout = ref.timeout;\n  var propCount = ref.propCount;\n  if (!type) { return cb() }\n  var event = type === TRANSITION ? transitionEndEvent : animationEndEvent;\n  var ended = 0;\n  var end = function () {\n    el.removeEventListener(event, onEnd);\n    cb();\n  };\n  var onEnd = function (e) {\n    if (e.target === el) {\n      if (++ended >= propCount) {\n        end();\n      }\n    }\n  };\n  setTimeout(function () {\n    if (ended < propCount) {\n      end();\n    }\n  }, timeout + 1);\n  el.addEventListener(event, onEnd);\n}\n\nvar transformRE = /\\b(transform|all)(,|$)/;\n\nfunction getTransitionInfo (el, expectedType) {\n  var styles = window.getComputedStyle(el);\n  // JSDOM may return undefined for transition properties\n  var transitionDelays = (styles[transitionProp + 'Delay'] || '').split(', ');\n  var transitionDurations = (styles[transitionProp + 'Duration'] || '').split(', ');\n  var transitionTimeout = getTimeout(transitionDelays, transitionDurations);\n  var animationDelays = (styles[animationProp + 'Delay'] || '').split(', ');\n  var animationDurations = (styles[animationProp + 'Duration'] || '').split(', ');\n  var animationTimeout = getTimeout(animationDelays, animationDurations);\n\n  var type;\n  var timeout = 0;\n  var propCount = 0;\n  /* istanbul ignore if */\n  if (expectedType === TRANSITION) {\n    if (transitionTimeout > 0) {\n      type = TRANSITION;\n      timeout = transitionTimeout;\n      propCount = transitionDurations.length;\n    }\n  } else if (expectedType === ANIMATION) {\n    if (animationTimeout > 0) {\n      type = ANIMATION;\n      timeout = animationTimeout;\n      propCount = animationDurations.length;\n    }\n  } else {\n    timeout = Math.max(transitionTimeout, animationTimeout);\n    type = timeout > 0\n      ? transitionTimeout > animationTimeout\n        ? TRANSITION\n        : ANIMATION\n      : null;\n    propCount = type\n      ? type === TRANSITION\n        ? transitionDurations.length\n        : animationDurations.length\n      : 0;\n  }\n  var hasTransform =\n    type === TRANSITION &&\n    transformRE.test(styles[transitionProp + 'Property']);\n  return {\n    type: type,\n    timeout: timeout,\n    propCount: propCount,\n    hasTransform: hasTransform\n  }\n}\n\nfunction getTimeout (delays, durations) {\n  /* istanbul ignore next */\n  while (delays.length < durations.length) {\n    delays = delays.concat(delays);\n  }\n\n  return Math.max.apply(null, durations.map(function (d, i) {\n    return toMs(d) + toMs(delays[i])\n  }))\n}\n\n// Old versions of Chromium (below 61.0.3163.100) formats floating pointer numbers\n// in a locale-dependent way, using a comma instead of a dot.\n// If comma is not replaced with a dot, the input will be rounded down (i.e. acting\n// as a floor function) causing unexpected behaviors\nfunction toMs (s) {\n  return Number(s.slice(0, -1).replace(',', '.')) * 1000\n}\n\n/*  */\n\nfunction enter (vnode, toggleDisplay) {\n  var el = vnode.elm;\n\n  // call leave callback now\n  if (isDef(el._leaveCb)) {\n    el._leaveCb.cancelled = true;\n    el._leaveCb();\n  }\n\n  var data = resolveTransition(vnode.data.transition);\n  if (isUndef(data)) {\n    return\n  }\n\n  /* istanbul ignore if */\n  if (isDef(el._enterCb) || el.nodeType !== 1) {\n    return\n  }\n\n  var css = data.css;\n  var type = data.type;\n  var enterClass = data.enterClass;\n  var enterToClass = data.enterToClass;\n  var enterActiveClass = data.enterActiveClass;\n  var appearClass = data.appearClass;\n  var appearToClass = data.appearToClass;\n  var appearActiveClass = data.appearActiveClass;\n  var beforeEnter = data.beforeEnter;\n  var enter = data.enter;\n  var afterEnter = data.afterEnter;\n  var enterCancelled = data.enterCancelled;\n  var beforeAppear = data.beforeAppear;\n  var appear = data.appear;\n  var afterAppear = data.afterAppear;\n  var appearCancelled = data.appearCancelled;\n  var duration = data.duration;\n\n  // activeInstance will always be the <transition> component managing this\n  // transition. One edge case to check is when the <transition> is placed\n  // as the root node of a child component. In that case we need to check\n  // <transition>'s parent for appear check.\n  var context = activeInstance;\n  var transitionNode = activeInstance.$vnode;\n  while (transitionNode && transitionNode.parent) {\n    context = transitionNode.context;\n    transitionNode = transitionNode.parent;\n  }\n\n  var isAppear = !context._isMounted || !vnode.isRootInsert;\n\n  if (isAppear && !appear && appear !== '') {\n    return\n  }\n\n  var startClass = isAppear && appearClass\n    ? appearClass\n    : enterClass;\n  var activeClass = isAppear && appearActiveClass\n    ? appearActiveClass\n    : enterActiveClass;\n  var toClass = isAppear && appearToClass\n    ? appearToClass\n    : enterToClass;\n\n  var beforeEnterHook = isAppear\n    ? (beforeAppear || beforeEnter)\n    : beforeEnter;\n  var enterHook = isAppear\n    ? (typeof appear === 'function' ? appear : enter)\n    : enter;\n  var afterEnterHook = isAppear\n    ? (afterAppear || afterEnter)\n    : afterEnter;\n  var enterCancelledHook = isAppear\n    ? (appearCancelled || enterCancelled)\n    : enterCancelled;\n\n  var explicitEnterDuration = toNumber(\n    isObject(duration)\n      ? duration.enter\n      : duration\n  );\n\n  if (process.env.NODE_ENV !== 'production' && explicitEnterDuration != null) {\n    checkDuration(explicitEnterDuration, 'enter', vnode);\n  }\n\n  var expectsCSS = css !== false && !isIE9;\n  var userWantsControl = getHookArgumentsLength(enterHook);\n\n  var cb = el._enterCb = once(function () {\n    if (expectsCSS) {\n      removeTransitionClass(el, toClass);\n      removeTransitionClass(el, activeClass);\n    }\n    if (cb.cancelled) {\n      if (expectsCSS) {\n        removeTransitionClass(el, startClass);\n      }\n      enterCancelledHook && enterCancelledHook(el);\n    } else {\n      afterEnterHook && afterEnterHook(el);\n    }\n    el._enterCb = null;\n  });\n\n  if (!vnode.data.show) {\n    // remove pending leave element on enter by injecting an insert hook\n    mergeVNodeHook(vnode, 'insert', function () {\n      var parent = el.parentNode;\n      var pendingNode = parent && parent._pending && parent._pending[vnode.key];\n      if (pendingNode &&\n        pendingNode.tag === vnode.tag &&\n        pendingNode.elm._leaveCb\n      ) {\n        pendingNode.elm._leaveCb();\n      }\n      enterHook && enterHook(el, cb);\n    });\n  }\n\n  // start enter transition\n  beforeEnterHook && beforeEnterHook(el);\n  if (expectsCSS) {\n    addTransitionClass(el, startClass);\n    addTransitionClass(el, activeClass);\n    nextFrame(function () {\n      removeTransitionClass(el, startClass);\n      if (!cb.cancelled) {\n        addTransitionClass(el, toClass);\n        if (!userWantsControl) {\n          if (isValidDuration(explicitEnterDuration)) {\n            setTimeout(cb, explicitEnterDuration);\n          } else {\n            whenTransitionEnds(el, type, cb);\n          }\n        }\n      }\n    });\n  }\n\n  if (vnode.data.show) {\n    toggleDisplay && toggleDisplay();\n    enterHook && enterHook(el, cb);\n  }\n\n  if (!expectsCSS && !userWantsControl) {\n    cb();\n  }\n}\n\nfunction leave (vnode, rm) {\n  var el = vnode.elm;\n\n  // call enter callback now\n  if (isDef(el._enterCb)) {\n    el._enterCb.cancelled = true;\n    el._enterCb();\n  }\n\n  var data = resolveTransition(vnode.data.transition);\n  if (isUndef(data) || el.nodeType !== 1) {\n    return rm()\n  }\n\n  /* istanbul ignore if */\n  if (isDef(el._leaveCb)) {\n    return\n  }\n\n  var css = data.css;\n  var type = data.type;\n  var leaveClass = data.leaveClass;\n  var leaveToClass = data.leaveToClass;\n  var leaveActiveClass = data.leaveActiveClass;\n  var beforeLeave = data.beforeLeave;\n  var leave = data.leave;\n  var afterLeave = data.afterLeave;\n  var leaveCancelled = data.leaveCancelled;\n  var delayLeave = data.delayLeave;\n  var duration = data.duration;\n\n  var expectsCSS = css !== false && !isIE9;\n  var userWantsControl = getHookArgumentsLength(leave);\n\n  var explicitLeaveDuration = toNumber(\n    isObject(duration)\n      ? duration.leave\n      : duration\n  );\n\n  if (process.env.NODE_ENV !== 'production' && isDef(explicitLeaveDuration)) {\n    checkDuration(explicitLeaveDuration, 'leave', vnode);\n  }\n\n  var cb = el._leaveCb = once(function () {\n    if (el.parentNode && el.parentNode._pending) {\n      el.parentNode._pending[vnode.key] = null;\n    }\n    if (expectsCSS) {\n      removeTransitionClass(el, leaveToClass);\n      removeTransitionClass(el, leaveActiveClass);\n    }\n    if (cb.cancelled) {\n      if (expectsCSS) {\n        removeTransitionClass(el, leaveClass);\n      }\n      leaveCancelled && leaveCancelled(el);\n    } else {\n      rm();\n      afterLeave && afterLeave(el);\n    }\n    el._leaveCb = null;\n  });\n\n  if (delayLeave) {\n    delayLeave(performLeave);\n  } else {\n    performLeave();\n  }\n\n  function performLeave () {\n    // the delayed leave may have already been cancelled\n    if (cb.cancelled) {\n      return\n    }\n    // record leaving element\n    if (!vnode.data.show && el.parentNode) {\n      (el.parentNode._pending || (el.parentNode._pending = {}))[(vnode.key)] = vnode;\n    }\n    beforeLeave && beforeLeave(el);\n    if (expectsCSS) {\n      addTransitionClass(el, leaveClass);\n      addTransitionClass(el, leaveActiveClass);\n      nextFrame(function () {\n        removeTransitionClass(el, leaveClass);\n        if (!cb.cancelled) {\n          addTransitionClass(el, leaveToClass);\n          if (!userWantsControl) {\n            if (isValidDuration(explicitLeaveDuration)) {\n              setTimeout(cb, explicitLeaveDuration);\n            } else {\n              whenTransitionEnds(el, type, cb);\n            }\n          }\n        }\n      });\n    }\n    leave && leave(el, cb);\n    if (!expectsCSS && !userWantsControl) {\n      cb();\n    }\n  }\n}\n\n// only used in dev mode\nfunction checkDuration (val, name, vnode) {\n  if (typeof val !== 'number') {\n    warn(\n      \"<transition> explicit \" + name + \" duration is not a valid number - \" +\n      \"got \" + (JSON.stringify(val)) + \".\",\n      vnode.context\n    );\n  } else if (isNaN(val)) {\n    warn(\n      \"<transition> explicit \" + name + \" duration is NaN - \" +\n      'the duration expression might be incorrect.',\n      vnode.context\n    );\n  }\n}\n\nfunction isValidDuration (val) {\n  return typeof val === 'number' && !isNaN(val)\n}\n\n/**\n * Normalize a transition hook's argument length. The hook may be:\n * - a merged hook (invoker) with the original in .fns\n * - a wrapped component method (check ._length)\n * - a plain function (.length)\n */\nfunction getHookArgumentsLength (fn) {\n  if (isUndef(fn)) {\n    return false\n  }\n  var invokerFns = fn.fns;\n  if (isDef(invokerFns)) {\n    // invoker\n    return getHookArgumentsLength(\n      Array.isArray(invokerFns)\n        ? invokerFns[0]\n        : invokerFns\n    )\n  } else {\n    return (fn._length || fn.length) > 1\n  }\n}\n\nfunction _enter (_, vnode) {\n  if (vnode.data.show !== true) {\n    enter(vnode);\n  }\n}\n\nvar transition = inBrowser ? {\n  create: _enter,\n  activate: _enter,\n  remove: function remove$$1 (vnode, rm) {\n    /* istanbul ignore else */\n    if (vnode.data.show !== true) {\n      leave(vnode, rm);\n    } else {\n      rm();\n    }\n  }\n} : {};\n\nvar platformModules = [\n  attrs,\n  klass,\n  events,\n  domProps,\n  style,\n  transition\n];\n\n/*  */\n\n// the directive module should be applied last, after all\n// built-in modules have been applied.\nvar modules = platformModules.concat(baseModules);\n\nvar patch = createPatchFunction({ nodeOps: nodeOps, modules: modules });\n\n/**\n * Not type checking this file because flow doesn't like attaching\n * properties to Elements.\n */\n\n/* istanbul ignore if */\nif (isIE9) {\n  // http://www.matts411.com/post/internet-explorer-9-oninput/\n  document.addEventListener('selectionchange', function () {\n    var el = document.activeElement;\n    if (el && el.vmodel) {\n      trigger(el, 'input');\n    }\n  });\n}\n\nvar directive = {\n  inserted: function inserted (el, binding, vnode, oldVnode) {\n    if (vnode.tag === 'select') {\n      // #6903\n      if (oldVnode.elm && !oldVnode.elm._vOptions) {\n        mergeVNodeHook(vnode, 'postpatch', function () {\n          directive.componentUpdated(el, binding, vnode);\n        });\n      } else {\n        setSelected(el, binding, vnode.context);\n      }\n      el._vOptions = [].map.call(el.options, getValue);\n    } else if (vnode.tag === 'textarea' || isTextInputType(el.type)) {\n      el._vModifiers = binding.modifiers;\n      if (!binding.modifiers.lazy) {\n        el.addEventListener('compositionstart', onCompositionStart);\n        el.addEventListener('compositionend', onCompositionEnd);\n        // Safari < 10.2 & UIWebView doesn't fire compositionend when\n        // switching focus before confirming composition choice\n        // this also fixes the issue where some browsers e.g. iOS Chrome\n        // fires \"change\" instead of \"input\" on autocomplete.\n        el.addEventListener('change', onCompositionEnd);\n        /* istanbul ignore if */\n        if (isIE9) {\n          el.vmodel = true;\n        }\n      }\n    }\n  },\n\n  componentUpdated: function componentUpdated (el, binding, vnode) {\n    if (vnode.tag === 'select') {\n      setSelected(el, binding, vnode.context);\n      // in case the options rendered by v-for have changed,\n      // it's possible that the value is out-of-sync with the rendered options.\n      // detect such cases and filter out values that no longer has a matching\n      // option in the DOM.\n      var prevOptions = el._vOptions;\n      var curOptions = el._vOptions = [].map.call(el.options, getValue);\n      if (curOptions.some(function (o, i) { return !looseEqual(o, prevOptions[i]); })) {\n        // trigger change event if\n        // no matching option found for at least one value\n        var needReset = el.multiple\n          ? binding.value.some(function (v) { return hasNoMatchingOption(v, curOptions); })\n          : binding.value !== binding.oldValue && hasNoMatchingOption(binding.value, curOptions);\n        if (needReset) {\n          trigger(el, 'change');\n        }\n      }\n    }\n  }\n};\n\nfunction setSelected (el, binding, vm) {\n  actuallySetSelected(el, binding, vm);\n  /* istanbul ignore if */\n  if (isIE || isEdge) {\n    setTimeout(function () {\n      actuallySetSelected(el, binding, vm);\n    }, 0);\n  }\n}\n\nfunction actuallySetSelected (el, binding, vm) {\n  var value = binding.value;\n  var isMultiple = el.multiple;\n  if (isMultiple && !Array.isArray(value)) {\n    process.env.NODE_ENV !== 'production' && warn(\n      \"<select multiple v-model=\\\"\" + (binding.expression) + \"\\\"> \" +\n      \"expects an Array value for its binding, but got \" + (Object.prototype.toString.call(value).slice(8, -1)),\n      vm\n    );\n    return\n  }\n  var selected, option;\n  for (var i = 0, l = el.options.length; i < l; i++) {\n    option = el.options[i];\n    if (isMultiple) {\n      selected = looseIndexOf(value, getValue(option)) > -1;\n      if (option.selected !== selected) {\n        option.selected = selected;\n      }\n    } else {\n      if (looseEqual(getValue(option), value)) {\n        if (el.selectedIndex !== i) {\n          el.selectedIndex = i;\n        }\n        return\n      }\n    }\n  }\n  if (!isMultiple) {\n    el.selectedIndex = -1;\n  }\n}\n\nfunction hasNoMatchingOption (value, options) {\n  return options.every(function (o) { return !looseEqual(o, value); })\n}\n\nfunction getValue (option) {\n  return '_value' in option\n    ? option._value\n    : option.value\n}\n\nfunction onCompositionStart (e) {\n  e.target.composing = true;\n}\n\nfunction onCompositionEnd (e) {\n  // prevent triggering an input event for no reason\n  if (!e.target.composing) { return }\n  e.target.composing = false;\n  trigger(e.target, 'input');\n}\n\nfunction trigger (el, type) {\n  var e = document.createEvent('HTMLEvents');\n  e.initEvent(type, true, true);\n  el.dispatchEvent(e);\n}\n\n/*  */\n\n// recursively search for possible transition defined inside the component root\nfunction locateNode (vnode) {\n  return vnode.componentInstance && (!vnode.data || !vnode.data.transition)\n    ? locateNode(vnode.componentInstance._vnode)\n    : vnode\n}\n\nvar show = {\n  bind: function bind (el, ref, vnode) {\n    var value = ref.value;\n\n    vnode = locateNode(vnode);\n    var transition$$1 = vnode.data && vnode.data.transition;\n    var originalDisplay = el.__vOriginalDisplay =\n      el.style.display === 'none' ? '' : el.style.display;\n    if (value && transition$$1) {\n      vnode.data.show = true;\n      enter(vnode, function () {\n        el.style.display = originalDisplay;\n      });\n    } else {\n      el.style.display = value ? originalDisplay : 'none';\n    }\n  },\n\n  update: function update (el, ref, vnode) {\n    var value = ref.value;\n    var oldValue = ref.oldValue;\n\n    /* istanbul ignore if */\n    if (!value === !oldValue) { return }\n    vnode = locateNode(vnode);\n    var transition$$1 = vnode.data && vnode.data.transition;\n    if (transition$$1) {\n      vnode.data.show = true;\n      if (value) {\n        enter(vnode, function () {\n          el.style.display = el.__vOriginalDisplay;\n        });\n      } else {\n        leave(vnode, function () {\n          el.style.display = 'none';\n        });\n      }\n    } else {\n      el.style.display = value ? el.__vOriginalDisplay : 'none';\n    }\n  },\n\n  unbind: function unbind (\n    el,\n    binding,\n    vnode,\n    oldVnode,\n    isDestroy\n  ) {\n    if (!isDestroy) {\n      el.style.display = el.__vOriginalDisplay;\n    }\n  }\n};\n\nvar platformDirectives = {\n  model: directive,\n  show: show\n};\n\n/*  */\n\nvar transitionProps = {\n  name: String,\n  appear: Boolean,\n  css: Boolean,\n  mode: String,\n  type: String,\n  enterClass: String,\n  leaveClass: String,\n  enterToClass: String,\n  leaveToClass: String,\n  enterActiveClass: String,\n  leaveActiveClass: String,\n  appearClass: String,\n  appearActiveClass: String,\n  appearToClass: String,\n  duration: [Number, String, Object]\n};\n\n// in case the child is also an abstract component, e.g. <keep-alive>\n// we want to recursively retrieve the real component to be rendered\nfunction getRealChild (vnode) {\n  var compOptions = vnode && vnode.componentOptions;\n  if (compOptions && compOptions.Ctor.options.abstract) {\n    return getRealChild(getFirstComponentChild(compOptions.children))\n  } else {\n    return vnode\n  }\n}\n\nfunction extractTransitionData (comp) {\n  var data = {};\n  var options = comp.$options;\n  // props\n  for (var key in options.propsData) {\n    data[key] = comp[key];\n  }\n  // events.\n  // extract listeners and pass them directly to the transition methods\n  var listeners = options._parentListeners;\n  for (var key$1 in listeners) {\n    data[camelize(key$1)] = listeners[key$1];\n  }\n  return data\n}\n\nfunction placeholder (h, rawChild) {\n  if (/\\d-keep-alive$/.test(rawChild.tag)) {\n    return h('keep-alive', {\n      props: rawChild.componentOptions.propsData\n    })\n  }\n}\n\nfunction hasParentTransition (vnode) {\n  while ((vnode = vnode.parent)) {\n    if (vnode.data.transition) {\n      return true\n    }\n  }\n}\n\nfunction isSameChild (child, oldChild) {\n  return oldChild.key === child.key && oldChild.tag === child.tag\n}\n\nvar isNotTextNode = function (c) { return c.tag || isAsyncPlaceholder(c); };\n\nvar isVShowDirective = function (d) { return d.name === 'show'; };\n\nvar Transition = {\n  name: 'transition',\n  props: transitionProps,\n  abstract: true,\n\n  render: function render (h) {\n    var this$1 = this;\n\n    var children = this.$slots.default;\n    if (!children) {\n      return\n    }\n\n    // filter out text nodes (possible whitespaces)\n    children = children.filter(isNotTextNode);\n    /* istanbul ignore if */\n    if (!children.length) {\n      return\n    }\n\n    // warn multiple elements\n    if (process.env.NODE_ENV !== 'production' && children.length > 1) {\n      warn(\n        '<transition> can only be used on a single element. Use ' +\n        '<transition-group> for lists.',\n        this.$parent\n      );\n    }\n\n    var mode = this.mode;\n\n    // warn invalid mode\n    if (process.env.NODE_ENV !== 'production' &&\n      mode && mode !== 'in-out' && mode !== 'out-in'\n    ) {\n      warn(\n        'invalid <transition> mode: ' + mode,\n        this.$parent\n      );\n    }\n\n    var rawChild = children[0];\n\n    // if this is a component root node and the component's\n    // parent container node also has transition, skip.\n    if (hasParentTransition(this.$vnode)) {\n      return rawChild\n    }\n\n    // apply transition data to child\n    // use getRealChild() to ignore abstract components e.g. keep-alive\n    var child = getRealChild(rawChild);\n    /* istanbul ignore if */\n    if (!child) {\n      return rawChild\n    }\n\n    if (this._leaving) {\n      return placeholder(h, rawChild)\n    }\n\n    // ensure a key that is unique to the vnode type and to this transition\n    // component instance. This key will be used to remove pending leaving nodes\n    // during entering.\n    var id = \"__transition-\" + (this._uid) + \"-\";\n    child.key = child.key == null\n      ? child.isComment\n        ? id + 'comment'\n        : id + child.tag\n      : isPrimitive(child.key)\n        ? (String(child.key).indexOf(id) === 0 ? child.key : id + child.key)\n        : child.key;\n\n    var data = (child.data || (child.data = {})).transition = extractTransitionData(this);\n    var oldRawChild = this._vnode;\n    var oldChild = getRealChild(oldRawChild);\n\n    // mark v-show\n    // so that the transition module can hand over the control to the directive\n    if (child.data.directives && child.data.directives.some(isVShowDirective)) {\n      child.data.show = true;\n    }\n\n    if (\n      oldChild &&\n      oldChild.data &&\n      !isSameChild(child, oldChild) &&\n      !isAsyncPlaceholder(oldChild) &&\n      // #6687 component root is a comment node\n      !(oldChild.componentInstance && oldChild.componentInstance._vnode.isComment)\n    ) {\n      // replace old child transition data with fresh one\n      // important for dynamic transitions!\n      var oldData = oldChild.data.transition = extend({}, data);\n      // handle transition mode\n      if (mode === 'out-in') {\n        // return placeholder node and queue update when leave finishes\n        this._leaving = true;\n        mergeVNodeHook(oldData, 'afterLeave', function () {\n          this$1._leaving = false;\n          this$1.$forceUpdate();\n        });\n        return placeholder(h, rawChild)\n      } else if (mode === 'in-out') {\n        if (isAsyncPlaceholder(child)) {\n          return oldRawChild\n        }\n        var delayedLeave;\n        var performLeave = function () { delayedLeave(); };\n        mergeVNodeHook(data, 'afterEnter', performLeave);\n        mergeVNodeHook(data, 'enterCancelled', performLeave);\n        mergeVNodeHook(oldData, 'delayLeave', function (leave) { delayedLeave = leave; });\n      }\n    }\n\n    return rawChild\n  }\n};\n\n/*  */\n\nvar props = extend({\n  tag: String,\n  moveClass: String\n}, transitionProps);\n\ndelete props.mode;\n\nvar TransitionGroup = {\n  props: props,\n\n  beforeMount: function beforeMount () {\n    var this$1 = this;\n\n    var update = this._update;\n    this._update = function (vnode, hydrating) {\n      var restoreActiveInstance = setActiveInstance(this$1);\n      // force removing pass\n      this$1.__patch__(\n        this$1._vnode,\n        this$1.kept,\n        false, // hydrating\n        true // removeOnly (!important, avoids unnecessary moves)\n      );\n      this$1._vnode = this$1.kept;\n      restoreActiveInstance();\n      update.call(this$1, vnode, hydrating);\n    };\n  },\n\n  render: function render (h) {\n    var tag = this.tag || this.$vnode.data.tag || 'span';\n    var map = Object.create(null);\n    var prevChildren = this.prevChildren = this.children;\n    var rawChildren = this.$slots.default || [];\n    var children = this.children = [];\n    var transitionData = extractTransitionData(this);\n\n    for (var i = 0; i < rawChildren.length; i++) {\n      var c = rawChildren[i];\n      if (c.tag) {\n        if (c.key != null && String(c.key).indexOf('__vlist') !== 0) {\n          children.push(c);\n          map[c.key] = c\n          ;(c.data || (c.data = {})).transition = transitionData;\n        } else if (process.env.NODE_ENV !== 'production') {\n          var opts = c.componentOptions;\n          var name = opts ? (opts.Ctor.options.name || opts.tag || '') : c.tag;\n          warn((\"<transition-group> children must be keyed: <\" + name + \">\"));\n        }\n      }\n    }\n\n    if (prevChildren) {\n      var kept = [];\n      var removed = [];\n      for (var i$1 = 0; i$1 < prevChildren.length; i$1++) {\n        var c$1 = prevChildren[i$1];\n        c$1.data.transition = transitionData;\n        c$1.data.pos = c$1.elm.getBoundingClientRect();\n        if (map[c$1.key]) {\n          kept.push(c$1);\n        } else {\n          removed.push(c$1);\n        }\n      }\n      this.kept = h(tag, null, kept);\n      this.removed = removed;\n    }\n\n    return h(tag, null, children)\n  },\n\n  updated: function updated () {\n    var children = this.prevChildren;\n    var moveClass = this.moveClass || ((this.name || 'v') + '-move');\n    if (!children.length || !this.hasMove(children[0].elm, moveClass)) {\n      return\n    }\n\n    // we divide the work into three loops to avoid mixing DOM reads and writes\n    // in each iteration - which helps prevent layout thrashing.\n    children.forEach(callPendingCbs);\n    children.forEach(recordPosition);\n    children.forEach(applyTranslation);\n\n    // force reflow to put everything in position\n    // assign to this to avoid being removed in tree-shaking\n    // $flow-disable-line\n    this._reflow = document.body.offsetHeight;\n\n    children.forEach(function (c) {\n      if (c.data.moved) {\n        var el = c.elm;\n        var s = el.style;\n        addTransitionClass(el, moveClass);\n        s.transform = s.WebkitTransform = s.transitionDuration = '';\n        el.addEventListener(transitionEndEvent, el._moveCb = function cb (e) {\n          if (e && e.target !== el) {\n            return\n          }\n          if (!e || /transform$/.test(e.propertyName)) {\n            el.removeEventListener(transitionEndEvent, cb);\n            el._moveCb = null;\n            removeTransitionClass(el, moveClass);\n          }\n        });\n      }\n    });\n  },\n\n  methods: {\n    hasMove: function hasMove (el, moveClass) {\n      /* istanbul ignore if */\n      if (!hasTransition) {\n        return false\n      }\n      /* istanbul ignore if */\n      if (this._hasMove) {\n        return this._hasMove\n      }\n      // Detect whether an element with the move class applied has\n      // CSS transitions. Since the element may be inside an entering\n      // transition at this very moment, we make a clone of it and remove\n      // all other transition classes applied to ensure only the move class\n      // is applied.\n      var clone = el.cloneNode();\n      if (el._transitionClasses) {\n        el._transitionClasses.forEach(function (cls) { removeClass(clone, cls); });\n      }\n      addClass(clone, moveClass);\n      clone.style.display = 'none';\n      this.$el.appendChild(clone);\n      var info = getTransitionInfo(clone);\n      this.$el.removeChild(clone);\n      return (this._hasMove = info.hasTransform)\n    }\n  }\n};\n\nfunction callPendingCbs (c) {\n  /* istanbul ignore if */\n  if (c.elm._moveCb) {\n    c.elm._moveCb();\n  }\n  /* istanbul ignore if */\n  if (c.elm._enterCb) {\n    c.elm._enterCb();\n  }\n}\n\nfunction recordPosition (c) {\n  c.data.newPos = c.elm.getBoundingClientRect();\n}\n\nfunction applyTranslation (c) {\n  var oldPos = c.data.pos;\n  var newPos = c.data.newPos;\n  var dx = oldPos.left - newPos.left;\n  var dy = oldPos.top - newPos.top;\n  if (dx || dy) {\n    c.data.moved = true;\n    var s = c.elm.style;\n    s.transform = s.WebkitTransform = \"translate(\" + dx + \"px,\" + dy + \"px)\";\n    s.transitionDuration = '0s';\n  }\n}\n\nvar platformComponents = {\n  Transition: Transition,\n  TransitionGroup: TransitionGroup\n};\n\n/*  */\n\n// install platform specific utils\nVue.config.mustUseProp = mustUseProp;\nVue.config.isReservedTag = isReservedTag;\nVue.config.isReservedAttr = isReservedAttr;\nVue.config.getTagNamespace = getTagNamespace;\nVue.config.isUnknownElement = isUnknownElement;\n\n// install platform runtime directives & components\nextend(Vue.options.directives, platformDirectives);\nextend(Vue.options.components, platformComponents);\n\n// install platform patch function\nVue.prototype.__patch__ = inBrowser ? patch : noop;\n\n// public mount method\nVue.prototype.$mount = function (\n  el,\n  hydrating\n) {\n  el = el && inBrowser ? query(el) : undefined;\n  return mountComponent(this, el, hydrating)\n};\n\n// devtools global hook\n/* istanbul ignore next */\nif (inBrowser) {\n  setTimeout(function () {\n    if (config.devtools) {\n      if (devtools) {\n        devtools.emit('init', Vue);\n      } else if (\n        process.env.NODE_ENV !== 'production' &&\n        process.env.NODE_ENV !== 'test'\n      ) {\n        console[console.info ? 'info' : 'log'](\n          'Download the Vue Devtools extension for a better development experience:\\n' +\n          'https://github.com/vuejs/vue-devtools'\n        );\n      }\n    }\n    if (process.env.NODE_ENV !== 'production' &&\n      process.env.NODE_ENV !== 'test' &&\n      config.productionTip !== false &&\n      typeof console !== 'undefined'\n    ) {\n      console[console.info ? 'info' : 'log'](\n        \"You are running Vue in development mode.\\n\" +\n        \"Make sure to turn on production mode when deploying for production.\\n\" +\n        \"See more tips at https://vuejs.org/guide/deployment.html\"\n      );\n    }\n  }, 0);\n}\n\n/*  */\n\nexport default Vue;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\n */\n\nexport const CONSTANTS = {\n  /**\n   * @define {boolean} Whether this is the client Node.js SDK.\n   */\n  NODE_CLIENT: false,\n  /**\n   * @define {boolean} Whether this is the Admin Node.js SDK.\n   */\n  NODE_ADMIN: false,\n\n  /**\n   * Firebase SDK Version\n   */\n  SDK_VERSION: '${JSCORE_VERSION}'\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONSTANTS } from './constants';\n\n/**\n * Throws an error if the provided assertion is falsy\n */\nexport const assert = function(assertion: unknown, message: string): void {\n  if (!assertion) {\n    throw assertionError(message);\n  }\n};\n\n/**\n * Returns an Error object suitable for throwing.\n */\nexport const assertionError = function(message: string): Error {\n  return new Error(\n    'Firebase Database (' +\n      CONSTANTS.SDK_VERSION +\n      ') INTERNAL ASSERT FAILED: ' +\n      message\n  );\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst stringToByteArray = function(str: string): number[] {\n  // TODO(user): Use native implementations if/when available\n  const out: number[] = [];\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i);\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192;\n      out[p++] = (c & 63) | 128;\n    } else if (\n      (c & 0xfc00) === 0xd800 &&\n      i + 1 < str.length &&\n      (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00\n    ) {\n      // Surrogate Pair\n      c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\n      out[p++] = (c >> 18) | 240;\n      out[p++] = ((c >> 12) & 63) | 128;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    } else {\n      out[p++] = (c >> 12) | 224;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    }\n  }\n  return out;\n};\n\n/**\n * Turns an array of numbers into the string given by the concatenation of the\n * characters to which the numbers correspond.\n * @param bytes Array of numbers representing characters.\n * @return Stringification of the array.\n */\nconst byteArrayToString = function(bytes: number[]): string {\n  // TODO(user): Use native implementations if/when available\n  const out: string[] = [];\n  let pos = 0,\n    c = 0;\n  while (pos < bytes.length) {\n    const c1 = bytes[pos++];\n    if (c1 < 128) {\n      out[c++] = String.fromCharCode(c1);\n    } else if (c1 > 191 && c1 < 224) {\n      const c2 = bytes[pos++];\n      out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\n    } else if (c1 > 239 && c1 < 365) {\n      // Surrogate Pair\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      const c4 = bytes[pos++];\n      const u =\n        (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\n        0x10000;\n      out[c++] = String.fromCharCode(0xd800 + (u >> 10));\n      out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\n    } else {\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      out[c++] = String.fromCharCode(\n        ((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63)\n      );\n    }\n  }\n  return out.join('');\n};\n\n// Static lookup maps, lazily populated by init_()\nexport const base64 = {\n  /**\n   * Maps bytes to characters.\n   * @type {Object}\n   * @private\n   */\n  byteToCharMap_: null,\n\n  /**\n   * Maps characters to bytes.\n   * @type {Object}\n   * @private\n   */\n  charToByteMap_: null,\n\n  /**\n   * Maps bytes to websafe characters.\n   * @type {Object}\n   * @private\n   */\n  byteToCharMapWebSafe_: null,\n\n  /**\n   * Maps websafe characters to bytes.\n   * @type {Object}\n   * @private\n   */\n  charToByteMapWebSafe_: null,\n\n  /**\n   * Our default alphabet, shared between\n   * ENCODED_VALS and ENCODED_VALS_WEBSAFE\n   * @type {string}\n   */\n  ENCODED_VALS_BASE:\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\n\n  /**\n   * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\n   * @type {string}\n   */\n  get ENCODED_VALS() {\n    return this.ENCODED_VALS_BASE + '+/=';\n  },\n\n  /**\n   * Our websafe alphabet.\n   * @type {string}\n   */\n  get ENCODED_VALS_WEBSAFE() {\n    return this.ENCODED_VALS_BASE + '-_.';\n  },\n\n  /**\n   * Whether this browser supports the atob and btoa functions. This extension\n   * started at Mozilla but is now implemented by many browsers. We use the\n   * ASSUME_* variables to avoid pulling in the full useragent detection library\n   * but still allowing the standard per-browser compilations.\n   *\n   * @type {boolean}\n   */\n  HAS_NATIVE_SUPPORT: typeof atob === 'function',\n\n  /**\n   * Base64-encode an array of bytes.\n   *\n   * @param input An array of bytes (numbers with\n   *     value in [0, 255]) to encode.\n   * @param webSafe Boolean indicating we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeByteArray(input: number[] | Uint8Array, webSafe?: boolean): string {\n    if (!Array.isArray(input)) {\n      throw Error('encodeByteArray takes an array as a parameter');\n    }\n\n    this.init_();\n\n    const byteToCharMap: number[] = webSafe\n      ? this.byteToCharMapWebSafe_\n      : this.byteToCharMap_;\n\n    const output: number[] = [];\n\n    for (let i = 0; i < input.length; i += 3) {\n      const byte1 = input[i];\n      const haveByte2 = i + 1 < input.length;\n      const byte2 = haveByte2 ? input[i + 1] : 0;\n      const haveByte3 = i + 2 < input.length;\n      const byte3 = haveByte3 ? input[i + 2] : 0;\n\n      const outByte1 = byte1 >> 2;\n      const outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\n      let outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\n      let outByte4 = byte3 & 0x3f;\n\n      if (!haveByte3) {\n        outByte4 = 64;\n\n        if (!haveByte2) {\n          outByte3 = 64;\n        }\n      }\n\n      output.push(\n        byteToCharMap[outByte1],\n        byteToCharMap[outByte2],\n        byteToCharMap[outByte3],\n        byteToCharMap[outByte4]\n      );\n    }\n\n    return output.join('');\n  },\n\n  /**\n   * Base64-encode a string.\n   *\n   * @param input A string to encode.\n   * @param webSafe If true, we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeString(input: string, webSafe?: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return btoa(input);\n    }\n    return this.encodeByteArray(stringToByteArray(input), webSafe);\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * @param input to decode.\n   * @param webSafe True if we should use the\n   *     alternative alphabet.\n   * @return string representing the decoded value.\n   */\n  decodeString(input: string, webSafe: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return atob(input);\n    }\n    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * In base-64 decoding, groups of four characters are converted into three\n   * bytes.  If the encoder did not apply padding, the input length may not\n   * be a multiple of 4.\n   *\n   * In this case, the last group will have fewer than 4 characters, and\n   * padding will be inferred.  If the group has one or two characters, it decodes\n   * to one byte.  If the group has three characters, it decodes to two bytes.\n   *\n   * @param input Input to decode.\n   * @param webSafe True if we should use the web-safe alphabet.\n   * @return bytes representing the decoded value.\n   */\n  decodeStringToByteArray(input: string, webSafe: boolean): number[] {\n    this.init_();\n\n    const charToByteMap = webSafe\n      ? this.charToByteMapWebSafe_\n      : this.charToByteMap_;\n\n    const output: number[] = [];\n\n    for (let i = 0; i < input.length; ) {\n      const byte1 = charToByteMap[input.charAt(i++)];\n\n      const haveByte2 = i < input.length;\n      const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\n      ++i;\n\n      const haveByte3 = i < input.length;\n      const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      const haveByte4 = i < input.length;\n      const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\n        throw Error();\n      }\n\n      const outByte1 = (byte1 << 2) | (byte2 >> 4);\n      output.push(outByte1);\n\n      if (byte3 !== 64) {\n        const outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\n        output.push(outByte2);\n\n        if (byte4 !== 64) {\n          const outByte3 = ((byte3 << 6) & 0xc0) | byte4;\n          output.push(outByte3);\n        }\n      }\n    }\n\n    return output;\n  },\n\n  /**\n   * Lazy static initialization function. Called before\n   * accessing any of the static map variables.\n   * @private\n   */\n  init_() {\n    if (!this.byteToCharMap_) {\n      this.byteToCharMap_ = {};\n      this.charToByteMap_ = {};\n      this.byteToCharMapWebSafe_ = {};\n      this.charToByteMapWebSafe_ = {};\n\n      // We want quick mappings back and forth, so we precompute two maps.\n      for (let i = 0; i < this.ENCODED_VALS.length; i++) {\n        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\n        this.charToByteMap_[this.byteToCharMap_[i]] = i;\n        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\n        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\n\n        // Be forgiving when decoding and correctly decode both encodings.\n        if (i >= this.ENCODED_VALS_BASE.length) {\n          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\n          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\n        }\n      }\n    }\n  }\n};\n\n/**\n * URL-safe base64 encoding\n */\nexport const base64Encode = function(str: string): string {\n  const utf8Bytes = stringToByteArray(str);\n  return base64.encodeByteArray(utf8Bytes, true);\n};\n\n/**\n * URL-safe base64 decoding\n *\n * NOTE: DO NOT use the global atob() function - it does NOT support the\n * base64Url variant encoding.\n *\n * @param str To be decoded\n * @return Decoded result, if possible\n */\nexport const base64Decode = function(str: string): string | null {\n  try {\n    return base64.decodeString(str, true);\n  } catch (e) {\n    console.error('base64Decode failed: ', e);\n  }\n  return null;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Do a deep-copy of basic JavaScript Objects or Arrays.\n */\nexport function deepCopy<T>(value: T): T {\n  return deepExtend(undefined, value) as T;\n}\n\n/**\n * Copy properties from source to target (recursively allows extension\n * of Objects and Arrays).  Scalar values in the target are over-written.\n * If target is undefined, an object of the appropriate type will be created\n * (and returned).\n *\n * We recursively copy all child properties of plain Objects in the source- so\n * that namespace- like dictionaries are merged.\n *\n * Note that the target can be a function, in which case the properties in\n * the source Object are copied onto it as static properties of the Function.\n */\nexport function deepExtend(target: unknown, source: unknown): unknown {\n  if (!(source instanceof Object)) {\n    return source;\n  }\n\n  switch (source.constructor) {\n    case Date:\n      // Treat Dates like scalars; if the target date object had any child\n      // properties - they will be lost!\n      const dateValue = source as Date;\n      return new Date(dateValue.getTime());\n\n    case Object:\n      if (target === undefined) {\n        target = {};\n      }\n      break;\n\n    case Array:\n      // Always copy the array source and overwrite the target.\n      target = [];\n      break;\n\n    default:\n      // Not a plain Object - treat it as a scalar.\n      return source;\n  }\n\n  for (const prop in source) {\n    if (!source.hasOwnProperty(prop)) {\n      continue;\n    }\n    (target as { [key: string]: unknown })[prop] = deepExtend(\n      (target as { [key: string]: unknown })[prop],\n      (source as { [key: string]: unknown })[prop]\n    );\n  }\n\n  return target;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class Deferred<R> {\n  promise: Promise<R>;\n  reject: (value?: unknown) => void;\n  resolve: (value?: unknown) => void;\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n  }\n\n  /**\n   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\n   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\n   * and returns a node-style callback which will resolve or reject the Deferred's promise.\n   */\n  wrapCallback(\n    callback?: (error?: unknown, value?: unknown) => void\n  ): (error: unknown, value?: unknown) => void {\n    return (error, value?) => {\n      if (error) {\n        this.reject(error);\n      } else {\n        this.resolve(value);\n      }\n      if (typeof callback === 'function') {\n        // Attaching noop handler just in case developer wasn't expecting\n        // promises\n        this.promise.catch(() => {});\n\n        // Some of our callbacks don't expect a value and our own tests\n        // assert that the parameter length is 1\n        if (callback.length === 1) {\n          callback(error);\n        } else {\n          callback(error, value);\n        }\n      }\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONSTANTS } from './constants';\n\n/**\n * Returns navigator.userAgent string or '' if it's not defined.\n * @return user agent string\n */\nexport function getUA(): string {\n  if (\n    typeof navigator !== 'undefined' &&\n    typeof navigator['userAgent'] === 'string'\n  ) {\n    return navigator['userAgent'];\n  } else {\n    return '';\n  }\n}\n\n/**\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\n *\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\n * wait for a callback.\n */\nexport function isMobileCordova(): boolean {\n  return (\n    typeof window !== 'undefined' &&\n    // @ts-ignore Setting up an broadly applicable index signature for Window\n    // just to deal with this case would probably be a bad idea.\n    !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\n    /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())\n  );\n}\n\n/**\n * Detect Node.js.\n *\n * @return true if Node.js environment is detected.\n */\n// Node detection logic from: https://github.com/iliakan/detect-node/\nexport function isNode(): boolean {\n  try {\n    return (\n      Object.prototype.toString.call(global.process) === '[object process]'\n    );\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Detect Browser Environment\n */\nexport function isBrowser(): boolean {\n  return typeof self === 'object' && self.self === self;\n}\n\n/**\n * Detect React Native.\n *\n * @return true if ReactNative environment is detected.\n */\nexport function isReactNative(): boolean {\n  return (\n    typeof navigator === 'object' && navigator['product'] === 'ReactNative'\n  );\n}\n\n/**\n * Detect whether the current SDK build is the Node version.\n *\n * @return true if it's the Node SDK build.\n */\nexport function isNodeSdk(): boolean {\n  return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Standardized Firebase Error.\n *\n * Usage:\n *\n *   // Typescript string literals for type-safe codes\n *   type Err =\n *     'unknown' |\n *     'object-not-found'\n *     ;\n *\n *   // Closure enum for type-safe error codes\n *   // at-enum {string}\n *   var Err = {\n *     UNKNOWN: 'unknown',\n *     OBJECT_NOT_FOUND: 'object-not-found',\n *   }\n *\n *   let errors: Map<Err, string> = {\n *     'generic-error': \"Unknown error\",\n *     'file-not-found': \"Could not find file: {$file}\",\n *   };\n *\n *   // Type-safe function - must pass a valid error code as param.\n *   let error = new ErrorFactory<Err>('service', 'Service', errors);\n *\n *   ...\n *   throw error.create(Err.GENERIC);\n *   ...\n *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});\n *   ...\n *   // Service: Could not file file: foo.txt (service/file-not-found).\n *\n *   catch (e) {\n *     assert(e.message === \"Could not find file: foo.txt.\");\n *     if (e.code === 'service/file-not-found') {\n *       console.log(\"Could not read file: \" + e['file']);\n *     }\n *   }\n */\n\nexport type ErrorMap<ErrorCode extends string> = {\n  readonly [K in ErrorCode]: string\n};\n\nconst ERROR_NAME = 'FirebaseError';\n\nexport interface StringLike {\n  toString(): string;\n}\n\nexport interface ErrorData {\n  [key: string]: StringLike | undefined;\n}\n\nexport interface FirebaseError extends Error, ErrorData {\n  // Unique code for error - format is service/error-code-string.\n  readonly code: string;\n\n  // Developer-friendly error message.\n  readonly message: string;\n\n  // Always 'FirebaseError'.\n  readonly name: typeof ERROR_NAME;\n\n  // Where available - stack backtrace in a string.\n  readonly stack?: string;\n}\n\n// Based on code from:\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\nexport class FirebaseError extends Error {\n  readonly name = ERROR_NAME;\n\n  constructor(readonly code: string, message: string) {\n    super(message);\n\n    // Fix For ES5\n    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    Object.setPrototypeOf(this, FirebaseError.prototype);\n\n    // Maintains proper stack trace for where our error was thrown.\n    // Only available on V8.\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ErrorFactory.prototype.create);\n    }\n  }\n}\n\nexport class ErrorFactory<\n  ErrorCode extends string,\n  ErrorParams extends { readonly [K in ErrorCode]?: ErrorData } = {}\n> {\n  constructor(\n    private readonly service: string,\n    private readonly serviceName: string,\n    private readonly errors: ErrorMap<ErrorCode>\n  ) {}\n\n  create<K extends ErrorCode>(\n    code: K,\n    ...data: K extends keyof ErrorParams ? [ErrorParams[K]] : []\n  ): FirebaseError {\n    const customData = (data[0] as ErrorData) || {};\n    const fullCode = `${this.service}/${code}`;\n    const template = this.errors[code];\n\n    const message = template ? replaceTemplate(template, customData) : 'Error';\n    // Service Name: Error message (service/code).\n    const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;\n\n    const error = new FirebaseError(fullCode, fullMessage);\n\n    // Keys with an underscore at the end of their name are not included in\n    // error.data for some reason.\n    // TODO: Replace with Object.entries when lib is updated to es2017.\n    for (const key of Object.keys(customData)) {\n      if (key.slice(-1) !== '_') {\n        if (key in error) {\n          console.warn(\n            `Overwriting FirebaseError base field \"${key}\" can cause unexpected behavior.`\n          );\n        }\n        error[key] = customData[key];\n      }\n    }\n\n    return error;\n  }\n}\n\nfunction replaceTemplate(template: string, data: ErrorData): string {\n  return template.replace(PATTERN, (_, key) => {\n    const value = data[key];\n    return value != null ? value.toString() : `<${key}?>`;\n  });\n}\n\nconst PATTERN = /\\{\\$([^}]+)}/g;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Evaluates a JSON string into a javascript object.\n *\n * @param {string} str A string containing JSON.\n * @return {*} The javascript object representing the specified JSON.\n */\nexport function jsonEval(str: string): unknown {\n  return JSON.parse(str);\n}\n\n/**\n * Returns JSON representing a javascript object.\n * @param {*} data Javascript object to be stringified.\n * @return {string} The JSON contents of the object.\n */\nexport function stringify(data: unknown): string {\n  return JSON.stringify(data);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { base64Decode } from './crypt';\nimport { jsonEval } from './json';\n\ninterface Claims {\n  [key: string]: {};\n}\n\ninterface DecodedToken {\n  header: object;\n  claims: Claims;\n  data: object;\n  signature: string;\n}\n\n/**\n * Decodes a Firebase auth. token into constituent parts.\n *\n * Notes:\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const decode = function(token: string): DecodedToken {\n  let header = {},\n    claims: Claims = {},\n    data = {},\n    signature = '';\n\n  try {\n    const parts = token.split('.');\n    header = jsonEval(base64Decode(parts[0]) || '') as object;\n    claims = jsonEval(base64Decode(parts[1]) || '') as Claims;\n    signature = parts[2];\n    data = claims['d'] || {};\n    delete claims['d'];\n  } catch (e) {}\n\n  return {\n    header,\n    claims,\n    data,\n    signature\n  };\n};\n\ninterface DecodedToken {\n  header: object;\n  claims: Claims;\n  data: object;\n  signature: string;\n}\n\n/**\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isValidTimestamp = function(token: string): boolean {\n  const claims: Claims = decode(token).claims;\n  const now: number = Math.floor(new Date().getTime() / 1000);\n  let validSince: number = 0,\n    validUntil: number = 0;\n\n  if (typeof claims === 'object') {\n    if (claims.hasOwnProperty('nbf')) {\n      validSince = claims['nbf'] as number;\n    } else if (claims.hasOwnProperty('iat')) {\n      validSince = claims['iat'] as number;\n    }\n\n    if (claims.hasOwnProperty('exp')) {\n      validUntil = claims['exp'] as number;\n    } else {\n      // token will expire after 24h by default\n      validUntil = validSince + 86400;\n    }\n  }\n\n  return (\n    !!now &&\n    !!validSince &&\n    !!validUntil &&\n    now >= validSince &&\n    now <= validUntil\n  );\n};\n\n/**\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\n *\n * Notes:\n * - May return null if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const issuedAtTime = function(token: string): number | null {\n  const claims: Claims = decode(token).claims;\n  if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\n    return claims['iat'] as number;\n  }\n  return null;\n};\n\n/**\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isValidFormat = function(token: string): boolean {\n  const decoded = decode(token),\n    claims = decoded.claims;\n\n  return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\n};\n\n/**\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isAdmin = function(token: string): boolean {\n  const claims: Claims = decode(token).claims;\n  return typeof claims === 'object' && claims['admin'] === true;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable */\n// will enable after https://github.com/firebase/firebase-js-sdk/pull/1811 is merged\n\ninterface UtilObject<V> {\n  [key: string]: V;\n}\n\n// See http://www.devthought.com/2012/01/18/an-object-is-not-a-hash/\nexport const contains = function<V>(obj: UtilObject<V>, key: string): boolean {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n\nexport const safeGet = function<V>(\n  obj: UtilObject<V>,\n  key: string\n): V | undefined {\n  if (Object.prototype.hasOwnProperty.call(obj, key)) return obj[key];\n  // else return undefined.\n};\n\n/**\n * Enumerates the keys/values in an object, excluding keys defined on the prototype.\n *\n * @param {?Object.<K,V>} obj Object to enumerate.\n * @param {!function(K, V)} fn Function to call for each key and value.\n * @template K,V\n */\nexport const forEach = function<V>(\n  obj: UtilObject<V>,\n  fn: (key: string, value: V) => void\n): void {\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      fn(key, obj[key]);\n    }\n  }\n};\n\n/**\n * Copies all the (own) properties from one object to another.\n * @param {!Object} objTo\n * @param {!Object} objFrom\n * @return {!Object} objTo\n */\nexport const extend = function<V>(\n  objTo: UtilObject<V>,\n  objFrom: UtilObject<V>\n): UtilObject<V> {\n  forEach(objFrom, function(key, value) {\n    objTo[key] = value;\n  });\n  return objTo;\n};\n\n/**\n * Returns a clone of the specified object.\n * @param {!Object} obj\n * @return {!Object} cloned obj.\n */\nexport const clone = function<V>(obj: UtilObject<V>) {\n  return extend({}, obj);\n};\n\n/**\n * Returns true if obj has typeof \"object\" and is not null.  Unlike goog.isObject(), does not return true\n * for functions.\n */\nexport const isNonNullObject = function<V>(obj: UtilObject<V>): boolean {\n  return typeof obj === 'object' && obj !== null;\n};\n\nexport const isEmpty = function<V>(obj: UtilObject<V>) {\n  for (var key in obj) {\n    return false;\n  }\n  return true;\n};\n\nexport const getCount = function<V>(obj: UtilObject<V>): number {\n  var rv = 0;\n  for (var key in obj) {\n    rv++;\n  }\n  return rv;\n};\n\nexport const map = function<V>(\n  obj: UtilObject<V>,\n  fn: (value: V, key: string | number, obj: UtilObject<V>) => unknown,\n  context?: unknown\n) {\n  var res: UtilObject<V> = {};\n  for (var key in obj) {\n    res[key] = fn.call(context, obj[key], key, obj);\n  }\n  return res;\n};\n\nexport const findKey = function<V>(\n  obj: UtilObject<V>,\n  fn: (value: V, key: string | number, obj: UtilObject<V>) => unknown,\n  context?: unknown\n) {\n  for (var key in obj) {\n    if (fn.call(context, obj[key], key, obj)) {\n      return key;\n    }\n  }\n  return undefined;\n};\n\nexport const findValue = function<V>(\n  obj: UtilObject<V>,\n  fn: (value: V, key: string | number, obj: UtilObject<V>) => unknown,\n  context?: unknown\n) {\n  var key = findKey(obj, fn, context);\n  return key && obj[key];\n};\n\nexport const getAnyKey = function<V>(obj: UtilObject<V>) {\n  for (var key in obj) {\n    return key;\n  }\n};\n\nexport const getValues = function<V>(obj: UtilObject<V>) {\n  var res: V[] = [];\n  var i = 0;\n  for (var key in obj) {\n    res[i++] = obj[key];\n  }\n  return res;\n};\n\n/**\n * Tests whether every key/value pair in an object pass the test implemented\n * by the provided function\n *\n * @param {?Object.<K,V>} obj Object to test.\n * @param {!function(K, V)} fn Function to call for each key and value.\n * @template K,V\n */\nexport const every = function<V>(\n  obj: UtilObject<V>,\n  fn: (k: string, v?: V) => boolean\n): boolean {\n  for (let key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (!fn(key, obj[key])) {\n        return false;\n      }\n    }\n  }\n  return true;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { forEach } from './obj';\n\n/**\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a params\n * object (e.g. {arg: 'val', arg2: 'val2'})\n * Note: You must prepend it with ? when adding it to a URL.\n */\nexport const querystring = function<V>(querystringParams: {\n  [key: string]: string;\n}): string {\n  const params: string[] = [];\n  forEach(querystringParams, (key: string, value) => {\n    if (Array.isArray(value)) {\n      value.forEach(arrayVal => {\n        params.push(\n          encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal)\n        );\n      });\n    } else {\n      params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n    }\n  });\n  return params.length ? '&' + params.join('&') : '';\n};\n\n/**\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object (e.g. {arg: 'val', arg2: 'val2'})\n *\n * @param {string} querystring\n * @return {!Object}\n */\nexport const querystringDecode = function(querystring: string): object {\n  const obj: { [key: string]: unknown } = {};\n  const tokens = querystring.replace(/^\\?/, '').split('&');\n\n  tokens.forEach(token => {\n    if (token) {\n      const key = token.split('=');\n      obj[key[0]] = key[1];\n    }\n  });\n  return obj;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview SHA-1 cryptographic hash.\n * Variable names follow the notation in FIPS PUB 180-3:\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\n *\n * Usage:\n *   var sha1 = new sha1();\n *   sha1.update(bytes);\n *   var hash = sha1.digest();\n *\n * Performance:\n *   Chrome 23:   ~400 Mbit/s\n *   Firefox 16:  ~250 Mbit/s\n *\n */\n\n/**\n * SHA-1 cryptographic hash constructor.\n *\n * The properties declared here are discussed in the above algorithm document.\n * @constructor\n * @final\n * @struct\n */\nexport class Sha1 {\n  /**\n   * Holds the previous values of accumulated variables a-e in the compress_\n   * function.\n   * @private\n   */\n  private chain_: number[] = [];\n\n  /**\n   * A buffer holding the partially computed hash result.\n   * @private\n   */\n  private buf_: number[] = [];\n\n  /**\n   * An array of 80 bytes, each a part of the message to be hashed.  Referred to\n   * as the message schedule in the docs.\n   * @private\n   */\n  private W_: number[] = [];\n\n  /**\n   * Contains data needed to pad messages less than 64 bytes.\n   * @private\n   */\n  private pad_: number[] = [];\n\n  /**\n   * @private {number}\n   */\n  private inbuf_: number = 0;\n\n  /**\n   * @private {number}\n   */\n  private total_: number = 0;\n\n  blockSize: number;\n\n  constructor() {\n    this.blockSize = 512 / 8;\n\n    this.pad_[0] = 128;\n    for (let i = 1; i < this.blockSize; ++i) {\n      this.pad_[i] = 0;\n    }\n\n    this.reset();\n  }\n\n  reset(): void {\n    this.chain_[0] = 0x67452301;\n    this.chain_[1] = 0xefcdab89;\n    this.chain_[2] = 0x98badcfe;\n    this.chain_[3] = 0x10325476;\n    this.chain_[4] = 0xc3d2e1f0;\n\n    this.inbuf_ = 0;\n    this.total_ = 0;\n  }\n\n  /**\n   * Internal compress helper function.\n   * @param buf Block to compress.\n   * @param offset Offset of the block in the buffer.\n   * @private\n   */\n  compress_(buf: number[] | Uint8Array | string, offset?: number): void {\n    if (!offset) {\n      offset = 0;\n    }\n\n    const W = this.W_;\n\n    // get 16 big endian words\n    if (typeof buf === 'string') {\n      for (let i = 0; i < 16; i++) {\n        // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\n        // have a bug that turns the post-increment ++ operator into pre-increment\n        // during JIT compilation.  We have code that depends heavily on SHA-1 for\n        // correctness and which is affected by this bug, so I've removed all uses\n        // of post-increment ++ in which the result value is used.  We can revert\n        // this change once the Safari bug\n        // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\n        // most clients have been updated.\n        W[i] =\n          (buf.charCodeAt(offset) << 24) |\n          (buf.charCodeAt(offset + 1) << 16) |\n          (buf.charCodeAt(offset + 2) << 8) |\n          buf.charCodeAt(offset + 3);\n        offset += 4;\n      }\n    } else {\n      for (let i = 0; i < 16; i++) {\n        W[i] =\n          (buf[offset] << 24) |\n          (buf[offset + 1] << 16) |\n          (buf[offset + 2] << 8) |\n          buf[offset + 3];\n        offset += 4;\n      }\n    }\n\n    // expand to 80 words\n    for (let i = 16; i < 80; i++) {\n      const t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n      W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\n    }\n\n    let a = this.chain_[0];\n    let b = this.chain_[1];\n    let c = this.chain_[2];\n    let d = this.chain_[3];\n    let e = this.chain_[4];\n    let f, k;\n\n    // TODO(user): Try to unroll this loop to speed up the computation.\n    for (let i = 0; i < 80; i++) {\n      if (i < 40) {\n        if (i < 20) {\n          f = d ^ (b & (c ^ d));\n          k = 0x5a827999;\n        } else {\n          f = b ^ c ^ d;\n          k = 0x6ed9eba1;\n        }\n      } else {\n        if (i < 60) {\n          f = (b & c) | (d & (b | c));\n          k = 0x8f1bbcdc;\n        } else {\n          f = b ^ c ^ d;\n          k = 0xca62c1d6;\n        }\n      }\n\n      const t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\n      e = d;\n      d = c;\n      c = ((b << 30) | (b >>> 2)) & 0xffffffff;\n      b = a;\n      a = t;\n    }\n\n    this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\n    this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\n    this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\n    this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\n    this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\n  }\n\n  update(bytes?: number[] | Uint8Array | string, length?: number): void {\n    // TODO(johnlenz): tighten the function signature and remove this check\n    if (bytes == null) {\n      return;\n    }\n\n    if (length === undefined) {\n      length = bytes.length;\n    }\n\n    const lengthMinusBlock = length - this.blockSize;\n    let n = 0;\n    // Using local instead of member variables gives ~5% speedup on Firefox 16.\n    const buf = this.buf_;\n    let inbuf = this.inbuf_;\n\n    // The outer while loop should execute at most twice.\n    while (n < length) {\n      // When we have no data in the block to top up, we can directly process the\n      // input buffer (assuming it contains sufficient data). This gives ~25%\n      // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\n      // the data is provided in large chunks (or in multiples of 64 bytes).\n      if (inbuf === 0) {\n        while (n <= lengthMinusBlock) {\n          this.compress_(bytes, n);\n          n += this.blockSize;\n        }\n      }\n\n      if (typeof bytes === 'string') {\n        while (n < length) {\n          buf[inbuf] = bytes.charCodeAt(n);\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      } else {\n        while (n < length) {\n          buf[inbuf] = bytes[n];\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      }\n    }\n\n    this.inbuf_ = inbuf;\n    this.total_ += length;\n  }\n\n  /** @override */\n  digest(): number[] {\n    const digest: number[] = [];\n    let totalBits = this.total_ * 8;\n\n    // Add pad 0x80 0x00*.\n    if (this.inbuf_ < 56) {\n      this.update(this.pad_, 56 - this.inbuf_);\n    } else {\n      this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\n    }\n\n    // Add # bits.\n    for (let i = this.blockSize - 1; i >= 56; i--) {\n      this.buf_[i] = totalBits & 255;\n      totalBits /= 256; // Don't use bit-shifting here!\n    }\n\n    this.compress_(this.buf_);\n\n    let n = 0;\n    for (let i = 0; i < 5; i++) {\n      for (let j = 24; j >= 0; j -= 8) {\n        digest[n] = (this.chain_[i] >> j) & 255;\n        ++n;\n      }\n    }\n    return digest;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport type NextFn<T> = (value: T) => void;\nexport type ErrorFn = (error: Error) => void;\nexport type CompleteFn = () => void;\n\nexport interface Observer<T> {\n  // Called once for each value in a stream of values.\n  next: NextFn<T>;\n\n  // A stream terminates by a single call to EITHER error() or complete().\n  error: ErrorFn;\n\n  // No events will be sent to next() once complete() is called.\n  complete: CompleteFn;\n}\n\nexport type PartialObserver<T> = Partial<Observer<T>>;\n\n// TODO: Support also Unsubscribe.unsubscribe?\nexport type Unsubscribe = () => void;\n\n/**\n * The Subscribe interface has two forms - passing the inline function\n * callbacks, or a object interface with callback properties.\n */\nexport interface Subscribe<T> {\n  (next?: NextFn<T>, error?: ErrorFn, complete?: CompleteFn): Unsubscribe;\n  (observer: PartialObserver<T>): Unsubscribe;\n}\n\nexport interface Observable<T> {\n  // Subscribe method\n  subscribe: Subscribe<T>;\n}\n\nexport type Executor<T> = (observer: Observer<T>) => void;\n\n/**\n * Helper to make a Subscribe function (just like Promise helps make a\n * Thenable).\n *\n * @param executor Function which can make calls to a single Observer\n *     as a proxy.\n * @param onNoObservers Callback when count of Observers goes to zero.\n */\nexport function createSubscribe<T>(\n  executor: Executor<T>,\n  onNoObservers?: Executor<T>\n): Subscribe<T> {\n  const proxy = new ObserverProxy<T>(executor, onNoObservers);\n  return proxy.subscribe.bind(proxy);\n}\n\n/**\n * Implement fan-out for any number of Observers attached via a subscribe\n * function.\n */\nclass ObserverProxy<T> implements Observer<T> {\n  private observers: Array<Observer<T>> | undefined = [];\n  private unsubscribes: Unsubscribe[] = [];\n  private onNoObservers: Executor<T> | undefined;\n  private observerCount = 0;\n  // Micro-task scheduling by calling task.then().\n  private task = Promise.resolve();\n  private finalized = false;\n  private finalError: Error;\n\n  /**\n   * @param executor Function which can make calls to a single Observer\n   *     as a proxy.\n   * @param onNoObservers Callback when count of Observers goes to zero.\n   */\n  constructor(executor: Executor<T>, onNoObservers?: Executor<T>) {\n    this.onNoObservers = onNoObservers;\n    // Call the executor asynchronously so subscribers that are called\n    // synchronously after the creation of the subscribe function\n    // can still receive the very first value generated in the executor.\n    this.task\n      .then(() => {\n        executor(this);\n      })\n      .catch(e => {\n        this.error(e);\n      });\n  }\n\n  next(value: T): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.next(value);\n    });\n  }\n\n  error(error: Error): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.error(error);\n    });\n    this.close(error);\n  }\n\n  complete(): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.complete();\n    });\n    this.close();\n  }\n\n  /**\n   * Subscribe function that can be used to add an Observer to the fan-out list.\n   *\n   * - We require that no event is sent to a subscriber sychronously to their\n   *   call to subscribe().\n   */\n  subscribe(\n    nextOrObserver: PartialObserver<T> | Function,\n    error?: ErrorFn,\n    complete?: CompleteFn\n  ): Unsubscribe {\n    let observer: Observer<T>;\n\n    if (\n      nextOrObserver === undefined &&\n      error === undefined &&\n      complete === undefined\n    ) {\n      throw new Error('Missing Observer.');\n    }\n\n    // Assemble an Observer object when passed as callback functions.\n    if (implementsAnyMethods(nextOrObserver, ['next', 'error', 'complete'])) {\n      observer = nextOrObserver as Observer<T>;\n    } else {\n      observer = {\n        next: nextOrObserver as NextFn<T>,\n        error,\n        complete\n      } as Observer<T>;\n    }\n\n    if (observer.next === undefined) {\n      observer.next = noop as NextFn<T>;\n    }\n    if (observer.error === undefined) {\n      observer.error = noop as ErrorFn;\n    }\n    if (observer.complete === undefined) {\n      observer.complete = noop as CompleteFn;\n    }\n\n    const unsub = this.unsubscribeOne.bind(this, this.observers!.length);\n\n    // Attempt to subscribe to a terminated Observable - we\n    // just respond to the Observer with the final error or complete\n    // event.\n    if (this.finalized) {\n      // tslint:disable-next-line:no-floating-promises\n      this.task.then(() => {\n        try {\n          if (this.finalError) {\n            observer.error(this.finalError);\n          } else {\n            observer.complete();\n          }\n        } catch (e) {\n          // nothing\n        }\n        return;\n      });\n    }\n\n    this.observers!.push(observer as Observer<T>);\n\n    return unsub;\n  }\n\n  // Unsubscribe is synchronous - we guarantee that no events are sent to\n  // any unsubscribed Observer.\n  private unsubscribeOne(i: number): void {\n    if (this.observers === undefined || this.observers[i] === undefined) {\n      return;\n    }\n\n    delete this.observers[i];\n\n    this.observerCount -= 1;\n    if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n      this.onNoObservers(this);\n    }\n  }\n\n  private forEachObserver(fn: (observer: Observer<T>) => void): void {\n    if (this.finalized) {\n      // Already closed by previous event....just eat the additional values.\n      return;\n    }\n\n    // Since sendOne calls asynchronously - there is no chance that\n    // this.observers will become undefined.\n    for (let i = 0; i < this.observers!.length; i++) {\n      this.sendOne(i, fn);\n    }\n  }\n\n  // Call the Observer via one of it's callback function. We are careful to\n  // confirm that the observe has not been unsubscribed since this asynchronous\n  // function had been queued.\n  private sendOne(i: number, fn: (observer: Observer<T>) => void): void {\n    // Execute the callback asynchronously\n    // tslint:disable-next-line:no-floating-promises\n    this.task.then(() => {\n      if (this.observers !== undefined && this.observers[i] !== undefined) {\n        try {\n          fn(this.observers[i]);\n        } catch (e) {\n          // Ignore exceptions raised in Observers or missing methods of an\n          // Observer.\n          // Log error to console. b/31404806\n          if (typeof console !== 'undefined' && console.error) {\n            console.error(e);\n          }\n        }\n      }\n    });\n  }\n\n  private close(err?: Error): void {\n    if (this.finalized) {\n      return;\n    }\n    this.finalized = true;\n    if (err !== undefined) {\n      this.finalError = err;\n    }\n    // Proxy is no longer needed - garbage collect references\n    // tslint:disable-next-line:no-floating-promises\n    this.task.then(() => {\n      this.observers = undefined;\n      this.onNoObservers = undefined;\n    });\n  }\n}\n\n/** Turn synchronous function into one called asynchronously. */\nexport function async(fn: Function, onError?: ErrorFn): Function {\n  return (...args: unknown[]) => {\n    Promise.resolve(true)\n      .then(() => {\n        fn(...args);\n      })\n      .catch((error: Error) => {\n        if (onError) {\n          onError(error);\n        }\n      });\n  };\n}\n\n/**\n * Return true if the object passed in implements any of the named methods.\n */\nfunction implementsAnyMethods(\n  obj: { [key: string]: unknown },\n  methods: string[]\n): boolean {\n  if (typeof obj !== 'object' || obj === null) {\n    return false;\n  }\n\n  for (const method of methods) {\n    if (method in obj && typeof obj[method] === 'function') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction noop(): void {\n  // do nothing\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Check to make sure the appropriate number of arguments are provided for a public function.\n * Throws an error if it fails.\n *\n * @param fnName The function name\n * @param minCount The minimum number of arguments to allow for the function call\n * @param maxCount The maximum number of argument to allow for the function call\n * @param argCount The actual number of arguments provided.\n */\nexport const validateArgCount = function(\n  fnName: string,\n  minCount: number,\n  maxCount: number,\n  argCount: number\n): void {\n  let argError;\n  if (argCount < minCount) {\n    argError = 'at least ' + minCount;\n  } else if (argCount > maxCount) {\n    argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\n  }\n  if (argError) {\n    const error =\n      fnName +\n      ' failed: Was called with ' +\n      argCount +\n      (argCount === 1 ? ' argument.' : ' arguments.') +\n      ' Expects ' +\n      argError +\n      '.';\n    throw new Error(error);\n  }\n};\n\n/**\n * Generates a string to prefix an error message about failed argument validation\n *\n * @param fnName The function name\n * @param argumentNumber The index of the argument\n * @param optional Whether or not the argument is optional\n * @return The prefix to add to the error thrown for validation.\n */\nexport function errorPrefix(\n  fnName: string,\n  argumentNumber: number,\n  optional: boolean\n): string {\n  let argName = '';\n  switch (argumentNumber) {\n    case 1:\n      argName = optional ? 'first' : 'First';\n      break;\n    case 2:\n      argName = optional ? 'second' : 'Second';\n      break;\n    case 3:\n      argName = optional ? 'third' : 'Third';\n      break;\n    case 4:\n      argName = optional ? 'fourth' : 'Fourth';\n      break;\n    default:\n      throw new Error(\n        'errorPrefix called with argumentNumber > 4.  Need to update it?'\n      );\n  }\n\n  let error = fnName + ' failed: ';\n\n  error += argName + ' argument ';\n  return error;\n}\n\n/**\n * @param fnName\n * @param argumentNumber\n * @param namespace\n * @param optional\n */\nexport function validateNamespace(\n  fnName: string,\n  argumentNumber: number,\n  namespace: string,\n  optional: boolean\n): void {\n  if (optional && !namespace) {\n    return;\n  }\n  if (typeof namespace !== 'string') {\n    //TODO: I should do more validation here. We only allow certain chars in namespaces.\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid firebase namespace.'\n    );\n  }\n}\n\nexport function validateCallback(\n  fnName: string,\n  argumentNumber: number,\n  callback: Function,\n  optional: boolean\n): void {\n  if (optional && !callback) {\n    return;\n  }\n  if (typeof callback !== 'function') {\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid function.'\n    );\n  }\n}\n\nexport function validateContextObject(\n  fnName: string,\n  argumentNumber: number,\n  context: unknown,\n  optional: boolean\n): void {\n  if (optional && !context) {\n    return;\n  }\n  if (typeof context !== 'object' || context === null) {\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid context object.'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from './assert';\n\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\n// so it's been modified.\n\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\n// pair).\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\n\n/**\n * @param {string} str\n * @return {Array}\n */\nexport const stringToByteArray = function(str: string): number[] {\n  const out: number[] = [];\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i);\n\n    // Is this the lead surrogate in a surrogate pair?\n    if (c >= 0xd800 && c <= 0xdbff) {\n      const high = c - 0xd800; // the high 10 bits.\n      i++;\n      assert(i < str.length, 'Surrogate pair missing trail surrogate.');\n      const low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\n      c = 0x10000 + (high << 10) + low;\n    }\n\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192;\n      out[p++] = (c & 63) | 128;\n    } else if (c < 65536) {\n      out[p++] = (c >> 12) | 224;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    } else {\n      out[p++] = (c >> 18) | 240;\n      out[p++] = ((c >> 12) & 63) | 128;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    }\n  }\n  return out;\n};\n\n/**\n * Calculate length without actually converting; useful for doing cheaper validation.\n * @param {string} str\n * @return {number}\n */\nexport const stringLength = function(str: string): number {\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    const c = str.charCodeAt(i);\n    if (c < 128) {\n      p++;\n    } else if (c < 2048) {\n      p += 2;\n    } else if (c >= 0xd800 && c <= 0xdbff) {\n      // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\n      p += 4;\n      i++; // skip trail surrogate.\n    } else {\n      p += 3;\n    }\n  }\n  return p;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from './src/assert';\nexport * from './src/crypt';\nexport * from './src/constants';\nexport * from './src/deepCopy';\nexport * from './src/deferred';\nexport * from './src/environment';\nexport * from './src/errors';\nexport * from './src/json';\nexport * from './src/jwt';\nexport * from './src/obj';\nexport * from './src/query';\nexport * from './src/sha1';\nexport * from './src/subscribe';\nexport * from './src/validation';\nexport * from './src/utf8';\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A container for all of the Logger instances\n */\nexport const instances: Logger[] = [];\n\n/**\n * The JS SDK supports 5 log levels and also allows a user the ability to\n * silence the logs altogether.\n *\n * The order is a follows:\n * DEBUG < VERBOSE < INFO < WARN < ERROR\n *\n * All of the log types above the current log level will be captured (i.e. if\n * you set the log level to `INFO`, errors will still be logged, but `DEBUG` and\n * `VERBOSE` logs will not)\n */\nexport enum LogLevel {\n  DEBUG,\n  VERBOSE,\n  INFO,\n  WARN,\n  ERROR,\n  SILENT\n}\n\n/**\n * The default log level\n */\nconst defaultLogLevel: LogLevel = LogLevel.INFO;\n\n/**\n * We allow users the ability to pass their own log handler. We will pass the\n * type of log, the current log level, and any other arguments passed (i.e. the\n * messages that the user wants to log) to this function.\n */\nexport type LogHandler = (\n  loggerInstance: Logger,\n  logType: LogLevel,\n  ...args: unknown[]\n) => void;\n\n/**\n * The default log handler will forward DEBUG, VERBOSE, INFO, WARN, and ERROR\n * messages on to their corresponding console counterparts (if the log method\n * is supported by the current log level)\n */\nconst defaultLogHandler: LogHandler = (instance, logType, ...args): void => {\n  if (logType < instance.logLevel) {\n    return;\n  }\n  const now = new Date().toISOString();\n  switch (logType) {\n    /**\n     * By default, `console.debug` is not displayed in the developer console (in\n     * chrome). To avoid forcing users to have to opt-in to these logs twice\n     * (i.e. once for firebase, and once in the console), we are sending `DEBUG`\n     * logs to the `console.log` function.\n     */\n    case LogLevel.DEBUG:\n      console.log(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.VERBOSE:\n      console.log(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.INFO:\n      console.info(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.WARN:\n      console.warn(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.ERROR:\n      console.error(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    default:\n      throw new Error(\n        `Attempted to log a message with an invalid logType (value: ${logType})`\n      );\n  }\n};\n\nexport class Logger {\n  /**\n   * Gives you an instance of a Logger to capture messages according to\n   * Firebase's logging scheme.\n   *\n   * @param name The name that the logs will be associated with\n   */\n  constructor(public name: string) {\n    /**\n     * Capture the current instance for later use\n     */\n    instances.push(this);\n  }\n\n  /**\n   * The log level of the given Logger instance.\n   */\n  private _logLevel = defaultLogLevel;\n  get logLevel(): LogLevel {\n    return this._logLevel;\n  }\n  set logLevel(val: LogLevel) {\n    if (!(val in LogLevel)) {\n      throw new TypeError('Invalid value assigned to `logLevel`');\n    }\n    this._logLevel = val;\n  }\n\n  /**\n   * The log handler for the Logger instance.\n   */\n  private _logHandler: LogHandler = defaultLogHandler;\n  get logHandler(): LogHandler {\n    return this._logHandler;\n  }\n  set logHandler(val: LogHandler) {\n    if (typeof val !== 'function') {\n      throw new TypeError('Value assigned to `logHandler` must be a function');\n    }\n    this._logHandler = val;\n  }\n\n  /**\n   * The functions below are all based on the `console` interface\n   */\n\n  debug(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.DEBUG, ...args);\n  }\n  log(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.VERBOSE, ...args);\n  }\n  info(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.INFO, ...args);\n  }\n  warn(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.WARN, ...args);\n  }\n  error(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.ERROR, ...args);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  _FirebaseNamespace,\n  FirebaseService,\n  FirebaseAppInternals\n} from '@firebase/app-types/private';\nimport { deepCopy, deepExtend } from '@firebase/util';\nimport { AppError, ERROR_FACTORY } from './errors';\nimport { DEFAULT_ENTRY_NAME } from './constants';\n\ninterface ServicesCache {\n  [name: string]: {\n    [serviceName: string]: FirebaseService;\n  };\n}\n\n// An array to capture listeners before the true auth functions\n// exist\nlet tokenListeners: Array<(token: string | null) => void> = [];\n\n/**\n * Global context object for a collection of services using\n * a shared authentication state.\n */\nexport class FirebaseAppImpl implements FirebaseApp {\n  private readonly options_: FirebaseOptions;\n  private readonly name_: string;\n  private isDeleted_ = false;\n  private services_: ServicesCache = {};\n  private automaticDataCollectionEnabled_: boolean;\n\n  INTERNAL: FirebaseAppInternals;\n\n  constructor(\n    options: FirebaseOptions,\n    config: FirebaseAppConfig,\n    private readonly firebase_: _FirebaseNamespace\n  ) {\n    this.name_ = config.name!;\n    this.automaticDataCollectionEnabled_ =\n      config.automaticDataCollectionEnabled || false;\n    this.options_ = deepCopy<FirebaseOptions>(options);\n    this.INTERNAL = {\n      getUid: () => null,\n      getToken: () => Promise.resolve(null),\n      addAuthTokenListener: (callback: (token: string | null) => void) => {\n        tokenListeners.push(callback);\n        // Make sure callback is called, asynchronously, in the absence of the auth module\n        setTimeout(() => callback(null), 0);\n      },\n      removeAuthTokenListener: callback => {\n        tokenListeners = tokenListeners.filter(\n          listener => listener !== callback\n        );\n      }\n    };\n  }\n\n  get automaticDataCollectionEnabled(): boolean {\n    this.checkDestroyed_();\n    return this.automaticDataCollectionEnabled_;\n  }\n\n  set automaticDataCollectionEnabled(val) {\n    this.checkDestroyed_();\n    this.automaticDataCollectionEnabled_ = val;\n  }\n\n  get name(): string {\n    this.checkDestroyed_();\n    return this.name_;\n  }\n\n  get options(): FirebaseOptions {\n    this.checkDestroyed_();\n    return this.options_;\n  }\n\n  delete(): Promise<void> {\n    return new Promise(resolve => {\n      this.checkDestroyed_();\n      resolve();\n    })\n      .then(() => {\n        this.firebase_.INTERNAL.removeApp(this.name_);\n        const services: FirebaseService[] = [];\n\n        for (const serviceKey of Object.keys(this.services_)) {\n          for (const instanceKey of Object.keys(this.services_[serviceKey])) {\n            services.push(this.services_[serviceKey][instanceKey]);\n          }\n        }\n\n        return Promise.all(\n          services\n            .filter(service => 'INTERNAL' in service)\n            .map(service => service.INTERNAL!.delete())\n        );\n      })\n      .then(\n        (): void => {\n          this.isDeleted_ = true;\n          this.services_ = {};\n        }\n      );\n  }\n\n  /**\n   * Return a service instance associated with this app (creating it\n   * on demand), identified by the passed instanceIdentifier.\n   *\n   * NOTE: Currently storage is the only one that is leveraging this\n   * functionality. They invoke it by calling:\n   *\n   * ```javascript\n   * firebase.app().storage('STORAGE BUCKET ID')\n   * ```\n   *\n   * The service name is passed to this already\n   * @internal\n   */\n  _getService(\n    name: string,\n    instanceIdentifier: string = DEFAULT_ENTRY_NAME\n  ): FirebaseService {\n    this.checkDestroyed_();\n\n    if (!this.services_[name]) {\n      this.services_[name] = {};\n    }\n\n    if (!this.services_[name][instanceIdentifier]) {\n      /**\n       * If a custom instance has been defined (i.e. not '[DEFAULT]')\n       * then we will pass that instance on, otherwise we pass `null`\n       */\n      const instanceSpecifier =\n        instanceIdentifier !== DEFAULT_ENTRY_NAME\n          ? instanceIdentifier\n          : undefined;\n      const service = this.firebase_.INTERNAL.factories[name](\n        this,\n        this.extendApp.bind(this),\n        instanceSpecifier\n      );\n      this.services_[name][instanceIdentifier] = service;\n    }\n\n    return this.services_[name][instanceIdentifier];\n  }\n\n  /**\n   * Callback function used to extend an App instance at the time\n   * of service instance creation.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private extendApp(props: { [name: string]: any }): void {\n    // Copy the object onto the FirebaseAppImpl prototype\n    deepExtend(this, props);\n\n    /**\n     * If the app has overwritten the addAuthTokenListener stub, forward\n     * the active token listeners on to the true fxn.\n     *\n     * TODO: This function is required due to our current module\n     * structure. Once we are able to rely strictly upon a single module\n     * implementation, this code should be refactored and Auth should\n     * provide these stubs and the upgrade logic\n     */\n    if (props.INTERNAL && props.INTERNAL.addAuthTokenListener) {\n      tokenListeners.forEach(listener => {\n        this.INTERNAL.addAuthTokenListener(listener);\n      });\n      tokenListeners = [];\n    }\n  }\n\n  /**\n   * This function will throw an Error if the App has already been deleted -\n   * use before performing API actions on the App.\n   */\n  private checkDestroyed_(): void {\n    if (this.isDeleted_) {\n      throw ERROR_FACTORY.create(AppError.APP_DELETED, { name: this.name_ });\n    }\n  }\n}\n\n// Prevent dead-code elimination of these methods w/o invalid property\n// copying.\n(FirebaseAppImpl.prototype.name && FirebaseAppImpl.prototype.options) ||\n  FirebaseAppImpl.prototype.delete ||\n  console.log('dc');\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseNamespace,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  _FirebaseNamespace,\n  FirebaseService,\n  FirebaseServiceFactory,\n  FirebaseServiceNamespace,\n  AppHook\n} from '@firebase/app-types/private';\nimport { deepExtend, contains } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { ERROR_FACTORY, AppError } from './errors';\nimport { FirebaseAppLiteImpl } from './lite/firebaseAppLite';\nimport { DEFAULT_ENTRY_NAME } from './constants';\nimport { version } from '../../firebase/package.json';\n\n/**\n * Because auth can't share code with other components, we attach the utility functions\n * in an internal namespace to share code.\n * This function return a firebase namespace object without\n * any utility functions, so it can be shared between the regular firebaseNamespace and\n * the lite version.\n */\nexport function createFirebaseNamespaceCore(\n  firebaseAppImpl: typeof FirebaseAppImpl | typeof FirebaseAppLiteImpl\n): FirebaseNamespace {\n  const apps: { [name: string]: FirebaseApp } = {};\n  const factories: { [service: string]: FirebaseServiceFactory } = {};\n  const appHooks: { [service: string]: AppHook } = {};\n\n  // A namespace is a plain JavaScript Object.\n  const namespace: FirebaseNamespace = {\n    // Hack to prevent Babel from modifying the object returned\n    // as the firebase namespace.\n    // @ts-ignore\n    __esModule: true,\n    initializeApp,\n    // @ts-ignore\n    app,\n    // @ts-ignore\n    apps: null,\n    SDK_VERSION: version,\n    INTERNAL: {\n      registerService,\n      removeApp,\n      factories,\n      useAsService\n    }\n  };\n\n  // Inject a circular default export to allow Babel users who were previously\n  // using:\n  //\n  //   import firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase').default;\n  //\n  // instead of\n  //\n  //   import * as firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase');\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (namespace as any)['default'] = namespace;\n\n  // firebase.apps is a read-only getter.\n  Object.defineProperty(namespace, 'apps', {\n    get: getApps\n  });\n\n  /**\n   * Called by App.delete() - but before any services associated with the App\n   * are deleted.\n   */\n  function removeApp(name: string): void {\n    const app = apps[name];\n    callAppHooks(app, 'delete');\n    delete apps[name];\n  }\n\n  /**\n   * Get the App object for a given name (or DEFAULT).\n   */\n  function app(name?: string): FirebaseApp {\n    name = name || DEFAULT_ENTRY_NAME;\n    if (!contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.NO_APP, { name });\n    }\n    return apps[name];\n  }\n\n  // @ts-ignore\n  app['App'] = firebaseAppImpl;\n  /**\n   * Create a new App instance (name must be unique).\n   */\n  function initializeApp(\n    options: FirebaseOptions,\n    config?: FirebaseAppConfig\n  ): FirebaseApp;\n  function initializeApp(options: FirebaseOptions, name?: string): FirebaseApp;\n  function initializeApp(\n    options: FirebaseOptions,\n    rawConfig = {}\n  ): FirebaseApp {\n    if (typeof rawConfig !== 'object' || rawConfig === null) {\n      const name = rawConfig;\n      rawConfig = { name };\n    }\n\n    const config = rawConfig as FirebaseAppConfig;\n\n    if (config.name === undefined) {\n      config.name = DEFAULT_ENTRY_NAME;\n    }\n\n    const { name } = config;\n\n    if (typeof name !== 'string' || !name) {\n      throw ERROR_FACTORY.create(AppError.BAD_APP_NAME, { name: String(name) });\n    }\n\n    if (contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.DUPLICATE_APP, { name });\n    }\n\n    const app = new firebaseAppImpl(\n      options,\n      config,\n      namespace as _FirebaseNamespace\n    );\n\n    apps[name] = app;\n    callAppHooks(app, 'create');\n\n    return app;\n  }\n\n  /*\n   * Return an array of all the non-deleted FirebaseApps.\n   */\n  function getApps(): FirebaseApp[] {\n    // Make a copy so caller cannot mutate the apps list.\n    return Object.keys(apps).map(name => apps[name]);\n  }\n\n  /*\n   * Register a Firebase Service.\n   *\n   * firebase.INTERNAL.registerService()\n   *\n   * TODO: Implement serviceProperties.\n   */\n  function registerService(\n    name: string,\n    createService: FirebaseServiceFactory,\n    serviceProperties?: { [prop: string]: unknown },\n    appHook?: AppHook,\n    allowMultipleInstances = false\n  ): FirebaseServiceNamespace<FirebaseService> {\n    // Cannot re-register a service that already exists\n    if (factories[name]) {\n      throw ERROR_FACTORY.create(AppError.DUPLICATE_SERVICE, { name });\n    }\n\n    // Capture the service factory for later service instantiation\n    factories[name] = createService;\n\n    // Capture the appHook, if passed\n    if (appHook) {\n      appHooks[name] = appHook;\n\n      // Run the **new** app hook on all existing apps\n      getApps().forEach(app => {\n        appHook('create', app);\n      });\n    }\n\n    // The Service namespace is an accessor function ...\n    function serviceNamespace(appArg: FirebaseApp = app()): FirebaseService {\n      // @ts-ignore\n      if (typeof appArg[name] !== 'function') {\n        // Invalid argument.\n        // This happens in the following case: firebase.storage('gs:/')\n        throw ERROR_FACTORY.create(AppError.INVALID_APP_ARGUMENT, {\n          name\n        });\n      }\n\n      // Forward service instance lookup to the FirebaseApp.\n      // @ts-ignore\n      return appArg[name]();\n    }\n\n    // ... and a container for service-level properties.\n    if (serviceProperties !== undefined) {\n      deepExtend(serviceNamespace, serviceProperties);\n    }\n\n    // Monkey-patch the serviceNamespace onto the firebase namespace\n    // @ts-ignore\n    namespace[name] = serviceNamespace;\n\n    // Patch the FirebaseAppImpl prototype\n    // @ts-ignore\n    firebaseAppImpl.prototype[name] = function(...args) {\n      const serviceFxn = this._getService.bind(this, name);\n      return serviceFxn.apply(this, allowMultipleInstances ? args : []);\n    };\n\n    return serviceNamespace;\n  }\n\n  function callAppHooks(app: FirebaseApp, eventName: string): void {\n    for (const serviceName of Object.keys(factories)) {\n      // Ignore virtual services\n      const factoryName = useAsService(app, serviceName);\n      if (factoryName === null) {\n        return;\n      }\n\n      if (appHooks[factoryName]) {\n        appHooks[factoryName](eventName, app);\n      }\n    }\n  }\n\n  // Map the requested service to a registered service name\n  // (used to map auth to serverAuth service when needed).\n  function useAsService(app: FirebaseApp, name: string): string | null {\n    if (name === 'serverAuth') {\n      return null;\n    }\n\n    const useService = name;\n\n    return useService;\n  }\n\n  return namespace;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseNamespace } from '@firebase/app-types';\nimport { _FirebaseApp, _FirebaseNamespace } from '@firebase/app-types/private';\nimport { createSubscribe, deepExtend, ErrorFactory } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { createFirebaseNamespaceCore } from './firebaseNamespaceCore';\n\n/**\n * Return a firebase namespace object.\n *\n * In production, this will be called exactly once and the result\n * assigned to the 'firebase' global.  It may be called multiple times\n * in unit tests.\n */\nexport function createFirebaseNamespace(): FirebaseNamespace {\n  const namespace = createFirebaseNamespaceCore(FirebaseAppImpl);\n  (namespace as _FirebaseNamespace).INTERNAL = {\n    ...(namespace as _FirebaseNamespace).INTERNAL,\n    createFirebaseNamespace,\n    extendNamespace,\n    createSubscribe,\n    ErrorFactory,\n    deepExtend\n  };\n\n  /**\n   * Patch the top-level firebase namespace with additional properties.\n   *\n   * firebase.INTERNAL.extendNamespace()\n   */\n  function extendNamespace(props: { [prop: string]: unknown }): void {\n    deepExtend(namespace, props);\n  }\n\n  return namespace;\n}\n","import firebase from 'firebase/app'\n\nexport default firebase.initializeApp({\n  apiKey: \"AIzaSyA1LN0yN5_276Xn2MpJAaYXXbgADIWZdN4\",\n  authDomain: \"quarter-website.firebaseapp.com\",\n  databaseURL: \"https://quarter-website.firebaseio.com\",\n  projectId: \"quarter-website\",\n  storageBucket: \"quarter-website.appspot.com\",\n  messagingSenderId: \"64477425647\",\n  appId: \"1:64477425647:web:ac0d2eefe13f81f7\"\n})\n\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { jsonEval, stringify } from '@firebase/util';\n\n/**\n * Wraps a DOM Storage object and:\n * - automatically encode objects as JSON strings before storing them to allow us to store arbitrary types.\n * - prefixes names with \"firebase:\" to avoid collisions with app data.\n *\n * We automatically (see storage.js) create two such wrappers, one for sessionStorage,\n * and one for localStorage.\n *\n * @constructor\n */\nexport class DOMStorageWrapper {\n  // Use a prefix to avoid collisions with other stuff saved by the app.\n  private prefix_ = 'firebase:';\n\n  /**\n   * @param {Storage} domStorage_ The underlying storage object (e.g. localStorage or sessionStorage)\n   */\n  constructor(private domStorage_: Storage) {}\n\n  /**\n   * @param {string} key The key to save the value under\n   * @param {?Object} value The value being stored, or null to remove the key.\n   */\n  set(key: string, value: any | null) {\n    if (value == null) {\n      this.domStorage_.removeItem(this.prefixedName_(key));\n    } else {\n      this.domStorage_.setItem(this.prefixedName_(key), stringify(value));\n    }\n  }\n\n  /**\n   * @param {string} key\n   * @return {*} The value that was stored under this key, or null\n   */\n  get(key: string): any {\n    const storedVal = this.domStorage_.getItem(this.prefixedName_(key));\n    if (storedVal == null) {\n      return null;\n    } else {\n      return jsonEval(storedVal);\n    }\n  }\n\n  /**\n   * @param {string} key\n   */\n  remove(key: string) {\n    this.domStorage_.removeItem(this.prefixedName_(key));\n  }\n\n  isInMemoryStorage: boolean;\n\n  /**\n   * @param {string} name\n   * @return {string}\n   */\n  prefixedName_(name: string): string {\n    return this.prefix_ + name;\n  }\n\n  toString(): string {\n    return this.domStorage_.toString();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { contains } from '@firebase/util';\n\n/**\n * An in-memory storage implementation that matches the API of DOMStorageWrapper\n * (TODO: create interface for both to implement).\n *\n * @constructor\n */\nexport class MemoryStorage {\n  private cache_: { [k: string]: any } = {};\n\n  set(key: string, value: any | null) {\n    if (value == null) {\n      delete this.cache_[key];\n    } else {\n      this.cache_[key] = value;\n    }\n  }\n\n  get(key: string): any {\n    if (contains(this.cache_, key)) {\n      return this.cache_[key];\n    }\n    return null;\n  }\n\n  remove(key: string) {\n    delete this.cache_[key];\n  }\n\n  isInMemoryStorage = true;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DOMStorageWrapper } from './DOMStorageWrapper';\nimport { MemoryStorage } from './MemoryStorage';\n\ndeclare const window: any;\n\n/**\n * Helper to create a DOMStorageWrapper or else fall back to MemoryStorage.\n * TODO: Once MemoryStorage and DOMStorageWrapper have a shared interface this method annotation should change\n * to reflect this type\n *\n * @param {string} domStorageName Name of the underlying storage object\n *   (e.g. 'localStorage' or 'sessionStorage').\n * @return {?} Turning off type information until a common interface is defined.\n */\nconst createStoragefor = function(\n  domStorageName: string\n): DOMStorageWrapper | MemoryStorage {\n  try {\n    // NOTE: just accessing \"localStorage\" or \"window['localStorage']\" may throw a security exception,\n    // so it must be inside the try/catch.\n    if (\n      typeof window !== 'undefined' &&\n      typeof window[domStorageName] !== 'undefined'\n    ) {\n      // Need to test cache. Just because it's here doesn't mean it works\n      const domStorage = window[domStorageName];\n      domStorage.setItem('firebase:sentinel', 'cache');\n      domStorage.removeItem('firebase:sentinel');\n      return new DOMStorageWrapper(domStorage);\n    }\n  } catch (e) {}\n\n  // Failed to create wrapper.  Just return in-memory storage.\n  // TODO: log?\n  return new MemoryStorage();\n};\n\n/** A storage object that lasts across sessions */\nexport const PersistentStorage = createStoragefor('localStorage');\n\n/** A storage object that only lasts one session */\nexport const SessionStorage = createStoragefor('sessionStorage');\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Query } from '../../api/Query';\n\ndeclare const window: any;\ndeclare const Windows: any;\n\nimport { assert } from '@firebase/util';\nimport { forEach } from '@firebase/util';\nimport { base64 } from '@firebase/util';\nimport { Sha1 } from '@firebase/util';\nimport { stringToByteArray } from '@firebase/util';\nimport { stringify } from '@firebase/util';\nimport { SessionStorage } from '../storage/storage';\nimport { isNodeSdk } from '@firebase/util';\nimport { Logger, LogLevel } from '@firebase/logger';\n\nconst logClient = new Logger('@firebase/database');\n\n/**\n * Returns a locally-unique ID (generated by just incrementing up from 0 each time its called).\n * @type {function(): number} Generated ID.\n */\nexport const LUIDGenerator: () => number = (function() {\n  let id = 1;\n  return function() {\n    return id++;\n  };\n})();\n\n/**\n * Sha1 hash of the input string\n * @param {!string} str The string to hash\n * @return {!string} The resulting hash\n */\nexport const sha1 = function(str: string): string {\n  const utf8Bytes = stringToByteArray(str);\n  const sha1 = new Sha1();\n  sha1.update(utf8Bytes);\n  const sha1Bytes = sha1.digest();\n  return base64.encodeByteArray(sha1Bytes);\n};\n\n/**\n * @param {...*} var_args\n * @return {string}\n * @private\n */\nconst buildLogMessage_ = function(...var_args: any[]): string {\n  let message = '';\n  for (let i = 0; i < var_args.length; i++) {\n    if (\n      Array.isArray(var_args[i]) ||\n      (var_args[i] &&\n        typeof var_args[i] === 'object' &&\n        typeof var_args[i].length === 'number')\n    ) {\n      message += buildLogMessage_.apply(null, var_args[i]);\n    } else if (typeof var_args[i] === 'object') {\n      message += stringify(var_args[i]);\n    } else {\n      message += var_args[i];\n    }\n    message += ' ';\n  }\n\n  return message;\n};\n\n/**\n * Use this for all debug messages in Firebase.\n * @type {?function(string)}\n */\nexport let logger: ((a: string) => void) | null = null;\n\n/**\n * Flag to check for log availability on first log message\n * @type {boolean}\n * @private\n */\nlet firstLog_ = true;\n\n/**\n * The implementation of Firebase.enableLogging (defined here to break dependencies)\n * @param {boolean|?function(string)} logger_ A flag to turn on logging, or a custom logger\n * @param {boolean=} persistent Whether or not to persist logging settings across refreshes\n */\nexport const enableLogging = function(\n  logger_?: boolean | ((a: string) => void) | null,\n  persistent?: boolean\n) {\n  assert(\n    !persistent || (logger_ === true || logger_ === false),\n    \"Can't turn on custom loggers persistently.\"\n  );\n  if (logger_ === true) {\n    logClient.logLevel = LogLevel.VERBOSE;\n    logger = logClient.log.bind(logClient);\n    if (persistent) SessionStorage.set('logging_enabled', true);\n  } else if (typeof logger_ === 'function') {\n    logger = logger_;\n  } else {\n    logger = null;\n    SessionStorage.remove('logging_enabled');\n  }\n};\n\n/**\n *\n * @param {...(string|Arguments)} var_args\n */\nexport const log = function(...var_args: string[]) {\n  if (firstLog_ === true) {\n    firstLog_ = false;\n    if (logger === null && SessionStorage.get('logging_enabled') === true)\n      enableLogging(true);\n  }\n\n  if (logger) {\n    const message = buildLogMessage_.apply(null, var_args);\n    logger(message);\n  }\n};\n\n/**\n * @param {!string} prefix\n * @return {function(...[*])}\n */\nexport const logWrapper = function(\n  prefix: string\n): (...var_args: any[]) => void {\n  return function(...var_args: any[]) {\n    log(prefix, ...var_args);\n  };\n};\n\n/**\n * @param {...string} var_args\n */\nexport const error = function(...var_args: string[]) {\n  const message = 'FIREBASE INTERNAL ERROR: ' + buildLogMessage_(...var_args);\n  logClient.error(message);\n};\n\n/**\n * @param {...string} var_args\n */\nexport const fatal = function(...var_args: string[]) {\n  const message = `FIREBASE FATAL ERROR: ${buildLogMessage_(...var_args)}`;\n  logClient.error(message);\n  throw new Error(message);\n};\n\n/**\n * @param {...*} var_args\n */\nexport const warn = function(...var_args: any[]) {\n  const message = 'FIREBASE WARNING: ' + buildLogMessage_(...var_args);\n  logClient.warn(message);\n};\n\n/**\n * Logs a warning if the containing page uses https. Called when a call to new Firebase\n * does not use https.\n */\nexport const warnIfPageIsSecure = function() {\n  // Be very careful accessing browser globals. Who knows what may or may not exist.\n  if (\n    typeof window !== 'undefined' &&\n    window.location &&\n    window.location.protocol &&\n    window.location.protocol.indexOf('https:') !== -1\n  ) {\n    warn(\n      'Insecure Firebase access from a secure page. ' +\n        'Please use https in calls to new Firebase().'\n    );\n  }\n};\n\n/**\n * @param {!String} methodName\n */\nexport const warnAboutUnsupportedMethod = function(methodName: string) {\n  warn(\n    methodName +\n      ' is unsupported and will likely change soon.  ' +\n      'Please do not use.'\n  );\n};\n\n/**\n * Returns true if data is NaN, or +/- Infinity.\n * @param {*} data\n * @return {boolean}\n */\nexport const isInvalidJSONNumber = function(data: any): boolean {\n  return (\n    typeof data === 'number' &&\n    (data != data || // NaN\n      data == Number.POSITIVE_INFINITY ||\n      data == Number.NEGATIVE_INFINITY)\n  );\n};\n\n/**\n * @param {function()} fn\n */\nexport const executeWhenDOMReady = function(fn: () => void) {\n  if (isNodeSdk() || document.readyState === 'complete') {\n    fn();\n  } else {\n    // Modeled after jQuery. Try DOMContentLoaded and onreadystatechange (which\n    // fire before onload), but fall back to onload.\n\n    let called = false;\n    let wrappedFn = function() {\n      if (!document.body) {\n        setTimeout(wrappedFn, Math.floor(10));\n        return;\n      }\n\n      if (!called) {\n        called = true;\n        fn();\n      }\n    };\n\n    if (document.addEventListener) {\n      document.addEventListener('DOMContentLoaded', wrappedFn, false);\n      // fallback to onload.\n      window.addEventListener('load', wrappedFn, false);\n    } else if ((document as any).attachEvent) {\n      // IE.\n      (document as any).attachEvent('onreadystatechange', function() {\n        if (document.readyState === 'complete') wrappedFn();\n      });\n      // fallback to onload.\n      (window as any).attachEvent('onload', wrappedFn);\n\n      // jQuery has an extra hack for IE that we could employ (based on\n      // http://javascript.nwbox.com/IEContentLoaded/) But it looks really old.\n      // I'm hoping we don't need it.\n    }\n  }\n};\n\n/**\n * Minimum key name. Invalid for actual data, used as a marker to sort before any valid names\n * @type {!string}\n */\nexport const MIN_NAME = '[MIN_NAME]';\n\n/**\n * Maximum key name. Invalid for actual data, used as a marker to sort above any valid names\n * @type {!string}\n */\nexport const MAX_NAME = '[MAX_NAME]';\n\n/**\n * Compares valid Firebase key names, plus min and max name\n * @param {!string} a\n * @param {!string} b\n * @return {!number}\n */\nexport const nameCompare = function(a: string, b: string): number {\n  if (a === b) {\n    return 0;\n  } else if (a === MIN_NAME || b === MAX_NAME) {\n    return -1;\n  } else if (b === MIN_NAME || a === MAX_NAME) {\n    return 1;\n  } else {\n    const aAsInt = tryParseInt(a),\n      bAsInt = tryParseInt(b);\n\n    if (aAsInt !== null) {\n      if (bAsInt !== null) {\n        return aAsInt - bAsInt == 0 ? a.length - b.length : aAsInt - bAsInt;\n      } else {\n        return -1;\n      }\n    } else if (bAsInt !== null) {\n      return 1;\n    } else {\n      return a < b ? -1 : 1;\n    }\n  }\n};\n\n/**\n * @param {!string} a\n * @param {!string} b\n * @return {!number} comparison result.\n */\nexport const stringCompare = function(a: string, b: string): number {\n  if (a === b) {\n    return 0;\n  } else if (a < b) {\n    return -1;\n  } else {\n    return 1;\n  }\n};\n\n/**\n * @param {string} key\n * @param {Object} obj\n * @return {*}\n */\nexport const requireKey = function(\n  key: string,\n  obj: { [k: string]: any }\n): any {\n  if (obj && key in obj) {\n    return obj[key];\n  } else {\n    throw new Error(\n      'Missing required key (' + key + ') in object: ' + stringify(obj)\n    );\n  }\n};\n\n/**\n * @param {*} obj\n * @return {string}\n */\nexport const ObjectToUniqueKey = function(obj: any): string {\n  if (typeof obj !== 'object' || obj === null) return stringify(obj);\n\n  const keys = [];\n  for (let k in obj) {\n    keys.push(k);\n  }\n\n  // Export as json, but with the keys sorted.\n  keys.sort();\n  let key = '{';\n  for (let i = 0; i < keys.length; i++) {\n    if (i !== 0) key += ',';\n    key += stringify(keys[i]);\n    key += ':';\n    key += ObjectToUniqueKey(obj[keys[i]]);\n  }\n\n  key += '}';\n  return key;\n};\n\n/**\n * Splits a string into a number of smaller segments of maximum size\n * @param {!string} str The string\n * @param {!number} segsize The maximum number of chars in the string.\n * @return {Array.<string>} The string, split into appropriately-sized chunks\n */\nexport const splitStringBySize = function(\n  str: string,\n  segsize: number\n): string[] {\n  const len = str.length;\n\n  if (len <= segsize) {\n    return [str];\n  }\n\n  const dataSegs = [];\n  for (let c = 0; c < len; c += segsize) {\n    if (c + segsize > len) {\n      dataSegs.push(str.substring(c, len));\n    } else {\n      dataSegs.push(str.substring(c, c + segsize));\n    }\n  }\n  return dataSegs;\n};\n\n/**\n * Apply a function to each (key, value) pair in an object or\n * apply a function to each (index, value) pair in an array\n * @param {!(Object|Array)} obj The object or array to iterate over\n * @param {function(?, ?)} fn The function to apply\n */\nexport const each = function(\n  obj: Object | Array<any>,\n  fn: (v?: any, k?: any) => void\n) {\n  if (Array.isArray(obj)) {\n    for (let i = 0; i < obj.length; ++i) {\n      fn(i, obj[i]);\n    }\n  } else {\n    /**\n     * in the conversion of code we removed the goog.object.forEach\n     * function which did a value,key callback. We standardized on\n     * a single impl that does a key, value callback. So we invert\n     * to not have to touch the `each` code points\n     */\n    forEach(obj, (key: any, val: any) => fn(val, key));\n  }\n};\n\n/**\n * Like goog.bind, but doesn't bother to create a closure if opt_context is null/undefined.\n * @param {function(*)} callback Callback function.\n * @param {?Object=} context Optional context to bind to.\n * @return {function(*)}\n */\nexport const bindCallback = function(\n  callback: (a: any) => void,\n  context?: object | null\n): Function {\n  return context ? callback.bind(context) : callback;\n};\n\n/**\n * Borrowed from http://hg.secondlife.com/llsd/src/tip/js/typedarray.js (MIT License)\n * I made one modification at the end and removed the NaN / Infinity\n * handling (since it seemed broken [caused an overflow] and we don't need it).  See MJL comments.\n * @param {!number} v A double\n * @return {string}\n */\nexport const doubleToIEEE754String = function(v: number): string {\n  assert(!isInvalidJSONNumber(v), 'Invalid JSON number'); // MJL\n\n  const ebits = 11,\n    fbits = 52;\n  let bias = (1 << (ebits - 1)) - 1,\n    s,\n    e,\n    f,\n    ln,\n    i,\n    bits,\n    str;\n\n  // Compute sign, exponent, fraction\n  // Skip NaN / Infinity handling --MJL.\n  if (v === 0) {\n    e = 0;\n    f = 0;\n    s = 1 / v === -Infinity ? 1 : 0;\n  } else {\n    s = v < 0;\n    v = Math.abs(v);\n\n    if (v >= Math.pow(2, 1 - bias)) {\n      // Normalized\n      ln = Math.min(Math.floor(Math.log(v) / Math.LN2), bias);\n      e = ln + bias;\n      f = Math.round(v * Math.pow(2, fbits - ln) - Math.pow(2, fbits));\n    } else {\n      // Denormalized\n      e = 0;\n      f = Math.round(v / Math.pow(2, 1 - bias - fbits));\n    }\n  }\n\n  // Pack sign, exponent, fraction\n  bits = [];\n  for (i = fbits; i; i -= 1) {\n    bits.push(f % 2 ? 1 : 0);\n    f = Math.floor(f / 2);\n  }\n  for (i = ebits; i; i -= 1) {\n    bits.push(e % 2 ? 1 : 0);\n    e = Math.floor(e / 2);\n  }\n  bits.push(s ? 1 : 0);\n  bits.reverse();\n  str = bits.join('');\n\n  // Return the data as a hex string. --MJL\n  let hexByteString = '';\n  for (i = 0; i < 64; i += 8) {\n    let hexByte = parseInt(str.substr(i, 8), 2).toString(16);\n    if (hexByte.length === 1) hexByte = '0' + hexByte;\n    hexByteString = hexByteString + hexByte;\n  }\n  return hexByteString.toLowerCase();\n};\n\n/**\n * Used to detect if we're in a Chrome content script (which executes in an\n * isolated environment where long-polling doesn't work).\n * @return {boolean}\n */\nexport const isChromeExtensionContentScript = function(): boolean {\n  return !!(\n    typeof window === 'object' &&\n    window['chrome'] &&\n    window['chrome']['extension'] &&\n    !/^chrome/.test(window.location.href)\n  );\n};\n\n/**\n * Used to detect if we're in a Windows 8 Store app.\n * @return {boolean}\n */\nexport const isWindowsStoreApp = function(): boolean {\n  // Check for the presence of a couple WinRT globals\n  return typeof Windows === 'object' && typeof Windows.UI === 'object';\n};\n\n/**\n * Converts a server error code to a Javascript Error\n * @param {!string} code\n * @param {!Query} query\n * @return {Error}\n */\nexport const errorForServerCode = function(code: string, query: Query): Error {\n  let reason = 'Unknown Error';\n  if (code === 'too_big') {\n    reason =\n      'The data requested exceeds the maximum size ' +\n      'that can be accessed with a single request.';\n  } else if (code == 'permission_denied') {\n    reason = \"Client doesn't have permission to access the desired data.\";\n  } else if (code == 'unavailable') {\n    reason = 'The service is unavailable';\n  }\n\n  const error = new Error(\n    code + ' at ' + query.path.toString() + ': ' + reason\n  );\n  (error as any).code = code.toUpperCase();\n  return error;\n};\n\n/**\n * Used to test for integer-looking strings\n * @type {RegExp}\n * @private\n */\nexport const INTEGER_REGEXP_ = new RegExp('^-?\\\\d{1,10}$');\n\n/**\n * If the string contains a 32-bit integer, return it.  Else return null.\n * @param {!string} str\n * @return {?number}\n */\nexport const tryParseInt = function(str: string): number | null {\n  if (INTEGER_REGEXP_.test(str)) {\n    const intVal = Number(str);\n    if (intVal >= -2147483648 && intVal <= 2147483647) {\n      return intVal;\n    }\n  }\n  return null;\n};\n\n/**\n * Helper to run some code but catch any exceptions and re-throw them later.\n * Useful for preventing user callbacks from breaking internal code.\n *\n * Re-throwing the exception from a setTimeout is a little evil, but it's very\n * convenient (we don't have to try to figure out when is a safe point to\n * re-throw it), and the behavior seems reasonable:\n *\n * * If you aren't pausing on exceptions, you get an error in the console with\n *   the correct stack trace.\n * * If you're pausing on all exceptions, the debugger will pause on your\n *   exception and then again when we rethrow it.\n * * If you're only pausing on uncaught exceptions, the debugger will only pause\n *   on us re-throwing it.\n *\n * @param {!function()} fn The code to guard.\n */\nexport const exceptionGuard = function(fn: () => void) {\n  try {\n    fn();\n  } catch (e) {\n    // Re-throw exception when it's safe.\n    setTimeout(function() {\n      // It used to be that \"throw e\" would result in a good console error with\n      // relevant context, but as of Chrome 39, you just get the firebase.js\n      // file/line number where we re-throw it, which is useless. So we log\n      // e.stack explicitly.\n      const stack = e.stack || '';\n      warn('Exception was thrown by user callback.', stack);\n      throw e;\n    }, Math.floor(0));\n  }\n};\n\n/**\n * Helper function to safely call opt_callback with the specified arguments.  It:\n * 1. Turns into a no-op if opt_callback is null or undefined.\n * 2. Wraps the call inside exceptionGuard to prevent exceptions from breaking our state.\n *\n * @param {?Function=} callback Optional onComplete callback.\n * @param {...*} var_args Arbitrary args to be passed to opt_onComplete\n */\nexport const callUserCallback = function(\n  callback?: Function | null,\n  ...var_args: any[]\n) {\n  if (typeof callback === 'function') {\n    exceptionGuard(function() {\n      callback(...var_args);\n    });\n  }\n};\n\n/**\n * @return {boolean} true if we think we're currently being crawled.\n */\nexport const beingCrawled = function(): boolean {\n  const userAgent =\n    (typeof window === 'object' &&\n      window['navigator'] &&\n      window['navigator']['userAgent']) ||\n    '';\n\n  // For now we whitelist the most popular crawlers.  We should refine this to be the set of crawlers we\n  // believe to support JavaScript/AJAX rendering.\n  // NOTE: Google Webmaster Tools doesn't really belong, but their \"This is how a visitor to your website\n  // would have seen the page\" is flaky if we don't treat it as a crawler.\n  return (\n    userAgent.search(\n      /googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i\n    ) >= 0\n  );\n};\n\n/**\n * Export a property of an object using a getter function.\n *\n * @param {!Object} object\n * @param {string} name\n * @param {!function(): *} fnGet\n */\nexport const exportPropGetter = function(\n  object: Object,\n  name: string,\n  fnGet: () => any\n) {\n  Object.defineProperty(object, name, { get: fnGet });\n};\n\n/**\n * Same as setTimeout() except on Node.JS it will /not/ prevent the process from exiting.\n *\n * It is removed with clearTimeout() as normal.\n *\n * @param {Function} fn Function to run.\n * @param {number} time Milliseconds to wait before running.\n * @return {number|Object} The setTimeout() return value.\n */\nexport const setTimeoutNonBlocking = function(\n  fn: Function,\n  time: number\n): number | Object {\n  const timeout: number | Object = setTimeout(fn, time);\n  if (typeof timeout === 'object' && (timeout as any)['unref']) {\n    (timeout as any)['unref']();\n  }\n  return timeout;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nameCompare } from './util';\nimport { stringLength } from '@firebase/util';\n/**\n * An immutable object representing a parsed path.  It's immutable so that you\n * can pass them around to other functions without worrying about them changing\n * it.\n */\n\nexport class Path {\n  private pieces_: string[];\n  private pieceNum_: number;\n\n  /**\n   * Singleton to represent an empty path\n   *\n   * @const\n   */\n  static get Empty() {\n    return new Path('');\n  }\n\n  /**\n   * @param {string|Array.<string>} pathOrString Path string to parse,\n   *      or another path, or the raw tokens array\n   * @param {number=} pieceNum\n   */\n  constructor(pathOrString: string | string[], pieceNum?: number) {\n    if (pieceNum === void 0) {\n      this.pieces_ = (pathOrString as string).split('/');\n\n      // Remove empty pieces.\n      let copyTo = 0;\n      for (let i = 0; i < this.pieces_.length; i++) {\n        if (this.pieces_[i].length > 0) {\n          this.pieces_[copyTo] = this.pieces_[i];\n          copyTo++;\n        }\n      }\n      this.pieces_.length = copyTo;\n\n      this.pieceNum_ = 0;\n    } else {\n      this.pieces_ = pathOrString as string[];\n      this.pieceNum_ = pieceNum;\n    }\n  }\n\n  getFront(): string | null {\n    if (this.pieceNum_ >= this.pieces_.length) return null;\n\n    return this.pieces_[this.pieceNum_];\n  }\n\n  /**\n   * @return {number} The number of segments in this path\n   */\n  getLength(): number {\n    return this.pieces_.length - this.pieceNum_;\n  }\n\n  /**\n   * @return {!Path}\n   */\n  popFront(): Path {\n    let pieceNum = this.pieceNum_;\n    if (pieceNum < this.pieces_.length) {\n      pieceNum++;\n    }\n    return new Path(this.pieces_, pieceNum);\n  }\n\n  /**\n   * @return {?string}\n   */\n  getBack(): string | null {\n    if (this.pieceNum_ < this.pieces_.length)\n      return this.pieces_[this.pieces_.length - 1];\n\n    return null;\n  }\n\n  toString(): string {\n    let pathString = '';\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++) {\n      if (this.pieces_[i] !== '') pathString += '/' + this.pieces_[i];\n    }\n\n    return pathString || '/';\n  }\n\n  toUrlEncodedString(): string {\n    let pathString = '';\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++) {\n      if (this.pieces_[i] !== '')\n        pathString += '/' + encodeURIComponent(String(this.pieces_[i]));\n    }\n\n    return pathString || '/';\n  }\n\n  /**\n   * Shallow copy of the parts of the path.\n   *\n   * @param {number=} begin\n   * @return {!Array<string>}\n   */\n  slice(begin: number = 0): string[] {\n    return this.pieces_.slice(this.pieceNum_ + begin);\n  }\n\n  /**\n   * @return {?Path}\n   */\n  parent(): Path | null {\n    if (this.pieceNum_ >= this.pieces_.length) return null;\n\n    const pieces = [];\n    for (let i = this.pieceNum_; i < this.pieces_.length - 1; i++)\n      pieces.push(this.pieces_[i]);\n\n    return new Path(pieces, 0);\n  }\n\n  /**\n   * @param {string|!Path} childPathObj\n   * @return {!Path}\n   */\n  child(childPathObj: string | Path): Path {\n    const pieces = [];\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++)\n      pieces.push(this.pieces_[i]);\n\n    if (childPathObj instanceof Path) {\n      for (\n        let i = childPathObj.pieceNum_;\n        i < childPathObj.pieces_.length;\n        i++\n      ) {\n        pieces.push(childPathObj.pieces_[i]);\n      }\n    } else {\n      const childPieces = childPathObj.split('/');\n      for (let i = 0; i < childPieces.length; i++) {\n        if (childPieces[i].length > 0) pieces.push(childPieces[i]);\n      }\n    }\n\n    return new Path(pieces, 0);\n  }\n\n  /**\n   * @return {boolean} True if there are no segments in this path\n   */\n  isEmpty(): boolean {\n    return this.pieceNum_ >= this.pieces_.length;\n  }\n\n  /**\n   * @param {!Path} outerPath\n   * @param {!Path} innerPath\n   * @return {!Path} The path from outerPath to innerPath\n   */\n  static relativePath(outerPath: Path, innerPath: Path): Path {\n    const outer = outerPath.getFront(),\n      inner = innerPath.getFront();\n    if (outer === null) {\n      return innerPath;\n    } else if (outer === inner) {\n      return Path.relativePath(outerPath.popFront(), innerPath.popFront());\n    } else {\n      throw new Error(\n        'INTERNAL ERROR: innerPath (' +\n          innerPath +\n          ') is not within ' +\n          'outerPath (' +\n          outerPath +\n          ')'\n      );\n    }\n  }\n\n  /**\n   * @param {!Path} left\n   * @param {!Path} right\n   * @return {number} -1, 0, 1 if left is less, equal, or greater than the right.\n   */\n  static comparePaths(left: Path, right: Path): number {\n    const leftKeys = left.slice();\n    const rightKeys = right.slice();\n    for (let i = 0; i < leftKeys.length && i < rightKeys.length; i++) {\n      const cmp = nameCompare(leftKeys[i], rightKeys[i]);\n      if (cmp !== 0) return cmp;\n    }\n    if (leftKeys.length === rightKeys.length) return 0;\n    return leftKeys.length < rightKeys.length ? -1 : 1;\n  }\n\n  /**\n   *\n   * @param {Path} other\n   * @return {boolean} true if paths are the same.\n   */\n  equals(other: Path): boolean {\n    if (this.getLength() !== other.getLength()) {\n      return false;\n    }\n\n    for (\n      let i = this.pieceNum_, j = other.pieceNum_;\n      i <= this.pieces_.length;\n      i++, j++\n    ) {\n      if (this.pieces_[i] !== other.pieces_[j]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   *\n   * @param {!Path} other\n   * @return {boolean} True if this path is a parent (or the same as) other\n   */\n  contains(other: Path): boolean {\n    let i = this.pieceNum_;\n    let j = other.pieceNum_;\n    if (this.getLength() > other.getLength()) {\n      return false;\n    }\n    while (i < this.pieces_.length) {\n      if (this.pieces_[i] !== other.pieces_[j]) {\n        return false;\n      }\n      ++i;\n      ++j;\n    }\n    return true;\n  }\n} // end Path\n\n/**\n * Dynamic (mutable) path used to count path lengths.\n *\n * This class is used to efficiently check paths for valid\n * length (in UTF8 bytes) and depth (used in path validation).\n *\n * Throws Error exception if path is ever invalid.\n *\n * The definition of a path always begins with '/'.\n */\nexport class ValidationPath {\n  /** @type {!Array<string>} */\n  private parts_: string[];\n  /** @type {number} Initialize to number of '/' chars needed in path. */\n  private byteLength_: number;\n\n  /**\n   * @param {!Path} path Initial Path.\n   * @param {string} errorPrefix_ Prefix for any error messages.\n   */\n  constructor(path: Path, private errorPrefix_: string) {\n    /** @type {!Array<string>} */\n    this.parts_ = path.slice();\n    /** @type {number} Initialize to number of '/' chars needed in path. */\n    this.byteLength_ = Math.max(1, this.parts_.length);\n\n    for (let i = 0; i < this.parts_.length; i++) {\n      this.byteLength_ += stringLength(this.parts_[i]);\n    }\n    this.checkValid_();\n  }\n\n  /** @const {number} Maximum key depth. */\n  static get MAX_PATH_DEPTH() {\n    return 32;\n  }\n\n  /** @const {number} Maximum number of (UTF8) bytes in a Firebase path. */\n  static get MAX_PATH_LENGTH_BYTES() {\n    return 768;\n  }\n\n  /** @param {string} child */\n  push(child: string) {\n    // Count the needed '/'\n    if (this.parts_.length > 0) {\n      this.byteLength_ += 1;\n    }\n    this.parts_.push(child);\n    this.byteLength_ += stringLength(child);\n    this.checkValid_();\n  }\n\n  pop() {\n    const last = this.parts_.pop();\n    this.byteLength_ -= stringLength(last);\n    // Un-count the previous '/'\n    if (this.parts_.length > 0) {\n      this.byteLength_ -= 1;\n    }\n  }\n\n  private checkValid_() {\n    if (this.byteLength_ > ValidationPath.MAX_PATH_LENGTH_BYTES) {\n      throw new Error(\n        this.errorPrefix_ +\n          'has a key path longer than ' +\n          ValidationPath.MAX_PATH_LENGTH_BYTES +\n          ' bytes (' +\n          this.byteLength_ +\n          ').'\n      );\n    }\n    if (this.parts_.length > ValidationPath.MAX_PATH_DEPTH) {\n      throw new Error(\n        this.errorPrefix_ +\n          'path specified exceeds the maximum depth that can be written (' +\n          ValidationPath.MAX_PATH_DEPTH +\n          ') or object contains a cycle ' +\n          this.toErrorString()\n      );\n    }\n  }\n\n  /**\n   * String for use in error messages - uses '.' notation for path.\n   *\n   * @return {string}\n   */\n  toErrorString(): string {\n    if (this.parts_.length == 0) {\n      return '';\n    }\n    return \"in property '\" + this.parts_.join('.') + \"'\";\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const PROTOCOL_VERSION = '5';\n\nexport const VERSION_PARAM = 'v';\n\nexport const TRANSPORT_SESSION_PARAM = 's';\n\nexport const REFERER_PARAM = 'r';\n\nexport const FORGE_REF = 'f';\n\nexport const FORGE_DOMAIN = 'firebaseio.com';\n\nexport const LAST_SESSION_PARAM = 'ls';\n\nexport const WEBSOCKET = 'websocket';\n\nexport const LONG_POLLING = 'long_polling';\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { forEach } from '@firebase/util';\nimport { PersistentStorage } from './storage/storage';\nimport { LONG_POLLING, WEBSOCKET } from '../realtime/Constants';\n\n/**\n * A class that holds metadata about a Repo object\n *\n * @constructor\n */\nexport class RepoInfo {\n  host: string;\n  domain: string;\n  internalHost: string;\n\n  /**\n   * @param {string} host Hostname portion of the url for the repo\n   * @param {boolean} secure Whether or not this repo is accessed over ssl\n   * @param {string} namespace The namespace represented by the repo\n   * @param {boolean} webSocketOnly Whether to prefer websockets over all other transports (used by Nest).\n   * @param {string=} persistenceKey Override the default session persistence storage key\n   */\n  constructor(\n    host: string,\n    public secure: boolean,\n    public namespace: string,\n    public webSocketOnly: boolean,\n    public persistenceKey: string = ''\n  ) {\n    this.host = host.toLowerCase();\n    this.domain = this.host.substr(this.host.indexOf('.') + 1);\n    this.internalHost = PersistentStorage.get('host:' + host) || this.host;\n  }\n\n  needsQueryParam(): boolean {\n    return this.host !== this.internalHost || this.isCustomHost();\n  }\n\n  isCacheableHost(): boolean {\n    return this.internalHost.substr(0, 2) === 's-';\n  }\n\n  isDemoHost() {\n    return this.domain === 'firebaseio-demo.com';\n  }\n\n  isCustomHost() {\n    return (\n      this.domain !== 'firebaseio.com' && this.domain !== 'firebaseio-demo.com'\n    );\n  }\n\n  updateHost(newHost: string) {\n    if (newHost !== this.internalHost) {\n      this.internalHost = newHost;\n      if (this.isCacheableHost()) {\n        PersistentStorage.set('host:' + this.host, this.internalHost);\n      }\n    }\n  }\n\n  /**\n   * Returns the websocket URL for this repo\n   * @param {string} type of connection\n   * @param {Object} params list\n   * @return {string} The URL for this repo\n   */\n  connectionURL(type: string, params: { [k: string]: string }): string {\n    assert(typeof type === 'string', 'typeof type must == string');\n    assert(typeof params === 'object', 'typeof params must == object');\n\n    let connURL: string;\n    if (type === WEBSOCKET) {\n      connURL =\n        (this.secure ? 'wss://' : 'ws://') + this.internalHost + '/.ws?';\n    } else if (type === LONG_POLLING) {\n      connURL =\n        (this.secure ? 'https://' : 'http://') + this.internalHost + '/.lp?';\n    } else {\n      throw new Error('Unknown connection type: ' + type);\n    }\n    if (this.needsQueryParam()) {\n      params['ns'] = this.namespace;\n    }\n\n    const pairs: string[] = [];\n\n    forEach(params, (key: string, value: string) => {\n      pairs.push(key + '=' + value);\n    });\n\n    return connURL + pairs.join('&');\n  }\n\n  /** @return {string} */\n  toString(): string {\n    let str = this.toURLString();\n    if (this.persistenceKey) {\n      str += '<' + this.persistenceKey + '>';\n    }\n    return str;\n  }\n\n  /** @return {string} */\n  toURLString(): string {\n    return (this.secure ? 'https://' : 'http://') + this.host;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../Path';\nimport { RepoInfo } from '../../RepoInfo';\nimport { warnIfPageIsSecure, warn, fatal } from '../util';\n\n/**\n * @param {!string} pathString\n * @return {string}\n */\nfunction decodePath(pathString: string): string {\n  let pathStringDecoded = '';\n  const pieces = pathString.split('/');\n  for (let i = 0; i < pieces.length; i++) {\n    if (pieces[i].length > 0) {\n      let piece = pieces[i];\n      try {\n        piece = decodeURIComponent(piece.replace(/\\+/g, ' '));\n      } catch (e) {}\n      pathStringDecoded += '/' + piece;\n    }\n  }\n  return pathStringDecoded;\n}\n\n/**\n * @param {!string} queryString\n * @return {!{[key:string]:string}} key value hash\n */\nfunction decodeQuery(queryString: string): { [key: string]: string } {\n  let results = {};\n  if (queryString.charAt(0) === '?') {\n    queryString = queryString.substring(1);\n  }\n  for (const segment of queryString.split('&')) {\n    if (segment.length === 0) {\n      continue;\n    }\n    const kv = segment.split('=');\n    if (kv.length === 2) {\n      results[decodeURIComponent(kv[0])] = decodeURIComponent(kv[1]);\n    } else {\n      warn(`Invalid query segment '${segment}' in query '${queryString}'`);\n    }\n  }\n  return results;\n}\n\n/**\n *\n * @param {!string} dataURL\n * @return {{repoInfo: !RepoInfo, path: !Path}}\n */\nexport const parseRepoInfo = function(\n  dataURL: string\n): { repoInfo: RepoInfo; path: Path } {\n  const parsedUrl = parseURL(dataURL),\n    namespace = parsedUrl.subdomain;\n\n  if (parsedUrl.domain === 'firebase') {\n    fatal(\n      parsedUrl.host +\n        ' is no longer supported. ' +\n        'Please use <YOUR FIREBASE>.firebaseio.com instead'\n    );\n  }\n\n  // Catch common error of uninitialized namespace value.\n  if (\n    (!namespace || namespace == 'undefined') &&\n    parsedUrl.domain !== 'localhost'\n  ) {\n    fatal(\n      'Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com'\n    );\n  }\n\n  if (!parsedUrl.secure) {\n    warnIfPageIsSecure();\n  }\n\n  const webSocketOnly = parsedUrl.scheme === 'ws' || parsedUrl.scheme === 'wss';\n\n  return {\n    repoInfo: new RepoInfo(\n      parsedUrl.host,\n      parsedUrl.secure,\n      namespace,\n      webSocketOnly\n    ),\n    path: new Path(parsedUrl.pathString)\n  };\n};\n\n/**\n *\n * @param {!string} dataURL\n * @return {{host: string, port: number, domain: string, subdomain: string, secure: boolean, scheme: string, pathString: string}}\n */\nexport const parseURL = function(\n  dataURL: string\n): {\n  host: string;\n  port: number;\n  domain: string;\n  subdomain: string;\n  secure: boolean;\n  scheme: string;\n  pathString: string;\n} {\n  // Default to empty strings in the event of a malformed string.\n  let host = '',\n    domain = '',\n    subdomain = '',\n    pathString = '';\n\n  // Always default to SSL, unless otherwise specified.\n  let secure = true,\n    scheme = 'https',\n    port = 443;\n\n  // Don't do any validation here. The caller is responsible for validating the result of parsing.\n  if (typeof dataURL === 'string') {\n    // Parse scheme.\n    let colonInd = dataURL.indexOf('//');\n    if (colonInd >= 0) {\n      scheme = dataURL.substring(0, colonInd - 1);\n      dataURL = dataURL.substring(colonInd + 2);\n    }\n\n    // Parse host, path, and query string.\n    let slashInd = dataURL.indexOf('/');\n    if (slashInd === -1) {\n      slashInd = dataURL.length;\n    }\n    let questionMarkInd = dataURL.indexOf('?');\n    if (questionMarkInd === -1) {\n      questionMarkInd = dataURL.length;\n    }\n    host = dataURL.substring(0, Math.min(slashInd, questionMarkInd));\n    if (slashInd < questionMarkInd) {\n      // For pathString, questionMarkInd will always come after slashInd\n      pathString = decodePath(dataURL.substring(slashInd, questionMarkInd));\n    }\n    let queryParams = decodeQuery(\n      dataURL.substring(Math.min(dataURL.length, questionMarkInd))\n    );\n\n    // If we have a port, use scheme for determining if it's secure.\n    colonInd = host.indexOf(':');\n    if (colonInd >= 0) {\n      secure = scheme === 'https' || scheme === 'wss';\n      port = parseInt(host.substring(colonInd + 1), 10);\n    } else {\n      colonInd = dataURL.length;\n    }\n\n    const parts = host.split('.');\n    if (parts.length === 3) {\n      // Normalize namespaces to lowercase to share storage / connection.\n      domain = parts[1];\n      subdomain = parts[0].toLowerCase();\n    } else if (parts.length === 2) {\n      domain = parts[0];\n    } else if (parts[0].slice(0, colonInd).toLowerCase() === 'localhost') {\n      domain = 'localhost';\n    }\n    // Support `ns` query param if subdomain not already set\n    if (subdomain === '' && 'ns' in queryParams) {\n      subdomain = queryParams['ns'];\n    }\n  }\n\n  return {\n    host,\n    port,\n    domain,\n    subdomain,\n    secure,\n    scheme,\n    pathString\n  };\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path, ValidationPath } from './Path';\nimport { forEach, contains, safeGet } from '@firebase/util';\nimport { isInvalidJSONNumber } from './util';\nimport { errorPrefix as errorPrefixFxn } from '@firebase/util';\nimport { stringLength } from '@firebase/util';\nimport { RepoInfo } from '../RepoInfo';\n\n/**\n * True for invalid Firebase keys\n * @type {RegExp}\n * @private\n */\nexport const INVALID_KEY_REGEX_ = /[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/;\n\n/**\n * True for invalid Firebase paths.\n * Allows '/' in paths.\n * @type {RegExp}\n * @private\n */\nexport const INVALID_PATH_REGEX_ = /[\\[\\].#$\\u0000-\\u001F\\u007F]/;\n\n/**\n * Maximum number of characters to allow in leaf value\n * @type {number}\n * @private\n */\nexport const MAX_LEAF_SIZE_ = 10 * 1024 * 1024;\n\n/**\n * @param {*} key\n * @return {boolean}\n */\nexport const isValidKey = function(key: any): boolean {\n  return (\n    typeof key === 'string' && key.length !== 0 && !INVALID_KEY_REGEX_.test(key)\n  );\n};\n\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexport const isValidPathString = function(pathString: string): boolean {\n  return (\n    typeof pathString === 'string' &&\n    pathString.length !== 0 &&\n    !INVALID_PATH_REGEX_.test(pathString)\n  );\n};\n\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexport const isValidRootPathString = function(pathString: string): boolean {\n  if (pathString) {\n    // Allow '/.info/' at the beginning.\n    pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n  }\n\n  return isValidPathString(pathString);\n};\n\n/**\n * @param {*} priority\n * @return {boolean}\n */\nexport const isValidPriority = function(priority: any): boolean {\n  return (\n    priority === null ||\n    typeof priority === 'string' ||\n    (typeof priority === 'number' && !isInvalidJSONNumber(priority)) ||\n    (priority && typeof priority === 'object' && contains(priority, '.sv'))\n  );\n};\n\n/**\n * Pre-validate a datum passed as an argument to Firebase function.\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexport const validateFirebaseDataArg = function(\n  fnName: string,\n  argumentNumber: number,\n  data: any,\n  path: Path,\n  optional: boolean\n) {\n  if (optional && data === undefined) return;\n\n  validateFirebaseData(\n    errorPrefixFxn(fnName, argumentNumber, optional),\n    data,\n    path\n  );\n};\n\n/**\n * Validate a data object client-side before sending to server.\n *\n * @param {string} errorPrefix\n * @param {*} data\n * @param {!Path|!ValidationPath} path_\n */\nexport const validateFirebaseData = function(\n  errorPrefix: string,\n  data: any,\n  path_: Path | ValidationPath\n) {\n  const path =\n    path_ instanceof Path ? new ValidationPath(path_, errorPrefix) : path_;\n\n  if (data === undefined) {\n    throw new Error(errorPrefix + 'contains undefined ' + path.toErrorString());\n  }\n  if (typeof data === 'function') {\n    throw new Error(\n      errorPrefix +\n        'contains a function ' +\n        path.toErrorString() +\n        ' with contents = ' +\n        data.toString()\n    );\n  }\n  if (isInvalidJSONNumber(data)) {\n    throw new Error(\n      errorPrefix + 'contains ' + data.toString() + ' ' + path.toErrorString()\n    );\n  }\n\n  // Check max leaf size, but try to avoid the utf8 conversion if we can.\n  if (\n    typeof data === 'string' &&\n    data.length > MAX_LEAF_SIZE_ / 3 &&\n    stringLength(data) > MAX_LEAF_SIZE_\n  ) {\n    throw new Error(\n      errorPrefix +\n        'contains a string greater than ' +\n        MAX_LEAF_SIZE_ +\n        ' utf8 bytes ' +\n        path.toErrorString() +\n        \" ('\" +\n        data.substring(0, 50) +\n        \"...')\"\n    );\n  }\n\n  // TODO = Perf = Consider combining the recursive validation of keys into NodeFromJSON\n  // to save extra walking of large objects.\n  if (data && typeof data === 'object') {\n    let hasDotValue = false,\n      hasActualChild = false;\n    forEach(data, function(key: string, value: any) {\n      if (key === '.value') {\n        hasDotValue = true;\n      } else if (key !== '.priority' && key !== '.sv') {\n        hasActualChild = true;\n        if (!isValidKey(key)) {\n          throw new Error(\n            errorPrefix +\n              ' contains an invalid key (' +\n              key +\n              ') ' +\n              path.toErrorString() +\n              '.  Keys must be non-empty strings ' +\n              'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"'\n          );\n        }\n      }\n\n      path.push(key);\n      validateFirebaseData(errorPrefix, value, path);\n      path.pop();\n    });\n\n    if (hasDotValue && hasActualChild) {\n      throw new Error(\n        errorPrefix +\n          ' contains \".value\" child ' +\n          path.toErrorString() +\n          ' in addition to actual children.'\n      );\n    }\n  }\n};\n\n/**\n * Pre-validate paths passed in the firebase function.\n *\n * @param {string} errorPrefix\n * @param {Array<!Path>} mergePaths\n */\nexport const validateFirebaseMergePaths = function(\n  errorPrefix: string,\n  mergePaths: Path[]\n) {\n  let i, curPath;\n  for (i = 0; i < mergePaths.length; i++) {\n    curPath = mergePaths[i];\n    const keys = curPath.slice();\n    for (let j = 0; j < keys.length; j++) {\n      if (keys[j] === '.priority' && j === keys.length - 1) {\n        // .priority is OK\n      } else if (!isValidKey(keys[j])) {\n        throw new Error(\n          errorPrefix +\n            'contains an invalid key (' +\n            keys[j] +\n            ') in path ' +\n            curPath.toString() +\n            '. Keys must be non-empty strings ' +\n            'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"'\n        );\n      }\n    }\n  }\n\n  // Check that update keys are not descendants of each other.\n  // We rely on the property that sorting guarantees that ancestors come\n  // right before descendants.\n  mergePaths.sort(Path.comparePaths);\n  let prevPath: Path | null = null;\n  for (i = 0; i < mergePaths.length; i++) {\n    curPath = mergePaths[i];\n    if (prevPath !== null && prevPath.contains(curPath)) {\n      throw new Error(\n        errorPrefix +\n          'contains a path ' +\n          prevPath.toString() +\n          ' that is ancestor of another path ' +\n          curPath.toString()\n      );\n    }\n    prevPath = curPath;\n  }\n};\n\n/**\n * pre-validate an object passed as an argument to firebase function (\n * must be an object - e.g. for firebase.update()).\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexport const validateFirebaseMergeDataArg = function(\n  fnName: string,\n  argumentNumber: number,\n  data: any,\n  path: Path,\n  optional: boolean\n) {\n  if (optional && data === undefined) return;\n\n  const errorPrefix = errorPrefixFxn(fnName, argumentNumber, optional);\n\n  if (!(data && typeof data === 'object') || Array.isArray(data)) {\n    throw new Error(\n      errorPrefix + ' must be an object containing the children to replace.'\n    );\n  }\n\n  const mergePaths: Path[] = [];\n  forEach(data, function(key: string, value: any) {\n    const curPath = new Path(key);\n    validateFirebaseData(errorPrefix, value, path.child(curPath));\n    if (curPath.getBack() === '.priority') {\n      if (!isValidPriority(value)) {\n        throw new Error(\n          errorPrefix +\n            \"contains an invalid value for '\" +\n            curPath.toString() +\n            \"', which must be a valid \" +\n            'Firebase priority (a string, finite number, server value, or null).'\n        );\n      }\n    }\n    mergePaths.push(curPath);\n  });\n  validateFirebaseMergePaths(errorPrefix, mergePaths);\n};\n\nexport const validatePriority = function(\n  fnName: string,\n  argumentNumber: number,\n  priority: any,\n  optional: boolean\n) {\n  if (optional && priority === undefined) return;\n  if (isInvalidJSONNumber(priority))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'is ' +\n        priority.toString() +\n        ', but must be a valid Firebase priority (a string, finite number, ' +\n        'server value, or null).'\n    );\n  // Special case to allow importing data with a .sv.\n  if (!isValidPriority(priority))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid Firebase priority ' +\n        '(a string, finite number, server value, or null).'\n    );\n};\n\nexport const validateEventType = function(\n  fnName: string,\n  argumentNumber: number,\n  eventType: string,\n  optional: boolean\n) {\n  if (optional && eventType === undefined) return;\n\n  switch (eventType) {\n    case 'value':\n    case 'child_added':\n    case 'child_removed':\n    case 'child_changed':\n    case 'child_moved':\n      break;\n    default:\n      throw new Error(\n        errorPrefixFxn(fnName, argumentNumber, optional) +\n          'must be a valid event type = \"value\", \"child_added\", \"child_removed\", ' +\n          '\"child_changed\", or \"child_moved\".'\n      );\n  }\n};\n\nexport const validateKey = function(\n  fnName: string,\n  argumentNumber: number,\n  key: string,\n  optional: boolean\n) {\n  if (optional && key === undefined) return;\n  if (!isValidKey(key))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'was an invalid key = \"' +\n        key +\n        '\".  Firebase keys must be non-empty strings and ' +\n        'can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").'\n    );\n};\n\nexport const validatePathString = function(\n  fnName: string,\n  argumentNumber: number,\n  pathString: string,\n  optional: boolean\n) {\n  if (optional && pathString === undefined) return;\n\n  if (!isValidPathString(pathString))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'was an invalid path = \"' +\n        pathString +\n        '\". Paths must be non-empty strings and ' +\n        'can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"'\n    );\n};\n\nexport const validateRootPathString = function(\n  fnName: string,\n  argumentNumber: number,\n  pathString: string,\n  optional: boolean\n) {\n  if (pathString) {\n    // Allow '/.info/' at the beginning.\n    pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n  }\n\n  validatePathString(fnName, argumentNumber, pathString, optional);\n};\n\nexport const validateWritablePath = function(fnName: string, path: Path) {\n  if (path.getFront() === '.info') {\n    throw new Error(fnName + \" failed = Can't modify data under /.info/\");\n  }\n};\n\nexport const validateUrl = function(\n  fnName: string,\n  argumentNumber: number,\n  parsedUrl: { repoInfo: RepoInfo; path: Path }\n) {\n  // TODO = Validate server better.\n  const pathString = parsedUrl.path.toString();\n  if (\n    !(typeof parsedUrl.repoInfo.host === 'string') ||\n    parsedUrl.repoInfo.host.length === 0 ||\n    (!isValidKey(parsedUrl.repoInfo.namespace) &&\n      parsedUrl.repoInfo.host.split(':')[0] !== 'localhost') ||\n    (pathString.length !== 0 && !isValidRootPathString(pathString))\n  ) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, false) +\n        'must be a valid firebase URL and ' +\n        'the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".'\n    );\n  }\n};\n\nexport const validateCredential = function(\n  fnName: string,\n  argumentNumber: number,\n  cred: any,\n  optional: boolean\n) {\n  if (optional && cred === undefined) return;\n  if (!(typeof cred === 'string'))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid credential (a string).'\n    );\n};\n\nexport const validateBoolean = function(\n  fnName: string,\n  argumentNumber: number,\n  bool: any,\n  optional: boolean\n) {\n  if (optional && bool === undefined) return;\n  if (typeof bool !== 'boolean')\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) + 'must be a boolean.'\n    );\n};\n\nexport const validateString = function(\n  fnName: string,\n  argumentNumber: number,\n  string: any,\n  optional: boolean\n) {\n  if (optional && string === undefined) return;\n  if (!(typeof string === 'string')) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid string.'\n    );\n  }\n};\n\nexport const validateObject = function(\n  fnName: string,\n  argumentNumber: number,\n  obj: any,\n  optional: boolean\n) {\n  if (optional && obj === undefined) return;\n  if (!(obj && typeof obj === 'object') || obj === null) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid object.'\n    );\n  }\n};\n\nexport const validateObjectContainsKey = function(\n  fnName: string,\n  argumentNumber: number,\n  obj: any,\n  key: string,\n  optional: boolean,\n  opt_type?: string\n) {\n  const objectContainsKey =\n    obj && typeof obj === 'object' && contains(obj, key);\n\n  if (!objectContainsKey) {\n    if (optional) {\n      return;\n    } else {\n      throw new Error(\n        errorPrefixFxn(fnName, argumentNumber, optional) +\n          'must contain the key \"' +\n          key +\n          '\"'\n      );\n    }\n  }\n\n  if (opt_type) {\n    const val = safeGet(obj, key);\n    if (\n      (opt_type === 'number' && !(typeof val === 'number')) ||\n      (opt_type === 'string' && !(typeof val === 'string')) ||\n      (opt_type === 'boolean' && !(typeof val === 'boolean')) ||\n      (opt_type === 'function' && !(typeof val === 'function')) ||\n      (opt_type === 'object' && !(typeof val === 'object') && val)\n    ) {\n      if (optional) {\n        throw new Error(\n          errorPrefixFxn(fnName, argumentNumber, optional) +\n            'contains invalid value for key \"' +\n            key +\n            '\" (must be of type \"' +\n            opt_type +\n            '\")'\n        );\n      } else {\n        throw new Error(\n          errorPrefixFxn(fnName, argumentNumber, optional) +\n            'must contain the key \"' +\n            key +\n            '\" with type \"' +\n            opt_type +\n            '\"'\n        );\n      }\n    }\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport {\n  validateWritablePath,\n  validateFirebaseDataArg,\n  validatePriority,\n  validateFirebaseMergeDataArg\n} from '../core/util/validation';\nimport { warn } from '../core/util/util';\nimport { Deferred } from '@firebase/util';\nimport { Repo } from '../core/Repo';\nimport { Path } from '../core/util/Path';\n\n/**\n * @constructor\n */\nexport class OnDisconnect {\n  /**\n   * @param {!Repo} repo_\n   * @param {!Path} path_\n   */\n  constructor(private repo_: Repo, private path_: Path) {}\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  cancel(onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.cancel', 0, 1, arguments.length);\n    validateCallback('OnDisconnect.cancel', 1, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectCancel(\n      this.path_,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  remove(onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.remove', 0, 1, arguments.length);\n    validateWritablePath('OnDisconnect.remove', this.path_);\n    validateCallback('OnDisconnect.remove', 1, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSet(\n      this.path_,\n      null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} value\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  set(value: any, onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.set', 1, 2, arguments.length);\n    validateWritablePath('OnDisconnect.set', this.path_);\n    validateFirebaseDataArg('OnDisconnect.set', 1, value, this.path_, false);\n    validateCallback('OnDisconnect.set', 2, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSet(\n      this.path_,\n      value,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} value\n   * @param {number|string|null} priority\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  setWithPriority(\n    value: any,\n    priority: number | string | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<void> {\n    validateArgCount('OnDisconnect.setWithPriority', 2, 3, arguments.length);\n    validateWritablePath('OnDisconnect.setWithPriority', this.path_);\n    validateFirebaseDataArg(\n      'OnDisconnect.setWithPriority',\n      1,\n      value,\n      this.path_,\n      false\n    );\n    validatePriority('OnDisconnect.setWithPriority', 2, priority, false);\n    validateCallback('OnDisconnect.setWithPriority', 3, onComplete, true);\n\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSetWithPriority(\n      this.path_,\n      value,\n      priority,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {!Object} objectToMerge\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  update(\n    objectToMerge: object,\n    onComplete?: (a: Error | null) => void\n  ): Promise<void> {\n    validateArgCount('OnDisconnect.update', 1, 2, arguments.length);\n    validateWritablePath('OnDisconnect.update', this.path_);\n    if (Array.isArray(objectToMerge)) {\n      const newObjectToMerge: { [k: string]: any } = {};\n      for (let i = 0; i < objectToMerge.length; ++i) {\n        newObjectToMerge['' + i] = objectToMerge[i];\n      }\n      objectToMerge = newObjectToMerge;\n      warn(\n        'Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the ' +\n          'existing data, or an Object with integer keys if you really do want to only update some of the children.'\n      );\n    }\n    validateFirebaseMergeDataArg(\n      'OnDisconnect.update',\n      1,\n      objectToMerge,\n      this.path_,\n      false\n    );\n    validateCallback('OnDisconnect.update', 2, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectUpdate(\n      this.path_,\n      objectToMerge,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataSnapshot } from './DataSnapshot';\nimport { validateArgCount } from '@firebase/util';\n\nexport class TransactionResult {\n  /**\n   * A type for the resolve value of Firebase.transaction.\n   * @constructor\n   * @dict\n   * @param {boolean} committed\n   * @param {DataSnapshot} snapshot\n   */\n  constructor(public committed: boolean, public snapshot: DataSnapshot) {}\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users\n  toJSON(): object {\n    validateArgCount('TransactionResult.toJSON', 0, 1, arguments.length);\n    return { committed: this.committed, snapshot: this.snapshot.toJSON() };\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\n\n/**\n * Fancy ID generator that creates 20-character string identifiers with the\n * following properties:\n *\n * 1. They're based on timestamp so that they sort *after* any existing ids.\n * 2. They contain 72-bits of random data after the timestamp so that IDs won't\n *    collide with other clients' IDs.\n * 3. They sort *lexicographically* (so the timestamp is converted to characters\n *    that will sort properly).\n * 4. They're monotonically increasing. Even if you generate more than one in\n *    the same timestamp, the latter ones will sort after the former ones. We do\n *    this by using the previous random bits but \"incrementing\" them by 1 (only\n *    in the case of a timestamp collision).\n */\nexport const nextPushId = (function() {\n  // Modeled after base64 web-safe chars, but ordered by ASCII.\n  const PUSH_CHARS =\n    '-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz';\n\n  // Timestamp of last push, used to prevent local collisions if you push twice\n  // in one ms.\n  let lastPushTime = 0;\n\n  // We generate 72-bits of randomness which get turned into 12 characters and\n  // appended to the timestamp to prevent collisions with other clients. We\n  // store the last characters we generated because in the event of a collision,\n  // we'll use those same characters except \"incremented\" by one.\n  const lastRandChars: number[] = [];\n\n  return function(now: number) {\n    const duplicateTime = now === lastPushTime;\n    lastPushTime = now;\n\n    let i;\n    const timeStampChars = new Array(8);\n    for (i = 7; i >= 0; i--) {\n      timeStampChars[i] = PUSH_CHARS.charAt(now % 64);\n      // NOTE: Can't use << here because javascript will convert to int and lose\n      // the upper bits.\n      now = Math.floor(now / 64);\n    }\n    assert(now === 0, 'Cannot push at time == 0');\n\n    let id = timeStampChars.join('');\n\n    if (!duplicateTime) {\n      for (i = 0; i < 12; i++) {\n        lastRandChars[i] = Math.floor(Math.random() * 64);\n      }\n    } else {\n      // If the timestamp hasn't changed since last push, use the same random\n      // number, except incremented by 1.\n      for (i = 11; i >= 0 && lastRandChars[i] === 63; i--) {\n        lastRandChars[i] = 0;\n      }\n      lastRandChars[i]++;\n    }\n    for (i = 0; i < 12; i++) {\n      id += PUSH_CHARS.charAt(lastRandChars[i]);\n    }\n    assert(id.length === 20, 'nextPushId: Length should be 20.');\n\n    return id;\n  };\n})();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { Index } from './indexes/Index';\n\n/**\n * Node is an interface defining the common functionality for nodes in\n * a DataSnapshot.\n *\n * @interface\n */\nexport interface Node {\n  /**\n   * Whether this node is a leaf node.\n   * @return {boolean} Whether this is a leaf node.\n   */\n  isLeafNode(): boolean;\n\n  /**\n   * Gets the priority of the node.\n   * @return {!Node} The priority of the node.\n   */\n  getPriority(): Node;\n\n  /**\n   * Returns a duplicate node with the new priority.\n   * @param {!Node} newPriorityNode New priority to set for the node.\n   * @return {!Node} Node with new priority.\n   */\n  updatePriority(newPriorityNode: Node): Node;\n\n  /**\n   * Returns the specified immediate child, or null if it doesn't exist.\n   * @param {string} childName The name of the child to retrieve.\n   * @return {!Node} The retrieved child, or an empty node.\n   */\n  getImmediateChild(childName: string): Node;\n\n  /**\n   * Returns a child by path, or null if it doesn't exist.\n   * @param {!Path} path The path of the child to retrieve.\n   * @return {!Node} The retrieved child or an empty node.\n   */\n  getChild(path: Path): Node;\n\n  /**\n   * Returns the name of the child immediately prior to the specified childNode, or null.\n   * @param {!string} childName The name of the child to find the predecessor of.\n   * @param {!Node} childNode The node to find the predecessor of.\n   * @param {!Index} index The index to use to determine the predecessor\n   * @return {?string} The name of the predecessor child, or null if childNode is the first child.\n   */\n  getPredecessorChildName(\n    childName: String,\n    childNode: Node,\n    index: Index\n  ): string | null;\n\n  /**\n   * Returns a duplicate node, with the specified immediate child updated.\n   * Any value in the node will be removed.\n   * @param {string} childName The name of the child to update.\n   * @param {!Node} newChildNode The new child node\n   * @return {!Node} The updated node.\n   */\n  updateImmediateChild(childName: string, newChildNode: Node): Node;\n\n  /**\n   * Returns a duplicate node, with the specified child updated.  Any value will\n   * be removed.\n   * @param {!Path} path The path of the child to update.\n   * @param {!Node} newChildNode The new child node, which may be an empty node\n   * @return {!Node} The updated node.\n   */\n  updateChild(path: Path, newChildNode: Node): Node;\n\n  /**\n   * True if the immediate child specified exists\n   * @param {!string} childName\n   * @return {boolean}\n   */\n  hasChild(childName: string): boolean;\n\n  /**\n   * @return {boolean} True if this node has no value or children.\n   */\n  isEmpty(): boolean;\n\n  /**\n   * @return {number} The number of children of this node.\n   */\n  numChildren(): number;\n\n  /**\n   * Calls action for each child.\n   * @param {!Index} index\n   * @param {function(string, !Node)} action Action to be called for\n   * each child.  It's passed the child name and the child node.\n   * @return {*} The first truthy value return by action, or the last falsey one\n   */\n  forEachChild(index: Index, action: (a: string, b: Node) => void): any;\n\n  /**\n   * @param {boolean=} exportFormat True for export format (also wire protocol format).\n   * @return {*} Value of this node as JSON.\n   */\n  val(exportFormat?: boolean): unknown;\n\n  /**\n   * @return {string} hash representing the node contents.\n   */\n  hash(): string;\n\n  /**\n   * @param {!Node} other Another node\n   * @return {!number} -1 for less than, 0 for equal, 1 for greater than other\n   */\n  compareTo(other: Node): number;\n\n  /**\n   * @param {!Node} other\n   * @return {boolean} Whether or not this snapshot equals other\n   */\n  equals(other: Node): boolean;\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {!Node} This node, with the specified index now available\n   */\n  withIndex(indexDefinition: Index): Node;\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {boolean}\n   */\n  isIndexed(indexDefinition: Index): boolean;\n}\n\n/**\n *\n * @param {!string} name\n * @param {!Node} node\n * @constructor\n * @struct\n */\nexport class NamedNode {\n  constructor(public name: string, public node: Node) {}\n\n  /**\n   *\n   * @param {!string} name\n   * @param {!Node} node\n   * @return {NamedNode}\n   */\n  static Wrap(name: string, node: Node) {\n    return new NamedNode(name, node);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node, NamedNode } from '../Node';\nimport { MIN_NAME, MAX_NAME } from '../../util/util';\nimport { Comparator } from '../../util/SortedMap';\n\n/**\n *\n * @constructor\n */\nexport abstract class Index {\n  /**\n   * @param {!NamedNode} a\n   * @param {!NamedNode} b\n   * @return {number}\n   */\n  abstract compare(a: NamedNode, b: NamedNode): number;\n\n  /**\n   * @param {!Node} node\n   * @return {boolean}\n   */\n  abstract isDefinedOn(node: Node): boolean;\n\n  /**\n   * @return {function(!NamedNode, !NamedNode):number} A standalone comparison function for\n   * this index\n   */\n  getCompare(): Comparator<NamedNode> {\n    return this.compare.bind(this);\n  }\n\n  /**\n   * Given a before and after value for a node, determine if the indexed value has changed. Even if they are different,\n   * it's possible that the changes are isolated to parts of the snapshot that are not indexed.\n   *\n   * @param {!Node} oldNode\n   * @param {!Node} newNode\n   * @return {boolean} True if the portion of the snapshot being indexed changed between oldNode and newNode\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    const oldWrapped = new NamedNode(MIN_NAME, oldNode);\n    const newWrapped = new NamedNode(MIN_NAME, newNode);\n    return this.compare(oldWrapped, newWrapped) !== 0;\n  }\n\n  /**\n   * @return {!NamedNode} a node wrapper that will sort equal to or less than\n   * any other node wrapper, using this index\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @return {!NamedNode} a node wrapper that will sort greater than or equal to\n   * any other node wrapper, using this index\n   */\n  abstract maxPost(): NamedNode;\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  abstract makePost(indexValue: any, name: string): NamedNode;\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  abstract toString(): string;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { Node, NamedNode } from '../Node';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { assert, assertionError } from '@firebase/util';\nimport { ChildrenNode } from '../ChildrenNode';\n\nlet __EMPTY_NODE: ChildrenNode;\n\nexport class KeyIndex extends Index {\n  static get __EMPTY_NODE() {\n    return __EMPTY_NODE;\n  }\n\n  static set __EMPTY_NODE(val) {\n    __EMPTY_NODE = val;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    return nameCompare(a.name, b.name);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    // We could probably return true here (since every node has a key), but it's never called\n    // so just leaving unimplemented for now.\n    throw assertionError('KeyIndex.isDefinedOn not expected to be called.');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return false; // The key for a node never changes.\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost() {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    // TODO: This should really be created once and cached in a static property, but\n    // NamedNode isn't defined yet, so I can't use it in a static.  Bleh.\n    return new NamedNode(MAX_NAME, __EMPTY_NODE);\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: string, name: string): NamedNode {\n    assert(\n      typeof indexValue === 'string',\n      'KeyIndex indexValue must always be a string.'\n    );\n    // We just use empty node, but it'll never be compared, since our comparator only looks at name.\n    return new NamedNode(indexValue, __EMPTY_NODE);\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.key';\n  }\n}\n\nexport const KEY_INDEX = new KeyIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { doubleToIEEE754String } from '../util/util';\nimport { contains } from '@firebase/util';\nimport { Node } from './Node';\n\nlet MAX_NODE: Node;\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @param {(!string|!number)} priority\n * @return {!string}\n */\nexport const priorityHashText = function(priority: string | number): string {\n  if (typeof priority === 'number')\n    return 'number:' + doubleToIEEE754String(priority);\n  else return 'string:' + priority;\n};\n\n/**\n * Validates that a priority snapshot Node is valid.\n *\n * @param {!Node} priorityNode\n */\nexport const validatePriorityNode = function(priorityNode: Node) {\n  if (priorityNode.isLeafNode()) {\n    const val = priorityNode.val();\n    assert(\n      typeof val === 'string' ||\n        typeof val === 'number' ||\n        (typeof val === 'object' &&\n          contains(val as { [key: string]: unknown }, '.sv')),\n      'Priority must be a string or number.'\n    );\n  } else {\n    assert(\n      priorityNode === MAX_NODE || priorityNode.isEmpty(),\n      'priority of unexpected type.'\n    );\n  }\n  // Don't call getPriority() on MAX_NODE to avoid hitting assertion.\n  assert(\n    priorityNode === MAX_NODE || priorityNode.getPriority().isEmpty(),\n    \"Priority nodes can't have a priority of their own.\"\n  );\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { doubleToIEEE754String, sha1 } from '../util/util';\nimport { priorityHashText, validatePriorityNode } from './snap';\nimport { Node } from './Node';\nimport { Path } from '../util/Path';\nimport { Index } from './indexes/Index';\nimport { ChildrenNodeConstructor } from './ChildrenNode';\n\nlet __childrenNodeConstructor: ChildrenNodeConstructor;\n\n/**\n * LeafNode is a class for storing leaf nodes in a DataSnapshot.  It\n * implements Node and stores the value of the node (a string,\n * number, or boolean) accessible via getValue().\n */\nexport class LeafNode implements Node {\n  static set __childrenNodeConstructor(val: ChildrenNodeConstructor) {\n    __childrenNodeConstructor = val;\n  }\n\n  static get __childrenNodeConstructor() {\n    return __childrenNodeConstructor;\n  }\n\n  /**\n   * The sort order for comparing leaf nodes of different types. If two leaf nodes have\n   * the same type, the comparison falls back to their value\n   * @type {Array.<!string>}\n   * @const\n   */\n  static VALUE_TYPE_ORDER = ['object', 'boolean', 'number', 'string'];\n\n  private lazyHash_: string | null = null;\n\n  /**\n   * @implements {Node}\n   * @param {!(string|number|boolean|Object)} value_ The value to store in this leaf node.\n   *                                         The object type is possible in the event of a deferred value\n   * @param {!Node=} priorityNode_ The priority of this node.\n   */\n  constructor(\n    private readonly value_: string | number | boolean | object,\n    private priorityNode_: Node = LeafNode.__childrenNodeConstructor.EMPTY_NODE\n  ) {\n    assert(\n      this.value_ !== undefined && this.value_ !== null,\n      \"LeafNode shouldn't be created with null/undefined value.\"\n    );\n\n    validatePriorityNode(this.priorityNode_);\n  }\n\n  /** @inheritDoc */\n  isLeafNode(): boolean {\n    return true;\n  }\n\n  /** @inheritDoc */\n  getPriority(): Node {\n    return this.priorityNode_;\n  }\n\n  /** @inheritDoc */\n  updatePriority(newPriorityNode: Node): Node {\n    return new LeafNode(this.value_, newPriorityNode);\n  }\n\n  /** @inheritDoc */\n  getImmediateChild(childName: string): Node {\n    // Hack to treat priority as a regular child\n    if (childName === '.priority') {\n      return this.priorityNode_;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n    }\n  }\n\n  /** @inheritDoc */\n  getChild(path: Path): Node {\n    if (path.isEmpty()) {\n      return this;\n    } else if (path.getFront() === '.priority') {\n      return this.priorityNode_;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasChild(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  getPredecessorChildName(childName: String, childNode: Node): null {\n    return null;\n  }\n\n  /** @inheritDoc */\n  updateImmediateChild(childName: string, newChildNode: Node): Node {\n    if (childName === '.priority') {\n      return this.updatePriority(newChildNode);\n    } else if (newChildNode.isEmpty() && childName !== '.priority') {\n      return this;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(\n        childName,\n        newChildNode\n      ).updatePriority(this.priorityNode_);\n    }\n  }\n\n  /** @inheritDoc */\n  updateChild(path: Path, newChildNode: Node): Node {\n    const front = path.getFront();\n    if (front === null) {\n      return newChildNode;\n    } else if (newChildNode.isEmpty() && front !== '.priority') {\n      return this;\n    } else {\n      assert(\n        front !== '.priority' || path.getLength() === 1,\n        '.priority must be the last token in a path'\n      );\n\n      return this.updateImmediateChild(\n        front,\n        LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(\n          path.popFront(),\n          newChildNode\n        )\n      );\n    }\n  }\n\n  /** @inheritDoc */\n  isEmpty(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  numChildren(): number {\n    return 0;\n  }\n\n  /** @inheritDoc */\n  forEachChild(index: Index, action: (s: string, n: Node) => void): any {\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  val(exportFormat?: boolean): Object {\n    if (exportFormat && !this.getPriority().isEmpty())\n      return {\n        '.value': this.getValue(),\n        '.priority': this.getPriority().val()\n      };\n    else return this.getValue();\n  }\n\n  /** @inheritDoc */\n  hash(): string {\n    if (this.lazyHash_ === null) {\n      let toHash = '';\n      if (!this.priorityNode_.isEmpty())\n        toHash +=\n          'priority:' +\n          priorityHashText(this.priorityNode_.val() as number | string) +\n          ':';\n\n      const type = typeof this.value_;\n      toHash += type + ':';\n      if (type === 'number') {\n        toHash += doubleToIEEE754String(this.value_ as number);\n      } else {\n        toHash += this.value_;\n      }\n      this.lazyHash_ = sha1(toHash);\n    }\n    return this.lazyHash_;\n  }\n\n  /**\n   * Returns the value of the leaf node.\n   * @return {Object|string|number|boolean} The value of the node.\n   */\n  getValue(): object | string | number | boolean {\n    return this.value_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compareTo(other: Node): number {\n    if (other === LeafNode.__childrenNodeConstructor.EMPTY_NODE) {\n      return 1;\n    } else if (other instanceof LeafNode.__childrenNodeConstructor) {\n      return -1;\n    } else {\n      assert(other.isLeafNode(), 'Unknown node type');\n      return this.compareToLeafNode_(other as LeafNode);\n    }\n  }\n\n  /**\n   * Comparison specifically for two leaf nodes\n   * @param {!LeafNode} otherLeaf\n   * @return {!number}\n   * @private\n   */\n  private compareToLeafNode_(otherLeaf: LeafNode): number {\n    const otherLeafType = typeof otherLeaf.value_;\n    const thisLeafType = typeof this.value_;\n    const otherIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType);\n    const thisIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);\n    assert(otherIndex >= 0, 'Unknown leaf type: ' + otherLeafType);\n    assert(thisIndex >= 0, 'Unknown leaf type: ' + thisLeafType);\n    if (otherIndex === thisIndex) {\n      // Same type, compare values\n      if (thisLeafType === 'object') {\n        // Deferred value nodes are all equal, but we should also never get to this point...\n        return 0;\n      } else {\n        // Note that this works because true > false, all others are number or string comparisons\n        if (this.value_ < otherLeaf.value_) {\n          return -1;\n        } else if (this.value_ === otherLeaf.value_) {\n          return 0;\n        } else {\n          return 1;\n        }\n      }\n    } else {\n      return thisIndex - otherIndex;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  withIndex(): Node {\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isIndexed(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  equals(other: Node): boolean {\n    /**\n     * @inheritDoc\n     */\n    if (other === this) {\n      return true;\n    } else if (other.isLeafNode()) {\n      const otherLeaf = other as LeafNode;\n      return (\n        this.value_ === otherLeaf.value_ &&\n        this.priorityNode_.equals(otherLeaf.priorityNode_)\n      );\n    } else {\n      return false;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { NamedNode, Node } from '../Node';\nimport { LeafNode } from '../LeafNode';\n\nlet nodeFromJSON: (a: any) => Node;\nlet MAX_NODE: Node;\n\nexport function setNodeFromJSON(val: (a: any) => Node) {\n  nodeFromJSON = val;\n}\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class PriorityIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aPriority = a.node.getPriority();\n    const bPriority = b.node.getPriority();\n    const indexCmp = aPriority.compareTo(bPriority);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getPriority().isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.getPriority().equals(newNode.getPriority());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return new NamedNode(MAX_NAME, new LeafNode('[PRIORITY-POST]', MAX_NODE));\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: any, name: string): NamedNode {\n    const priorityNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, new LeafNode('[PRIORITY-POST]', priorityNode));\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.priority';\n  }\n}\n\nexport const PRIORITY_INDEX = new PriorityIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implementation of an immutable SortedMap using a Left-leaning\n * Red-Black Tree, adapted from the implementation in Mugs\n * (http://mads379.github.com/mugs/) by Mads Hartmann Jensen\n * (mads379@gmail.com).\n *\n * Original paper on Left-leaning Red-Black Trees:\n *   http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf\n *\n * Invariant 1: No red node has a red child\n * Invariant 2: Every leaf path has the same number of black nodes\n * Invariant 3: Only the left child can be red (left leaning)\n */\n\n// TODO: There are some improvements I'd like to make to improve memory / perf:\n//  * Create two prototypes, LLRedNode and LLBlackNode, instead of storing a\n//    color property in every node.\n// TODO: It would also be good (and possibly necessary) to create a base\n// interface for LLRBNode and LLRBEmptyNode.\n\nexport type Comparator<K> = (key1: K, key2: K) => number;\n\n/**\n * An iterator over an LLRBNode.\n */\nexport class SortedMapIterator<K, V, T> {\n  /** @private\n   * @type {Array.<!LLRBNode>}\n   */\n  private nodeStack_: (LLRBNode<K, V> | LLRBEmptyNode<K, V>)[] = [];\n\n  /**\n   * @template K, V, T\n   * @param {LLRBNode|LLRBEmptyNode} node Node to iterate.\n   * @param {?K} startKey\n   * @param {function(K, K): number} comparator\n   * @param {boolean} isReverse_ Whether or not to iterate in reverse\n   * @param {(function(K, V):T)=} resultGenerator_\n   */\n  constructor(\n    node: LLRBNode<K, V> | LLRBEmptyNode<K, V>,\n    startKey: K | null,\n    comparator: Comparator<K>,\n    private isReverse_: boolean,\n    private resultGenerator_: ((k: K, v: V) => T) | null = null\n  ) {\n    let cmp = 1;\n    while (!node.isEmpty()) {\n      node = node as LLRBNode<K, V>;\n      cmp = startKey ? comparator(node.key, startKey) : 1;\n      // flip the comparison if we're going in reverse\n      if (isReverse_) cmp *= -1;\n\n      if (cmp < 0) {\n        // This node is less than our start key. ignore it\n        if (this.isReverse_) {\n          node = node.left;\n        } else {\n          node = node.right;\n        }\n      } else if (cmp === 0) {\n        // This node is exactly equal to our start key. Push it on the stack, but stop iterating;\n        this.nodeStack_.push(node);\n        break;\n      } else {\n        // This node is greater than our start key, add it to the stack and move to the next one\n        this.nodeStack_.push(node);\n        if (this.isReverse_) {\n          node = node.right;\n        } else {\n          node = node.left;\n        }\n      }\n    }\n  }\n\n  getNext(): T {\n    if (this.nodeStack_.length === 0) return null;\n\n    let node = this.nodeStack_.pop();\n    let result: T;\n    if (this.resultGenerator_)\n      result = this.resultGenerator_(node.key, node.value);\n    else result = { key: node.key, value: node.value } as any;\n\n    if (this.isReverse_) {\n      node = node.left;\n      while (!node.isEmpty()) {\n        this.nodeStack_.push(node);\n        node = node.right;\n      }\n    } else {\n      node = node.right;\n      while (!node.isEmpty()) {\n        this.nodeStack_.push(node);\n        node = node.left;\n      }\n    }\n\n    return result;\n  }\n\n  hasNext(): boolean {\n    return this.nodeStack_.length > 0;\n  }\n\n  peek(): T {\n    if (this.nodeStack_.length === 0) return null;\n\n    const node = this.nodeStack_[this.nodeStack_.length - 1];\n    if (this.resultGenerator_) {\n      return this.resultGenerator_(node.key, node.value);\n    } else {\n      return { key: node.key, value: node.value } as any;\n    }\n  }\n}\n\n/**\n * Represents a node in a Left-leaning Red-Black tree.\n */\nexport class LLRBNode<K, V> {\n  color: boolean;\n  left: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  right: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n\n  /**\n   * @template K, V\n   * @param {!K} key Key associated with this node.\n   * @param {!V} value Value associated with this node.\n   * @param {?boolean} color Whether this node is red.\n   * @param {?(LLRBNode|LLRBEmptyNode)=} left Left child.\n   * @param {?(LLRBNode|LLRBEmptyNode)=} right Right child.\n   */\n  constructor(\n    public key: K,\n    public value: V,\n    color: boolean | null,\n    left?: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right?: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ) {\n    this.color = color != null ? color : LLRBNode.RED;\n    this.left =\n      left != null ? left : (SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>);\n    this.right =\n      right != null ? right : (SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>);\n  }\n\n  static RED = true;\n  static BLACK = false;\n\n  /**\n   * Returns a copy of the current node, optionally replacing pieces of it.\n   *\n   * @param {?K} key New key for the node, or null.\n   * @param {?V} value New value for the node, or null.\n   * @param {?boolean} color New color for the node, or null.\n   * @param {?LLRBNode|LLRBEmptyNode} left New left child for the node, or null.\n   * @param {?LLRBNode|LLRBEmptyNode} right New right child for the node, or null.\n   * @return {!LLRBNode} The node copy.\n   */\n  copy(\n    key: K | null,\n    value: V | null,\n    color: boolean | null,\n    left: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ): LLRBNode<K, V> {\n    return new LLRBNode(\n      key != null ? key : this.key,\n      value != null ? value : this.value,\n      color != null ? color : this.color,\n      left != null ? left : this.left,\n      right != null ? right : this.right\n    );\n  }\n\n  /**\n   * @return {number} The total number of nodes in the tree.\n   */\n  count(): number {\n    return this.left.count() + 1 + this.right.count();\n  }\n\n  /**\n   * @return {boolean} True if the tree is empty.\n   */\n  isEmpty(): boolean {\n    return false;\n  }\n\n  /**\n   * Traverses the tree in key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called for each\n   *   node.  If it returns true, traversal is aborted.\n   * @return {*} The first truthy value returned by action, or the last falsey\n   *   value returned by action\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return (\n      this.left.inorderTraversal(action) ||\n      action(this.key, this.value) ||\n      this.right.inorderTraversal(action)\n    );\n  }\n\n  /**\n   * Traverses the tree in reverse key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!Object, !Object)} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {*} True if traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return (\n      this.right.reverseTraversal(action) ||\n      action(this.key, this.value) ||\n      this.left.reverseTraversal(action)\n    );\n  }\n\n  /**\n   * @return {!Object} The minimum node in the tree.\n   * @private\n   */\n  private min_(): LLRBNode<K, V> {\n    if (this.left.isEmpty()) {\n      return this;\n    } else {\n      return (this.left as LLRBNode<K, V>).min_();\n    }\n  }\n\n  /**\n   * @return {!K} The maximum key in the tree.\n   */\n  minKey(): K {\n    return this.min_().key;\n  }\n\n  /**\n   * @return {!K} The maximum key in the tree.\n   */\n  maxKey(): K {\n    if (this.right.isEmpty()) {\n      return this.key;\n    } else {\n      return this.right.maxKey();\n    }\n  }\n\n  /**\n   *\n   * @param {!Object} key Key to insert.\n   * @param {!Object} value Value to insert.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode} New tree, with the key/value added.\n   */\n  insert(key: K, value: V, comparator: Comparator<K>): LLRBNode<K, V> {\n    let cmp, n;\n    n = this;\n    cmp = comparator(key, n.key);\n    if (cmp < 0) {\n      n = n.copy(null, null, null, n.left.insert(key, value, comparator), null);\n    } else if (cmp === 0) {\n      n = n.copy(null, value, null, null, null);\n    } else {\n      n = n.copy(\n        null,\n        null,\n        null,\n        null,\n        n.right.insert(key, value, comparator)\n      );\n    }\n    return n.fixUp_();\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode|LLRBEmptyNode} New tree, with the minimum key removed.\n   */\n  private removeMin_(): LLRBNode<K, V> | LLRBEmptyNode<K, V> {\n    if (this.left.isEmpty()) {\n      return SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>;\n    }\n    let n: LLRBNode<K, V> = this;\n    if (!n.left.isRed_() && !n.left.left.isRed_()) n = n.moveRedLeft_();\n    n = n.copy(null, null, null, (n.left as LLRBNode<K, V>).removeMin_(), null);\n    return n.fixUp_();\n  }\n\n  /**\n   * @param {!Object} key The key of the item to remove.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode|LLRBEmptyNode} New tree, with the specified item removed.\n   */\n  remove(\n    key: K,\n    comparator: Comparator<K>\n  ): LLRBNode<K, V> | LLRBEmptyNode<K, V> {\n    let n, smallest;\n    n = this;\n    if (comparator(key, n.key) < 0) {\n      if (!n.left.isEmpty() && !n.left.isRed_() && !n.left.left.isRed_()) {\n        n = n.moveRedLeft_();\n      }\n      n = n.copy(null, null, null, n.left.remove(key, comparator), null);\n    } else {\n      if (n.left.isRed_()) n = n.rotateRight_();\n      if (!n.right.isEmpty() && !n.right.isRed_() && !n.right.left.isRed_()) {\n        n = n.moveRedRight_();\n      }\n      if (comparator(key, n.key) === 0) {\n        if (n.right.isEmpty()) {\n          return SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>;\n        } else {\n          smallest = (n.right as LLRBNode<K, V>).min_();\n          n = n.copy(\n            smallest.key,\n            smallest.value,\n            null,\n            null,\n            (n.right as LLRBNode<K, V>).removeMin_()\n          );\n        }\n      }\n      n = n.copy(null, null, null, null, n.right.remove(key, comparator));\n    }\n    return n.fixUp_();\n  }\n\n  /**\n   * @private\n   * @return {boolean} Whether this is a RED node.\n   */\n  isRed_(): boolean {\n    return this.color;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree after performing any needed rotations.\n   */\n  private fixUp_(): LLRBNode<K, V> {\n    let n = this as any;\n    if (n.right.isRed_() && !n.left.isRed_()) n = n.rotateLeft_();\n    if (n.left.isRed_() && n.left.left.isRed_()) n = n.rotateRight_();\n    if (n.left.isRed_() && n.right.isRed_()) n = n.colorFlip_();\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after moveRedLeft.\n   */\n  private moveRedLeft_(): LLRBNode<K, V> {\n    let n = this.colorFlip_();\n    if (n.right.left.isRed_()) {\n      n = n.copy(\n        null,\n        null,\n        null,\n        null,\n        (n.right as LLRBNode<K, V>).rotateRight_()\n      );\n      n = n.rotateLeft_();\n      n = n.colorFlip_();\n    }\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after moveRedRight.\n   */\n  private moveRedRight_(): LLRBNode<K, V> {\n    let n = this.colorFlip_();\n    if (n.left.left.isRed_()) {\n      n = n.rotateRight_();\n      n = n.colorFlip_();\n    }\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after rotateLeft.\n   */\n  private rotateLeft_(): LLRBNode<K, V> {\n    const nl = this.copy(null, null, LLRBNode.RED, null, this.right.left);\n    return this.right.copy(null, null, this.color, nl, null) as LLRBNode<K, V>;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after rotateRight.\n   */\n  private rotateRight_(): LLRBNode<K, V> {\n    const nr = this.copy(null, null, LLRBNode.RED, this.left.right, null);\n    return this.left.copy(null, null, this.color, null, nr) as LLRBNode<K, V>;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after colorFlip.\n   */\n  private colorFlip_(): LLRBNode<K, V> {\n    const left = this.left.copy(null, null, !this.left.color, null, null);\n    const right = this.right.copy(null, null, !this.right.color, null, null);\n    return this.copy(null, null, !this.color, left, right);\n  }\n\n  /**\n   * For testing.\n   *\n   * @private\n   * @return {boolean} True if all is well.\n   */\n  private checkMaxDepth_(): boolean {\n    const blackDepth = this.check_();\n    return Math.pow(2.0, blackDepth) <= this.count() + 1;\n  }\n\n  /**\n   * @private\n   * @return {number} Not sure what this returns exactly. :-).\n   */\n  check_(): number {\n    let blackDepth;\n    if (this.isRed_() && this.left.isRed_()) {\n      throw new Error(\n        'Red node has red child(' + this.key + ',' + this.value + ')'\n      );\n    }\n    if (this.right.isRed_()) {\n      throw new Error(\n        'Right child of (' + this.key + ',' + this.value + ') is red'\n      );\n    }\n    blackDepth = this.left.check_();\n    if (blackDepth !== this.right.check_()) {\n      throw new Error('Black depths differ');\n    } else {\n      return blackDepth + (this.isRed_() ? 0 : 1);\n    }\n  }\n}\n\n/**\n * Represents an empty node (a leaf node in the Red-Black Tree).\n */\nexport class LLRBEmptyNode<K, V> {\n  key: K;\n  value: V;\n  left: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  right: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  color: boolean;\n\n  /**\n   * Returns a copy of the current node.\n   *\n   * @return {!LLRBEmptyNode} The node copy.\n   */\n  copy(\n    key: K | null,\n    value: V | null,\n    color: boolean | null,\n    left: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ): LLRBEmptyNode<K, V> {\n    return this;\n  }\n\n  /**\n   * Returns a copy of the tree, with the specified key/value added.\n   *\n   * @param {!K} key Key to be added.\n   * @param {!V} value Value to be added.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode} New tree, with item added.\n   */\n  insert(key: K, value: V, comparator: Comparator<K>): LLRBNode<K, V> {\n    return new LLRBNode(key, value, null);\n  }\n\n  /**\n   * Returns a copy of the tree, with the specified key removed.\n   *\n   * @param {!K} key The key to remove.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBEmptyNode} New tree, with item removed.\n   */\n  remove(key: K, comparator: Comparator<K>): LLRBEmptyNode<K, V> {\n    return this;\n  }\n\n  /**\n   * @return {number} The total number of nodes in the tree.\n   */\n  count(): number {\n    return 0;\n  }\n\n  /**\n   * @return {boolean} True if the tree is empty.\n   */\n  isEmpty(): boolean {\n    return true;\n  }\n\n  /**\n   * Traverses the tree in key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {boolean} True if traversal was aborted.\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return false;\n  }\n\n  /**\n   * Traverses the tree in reverse key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V)} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {boolean} True if traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return false;\n  }\n\n  /**\n   * @return {null}\n   */\n  minKey(): null {\n    return null;\n  }\n\n  /**\n   * @return {null}\n   */\n  maxKey(): null {\n    return null;\n  }\n\n  /**\n   * @private\n   * @return {number} Not sure what this returns exactly. :-).\n   */\n  check_(): number {\n    return 0;\n  }\n\n  /**\n   * @private\n   * @return {boolean} Whether this node is red.\n   */\n  isRed_() {\n    return false;\n  }\n}\n\n/**\n * An immutable sorted map implementation, based on a Left-leaning Red-Black\n * tree.\n */\nexport class SortedMap<K, V> {\n  /**\n   * Always use the same empty node, to reduce memory.\n   * @const\n   */\n  static EMPTY_NODE = new LLRBEmptyNode();\n\n  /**\n   * @template K, V\n   * @param {function(K, K):number} comparator_ Key comparator.\n   * @param {LLRBNode=} root_ (Optional) Root node for the map.\n   */\n  constructor(\n    private comparator_: Comparator<K>,\n    private root_:\n      | LLRBNode<K, V>\n      | LLRBEmptyNode<K, V> = SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>\n  ) {}\n\n  /**\n   * Returns a copy of the map, with the specified key/value added or replaced.\n   * (TODO: We should perhaps rename this method to 'put')\n   *\n   * @param {!K} key Key to be added.\n   * @param {!V} value Value to be added.\n   * @return {!SortedMap.<K, V>} New map, with item added.\n   */\n  insert(key: K, value: V): SortedMap<K, V> {\n    return new SortedMap(\n      this.comparator_,\n      this.root_\n        .insert(key, value, this.comparator_)\n        .copy(null, null, LLRBNode.BLACK, null, null)\n    );\n  }\n\n  /**\n   * Returns a copy of the map, with the specified key removed.\n   *\n   * @param {!K} key The key to remove.\n   * @return {!SortedMap.<K, V>} New map, with item removed.\n   */\n  remove(key: K): SortedMap<K, V> {\n    return new SortedMap(\n      this.comparator_,\n      this.root_\n        .remove(key, this.comparator_)\n        .copy(null, null, LLRBNode.BLACK, null, null)\n    );\n  }\n\n  /**\n   * Returns the value of the node with the given key, or null.\n   *\n   * @param {!K} key The key to look up.\n   * @return {?V} The value of the node with the given key, or null if the\n   * key doesn't exist.\n   */\n  get(key: K): V | null {\n    let cmp;\n    let node = this.root_;\n    while (!node.isEmpty()) {\n      cmp = this.comparator_(key, node.key);\n      if (cmp === 0) {\n        return node.value;\n      } else if (cmp < 0) {\n        node = node.left;\n      } else if (cmp > 0) {\n        node = node.right;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Returns the key of the item *before* the specified key, or null if key is the first item.\n   * @param {K} key The key to find the predecessor of\n   * @return {?K} The predecessor key.\n   */\n  getPredecessorKey(key: K): K | null {\n    let cmp,\n      node = this.root_,\n      rightParent = null;\n    while (!node.isEmpty()) {\n      cmp = this.comparator_(key, node.key);\n      if (cmp === 0) {\n        if (!node.left.isEmpty()) {\n          node = node.left;\n          while (!node.right.isEmpty()) node = node.right;\n          return node.key;\n        } else if (rightParent) {\n          return rightParent.key;\n        } else {\n          return null; // first item.\n        }\n      } else if (cmp < 0) {\n        node = node.left;\n      } else if (cmp > 0) {\n        rightParent = node;\n        node = node.right;\n      }\n    }\n\n    throw new Error(\n      'Attempted to find predecessor key for a nonexistent key.  What gives?'\n    );\n  }\n\n  /**\n   * @return {boolean} True if the map is empty.\n   */\n  isEmpty(): boolean {\n    return this.root_.isEmpty();\n  }\n\n  /**\n   * @return {number} The total number of nodes in the map.\n   */\n  count(): number {\n    return this.root_.count();\n  }\n\n  /**\n   * @return {?K} The minimum key in the map.\n   */\n  minKey(): K | null {\n    return this.root_.minKey();\n  }\n\n  /**\n   * @return {?K} The maximum key in the map.\n   */\n  maxKey(): K | null {\n    return this.root_.maxKey();\n  }\n\n  /**\n   * Traverses the map in key order and calls the specified action function\n   * for each key/value pair.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called\n   * for each key/value pair.  If action returns true, traversal is aborted.\n   * @return {*} The first truthy value returned by action, or the last falsey\n   *   value returned by action\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return this.root_.inorderTraversal(action);\n  }\n\n  /**\n   * Traverses the map in reverse key order and calls the specified action function\n   * for each key/value pair.\n   *\n   * @param {function(!Object, !Object)} action Callback function to be called\n   * for each key/value pair.  If action returns true, traversal is aborted.\n   * @return {*} True if the traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return this.root_.reverseTraversal(action);\n  }\n\n  /**\n   * Returns an iterator over the SortedMap.\n   * @template T\n   * @param {(function(K, V):T)=} resultGenerator\n   * @return {SortedMapIterator.<K, V, T>} The iterator.\n   */\n  getIterator<T>(\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      null,\n      this.comparator_,\n      false,\n      resultGenerator\n    );\n  }\n\n  getIteratorFrom<T>(\n    key: K,\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      key,\n      this.comparator_,\n      false,\n      resultGenerator\n    );\n  }\n\n  getReverseIteratorFrom<T>(\n    key: K,\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      key,\n      this.comparator_,\n      true,\n      resultGenerator\n    );\n  }\n\n  getReverseIterator<T>(\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      null,\n      this.comparator_,\n      true,\n      resultGenerator\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LLRBNode } from '../util/SortedMap';\nimport { SortedMap } from '../util/SortedMap';\nimport { NamedNode } from './Node';\n\nconst LOG_2 = Math.log(2);\n\n/**\n * @constructor\n */\nclass Base12Num {\n  count: number;\n  private current_: number;\n  private bits_: number;\n\n  /**\n   * @param {number} length\n   */\n  constructor(length: number) {\n    const logBase2 = (num: number) =>\n      parseInt((Math.log(num) / LOG_2) as any, 10);\n    const bitMask = (bits: number) => parseInt(Array(bits + 1).join('1'), 2);\n    this.count = logBase2(length + 1);\n    this.current_ = this.count - 1;\n    const mask = bitMask(this.count);\n    this.bits_ = (length + 1) & mask;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  nextBitIsOne(): boolean {\n    //noinspection JSBitwiseOperatorUsage\n    const result = !(this.bits_ & (0x1 << this.current_));\n    this.current_--;\n    return result;\n  }\n}\n\n/**\n * Takes a list of child nodes and constructs a SortedSet using the given comparison\n * function\n *\n * Uses the algorithm described in the paper linked here:\n * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.46.1458\n *\n * @template K, V\n * @param {Array.<!NamedNode>} childList Unsorted list of children\n * @param {function(!NamedNode, !NamedNode):number} cmp The comparison method to be used\n * @param {(function(NamedNode):K)=} keyFn An optional function to extract K from a node wrapper, if K's\n *                                                        type is not NamedNode\n * @param {(function(K, K):number)=} mapSortFn An optional override for comparator used by the generated sorted map\n * @return {SortedMap.<K, V>}\n */\nexport const buildChildSet = function<K, V>(\n  childList: NamedNode[],\n  cmp: (a: NamedNode, b: NamedNode) => number,\n  keyFn?: (a: NamedNode) => K,\n  mapSortFn?: (a: K, b: K) => number\n): SortedMap<K, V> {\n  childList.sort(cmp);\n\n  const buildBalancedTree = function(\n    low: number,\n    high: number\n  ): LLRBNode<K, V> | null {\n    const length = high - low;\n    let namedNode: NamedNode;\n    let key: K;\n    if (length == 0) {\n      return null;\n    } else if (length == 1) {\n      namedNode = childList[low];\n      key = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      return new LLRBNode(\n        key,\n        (namedNode.node as any) as V,\n        LLRBNode.BLACK,\n        null,\n        null\n      );\n    } else {\n      const middle = parseInt((length / 2) as any, 10) + low;\n      const left = buildBalancedTree(low, middle);\n      const right = buildBalancedTree(middle + 1, high);\n      namedNode = childList[middle];\n      key = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      return new LLRBNode(\n        key,\n        (namedNode.node as any) as V,\n        LLRBNode.BLACK,\n        left,\n        right\n      );\n    }\n  };\n\n  const buildFrom12Array = function(base12: Base12Num): LLRBNode<K, V> {\n    let node: LLRBNode<K, V> = null;\n    let root = null;\n    let index = childList.length;\n\n    const buildPennant = function(chunkSize: number, color: boolean) {\n      const low = index - chunkSize;\n      const high = index;\n      index -= chunkSize;\n      const childTree = buildBalancedTree(low + 1, high);\n      const namedNode = childList[low];\n      const key: K = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      attachPennant(\n        new LLRBNode(key, (namedNode.node as any) as V, color, null, childTree)\n      );\n    };\n\n    const attachPennant = function(pennant: LLRBNode<K, V>) {\n      if (node) {\n        node.left = pennant;\n        node = pennant;\n      } else {\n        root = pennant;\n        node = pennant;\n      }\n    };\n\n    for (let i = 0; i < base12.count; ++i) {\n      const isOne = base12.nextBitIsOne();\n      // The number of nodes taken in each slice is 2^(arr.length - (i + 1))\n      const chunkSize = Math.pow(2, base12.count - (i + 1));\n      if (isOne) {\n        buildPennant(chunkSize, LLRBNode.BLACK);\n      } else {\n        // current == 2\n        buildPennant(chunkSize, LLRBNode.BLACK);\n        buildPennant(chunkSize, LLRBNode.RED);\n      }\n    }\n    return root;\n  };\n\n  const base12 = new Base12Num(childList.length);\n  const root = buildFrom12Array(base12);\n\n  return new SortedMap<K, V>(mapSortFn || (cmp as any), root);\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { buildChildSet } from './childSet';\nimport { contains, clone, map, safeGet } from '@firebase/util';\nimport { NamedNode, Node } from './Node';\nimport { PRIORITY_INDEX } from './indexes/PriorityIndex';\nimport { KEY_INDEX } from './indexes/KeyIndex';\nimport { SortedMap } from '../util/SortedMap';\nimport { Index } from './indexes/Index';\n\nlet _defaultIndexMap: IndexMap;\n\nconst fallbackObject = {};\n\n/**\n *\n * @param {Object.<string, FallbackType|SortedMap.<NamedNode, Node>>} indexes\n * @param {Object.<string, Index>} indexSet\n * @constructor\n */\nexport class IndexMap {\n  /**\n   * The default IndexMap for nodes without a priority\n   * @type {!IndexMap}\n   * @const\n   */\n  static get Default(): IndexMap {\n    assert(\n      fallbackObject && PRIORITY_INDEX,\n      'ChildrenNode.ts has not been loaded'\n    );\n    _defaultIndexMap =\n      _defaultIndexMap ||\n      new IndexMap(\n        { '.priority': fallbackObject },\n        { '.priority': PRIORITY_INDEX }\n      );\n    return _defaultIndexMap;\n  }\n\n  constructor(\n    private indexes_: {\n      [k: string]: SortedMap<NamedNode, Node> | /*FallbackType*/ object;\n    },\n    private indexSet_: { [k: string]: Index }\n  ) {}\n\n  /**\n   *\n   * @param {!string} indexKey\n   * @return {?SortedMap.<NamedNode, Node>}\n   */\n  get(indexKey: string): SortedMap<NamedNode, Node> | null {\n    const sortedMap = safeGet(this.indexes_, indexKey);\n    if (!sortedMap) throw new Error('No index defined for ' + indexKey);\n\n    if (sortedMap === fallbackObject) {\n      // The index exists, but it falls back to just name comparison. Return null so that the calling code uses the\n      // regular child map\n      return null;\n    } else {\n      return sortedMap as SortedMap<NamedNode, Node>;\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {boolean}\n   */\n  hasIndex(indexDefinition: Index): boolean {\n    return contains(this.indexSet_, indexDefinition.toString());\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @param {!SortedMap.<string, !Node>} existingChildren\n   * @return {!IndexMap}\n   */\n  addIndex(\n    indexDefinition: Index,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    assert(\n      indexDefinition !== KEY_INDEX,\n      \"KeyIndex always exists and isn't meant to be added to the IndexMap.\"\n    );\n    const childList = [];\n    let sawIndexedValue = false;\n    const iter = existingChildren.getIterator(NamedNode.Wrap);\n    let next = iter.getNext();\n    while (next) {\n      sawIndexedValue =\n        sawIndexedValue || indexDefinition.isDefinedOn(next.node);\n      childList.push(next);\n      next = iter.getNext();\n    }\n    let newIndex;\n    if (sawIndexedValue) {\n      newIndex = buildChildSet(childList, indexDefinition.getCompare());\n    } else {\n      newIndex = fallbackObject;\n    }\n    const indexName = indexDefinition.toString();\n    const newIndexSet = clone(this.indexSet_);\n    newIndexSet[indexName] = indexDefinition;\n    const newIndexes = clone(this.indexes_);\n    newIndexes[indexName] = newIndex;\n    return new IndexMap(newIndexes, newIndexSet);\n  }\n\n  /**\n   * Ensure that this node is properly tracked in any indexes that we're maintaining\n   * @param {!NamedNode} namedNode\n   * @param {!SortedMap.<string, !Node>} existingChildren\n   * @return {!IndexMap}\n   */\n  addToIndexes(\n    namedNode: NamedNode,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    const newIndexes = map(\n      this.indexes_,\n      (indexedChildren: SortedMap<NamedNode, Node>, indexName: string) => {\n        const index = safeGet(this.indexSet_, indexName);\n        assert(index, 'Missing index implementation for ' + indexName);\n        if (indexedChildren === fallbackObject) {\n          // Check to see if we need to index everything\n          if (index.isDefinedOn(namedNode.node)) {\n            // We need to build this index\n            const childList = [];\n            const iter = existingChildren.getIterator(NamedNode.Wrap);\n            let next = iter.getNext();\n            while (next) {\n              if (next.name != namedNode.name) {\n                childList.push(next);\n              }\n              next = iter.getNext();\n            }\n            childList.push(namedNode);\n            return buildChildSet(childList, index.getCompare());\n          } else {\n            // No change, this remains a fallback\n            return fallbackObject;\n          }\n        } else {\n          const existingSnap = existingChildren.get(namedNode.name);\n          let newChildren = indexedChildren;\n          if (existingSnap) {\n            newChildren = newChildren.remove(\n              new NamedNode(namedNode.name, existingSnap)\n            );\n          }\n          return newChildren.insert(namedNode, namedNode.node);\n        }\n      }\n    );\n    return new IndexMap(newIndexes, this.indexSet_);\n  }\n\n  /**\n   * Create a new IndexMap instance with the given value removed\n   * @param {!NamedNode} namedNode\n   * @param {!SortedMap.<string, !Node>} existingChildren\n   * @return {!IndexMap}\n   */\n  removeFromIndexes(\n    namedNode: NamedNode,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    const newIndexes = map(this.indexes_, function(\n      indexedChildren: SortedMap<NamedNode, Node>\n    ) {\n      if (indexedChildren === fallbackObject) {\n        // This is the fallback. Just return it, nothing to do in this case\n        return indexedChildren;\n      } else {\n        const existingSnap = existingChildren.get(namedNode.name);\n        if (existingSnap) {\n          return indexedChildren.remove(\n            new NamedNode(namedNode.name, existingSnap)\n          );\n        } else {\n          // No record of this child\n          return indexedChildren;\n        }\n      }\n    });\n    return new IndexMap(newIndexes, this.indexSet_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nameCompare } from '../util/util';\nimport { NamedNode } from './Node';\n\nexport function NAME_ONLY_COMPARATOR(left: NamedNode, right: NamedNode) {\n  return nameCompare(left.name, right.name);\n}\n\nexport function NAME_COMPARATOR(left: string, right: string) {\n  return nameCompare(left, right);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { sha1, MAX_NAME, MIN_NAME } from '../util/util';\nimport { SortedMap, SortedMapIterator } from '../util/SortedMap';\nimport { Node, NamedNode } from './Node';\nimport { validatePriorityNode, priorityHashText, setMaxNode } from './snap';\nimport {\n  PRIORITY_INDEX,\n  setMaxNode as setPriorityMaxNode\n} from './indexes/PriorityIndex';\nimport { KEY_INDEX, KeyIndex } from './indexes/KeyIndex';\nimport { IndexMap } from './IndexMap';\nimport { LeafNode } from './LeafNode';\nimport { NAME_COMPARATOR } from './comparators';\nimport { Index } from './indexes/Index';\nimport { Path } from '../util/Path';\n\nexport interface ChildrenNodeConstructor {\n  new (\n    children_: SortedMap<string, Node>,\n    priorityNode_: Node | null,\n    indexMap_: IndexMap\n  ): ChildrenNode;\n  EMPTY_NODE: ChildrenNode;\n}\n\n// TODO: For memory savings, don't store priorityNode_ if it's empty.\n\nlet EMPTY_NODE: ChildrenNode;\n\n/**\n * ChildrenNode is a class for storing internal nodes in a DataSnapshot\n * (i.e. nodes with children).  It implements Node and stores the\n * list of children in the children property, sorted by child name.\n *\n * @constructor\n * @implements {Node}\n */\nexport class ChildrenNode implements Node {\n  private lazyHash_: string | null = null;\n\n  static get EMPTY_NODE(): ChildrenNode {\n    return (\n      EMPTY_NODE ||\n      (EMPTY_NODE = new ChildrenNode(\n        new SortedMap<string, Node>(NAME_COMPARATOR),\n        null,\n        IndexMap.Default\n      ))\n    );\n  }\n\n  /**\n   *\n   * @param {!SortedMap.<string, !Node>} children_ List of children\n   * of this node..\n   * @param {?Node} priorityNode_ The priority of this node (as a snapshot node).\n   * @param {!IndexMap} indexMap_\n   */\n  constructor(\n    private readonly children_: SortedMap<string, Node>,\n    private readonly priorityNode_: Node | null,\n    private indexMap_: IndexMap\n  ) {\n    /**\n     * Note: The only reason we allow null priority is for EMPTY_NODE, since we can't use\n     * EMPTY_NODE as the priority of EMPTY_NODE.  We might want to consider making EMPTY_NODE its own\n     * class instead of an empty ChildrenNode.\n     */\n    if (this.priorityNode_) {\n      validatePriorityNode(this.priorityNode_);\n    }\n\n    if (this.children_.isEmpty()) {\n      assert(\n        !this.priorityNode_ || this.priorityNode_.isEmpty(),\n        'An empty node cannot have a priority'\n      );\n    }\n  }\n\n  /** @inheritDoc */\n  isLeafNode(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  getPriority(): Node {\n    return this.priorityNode_ || EMPTY_NODE;\n  }\n\n  /** @inheritDoc */\n  updatePriority(newPriorityNode: Node): Node {\n    if (this.children_.isEmpty()) {\n      // Don't allow priorities on empty nodes\n      return this;\n    } else {\n      return new ChildrenNode(this.children_, newPriorityNode, this.indexMap_);\n    }\n  }\n\n  /** @inheritDoc */\n  getImmediateChild(childName: string): Node {\n    // Hack to treat priority as a regular child\n    if (childName === '.priority') {\n      return this.getPriority();\n    } else {\n      const child = this.children_.get(childName);\n      return child === null ? EMPTY_NODE : child;\n    }\n  }\n\n  /** @inheritDoc */\n  getChild(path: Path): Node {\n    const front = path.getFront();\n    if (front === null) return this;\n\n    return this.getImmediateChild(front).getChild(path.popFront());\n  }\n\n  /** @inheritDoc */\n  hasChild(childName: string): boolean {\n    return this.children_.get(childName) !== null;\n  }\n\n  /** @inheritDoc */\n  updateImmediateChild(childName: string, newChildNode: Node): Node {\n    assert(newChildNode, 'We should always be passing snapshot nodes');\n    if (childName === '.priority') {\n      return this.updatePriority(newChildNode);\n    } else {\n      const namedNode = new NamedNode(childName, newChildNode);\n      let newChildren, newIndexMap, newPriority;\n      if (newChildNode.isEmpty()) {\n        newChildren = this.children_.remove(childName);\n        newIndexMap = this.indexMap_.removeFromIndexes(\n          namedNode,\n          this.children_\n        );\n      } else {\n        newChildren = this.children_.insert(childName, newChildNode);\n        newIndexMap = this.indexMap_.addToIndexes(namedNode, this.children_);\n      }\n\n      newPriority = newChildren.isEmpty() ? EMPTY_NODE : this.priorityNode_;\n      return new ChildrenNode(newChildren, newPriority, newIndexMap);\n    }\n  }\n\n  /** @inheritDoc */\n  updateChild(path: Path, newChildNode: Node): Node {\n    const front = path.getFront();\n    if (front === null) {\n      return newChildNode;\n    } else {\n      assert(\n        path.getFront() !== '.priority' || path.getLength() === 1,\n        '.priority must be the last token in a path'\n      );\n      const newImmediateChild = this.getImmediateChild(front).updateChild(\n        path.popFront(),\n        newChildNode\n      );\n      return this.updateImmediateChild(front, newImmediateChild);\n    }\n  }\n\n  /** @inheritDoc */\n  isEmpty(): boolean {\n    return this.children_.isEmpty();\n  }\n\n  /** @inheritDoc */\n  numChildren(): number {\n    return this.children_.count();\n  }\n\n  /**\n   * @private\n   * @type {RegExp}\n   */\n  private static INTEGER_REGEXP_ = /^(0|[1-9]\\d*)$/;\n\n  /** @inheritDoc */\n  val(exportFormat?: boolean): object {\n    if (this.isEmpty()) return null;\n\n    const obj: { [k: string]: unknown } = {};\n    let numKeys = 0,\n      maxKey = 0,\n      allIntegerKeys = true;\n    this.forEachChild(PRIORITY_INDEX, function(key: string, childNode: Node) {\n      obj[key] = childNode.val(exportFormat);\n\n      numKeys++;\n      if (allIntegerKeys && ChildrenNode.INTEGER_REGEXP_.test(key)) {\n        maxKey = Math.max(maxKey, Number(key));\n      } else {\n        allIntegerKeys = false;\n      }\n    });\n\n    if (!exportFormat && allIntegerKeys && maxKey < 2 * numKeys) {\n      // convert to array.\n      const array: unknown[] = [];\n      for (let key in obj) array[(key as any) as number] = obj[key];\n\n      return array;\n    } else {\n      if (exportFormat && !this.getPriority().isEmpty()) {\n        obj['.priority'] = this.getPriority().val();\n      }\n      return obj;\n    }\n  }\n\n  /** @inheritDoc */\n  hash(): string {\n    if (this.lazyHash_ === null) {\n      let toHash = '';\n      if (!this.getPriority().isEmpty())\n        toHash +=\n          'priority:' +\n          priorityHashText(this.getPriority().val() as string | number) +\n          ':';\n\n      this.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n        const childHash = childNode.hash();\n        if (childHash !== '') toHash += ':' + key + ':' + childHash;\n      });\n\n      this.lazyHash_ = toHash === '' ? '' : sha1(toHash);\n    }\n    return this.lazyHash_;\n  }\n\n  /** @inheritDoc */\n  getPredecessorChildName(\n    childName: string,\n    childNode: Node,\n    index: Index\n  ): string {\n    const idx = this.resolveIndex_(index);\n    if (idx) {\n      const predecessor = idx.getPredecessorKey(\n        new NamedNode(childName, childNode)\n      );\n      return predecessor ? predecessor.name : null;\n    } else {\n      return this.children_.getPredecessorKey(childName);\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?string}\n   */\n  getFirstChildName(indexDefinition: Index): string | null {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      const minKey = idx.minKey();\n      return minKey && minKey.name;\n    } else {\n      return this.children_.minKey();\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?NamedNode}\n   */\n  getFirstChild(indexDefinition: Index): NamedNode | null {\n    const minKey = this.getFirstChildName(indexDefinition);\n    if (minKey) {\n      return new NamedNode(minKey, this.children_.get(minKey));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Given an index, return the key name of the largest value we have, according to that index\n   * @param {!Index} indexDefinition\n   * @return {?string}\n   */\n  getLastChildName(indexDefinition: Index): string | null {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      const maxKey = idx.maxKey();\n      return maxKey && maxKey.name;\n    } else {\n      return this.children_.maxKey();\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?NamedNode}\n   */\n  getLastChild(indexDefinition: Index): NamedNode | null {\n    const maxKey = this.getLastChildName(indexDefinition);\n    if (maxKey) {\n      return new NamedNode(maxKey, this.children_.get(maxKey));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachChild(\n    index: Index,\n    action: (key: string, node: Node) => boolean | void\n  ): boolean {\n    const idx = this.resolveIndex_(index);\n    if (idx) {\n      return idx.inorderTraversal(function(wrappedNode) {\n        return action(wrappedNode.name, wrappedNode.node);\n      });\n    } else {\n      return this.children_.inorderTraversal(action);\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {SortedMapIterator}\n   */\n  getIterator(\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    return this.getIteratorFrom(indexDefinition.minPost(), indexDefinition);\n  }\n\n  /**\n   *\n   * @param {!NamedNode} startPost\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getIteratorFrom(\n    startPost: NamedNode,\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      return idx.getIteratorFrom(startPost, key => key);\n    } else {\n      const iterator = this.children_.getIteratorFrom(\n        startPost.name,\n        NamedNode.Wrap\n      );\n      let next = iterator.peek();\n      while (next != null && indexDefinition.compare(next, startPost) < 0) {\n        iterator.getNext();\n        next = iterator.peek();\n      }\n      return iterator;\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getReverseIterator(\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    return this.getReverseIteratorFrom(\n      indexDefinition.maxPost(),\n      indexDefinition\n    );\n  }\n\n  /**\n   * @param {!NamedNode} endPost\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getReverseIteratorFrom(\n    endPost: NamedNode,\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      return idx.getReverseIteratorFrom(endPost, function(key) {\n        return key;\n      });\n    } else {\n      const iterator = this.children_.getReverseIteratorFrom(\n        endPost.name,\n        NamedNode.Wrap\n      );\n      let next = iterator.peek();\n      while (next != null && indexDefinition.compare(next, endPost) > 0) {\n        iterator.getNext();\n        next = iterator.peek();\n      }\n      return iterator;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compareTo(other: ChildrenNode): number {\n    if (this.isEmpty()) {\n      if (other.isEmpty()) {\n        return 0;\n      } else {\n        return -1;\n      }\n    } else if (other.isLeafNode() || other.isEmpty()) {\n      return 1;\n    } else if (other === MAX_NODE) {\n      return -1;\n    } else {\n      // Must be another node with children.\n      return 0;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  withIndex(indexDefinition: Index): Node {\n    if (\n      indexDefinition === KEY_INDEX ||\n      this.indexMap_.hasIndex(indexDefinition)\n    ) {\n      return this;\n    } else {\n      const newIndexMap = this.indexMap_.addIndex(\n        indexDefinition,\n        this.children_\n      );\n      return new ChildrenNode(this.children_, this.priorityNode_, newIndexMap);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isIndexed(index: Index): boolean {\n    return index === KEY_INDEX || this.indexMap_.hasIndex(index);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  equals(other: Node): boolean {\n    if (other === this) {\n      return true;\n    } else if (other.isLeafNode()) {\n      return false;\n    } else {\n      const otherChildrenNode = other as ChildrenNode;\n      if (!this.getPriority().equals(otherChildrenNode.getPriority())) {\n        return false;\n      } else if (\n        this.children_.count() === otherChildrenNode.children_.count()\n      ) {\n        const thisIter = this.getIterator(PRIORITY_INDEX);\n        const otherIter = otherChildrenNode.getIterator(PRIORITY_INDEX);\n        let thisCurrent = thisIter.getNext();\n        let otherCurrent = otherIter.getNext();\n        while (thisCurrent && otherCurrent) {\n          if (\n            thisCurrent.name !== otherCurrent.name ||\n            !thisCurrent.node.equals(otherCurrent.node)\n          ) {\n            return false;\n          }\n          thisCurrent = thisIter.getNext();\n          otherCurrent = otherIter.getNext();\n        }\n        return thisCurrent === null && otherCurrent === null;\n      } else {\n        return false;\n      }\n    }\n  }\n\n  /**\n   * Returns a SortedMap ordered by index, or null if the default (by-key) ordering can be used\n   * instead.\n   *\n   * @private\n   * @param {!Index} indexDefinition\n   * @return {?SortedMap.<NamedNode, Node>}\n   */\n  private resolveIndex_(\n    indexDefinition: Index\n  ): SortedMap<NamedNode, Node> | null {\n    if (indexDefinition === KEY_INDEX) {\n      return null;\n    } else {\n      return this.indexMap_.get(indexDefinition.toString());\n    }\n  }\n}\n\n/**\n * @constructor\n * @extends {ChildrenNode}\n * @private\n */\nexport class MaxNode extends ChildrenNode {\n  constructor() {\n    super(\n      new SortedMap<string, Node>(NAME_COMPARATOR),\n      ChildrenNode.EMPTY_NODE,\n      IndexMap.Default\n    );\n  }\n\n  compareTo(other: Node): number {\n    if (other === this) {\n      return 0;\n    } else {\n      return 1;\n    }\n  }\n\n  equals(other: Node): boolean {\n    // Not that we every compare it, but MAX_NODE is only ever equal to itself\n    return other === this;\n  }\n\n  getPriority(): MaxNode {\n    return this;\n  }\n\n  getImmediateChild(childName: string): ChildrenNode {\n    return ChildrenNode.EMPTY_NODE;\n  }\n\n  isEmpty(): boolean {\n    return false;\n  }\n}\n\n/**\n * Marker that will sort higher than any other snapshot.\n * @type {!MAX_NODE}\n * @const\n */\nexport const MAX_NODE = new MaxNode();\n\n/**\n * Document NamedNode extensions\n */\ndeclare module './Node' {\n  interface NamedNode {\n    MIN: NamedNode;\n    MAX: NamedNode;\n  }\n}\n\nObject.defineProperties(NamedNode, {\n  MIN: {\n    value: new NamedNode(MIN_NAME, ChildrenNode.EMPTY_NODE)\n  },\n  MAX: {\n    value: new NamedNode(MAX_NAME, MAX_NODE)\n  }\n});\n\n/**\n * Reference Extensions\n */\nKeyIndex.__EMPTY_NODE = ChildrenNode.EMPTY_NODE;\nLeafNode.__childrenNodeConstructor = ChildrenNode;\nsetMaxNode(MAX_NODE);\nsetPriorityMaxNode(MAX_NODE);\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from './ChildrenNode';\nimport { LeafNode } from './LeafNode';\nimport { NamedNode, Node } from './Node';\nimport { forEach, contains } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { buildChildSet } from './childSet';\nimport { NAME_COMPARATOR, NAME_ONLY_COMPARATOR } from './comparators';\nimport { IndexMap } from './IndexMap';\nimport { PRIORITY_INDEX, setNodeFromJSON } from './indexes/PriorityIndex';\nimport { SortedMap } from '../util/SortedMap';\n\nconst USE_HINZE = true;\n\n/**\n * Constructs a snapshot node representing the passed JSON and returns it.\n * @param {*} json JSON to create a node for.\n * @param {?string|?number=} priority Optional priority to use.  This will be ignored if the\n * passed JSON contains a .priority property.\n * @return {!Node}\n */\nexport function nodeFromJSON(\n  json: any | null,\n  priority: string | number | null = null\n): Node {\n  if (json === null) {\n    return ChildrenNode.EMPTY_NODE;\n  }\n\n  if (typeof json === 'object' && '.priority' in json) {\n    priority = json['.priority'];\n  }\n\n  assert(\n    priority === null ||\n      typeof priority === 'string' ||\n      typeof priority === 'number' ||\n      (typeof priority === 'object' && '.sv' in (priority as object)),\n    'Invalid priority type found: ' + typeof priority\n  );\n\n  if (typeof json === 'object' && '.value' in json && json['.value'] !== null) {\n    json = json['.value'];\n  }\n\n  // Valid leaf nodes include non-objects or server-value wrapper objects\n  if (typeof json !== 'object' || '.sv' in json) {\n    const jsonLeaf = json as string | number | boolean | object;\n    return new LeafNode(jsonLeaf, nodeFromJSON(priority));\n  }\n\n  if (!(json instanceof Array) && USE_HINZE) {\n    const children: NamedNode[] = [];\n    let childrenHavePriority = false;\n    const hinzeJsonObj: { [k: string]: any } = json as object;\n    forEach(hinzeJsonObj, (key: string, child: any) => {\n      if (typeof key !== 'string' || key.substring(0, 1) !== '.') {\n        // Ignore metadata nodes\n        const childNode = nodeFromJSON(hinzeJsonObj[key]);\n        if (!childNode.isEmpty()) {\n          childrenHavePriority =\n            childrenHavePriority || !childNode.getPriority().isEmpty();\n          children.push(new NamedNode(key, childNode));\n        }\n      }\n    });\n\n    if (children.length == 0) {\n      return ChildrenNode.EMPTY_NODE;\n    }\n\n    const childSet = buildChildSet(\n      children,\n      NAME_ONLY_COMPARATOR,\n      namedNode => namedNode.name,\n      NAME_COMPARATOR\n    ) as SortedMap<string, Node>;\n    if (childrenHavePriority) {\n      const sortedChildSet = buildChildSet(\n        children,\n        PRIORITY_INDEX.getCompare()\n      );\n      return new ChildrenNode(\n        childSet,\n        nodeFromJSON(priority),\n        new IndexMap(\n          { '.priority': sortedChildSet },\n          { '.priority': PRIORITY_INDEX }\n        )\n      );\n    } else {\n      return new ChildrenNode(\n        childSet,\n        nodeFromJSON(priority),\n        IndexMap.Default\n      );\n    }\n  } else {\n    let node: Node = ChildrenNode.EMPTY_NODE;\n    const jsonObj = json as { [key: string]: unknown };\n    forEach(jsonObj, (key: string, childData: any) => {\n      if (contains(jsonObj, key)) {\n        if (key.substring(0, 1) !== '.') {\n          // ignore metadata nodes.\n          const childNode = nodeFromJSON(childData);\n          if (childNode.isLeafNode() || !childNode.isEmpty())\n            node = node.updateImmediateChild(key, childNode);\n        }\n      }\n    });\n\n    return node.updatePriority(nodeFromJSON(priority));\n  }\n}\n\nsetNodeFromJSON(nodeFromJSON);\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { NamedNode, Node } from '../Node';\nimport { nameCompare } from '../../util/util';\nimport { nodeFromJSON } from '../nodeFromJSON';\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class ValueIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const indexCmp = a.node.compareTo(b.node);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.equals(newNode);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return (NamedNode as any).MAX;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: object, name: string): NamedNode {\n    const valueNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, valueNode);\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.value';\n  }\n}\n\nexport const VALUE_INDEX = new ValueIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { Index } from './Index';\nimport { ChildrenNode, MAX_NODE } from '../ChildrenNode';\nimport { NamedNode, Node } from '../Node';\nimport { nodeFromJSON } from '../nodeFromJSON';\nimport { Path } from '../../util/Path';\n\n/**\n * @param {!Path} indexPath\n * @constructor\n * @extends {Index}\n */\nexport class PathIndex extends Index {\n  constructor(private indexPath_: Path) {\n    super();\n\n    assert(\n      !indexPath_.isEmpty() && indexPath_.getFront() !== '.priority',\n      \"Can't create PathIndex with empty path or .priority key\"\n    );\n  }\n\n  /**\n   * @param {!Node} snap\n   * @return {!Node}\n   * @protected\n   */\n  protected extractChild(snap: Node): Node {\n    return snap.getChild(this.indexPath_);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getChild(this.indexPath_).isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aChild = this.extractChild(a.node);\n    const bChild = this.extractChild(b.node);\n    const indexCmp = aChild.compareTo(bChild);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  makePost(indexValue: object, name: string): NamedNode {\n    const valueNode = nodeFromJSON(indexValue);\n    const node = ChildrenNode.EMPTY_NODE.updateChild(\n      this.indexPath_,\n      valueNode\n    );\n    return new NamedNode(name, node);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    const node = ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_, MAX_NODE);\n    return new NamedNode(MAX_NAME, node);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return this.indexPath_.slice().join('/');\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport { validatePathString } from '../core/util/validation';\nimport { Path } from '../core/util/Path';\nimport { PRIORITY_INDEX } from '../core/snap/indexes/PriorityIndex';\nimport { Node } from '../core/snap/Node';\nimport { Reference } from './Reference';\nimport { Index } from '../core/snap/indexes/Index';\nimport { ChildrenNode } from '../core/snap/ChildrenNode';\n\n/**\n * Class representing a firebase data snapshot.  It wraps a SnapshotNode and\n * surfaces the public methods (val, forEach, etc.) we want to expose.\n */\nexport class DataSnapshot {\n  /**\n   * @param {!Node} node_ A SnapshotNode to wrap.\n   * @param {!Reference} ref_ The ref of the location this snapshot came from.\n   * @param {!Index} index_ The iteration order for this snapshot\n   */\n  constructor(\n    private readonly node_: Node,\n    private readonly ref_: Reference,\n    private readonly index_: Index\n  ) {}\n\n  /**\n   * Retrieves the snapshot contents as JSON.  Returns null if the snapshot is\n   * empty.\n   *\n   * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n   */\n  val(): any {\n    validateArgCount('DataSnapshot.val', 0, 0, arguments.length);\n    return this.node_.val();\n  }\n\n  /**\n   * Returns the snapshot contents as JSON, including priorities of node.  Suitable for exporting\n   * the entire node contents.\n   * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n   */\n  exportVal(): any {\n    validateArgCount('DataSnapshot.exportVal', 0, 0, arguments.length);\n    return this.node_.val(true);\n  }\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users\n  toJSON(): any {\n    // Optional spacer argument is unnecessary because we're depending on recursion rather than stringifying the content\n    validateArgCount('DataSnapshot.toJSON', 0, 1, arguments.length);\n    return this.exportVal();\n  }\n\n  /**\n   * Returns whether the snapshot contains a non-null value.\n   *\n   * @return {boolean} Whether the snapshot contains a non-null value, or is empty.\n   */\n  exists(): boolean {\n    validateArgCount('DataSnapshot.exists', 0, 0, arguments.length);\n    return !this.node_.isEmpty();\n  }\n\n  /**\n   * Returns a DataSnapshot of the specified child node's contents.\n   *\n   * @param {!string} childPathString Path to a child.\n   * @return {!DataSnapshot} DataSnapshot for child node.\n   */\n  child(childPathString: string): DataSnapshot {\n    validateArgCount('DataSnapshot.child', 0, 1, arguments.length);\n    // Ensure the childPath is a string (can be a number)\n    childPathString = String(childPathString);\n    validatePathString('DataSnapshot.child', 1, childPathString, false);\n\n    const childPath = new Path(childPathString);\n    const childRef = this.ref_.child(childPath);\n    return new DataSnapshot(\n      this.node_.getChild(childPath),\n      childRef,\n      PRIORITY_INDEX\n    );\n  }\n\n  /**\n   * Returns whether the snapshot contains a child at the specified path.\n   *\n   * @param {!string} childPathString Path to a child.\n   * @return {boolean} Whether the child exists.\n   */\n  hasChild(childPathString: string): boolean {\n    validateArgCount('DataSnapshot.hasChild', 1, 1, arguments.length);\n    validatePathString('DataSnapshot.hasChild', 1, childPathString, false);\n\n    const childPath = new Path(childPathString);\n    return !this.node_.getChild(childPath).isEmpty();\n  }\n\n  /**\n   * Returns the priority of the object, or null if no priority was set.\n   *\n   * @return {string|number|null} The priority.\n   */\n  getPriority(): string | number | null {\n    validateArgCount('DataSnapshot.getPriority', 0, 0, arguments.length);\n\n    // typecast here because we never return deferred values or internal priorities (MAX_PRIORITY)\n    return this.node_.getPriority().val() as string | number | null;\n  }\n\n  /**\n   * Iterates through child nodes and calls the specified action for each one.\n   *\n   * @param {function(!DataSnapshot)} action Callback function to be called\n   * for each child.\n   * @return {boolean} True if forEach was canceled by action returning true for\n   * one of the child nodes.\n   */\n  forEach(action: (d: DataSnapshot) => boolean | void): boolean {\n    validateArgCount('DataSnapshot.forEach', 1, 1, arguments.length);\n    validateCallback('DataSnapshot.forEach', 1, action, false);\n\n    if (this.node_.isLeafNode()) return false;\n\n    const childrenNode = this.node_ as ChildrenNode;\n    // Sanitize the return value to a boolean. ChildrenNode.forEachChild has a weird return type...\n    return !!childrenNode.forEachChild(this.index_, (key, node) => {\n      return action(\n        new DataSnapshot(node, this.ref_.child(key), PRIORITY_INDEX)\n      );\n    });\n  }\n\n  /**\n   * Returns whether this DataSnapshot has children.\n   * @return {boolean} True if the DataSnapshot contains 1 or more child nodes.\n   */\n  hasChildren(): boolean {\n    validateArgCount('DataSnapshot.hasChildren', 0, 0, arguments.length);\n\n    if (this.node_.isLeafNode()) return false;\n    else return !this.node_.isEmpty();\n  }\n\n  get key() {\n    return this.ref_.getKey();\n  }\n\n  /**\n   * Returns the number of children for this DataSnapshot.\n   * @return {number} The number of children that this DataSnapshot contains.\n   */\n  numChildren(): number {\n    validateArgCount('DataSnapshot.numChildren', 0, 0, arguments.length);\n\n    return this.node_.numChildren();\n  }\n\n  /**\n   * @return {Reference} The Firebase reference for the location this snapshot's data came from.\n   */\n  getRef(): Reference {\n    validateArgCount('DataSnapshot.ref', 0, 0, arguments.length);\n\n    return this.ref_;\n  }\n\n  get ref() {\n    return this.getRef();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { stringify } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { EventRegistration } from './EventRegistration';\nimport { DataSnapshot } from '../../api/DataSnapshot';\n\n/**\n * Encapsulates the data needed to raise an event\n * @interface\n */\nexport interface Event {\n  /**\n   * @return {!Path}\n   */\n  getPath(): Path;\n\n  /**\n   * @return {!string}\n   */\n  getEventType(): string;\n\n  /**\n   * @return {!function()}\n   */\n  getEventRunner(): () => void;\n\n  /**\n   * @return {!string}\n   */\n  toString(): string;\n}\n\n/**\n * Encapsulates the data needed to raise an event\n * @implements {Event}\n */\nexport class DataEvent implements Event {\n  /**\n   * @param {!string} eventType One of: value, child_added, child_changed, child_moved, child_removed\n   * @param {!EventRegistration} eventRegistration The function to call to with the event data. User provided\n   * @param {!DataSnapshot} snapshot The data backing the event\n   * @param {?string=} prevName Optional, the name of the previous child for child_* events.\n   */\n  constructor(\n    public eventType:\n      | 'value'\n      | ' child_added'\n      | ' child_changed'\n      | ' child_moved'\n      | ' child_removed',\n    public eventRegistration: EventRegistration,\n    public snapshot: DataSnapshot,\n    public prevName?: string | null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getPath(): Path {\n    const ref = this.snapshot.getRef();\n    if (this.eventType === 'value') {\n      return ref.path;\n    } else {\n      return ref.getParent().path;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventType(): string {\n    return this.eventType;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(): () => void {\n    return this.eventRegistration.getEventRunner(this);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return (\n      this.getPath().toString() +\n      ':' +\n      this.eventType +\n      ':' +\n      stringify(this.snapshot.exportVal())\n    );\n  }\n}\n\nexport class CancelEvent implements Event {\n  /**\n   * @param {EventRegistration} eventRegistration\n   * @param {Error} error\n   * @param {!Path} path\n   */\n  constructor(\n    public eventRegistration: EventRegistration,\n    public error: Error,\n    public path: Path\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getPath(): Path {\n    return this.path;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventType(): string {\n    return 'cancel';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(): () => void {\n    return this.eventRegistration.getEventRunner(this);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return this.path.toString() + ':cancel';\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataSnapshot } from '../../api/DataSnapshot';\nimport { DataEvent, CancelEvent, Event } from './Event';\nimport { contains, getCount, getAnyKey, every } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { Change } from './Change';\nimport { Query } from '../../api/Query';\n\n/**\n * An EventRegistration is basically an event type ('value', 'child_added', etc.) and a callback\n * to be notified of that type of event.\n *\n * That said, it can also contain a cancel callback to be notified if the event is canceled.  And\n * currently, this code is organized around the idea that you would register multiple child_ callbacks\n * together, as a single EventRegistration.  Though currently we don't do that.\n */\nexport interface EventRegistration {\n  /**\n   * True if this container has a callback to trigger for this event type\n   * @param {!string} eventType\n   * @return {boolean}\n   */\n  respondsTo(eventType: string): boolean;\n\n  /**\n   * @param {!Change} change\n   * @param {!Query} query\n   * @return {!Event}\n   */\n  createEvent(change: Change, query: Query): Event;\n\n  /**\n   * Given event data, return a function to trigger the user's callback\n   * @param {!Event} eventData\n   * @return {function()}\n   */\n  getEventRunner(eventData: Event): () => void;\n\n  /**\n   * @param {!Error} error\n   * @param {!Path} path\n   * @return {?CancelEvent}\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null;\n\n  /**\n   * @param {!EventRegistration} other\n   * @return {boolean}\n   */\n  matches(other: EventRegistration): boolean;\n\n  /**\n   * False basically means this is a \"dummy\" callback container being used as a sentinel\n   * to remove all callback containers of a particular type.  (e.g. if the user does\n   * ref.off('value') without specifying a specific callback).\n   *\n   * (TODO: Rework this, since it's hacky)\n   *\n   * @return {boolean}\n   */\n  hasAnyCallback(): boolean;\n}\n\n/**\n * Represents registration for 'value' events.\n */\nexport class ValueEventRegistration implements EventRegistration {\n  /**\n   * @param {?function(!DataSnapshot)} callback_\n   * @param {?function(Error)} cancelCallback_\n   * @param {?Object} context_\n   */\n  constructor(\n    private callback_: ((d: DataSnapshot) => void) | null,\n    private cancelCallback_: ((e: Error) => void) | null,\n    private context_: Object | null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  respondsTo(eventType: string): boolean {\n    return eventType === 'value';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createEvent(change: Change, query: Query): DataEvent {\n    const index = query.getQueryParams().getIndex();\n    return new DataEvent(\n      'value',\n      this,\n      new DataSnapshot(change.snapshotNode, query.getRef(), index)\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(eventData: CancelEvent | DataEvent): () => void {\n    const ctx = this.context_;\n    if (eventData.getEventType() === 'cancel') {\n      assert(\n        this.cancelCallback_,\n        'Raising a cancel event on a listener with no cancel callback'\n      );\n      const cancelCB = this.cancelCallback_;\n      return function() {\n        // We know that error exists, we checked above that this is a cancel event\n        cancelCB.call(ctx, (eventData as CancelEvent).error);\n      };\n    } else {\n      const cb = this.callback_;\n      return function() {\n        cb.call(ctx, (eventData as DataEvent).snapshot);\n      };\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null {\n    if (this.cancelCallback_) {\n      return new CancelEvent(this, error, path);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  matches(other: EventRegistration): boolean {\n    if (!(other instanceof ValueEventRegistration)) {\n      return false;\n    } else if (!other.callback_ || !this.callback_) {\n      // If no callback specified, we consider it to match any callback.\n      return true;\n    } else {\n      return (\n        other.callback_ === this.callback_ && other.context_ === this.context_\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasAnyCallback(): boolean {\n    return this.callback_ !== null;\n  }\n}\n\n/**\n * Represents the registration of 1 or more child_xxx events.\n *\n * Currently, it is always exactly 1 child_xxx event, but the idea is we might let you\n * register a group of callbacks together in the future.\n *\n * @constructor\n * @implements {EventRegistration}\n */\nexport class ChildEventRegistration implements EventRegistration {\n  /**\n   * @param {?Object.<string, function(!DataSnapshot, ?string=)>} callbacks_\n   * @param {?function(Error)} cancelCallback_\n   * @param {Object=} context_\n   */\n  constructor(\n    private callbacks_:\n      | ({ [k: string]: (d: DataSnapshot, s?: string | null) => void })\n      | null,\n    private cancelCallback_: ((e: Error) => void) | null,\n    private context_?: Object\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  respondsTo(eventType: string): boolean {\n    let eventToCheck =\n      eventType === 'children_added' ? 'child_added' : eventType;\n    eventToCheck =\n      eventToCheck === 'children_removed' ? 'child_removed' : eventToCheck;\n    return contains(this.callbacks_, eventToCheck);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null {\n    if (this.cancelCallback_) {\n      return new CancelEvent(this, error, path);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createEvent(change: Change, query: Query): DataEvent {\n    assert(change.childName != null, 'Child events should have a childName.');\n    const ref = query.getRef().child(/** @type {!string} */ (change.childName));\n    const index = query.getQueryParams().getIndex();\n    return new DataEvent(\n      change.type as any,\n      this,\n      new DataSnapshot(change.snapshotNode, ref, index as any),\n      change.prevName\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(eventData: CancelEvent | DataEvent): () => void {\n    const ctx = this.context_;\n    if (eventData.getEventType() === 'cancel') {\n      assert(\n        this.cancelCallback_,\n        'Raising a cancel event on a listener with no cancel callback'\n      );\n      const cancelCB = this.cancelCallback_;\n      return function() {\n        // We know that error exists, we checked above that this is a cancel event\n        cancelCB.call(ctx, (eventData as CancelEvent).error);\n      };\n    } else {\n      const cb = this.callbacks_[(eventData as DataEvent).eventType];\n      return function() {\n        cb.call(\n          ctx,\n          (eventData as DataEvent).snapshot,\n          (eventData as DataEvent).prevName\n        );\n      };\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  matches(other: EventRegistration): boolean {\n    if (other instanceof ChildEventRegistration) {\n      if (!this.callbacks_ || !other.callbacks_) {\n        return true;\n      } else if (this.context_ === other.context_) {\n        const otherCount = getCount(other.callbacks_);\n        const thisCount = getCount(this.callbacks_);\n        if (otherCount === thisCount) {\n          // If count is 1, do an exact match on eventType, if either is defined but null, it's a match.\n          //  If event types don't match, not a match\n          // If count is not 1, exact match across all\n\n          if (otherCount === 1) {\n            const otherKey /** @type {!string} */ = getAnyKey(other.callbacks_);\n            const thisKey /** @type {!string} */ = getAnyKey(this.callbacks_);\n            return (\n              thisKey === otherKey &&\n              (!other.callbacks_[otherKey] ||\n                !this.callbacks_[thisKey] ||\n                other.callbacks_[otherKey] === this.callbacks_[thisKey])\n            );\n          } else {\n            // Exact match on each key.\n            return every(\n              this.callbacks_,\n              (eventType, cb) => other.callbacks_[eventType] === cb\n            );\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasAnyCallback(): boolean {\n    return this.callbacks_ !== null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { KEY_INDEX } from '../core/snap/indexes/KeyIndex';\nimport { PRIORITY_INDEX } from '../core/snap/indexes/PriorityIndex';\nimport { VALUE_INDEX } from '../core/snap/indexes/ValueIndex';\nimport { PathIndex } from '../core/snap/indexes/PathIndex';\nimport { MIN_NAME, MAX_NAME, ObjectToUniqueKey } from '../core/util/util';\nimport { Path } from '../core/util/Path';\nimport {\n  isValidPriority,\n  validateEventType,\n  validatePathString,\n  validateFirebaseDataArg,\n  validateKey\n} from '../core/util/validation';\nimport {\n  errorPrefix,\n  validateArgCount,\n  validateCallback,\n  validateContextObject\n} from '@firebase/util';\nimport {\n  ValueEventRegistration,\n  ChildEventRegistration,\n  EventRegistration\n} from '../core/view/EventRegistration';\nimport { Deferred } from '@firebase/util';\nimport { Repo } from '../core/Repo';\nimport { QueryParams } from '../core/view/QueryParams';\nimport { Reference } from './Reference';\nimport { DataSnapshot } from './DataSnapshot';\n\nlet __referenceConstructor: new (repo: Repo, path: Path) => Query;\n\nexport interface SnapshotCallback {\n  (a: DataSnapshot, b?: string | null): any;\n}\n\n/**\n * A Query represents a filter to be applied to a firebase location.  This object purely represents the\n * query expression (and exposes our public API to build the query).  The actual query logic is in ViewBase.js.\n *\n * Since every Firebase reference is a query, Firebase inherits from this object.\n */\nexport class Query {\n  static set __referenceConstructor(val) {\n    __referenceConstructor = val;\n  }\n\n  static get __referenceConstructor() {\n    assert(__referenceConstructor, 'Reference.ts has not been loaded');\n    return __referenceConstructor;\n  }\n\n  constructor(\n    public repo: Repo,\n    public path: Path,\n    private queryParams_: QueryParams,\n    private orderByCalled_: boolean\n  ) {}\n\n  /**\n   * Validates start/end values for queries.\n   * @param {!QueryParams} params\n   * @private\n   */\n  private static validateQueryEndpoints_(params: QueryParams) {\n    let startNode = null;\n    let endNode = null;\n    if (params.hasStart()) {\n      startNode = params.getIndexStartValue();\n    }\n    if (params.hasEnd()) {\n      endNode = params.getIndexEndValue();\n    }\n\n    if (params.getIndex() === KEY_INDEX) {\n      const tooManyArgsError =\n        'Query: When ordering by key, you may only pass one argument to ' +\n        'startAt(), endAt(), or equalTo().';\n      const wrongArgTypeError =\n        'Query: When ordering by key, the argument passed to startAt(), endAt(),' +\n        'or equalTo() must be a string.';\n      if (params.hasStart()) {\n        const startName = params.getIndexStartName();\n        if (startName != MIN_NAME) {\n          throw new Error(tooManyArgsError);\n        } else if (typeof startNode !== 'string') {\n          throw new Error(wrongArgTypeError);\n        }\n      }\n      if (params.hasEnd()) {\n        const endName = params.getIndexEndName();\n        if (endName != MAX_NAME) {\n          throw new Error(tooManyArgsError);\n        } else if (typeof endNode !== 'string') {\n          throw new Error(wrongArgTypeError);\n        }\n      }\n    } else if (params.getIndex() === PRIORITY_INDEX) {\n      if (\n        (startNode != null && !isValidPriority(startNode)) ||\n        (endNode != null && !isValidPriority(endNode))\n      ) {\n        throw new Error(\n          'Query: When ordering by priority, the first argument passed to startAt(), ' +\n            'endAt(), or equalTo() must be a valid priority value (null, a number, or a string).'\n        );\n      }\n    } else {\n      assert(\n        params.getIndex() instanceof PathIndex ||\n          params.getIndex() === VALUE_INDEX,\n        'unknown index type.'\n      );\n      if (\n        (startNode != null && typeof startNode === 'object') ||\n        (endNode != null && typeof endNode === 'object')\n      ) {\n        throw new Error(\n          'Query: First argument passed to startAt(), endAt(), or equalTo() cannot be ' +\n            'an object.'\n        );\n      }\n    }\n  }\n\n  /**\n   * Validates that limit* has been called with the correct combination of parameters\n   * @param {!QueryParams} params\n   * @private\n   */\n  private static validateLimit_(params: QueryParams) {\n    if (\n      params.hasStart() &&\n      params.hasEnd() &&\n      params.hasLimit() &&\n      !params.hasAnchoredLimit()\n    ) {\n      throw new Error(\n        \"Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.\"\n      );\n    }\n  }\n\n  /**\n   * Validates that no other order by call has been made\n   * @param {!string} fnName\n   * @private\n   */\n  private validateNoPreviousOrderByCall_(fnName: string) {\n    if (this.orderByCalled_ === true) {\n      throw new Error(fnName + \": You can't combine multiple orderBy calls.\");\n    }\n  }\n\n  /**\n   * @return {!QueryParams}\n   */\n  getQueryParams(): QueryParams {\n    return this.queryParams_;\n  }\n\n  /**\n   * @return {!Reference}\n   */\n  getRef(): Reference {\n    validateArgCount('Query.ref', 0, 0, arguments.length);\n    // This is a slight hack. We cannot goog.require('fb.api.Firebase'), since Firebase requires fb.api.Query.\n    // However, we will always export 'Firebase' to the global namespace, so it's guaranteed to exist by the time this\n    // method gets called.\n    return new Query.__referenceConstructor(this.repo, this.path) as Reference;\n  }\n\n  /**\n   * @param {!string} eventType\n   * @param {!function(DataSnapshot, string=)} callback\n   * @param {(function(Error)|Object)=} cancelCallbackOrContext\n   * @param {Object=} context\n   * @return {!function(DataSnapshot, string=)}\n   */\n  on(\n    eventType: string,\n    callback: SnapshotCallback,\n    cancelCallbackOrContext?: ((a: Error) => any) | Object | null,\n    context?: Object | null\n  ): SnapshotCallback {\n    validateArgCount('Query.on', 2, 4, arguments.length);\n    validateEventType('Query.on', 1, eventType, false);\n    validateCallback('Query.on', 2, callback, false);\n\n    const ret = Query.getCancelAndContextArgs_(\n      'Query.on',\n      cancelCallbackOrContext,\n      context\n    );\n\n    if (eventType === 'value') {\n      this.onValueEvent(callback, ret.cancel, ret.context);\n    } else {\n      const callbacks: { [k: string]: typeof callback } = {};\n      callbacks[eventType] = callback;\n      this.onChildEvent(callbacks, ret.cancel, ret.context);\n    }\n    return callback;\n  }\n\n  /**\n   * @param {!function(!DataSnapshot)} callback\n   * @param {?function(Error)} cancelCallback\n   * @param {?Object} context\n   * @protected\n   */\n  protected onValueEvent(\n    callback: (a: DataSnapshot) => void,\n    cancelCallback: ((a: Error) => void) | null,\n    context: Object | null\n  ) {\n    const container = new ValueEventRegistration(\n      callback,\n      cancelCallback || null,\n      context || null\n    );\n    this.repo.addEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * @param {!Object.<string, !function(!DataSnapshot, ?string)>} callbacks\n   * @param {?function(Error)} cancelCallback\n   * @param {?Object} context\n   * @protected\n   */\n  onChildEvent(\n    callbacks: { [k: string]: SnapshotCallback },\n    cancelCallback: ((a: Error) => any) | null,\n    context: Object | null\n  ) {\n    const container = new ChildEventRegistration(\n      callbacks,\n      cancelCallback,\n      context\n    );\n    this.repo.addEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * @param {string=} eventType\n   * @param {(function(!DataSnapshot, ?string=))=} callback\n   * @param {Object=} context\n   */\n  off(\n    eventType?: string,\n    callback?: SnapshotCallback,\n    context?: Object | null\n  ): void {\n    validateArgCount('Query.off', 0, 3, arguments.length);\n    validateEventType('Query.off', 1, eventType, true);\n    validateCallback('Query.off', 2, callback, true);\n    validateContextObject('Query.off', 3, context, true);\n\n    let container: EventRegistration | null = null;\n    let callbacks: { [k: string]: typeof callback } | null = null;\n    if (eventType === 'value') {\n      const valueCallback = callback || null;\n      container = new ValueEventRegistration(\n        valueCallback,\n        null,\n        context || null\n      );\n    } else if (eventType) {\n      if (callback) {\n        callbacks = {};\n        callbacks[eventType] = callback;\n      }\n      container = new ChildEventRegistration(callbacks, null, context || null);\n    }\n    this.repo.removeEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * Attaches a listener, waits for the first event, and then removes the listener\n   * @param {!string} eventType\n   * @param {!function(!DataSnapshot, string=)} userCallback\n   * @param failureCallbackOrContext\n   * @param context\n   * @return {!firebase.Promise}\n   */\n  once(\n    eventType: string,\n    userCallback?: SnapshotCallback,\n    failureCallbackOrContext?: ((a: Error) => void) | Object | null,\n    context?: Object | null\n  ): Promise<DataSnapshot> {\n    validateArgCount('Query.once', 1, 4, arguments.length);\n    validateEventType('Query.once', 1, eventType, false);\n    validateCallback('Query.once', 2, userCallback, true);\n\n    const ret = Query.getCancelAndContextArgs_(\n      'Query.once',\n      failureCallbackOrContext,\n      context\n    );\n\n    // TODO: Implement this more efficiently (in particular, use 'get' wire protocol for 'value' event)\n    // TODO: consider actually wiring the callbacks into the promise. We cannot do this without a breaking change\n    // because the API currently expects callbacks will be called synchronously if the data is cached, but this is\n    // against the Promise specification.\n    let firstCall = true;\n    const deferred = new Deferred<DataSnapshot>();\n\n    // A dummy error handler in case a user wasn't expecting promises\n    deferred.promise.catch(() => {});\n\n    const onceCallback = (snapshot: DataSnapshot) => {\n      // NOTE: Even though we unsubscribe, we may get called multiple times if a single action (e.g. set() with JSON)\n      // triggers multiple events (e.g. child_added or child_changed).\n      if (firstCall) {\n        firstCall = false;\n        this.off(eventType, onceCallback);\n\n        if (userCallback) {\n          userCallback.bind(ret.context)(snapshot);\n        }\n        deferred.resolve(snapshot);\n      }\n    };\n\n    this.on(\n      eventType,\n      onceCallback,\n      /*cancel=*/ err => {\n        this.off(eventType, onceCallback);\n\n        if (ret.cancel) ret.cancel.bind(ret.context)(err);\n        deferred.reject(err);\n      }\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * Set a limit and anchor it to the start of the window.\n   * @param {!number} limit\n   * @return {!Query}\n   */\n  limitToFirst(limit: number): Query {\n    validateArgCount('Query.limitToFirst', 1, 1, arguments.length);\n    if (\n      typeof limit !== 'number' ||\n      Math.floor(limit) !== limit ||\n      limit <= 0\n    ) {\n      throw new Error(\n        'Query.limitToFirst: First argument must be a positive integer.'\n      );\n    }\n    if (this.queryParams_.hasLimit()) {\n      throw new Error(\n        'Query.limitToFirst: Limit was already set (by another call to limit, ' +\n          'limitToFirst, or limitToLast).'\n      );\n    }\n\n    return new Query(\n      this.repo,\n      this.path,\n      this.queryParams_.limitToFirst(limit),\n      this.orderByCalled_\n    );\n  }\n\n  /**\n   * Set a limit and anchor it to the end of the window.\n   * @param {!number} limit\n   * @return {!Query}\n   */\n  limitToLast(limit: number): Query {\n    validateArgCount('Query.limitToLast', 1, 1, arguments.length);\n    if (\n      typeof limit !== 'number' ||\n      Math.floor(limit) !== limit ||\n      limit <= 0\n    ) {\n      throw new Error(\n        'Query.limitToLast: First argument must be a positive integer.'\n      );\n    }\n    if (this.queryParams_.hasLimit()) {\n      throw new Error(\n        'Query.limitToLast: Limit was already set (by another call to limit, ' +\n          'limitToFirst, or limitToLast).'\n      );\n    }\n\n    return new Query(\n      this.repo,\n      this.path,\n      this.queryParams_.limitToLast(limit),\n      this.orderByCalled_\n    );\n  }\n\n  /**\n   * Given a child path, return a new query ordered by the specified grandchild path.\n   * @param {!string} path\n   * @return {!Query}\n   */\n  orderByChild(path: string): Query {\n    validateArgCount('Query.orderByChild', 1, 1, arguments.length);\n    if (path === '$key') {\n      throw new Error(\n        'Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.'\n      );\n    } else if (path === '$priority') {\n      throw new Error(\n        'Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.'\n      );\n    } else if (path === '$value') {\n      throw new Error(\n        'Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.'\n      );\n    }\n    validatePathString('Query.orderByChild', 1, path, false);\n    this.validateNoPreviousOrderByCall_('Query.orderByChild');\n    const parsedPath = new Path(path);\n    if (parsedPath.isEmpty()) {\n      throw new Error(\n        'Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.'\n      );\n    }\n    const index = new PathIndex(parsedPath);\n    const newParams = this.queryParams_.orderBy(index);\n    Query.validateQueryEndpoints_(newParams);\n\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the KeyIndex\n   * @return {!Query}\n   */\n  orderByKey(): Query {\n    validateArgCount('Query.orderByKey', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByKey');\n    const newParams = this.queryParams_.orderBy(KEY_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the PriorityIndex\n   * @return {!Query}\n   */\n  orderByPriority(): Query {\n    validateArgCount('Query.orderByPriority', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByPriority');\n    const newParams = this.queryParams_.orderBy(PRIORITY_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the ValueIndex\n   * @return {!Query}\n   */\n  orderByValue(): Query {\n    validateArgCount('Query.orderByValue', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByValue');\n    const newParams = this.queryParams_.orderBy(VALUE_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * @param {number|string|boolean|null} value\n   * @param {?string=} name\n   * @return {!Query}\n   */\n  startAt(\n    value: number | string | boolean | null = null,\n    name?: string | null\n  ): Query {\n    validateArgCount('Query.startAt', 0, 2, arguments.length);\n    validateFirebaseDataArg('Query.startAt', 1, value, this.path, true);\n    validateKey('Query.startAt', 2, name, true);\n\n    const newParams = this.queryParams_.startAt(value, name);\n    Query.validateLimit_(newParams);\n    Query.validateQueryEndpoints_(newParams);\n    if (this.queryParams_.hasStart()) {\n      throw new Error(\n        'Query.startAt: Starting point was already set (by another call to startAt ' +\n          'or equalTo).'\n      );\n    }\n\n    // Calling with no params tells us to start at the beginning.\n    if (value === undefined) {\n      value = null;\n      name = null;\n    }\n    return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n  }\n\n  /**\n   * @param {number|string|boolean|null} value\n   * @param {?string=} name\n   * @return {!Query}\n   */\n  endAt(\n    value: number | string | boolean | null = null,\n    name?: string | null\n  ): Query {\n    validateArgCount('Query.endAt', 0, 2, arguments.length);\n    validateFirebaseDataArg('Query.endAt', 1, value, this.path, true);\n    validateKey('Query.endAt', 2, name, true);\n\n    const newParams = this.queryParams_.endAt(value, name);\n    Query.validateLimit_(newParams);\n    Query.validateQueryEndpoints_(newParams);\n    if (this.queryParams_.hasEnd()) {\n      throw new Error(\n        'Query.endAt: Ending point was already set (by another call to endAt or ' +\n          'equalTo).'\n      );\n    }\n\n    return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n  }\n\n  /**\n   * Load the selection of children with exactly the specified value, and, optionally,\n   * the specified name.\n   * @param {number|string|boolean|null} value\n   * @param {string=} name\n   * @return {!Query}\n   */\n  equalTo(value: number | string | boolean | null, name?: string) {\n    validateArgCount('Query.equalTo', 1, 2, arguments.length);\n    validateFirebaseDataArg('Query.equalTo', 1, value, this.path, false);\n    validateKey('Query.equalTo', 2, name, true);\n    if (this.queryParams_.hasStart()) {\n      throw new Error(\n        'Query.equalTo: Starting point was already set (by another call to startAt or ' +\n          'equalTo).'\n      );\n    }\n    if (this.queryParams_.hasEnd()) {\n      throw new Error(\n        'Query.equalTo: Ending point was already set (by another call to endAt or ' +\n          'equalTo).'\n      );\n    }\n    return this.startAt(value, name).endAt(value, name);\n  }\n\n  /**\n   * @return {!string} URL for this location.\n   */\n  toString(): string {\n    validateArgCount('Query.toString', 0, 0, arguments.length);\n\n    return this.repo.toString() + this.path.toUrlEncodedString();\n  }\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users.\n  toJSON() {\n    // An optional spacer argument is unnecessary for a string.\n    validateArgCount('Query.toJSON', 0, 1, arguments.length);\n    return this.toString();\n  }\n\n  /**\n   * An object representation of the query parameters used by this Query.\n   * @return {!Object}\n   */\n  queryObject(): Object {\n    return this.queryParams_.getQueryObject();\n  }\n\n  /**\n   * @return {!string}\n   */\n  queryIdentifier(): string {\n    const obj = this.queryObject();\n    const id = ObjectToUniqueKey(obj);\n    return id === '{}' ? 'default' : id;\n  }\n\n  /**\n   * Return true if this query and the provided query are equivalent; otherwise, return false.\n   * @param {Query} other\n   * @return {boolean}\n   */\n  isEqual(other: Query): boolean {\n    validateArgCount('Query.isEqual', 1, 1, arguments.length);\n    if (!(other instanceof Query)) {\n      const error =\n        'Query.isEqual failed: First argument must be an instance of firebase.database.Query.';\n      throw new Error(error);\n    }\n\n    const sameRepo = this.repo === other.repo;\n    const samePath = this.path.equals(other.path);\n    const sameQueryIdentifier =\n      this.queryIdentifier() === other.queryIdentifier();\n\n    return sameRepo && samePath && sameQueryIdentifier;\n  }\n\n  /**\n   * Helper used by .on and .once to extract the context and or cancel arguments.\n   * @param {!string} fnName The function name (on or once)\n   * @param {(function(Error)|Object)=} cancelOrContext\n   * @param {Object=} context\n   * @return {{cancel: ?function(Error), context: ?Object}}\n   * @private\n   */\n  private static getCancelAndContextArgs_(\n    fnName: string,\n    cancelOrContext?: ((a: Error) => void) | Object | null,\n    context?: Object | null\n  ): { cancel: ((a: Error) => void) | null; context: Object | null } {\n    const ret: {\n      cancel: ((a: Error) => void) | null;\n      context: Object | null;\n    } = { cancel: null, context: null };\n    if (cancelOrContext && context) {\n      ret.cancel = cancelOrContext as (a: Error) => void;\n      validateCallback(fnName, 3, ret.cancel, true);\n\n      ret.context = context;\n      validateContextObject(fnName, 4, ret.context, true);\n    } else if (cancelOrContext) {\n      // we have either a cancel callback or a context.\n      if (typeof cancelOrContext === 'object' && cancelOrContext !== null) {\n        // it's a context!\n        ret.context = cancelOrContext;\n      } else if (typeof cancelOrContext === 'function') {\n        ret.cancel = cancelOrContext as (a: Error) => void;\n      } else {\n        throw new Error(\n          errorPrefix(fnName, 3, true) +\n            ' must either be a cancel callback or a context object.'\n        );\n      }\n    }\n    return ret;\n  }\n\n  get ref(): Reference {\n    return this.getRef();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEmpty, getCount, forEach, contains } from '@firebase/util';\n\n/**\n * Implements a set with a count of elements.\n *\n * @template K, V\n */\nexport class CountedSet<K extends string | number, V> {\n  set: { [k: string]: V } = {};\n\n  /**\n   * @param {!K} item\n   * @param {V} val\n   */\n  add(item: K, val: V) {\n    this.set[item as any] = val !== null ? val : (true as any);\n  }\n\n  /**\n   * @param {!K} key\n   * @return {boolean}\n   */\n  contains(key: K) {\n    return contains(this.set, key as string);\n  }\n\n  /**\n   * @param {!K} item\n   * @return {V}\n   */\n  get(item: K): V | void {\n    return this.contains(item) ? this.set[item as any] : undefined;\n  }\n\n  /**\n   * @param {!K} item\n   */\n  remove(item: K) {\n    delete this.set[item as any];\n  }\n\n  /**\n   * Deletes everything in the set\n   */\n  clear() {\n    this.set = {};\n  }\n\n  /**\n   * True if there's nothing in the set\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return isEmpty(this.set);\n  }\n\n  /**\n   * @return {number} The number of items in the set\n   */\n  count(): number {\n    return getCount(this.set);\n  }\n\n  /**\n   * Run a function on each k,v pair in the set\n   * @param {function(K, V)} fn\n   */\n  each(fn: (k: K | string, v: V) => void) {\n    forEach(this.set, (k: string, v: V) => fn(k, v));\n  }\n\n  /**\n   * Mostly for debugging\n   * @return {Array.<K>} The keys present in this CountedSet\n   */\n  keys(): K[] {\n    const keys: K[] = [];\n    forEach(this.set, (k: string) => {\n      keys.push(k as K);\n    });\n    return keys;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from './util/Path';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { CountedSet } from './util/CountedSet';\nimport { Node } from './snap/Node';\n\n/**\n * Helper class to store a sparse set of snapshots.\n *\n * @constructor\n */\nexport class SparseSnapshotTree {\n  /**\n   * @private\n   * @type {Node}\n   */\n  private value_: Node | null = null;\n\n  /**\n   * @private\n   * @type {CountedSet}\n   */\n  private children_: CountedSet<string, SparseSnapshotTree> | null = null;\n\n  /**\n   * Gets the node stored at the given path if one exists.\n   *\n   * @param {!Path} path Path to look up snapshot for.\n   * @return {?Node} The retrieved node, or null.\n   */\n  find(path: Path): Node | null {\n    if (this.value_ != null) {\n      return this.value_.getChild(path);\n    } else if (!path.isEmpty() && this.children_ != null) {\n      const childKey = path.getFront();\n      path = path.popFront();\n      if (this.children_.contains(childKey)) {\n        const childTree = this.children_.get(childKey) as SparseSnapshotTree;\n        return childTree.find(path);\n      } else {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Stores the given node at the specified path. If there is already a node\n   * at a shallower path, it merges the new data into that snapshot node.\n   *\n   * @param {!Path} path Path to look up snapshot for.\n   * @param {!Node} data The new data, or null.\n   */\n  remember(path: Path, data: Node) {\n    if (path.isEmpty()) {\n      this.value_ = data;\n      this.children_ = null;\n    } else if (this.value_ !== null) {\n      this.value_ = this.value_.updateChild(path, data);\n    } else {\n      if (this.children_ == null) {\n        this.children_ = new CountedSet<string, SparseSnapshotTree>();\n      }\n\n      const childKey = path.getFront();\n      if (!this.children_.contains(childKey)) {\n        this.children_.add(childKey, new SparseSnapshotTree());\n      }\n\n      const child = this.children_.get(childKey) as SparseSnapshotTree;\n      path = path.popFront();\n      child.remember(path, data);\n    }\n  }\n\n  /**\n   * Purge the data at path from the cache.\n   *\n   * @param {!Path} path Path to look up snapshot for.\n   * @return {boolean} True if this node should now be removed.\n   */\n  forget(path: Path): boolean {\n    if (path.isEmpty()) {\n      this.value_ = null;\n      this.children_ = null;\n      return true;\n    } else {\n      if (this.value_ !== null) {\n        if (this.value_.isLeafNode()) {\n          // We're trying to forget a node that doesn't exist\n          return false;\n        } else {\n          const value = this.value_;\n          this.value_ = null;\n\n          const self = this;\n          value.forEachChild(PRIORITY_INDEX, function(key, tree) {\n            self.remember(new Path(key), tree);\n          });\n\n          return this.forget(path);\n        }\n      } else if (this.children_ !== null) {\n        const childKey = path.getFront();\n        path = path.popFront();\n        if (this.children_.contains(childKey)) {\n          const safeToRemove = (this.children_.get(\n            childKey\n          ) as SparseSnapshotTree).forget(path);\n          if (safeToRemove) {\n            this.children_.remove(childKey);\n          }\n        }\n\n        if (this.children_.isEmpty()) {\n          this.children_ = null;\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        return true;\n      }\n    }\n  }\n\n  /**\n   * Recursively iterates through all of the stored tree and calls the\n   * callback on each one.\n   *\n   * @param {!Path} prefixPath Path to look up node for.\n   * @param {!Function} func The function to invoke for each tree.\n   */\n  forEachTree(prefixPath: Path, func: (a: Path, b: Node) => any) {\n    if (this.value_ !== null) {\n      func(prefixPath, this.value_);\n    } else {\n      this.forEachChild((key, tree) => {\n        const path = new Path(prefixPath.toString() + '/' + key);\n        tree.forEachTree(path, func);\n      });\n    }\n  }\n\n  /**\n   * Iterates through each immediate child and triggers the callback.\n   *\n   * @param {!Function} func The function to invoke for each child.\n   */\n  forEachChild(func: (a: string, b: SparseSnapshotTree) => void) {\n    if (this.children_ !== null) {\n      this.children_.each((key, tree) => {\n        func(key, tree);\n      });\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from './Path';\nimport { SparseSnapshotTree } from '../SparseSnapshotTree';\nimport { LeafNode } from '../snap/LeafNode';\nimport { nodeFromJSON } from '../snap/nodeFromJSON';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { Node } from '../snap/Node';\nimport { ChildrenNode } from '../snap/ChildrenNode';\n\n/**\n * Generate placeholders for deferred values.\n * @param {?Object} values\n * @return {!Object}\n */\nexport const generateWithValues = function(\n  values: {\n    [k: string]: any;\n  } | null\n): { [k: string]: any } {\n  values = values || {};\n  values['timestamp'] = values['timestamp'] || new Date().getTime();\n  return values;\n};\n\n/**\n * Value to use when firing local events. When writing server values, fire\n * local events with an approximate value, otherwise return value as-is.\n * @param {(Object|string|number|boolean)} value\n * @param {!Object} serverValues\n * @return {!(string|number|boolean)}\n */\nexport const resolveDeferredValue = function(\n  value: { [k: string]: any } | string | number | boolean,\n  serverValues: { [k: string]: any }\n): string | number | boolean {\n  if (!value || typeof value !== 'object') {\n    return value as string | number | boolean;\n  } else {\n    assert('.sv' in value, 'Unexpected leaf node or priority contents');\n    return serverValues[value['.sv']];\n  }\n};\n\n/**\n * Recursively replace all deferred values and priorities in the tree with the\n * specified generated replacement values.\n * @param {!SparseSnapshotTree} tree\n * @param {!Object} serverValues\n * @return {!SparseSnapshotTree}\n */\nexport const resolveDeferredValueTree = function(\n  tree: SparseSnapshotTree,\n  serverValues: Object\n): SparseSnapshotTree {\n  const resolvedTree = new SparseSnapshotTree();\n  tree.forEachTree(new Path(''), function(path, node) {\n    resolvedTree.remember(\n      path,\n      resolveDeferredValueSnapshot(node, serverValues)\n    );\n  });\n  return resolvedTree;\n};\n\n/**\n * Recursively replace all deferred values and priorities in the node with the\n * specified generated replacement values.  If there are no server values in the node,\n * it'll be returned as-is.\n * @param {!Node} node\n * @param {!Object} serverValues\n * @return {!Node}\n */\nexport const resolveDeferredValueSnapshot = function(\n  node: Node,\n  serverValues: Object\n): Node {\n  const rawPri = node.getPriority().val() as\n    | object\n    | boolean\n    | null\n    | number\n    | string;\n  const priority = resolveDeferredValue(rawPri, serverValues);\n  let newNode: Node;\n\n  if (node.isLeafNode()) {\n    const leafNode = node as LeafNode;\n    const value = resolveDeferredValue(leafNode.getValue(), serverValues);\n    if (\n      value !== leafNode.getValue() ||\n      priority !== leafNode.getPriority().val()\n    ) {\n      return new LeafNode(value, nodeFromJSON(priority));\n    } else {\n      return node;\n    }\n  } else {\n    const childrenNode = node as ChildrenNode;\n    newNode = childrenNode;\n    if (priority !== childrenNode.getPriority().val()) {\n      newNode = newNode.updatePriority(new LeafNode(priority));\n    }\n    childrenNode.forEachChild(PRIORITY_INDEX, function(childName, childNode) {\n      const newChildNode = resolveDeferredValueSnapshot(\n        childNode,\n        serverValues\n      );\n      if (newChildNode !== childNode) {\n        newNode = newNode.updateImmediateChild(childName, newChildNode);\n      }\n    });\n    return newNode;\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\n\n/**\n *\n * @enum\n */\nexport enum OperationType {\n  OVERWRITE,\n  MERGE,\n  ACK_USER_WRITE,\n  LISTEN_COMPLETE\n}\n\n/**\n * @interface\n */\nexport interface Operation {\n  /**\n   * @type {!OperationSource}\n   */\n  source: OperationSource;\n\n  /**\n   * @type {!OperationType}\n   */\n  type: OperationType;\n\n  /**\n   * @type {!Path}\n   */\n  path: Path;\n\n  /**\n   * @param {string} childName\n   * @return {?Operation}\n   */\n  operationForChild(childName: string): Operation | null;\n}\n\n/**\n * @param {boolean} fromUser\n * @param {boolean} fromServer\n * @param {?string} queryId\n * @param {boolean} tagged\n * @constructor\n */\nexport class OperationSource {\n  constructor(\n    public fromUser: boolean,\n    public fromServer: boolean,\n    public queryId: string | null,\n    public tagged: boolean\n  ) {\n    assert(!tagged || fromServer, 'Tagged queries must be from server.');\n  }\n  /**\n   * @const\n   * @type {!OperationSource}\n   */\n  static User = new OperationSource(\n    /*fromUser=*/ true,\n    false,\n    null,\n    /*tagged=*/ false\n  );\n\n  /**\n   * @const\n   * @type {!OperationSource}\n   */\n  static Server = new OperationSource(\n    false,\n    /*fromServer=*/ true,\n    null,\n    /*tagged=*/ false\n  );\n\n  /**\n   * @param {string} queryId\n   * @return {!OperationSource}\n   */\n  static forServerTaggedQuery = function(queryId: string): OperationSource {\n    return new OperationSource(\n      false,\n      /*fromServer=*/ true,\n      queryId,\n      /*tagged=*/ true\n    );\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { ImmutableTree } from '../util/ImmutableTree';\n\nexport class AckUserWrite implements Operation {\n  /** @inheritDoc */\n  type = OperationType.ACK_USER_WRITE;\n\n  /** @inheritDoc */\n  source = OperationSource.User;\n\n  /**\n   *\n   * @param {!Path} path\n   * @param {!ImmutableTree<!boolean>} affectedTree A tree containing true for each affected path. Affected paths can't overlap.\n   * @param {!boolean} revert\n   */\n  constructor(\n    /**@inheritDoc */ public path: Path,\n    /**@inheritDoc */ public affectedTree: ImmutableTree<boolean>,\n    /**@inheritDoc */ public revert: boolean\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  operationForChild(childName: string): AckUserWrite {\n    if (!this.path.isEmpty()) {\n      assert(\n        this.path.getFront() === childName,\n        'operationForChild called for unrelated child.'\n      );\n      return new AckUserWrite(\n        this.path.popFront(),\n        this.affectedTree,\n        this.revert\n      );\n    } else if (this.affectedTree.value != null) {\n      assert(\n        this.affectedTree.children.isEmpty(),\n        'affectedTree should not have overlapping affected paths.'\n      );\n      // All child locations are affected as well; just return same operation.\n      return this;\n    } else {\n      const childTree = this.affectedTree.subtree(new Path(childName));\n      return new AckUserWrite(Path.Empty, childTree, this.revert);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SortedMap } from './SortedMap';\nimport { Path } from './Path';\nimport { stringCompare } from './util';\nimport { forEach } from '@firebase/util';\n\nlet emptyChildrenSingleton: SortedMap<string, ImmutableTree<null>>;\n\n/**\n * Singleton empty children collection.\n *\n * @const\n * @type {!SortedMap.<string, !ImmutableTree.<?>>}\n */\nconst EmptyChildren = (): SortedMap<string, ImmutableTree<null>> => {\n  if (!emptyChildrenSingleton) {\n    emptyChildrenSingleton = new SortedMap<string, ImmutableTree<null>>(\n      stringCompare\n    );\n  }\n  return emptyChildrenSingleton;\n};\n\n/**\n * A tree with immutable elements.\n */\nexport class ImmutableTree<T> {\n  static Empty = new ImmutableTree<any>(null);\n\n  /**\n   * @template T\n   * @param {!Object.<string, !T>} obj\n   * @return {!ImmutableTree.<!T>}\n   */\n  static fromObject<T>(obj: { [k: string]: T }): ImmutableTree<T> {\n    let tree: ImmutableTree<T> = ImmutableTree.Empty;\n    forEach(obj, (childPath: string, childSnap: T) => {\n      tree = tree.set(new Path(childPath), childSnap);\n    });\n    return tree;\n  }\n\n  /**\n   * @template T\n   * @param {?T} value\n   * @param {SortedMap.<string, !ImmutableTree.<T>>=} children\n   */\n  constructor(\n    public readonly value: T | null,\n    public readonly children: SortedMap<\n      string,\n      ImmutableTree<T>\n    > = EmptyChildren()\n  ) {}\n\n  /**\n   * True if the value is empty and there are no children\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return this.value === null && this.children.isEmpty();\n  }\n\n  /**\n   * Given a path and predicate, return the first node and the path to that node\n   * where the predicate returns true.\n   *\n   * TODO Do a perf test -- If we're creating a bunch of {path: value:} objects\n   * on the way back out, it may be better to pass down a pathSoFar obj.\n   *\n   * @param {!Path} relativePath The remainder of the path\n   * @param {function(T):boolean} predicate The predicate to satisfy to return a\n   *   node\n   * @return {?{path:!Path, value:!T}}\n   */\n  findRootMostMatchingPathAndValue(\n    relativePath: Path,\n    predicate: (a: T) => boolean\n  ): { path: Path; value: T } | null {\n    if (this.value != null && predicate(this.value)) {\n      return { path: Path.Empty, value: this.value };\n    } else {\n      if (relativePath.isEmpty()) {\n        return null;\n      } else {\n        const front = relativePath.getFront();\n        const child = this.children.get(front);\n        if (child !== null) {\n          const childExistingPathAndValue = child.findRootMostMatchingPathAndValue(\n            relativePath.popFront(),\n            predicate\n          );\n          if (childExistingPathAndValue != null) {\n            const fullPath = new Path(front).child(\n              childExistingPathAndValue.path\n            );\n            return { path: fullPath, value: childExistingPathAndValue.value };\n          } else {\n            return null;\n          }\n        } else {\n          return null;\n        }\n      }\n    }\n  }\n\n  /**\n   * Find, if it exists, the shortest subpath of the given path that points a defined\n   * value in the tree\n   * @param {!Path} relativePath\n   * @return {?{path: !Path, value: !T}}\n   */\n  findRootMostValueAndPath(\n    relativePath: Path\n  ): { path: Path; value: T } | null {\n    return this.findRootMostMatchingPathAndValue(relativePath, () => true);\n  }\n\n  /**\n   * @param {!Path} relativePath\n   * @return {!ImmutableTree.<T>} The subtree at the given path\n   */\n  subtree(relativePath: Path): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return this;\n    } else {\n      const front = relativePath.getFront();\n      const childTree = this.children.get(front);\n      if (childTree !== null) {\n        return childTree.subtree(relativePath.popFront());\n      } else {\n        return ImmutableTree.Empty;\n      }\n    }\n  }\n\n  /**\n   * Sets a value at the specified path.\n   *\n   * @param {!Path} relativePath Path to set value at.\n   * @param {?T} toSet Value to set.\n   * @return {!ImmutableTree.<T>} Resulting tree.\n   */\n  set(relativePath: Path, toSet: T | null): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return new ImmutableTree(toSet, this.children);\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front) || ImmutableTree.Empty;\n      const newChild = child.set(relativePath.popFront(), toSet);\n      const newChildren = this.children.insert(front, newChild);\n      return new ImmutableTree(this.value, newChildren);\n    }\n  }\n\n  /**\n   * Removes the value at the specified path.\n   *\n   * @param {!Path} relativePath Path to value to remove.\n   * @return {!ImmutableTree.<T>} Resulting tree.\n   */\n  remove(relativePath: Path): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      if (this.children.isEmpty()) {\n        return ImmutableTree.Empty;\n      } else {\n        return new ImmutableTree(null, this.children);\n      }\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front);\n      if (child) {\n        const newChild = child.remove(relativePath.popFront());\n        let newChildren;\n        if (newChild.isEmpty()) {\n          newChildren = this.children.remove(front);\n        } else {\n          newChildren = this.children.insert(front, newChild);\n        }\n        if (this.value === null && newChildren.isEmpty()) {\n          return ImmutableTree.Empty;\n        } else {\n          return new ImmutableTree(this.value, newChildren);\n        }\n      } else {\n        return this;\n      }\n    }\n  }\n\n  /**\n   * Gets a value from the tree.\n   *\n   * @param {!Path} relativePath Path to get value for.\n   * @return {?T} Value at path, or null.\n   */\n  get(relativePath: Path): T | null {\n    if (relativePath.isEmpty()) {\n      return this.value;\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front);\n      if (child) {\n        return child.get(relativePath.popFront());\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Replace the subtree at the specified path with the given new tree.\n   *\n   * @param {!Path} relativePath Path to replace subtree for.\n   * @param {!ImmutableTree} newTree New tree.\n   * @return {!ImmutableTree} Resulting tree.\n   */\n  setTree(relativePath: Path, newTree: ImmutableTree<T>): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return newTree;\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front) || ImmutableTree.Empty;\n      const newChild = child.setTree(relativePath.popFront(), newTree);\n      let newChildren;\n      if (newChild.isEmpty()) {\n        newChildren = this.children.remove(front);\n      } else {\n        newChildren = this.children.insert(front, newChild);\n      }\n      return new ImmutableTree(this.value, newChildren);\n    }\n  }\n\n  /**\n   * Performs a depth first fold on this tree. Transforms a tree into a single\n   * value, given a function that operates on the path to a node, an optional\n   * current value, and a map of child names to folded subtrees\n   * @template V\n   * @param {function(Path, ?T, Object.<string, V>):V} fn\n   * @return {V}\n   */\n  fold<V>(fn: (path: Path, value: T, children: { [k: string]: V }) => V): V {\n    return this.fold_(Path.Empty, fn);\n  }\n\n  /**\n   * Recursive helper for public-facing fold() method\n   * @template V\n   * @param {!Path} pathSoFar\n   * @param {function(Path, ?T, Object.<string, V>):V} fn\n   * @return {V}\n   * @private\n   */\n  private fold_<V>(\n    pathSoFar: Path,\n    fn: (path: Path, value: T | null, children: { [k: string]: V }) => V\n  ): V {\n    const accum: { [k: string]: V } = {};\n    this.children.inorderTraversal(function(\n      childKey: string,\n      childTree: ImmutableTree<T>\n    ) {\n      accum[childKey] = childTree.fold_(pathSoFar.child(childKey), fn);\n    });\n    return fn(pathSoFar, this.value, accum);\n  }\n\n  /**\n   * Find the first matching value on the given path. Return the result of applying f to it.\n   * @template V\n   * @param {!Path} path\n   * @param {!function(!Path, !T):?V} f\n   * @return {?V}\n   */\n  findOnPath<V>(path: Path, f: (path: Path, value: T) => V | null): V | null {\n    return this.findOnPath_(path, Path.Empty, f);\n  }\n\n  private findOnPath_<V>(\n    pathToFollow: Path,\n    pathSoFar: Path,\n    f: (path: Path, value: T) => V | null\n  ): V | null {\n    const result = this.value ? f(pathSoFar, this.value) : false;\n    if (result) {\n      return result;\n    } else {\n      if (pathToFollow.isEmpty()) {\n        return null;\n      } else {\n        const front = pathToFollow.getFront()!;\n        const nextChild = this.children.get(front);\n        if (nextChild) {\n          return nextChild.findOnPath_(\n            pathToFollow.popFront(),\n            pathSoFar.child(front),\n            f\n          );\n        } else {\n          return null;\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {!Path} path\n   * @param {!function(!Path, !T)} f\n   * @returns {!ImmutableTree.<T>}\n   */\n  foreachOnPath(\n    path: Path,\n    f: (path: Path, value: T) => void\n  ): ImmutableTree<T> {\n    return this.foreachOnPath_(path, Path.Empty, f);\n  }\n\n  private foreachOnPath_(\n    pathToFollow: Path,\n    currentRelativePath: Path,\n    f: (path: Path, value: T) => void\n  ): ImmutableTree<T> {\n    if (pathToFollow.isEmpty()) {\n      return this;\n    } else {\n      if (this.value) {\n        f(currentRelativePath, this.value);\n      }\n      const front = pathToFollow.getFront();\n      const nextChild = this.children.get(front);\n      if (nextChild) {\n        return nextChild.foreachOnPath_(\n          pathToFollow.popFront(),\n          currentRelativePath.child(front),\n          f\n        );\n      } else {\n        return ImmutableTree.Empty;\n      }\n    }\n  }\n\n  /**\n   * Calls the given function for each node in the tree that has a value.\n   *\n   * @param {function(!Path, !T)} f A function to be called with\n   *   the path from the root of the tree to a node, and the value at that node.\n   *   Called in depth-first order.\n   */\n  foreach(f: (path: Path, value: T) => void) {\n    this.foreach_(Path.Empty, f);\n  }\n\n  private foreach_(\n    currentRelativePath: Path,\n    f: (path: Path, value: T) => void\n  ) {\n    this.children.inorderTraversal(function(childName, childTree) {\n      childTree.foreach_(currentRelativePath.child(childName), f);\n    });\n    if (this.value) {\n      f(currentRelativePath, this.value);\n    }\n  }\n\n  /**\n   *\n   * @param {function(string, !T)} f\n   */\n  foreachChild(f: (name: string, value: T) => void) {\n    this.children.inorderTraversal(\n      (childName: string, childTree: ImmutableTree<T>) => {\n        if (childTree.value) {\n          f(childName, childTree.value);\n        }\n      }\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { Operation, OperationSource, OperationType } from './Operation';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @constructor\n * @implements {Operation}\n */\nexport class ListenComplete implements Operation {\n  /** @inheritDoc */\n  type = OperationType.LISTEN_COMPLETE;\n\n  constructor(public source: OperationSource, public path: Path) {}\n\n  operationForChild(childName: string): ListenComplete {\n    if (this.path.isEmpty()) {\n      return new ListenComplete(this.source, Path.Empty);\n    } else {\n      return new ListenComplete(this.source, this.path.popFront());\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { Path } from '../util/Path';\nimport { Node } from '../snap/Node';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!Node} snap\n * @constructor\n * @implements {Operation}\n */\nexport class Overwrite implements Operation {\n  /** @inheritDoc */\n  type = OperationType.OVERWRITE;\n\n  constructor(\n    public source: OperationSource,\n    public path: Path,\n    public snap: Node\n  ) {}\n\n  operationForChild(childName: string): Overwrite {\n    if (this.path.isEmpty()) {\n      return new Overwrite(\n        this.source,\n        Path.Empty,\n        this.snap.getImmediateChild(childName)\n      );\n    } else {\n      return new Overwrite(this.source, this.path.popFront(), this.snap);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { Overwrite } from './Overwrite';\nimport { Path } from '../util/Path';\nimport { assert } from '@firebase/util';\nimport { ImmutableTree } from '../util/ImmutableTree';\nimport { Node } from '../snap/Node';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!ImmutableTree.<!Node>} children\n * @constructor\n * @implements {Operation}\n */\nexport class Merge implements Operation {\n  /** @inheritDoc */\n  type = OperationType.MERGE;\n\n  constructor(\n    /**@inheritDoc */ public source: OperationSource,\n    /**@inheritDoc */ public path: Path,\n    /**@inheritDoc */ public children: ImmutableTree<Node>\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  operationForChild(childName: string): Operation {\n    if (this.path.isEmpty()) {\n      const childTree = this.children.subtree(new Path(childName));\n      if (childTree.isEmpty()) {\n        // This child is unaffected\n        return null;\n      } else if (childTree.value) {\n        // We have a snapshot for the child in question.  This becomes an overwrite of the child.\n        return new Overwrite(this.source, Path.Empty, childTree.value);\n      } else {\n        // This is a merge at a deeper level\n        return new Merge(this.source, Path.Empty, childTree);\n      }\n    } else {\n      assert(\n        this.path.getFront() === childName,\n        \"Can't get a merge for a child not on the path of the operation\"\n      );\n      return new Merge(this.source, this.path.popFront(), this.children);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return (\n      'Operation(' +\n      this.path +\n      ': ' +\n      this.source.toString() +\n      ' merge: ' +\n      this.children.toString() +\n      ')'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node } from '../snap/Node';\nimport { Path } from '../util/Path';\n\n/**\n * A cache node only stores complete children. Additionally it holds a flag whether the node can be considered fully\n * initialized in the sense that we know at one point in time this represented a valid state of the world, e.g.\n * initialized with data from the server, or a complete overwrite by the client. The filtered flag also tracks\n * whether a node potentially had children removed due to a filter.\n */\nexport class CacheNode {\n  /**\n   * @param {!Node} node_\n   * @param {boolean} fullyInitialized_\n   * @param {boolean} filtered_\n   */\n  constructor(\n    private node_: Node,\n    private fullyInitialized_: boolean,\n    private filtered_: boolean\n  ) {}\n\n  /**\n   * Returns whether this node was fully initialized with either server data or a complete overwrite by the client\n   * @return {boolean}\n   */\n  isFullyInitialized(): boolean {\n    return this.fullyInitialized_;\n  }\n\n  /**\n   * Returns whether this node is potentially missing children due to a filter applied to the node\n   * @return {boolean}\n   */\n  isFiltered(): boolean {\n    return this.filtered_;\n  }\n\n  /**\n   * @param {!Path} path\n   * @return {boolean}\n   */\n  isCompleteForPath(path: Path): boolean {\n    if (path.isEmpty()) {\n      return this.isFullyInitialized() && !this.filtered_;\n    }\n\n    const childKey = path.getFront();\n    return this.isCompleteForChild(childKey);\n  }\n\n  /**\n   * @param {!string} key\n   * @return {boolean}\n   */\n  isCompleteForChild(key: string): boolean {\n    return (\n      (this.isFullyInitialized() && !this.filtered_) || this.node_.hasChild(key)\n    );\n  }\n\n  /**\n   * @return {!Node}\n   */\n  getNode(): Node {\n    return this.node_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { CacheNode } from './CacheNode';\nimport { Node } from '../snap/Node';\n\n/**\n * Stores the data we have cached for a view.\n *\n * serverSnap is the cached server data, eventSnap is the cached event data (server data plus any local writes).\n *\n * @constructor\n */\nexport class ViewCache {\n  /**\n   *\n   * @param {!CacheNode} eventCache_\n   * @param {!CacheNode} serverCache_\n   */\n  constructor(\n    private readonly eventCache_: CacheNode,\n    private readonly serverCache_: CacheNode\n  ) {}\n\n  /**\n   * @const\n   * @type {ViewCache}\n   */\n  static Empty = new ViewCache(\n    new CacheNode(\n      ChildrenNode.EMPTY_NODE,\n      /*fullyInitialized=*/ false,\n      /*filtered=*/ false\n    ),\n    new CacheNode(\n      ChildrenNode.EMPTY_NODE,\n      /*fullyInitialized=*/ false,\n      /*filtered=*/ false\n    )\n  );\n\n  /**\n   * @param {!Node} eventSnap\n   * @param {boolean} complete\n   * @param {boolean} filtered\n   * @return {!ViewCache}\n   */\n  updateEventSnap(\n    eventSnap: Node,\n    complete: boolean,\n    filtered: boolean\n  ): ViewCache {\n    return new ViewCache(\n      new CacheNode(eventSnap, complete, filtered),\n      this.serverCache_\n    );\n  }\n\n  /**\n   * @param {!Node} serverSnap\n   * @param {boolean} complete\n   * @param {boolean} filtered\n   * @return {!ViewCache}\n   */\n  updateServerSnap(\n    serverSnap: Node,\n    complete: boolean,\n    filtered: boolean\n  ): ViewCache {\n    return new ViewCache(\n      this.eventCache_,\n      new CacheNode(serverSnap, complete, filtered)\n    );\n  }\n\n  /**\n   * @return {!CacheNode}\n   */\n  getEventCache(): CacheNode {\n    return this.eventCache_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getCompleteEventSnap(): Node | null {\n    return this.eventCache_.isFullyInitialized()\n      ? this.eventCache_.getNode()\n      : null;\n  }\n\n  /**\n   * @return {!CacheNode}\n   */\n  getServerCache(): CacheNode {\n    return this.serverCache_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getCompleteServerSnap(): Node | null {\n    return this.serverCache_.isFullyInitialized()\n      ? this.serverCache_.getNode()\n      : null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node } from '../snap/Node';\n\n/**\n * @constructor\n * @struct\n * @param {!string} type The event type\n * @param {!Node} snapshotNode The data\n * @param {string=} childName The name for this child, if it's a child event\n * @param {Node=} oldSnap Used for intermediate processing of child changed events\n * @param {string=} prevName The name for the previous child, if applicable\n */\nexport class Change {\n  constructor(\n    public type: string,\n    public snapshotNode: Node,\n    public childName?: string,\n    public oldSnap?: Node,\n    public prevName?: string | null\n  ) {}\n\n  /**\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static valueChange(snapshot: Node): Change {\n    return new Change(Change.VALUE, snapshot);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childAddedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_ADDED, snapshot, childKey);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childRemovedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_REMOVED, snapshot, childKey);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} newSnapshot\n   * @param {!Node} oldSnapshot\n   * @return {!Change}\n   */\n  static childChangedChange(\n    childKey: string,\n    newSnapshot: Node,\n    oldSnapshot: Node\n  ): Change {\n    return new Change(Change.CHILD_CHANGED, newSnapshot, childKey, oldSnapshot);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childMovedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_MOVED, snapshot, childKey);\n  }\n\n  //event types\n  /** Event type for a child added */\n  static CHILD_ADDED = 'child_added';\n\n  /** Event type for a child removed */\n  static CHILD_REMOVED = 'child_removed';\n\n  /** Event type for a child changed */\n  static CHILD_CHANGED = 'child_changed';\n\n  /** Event type for a child moved */\n  static CHILD_MOVED = 'child_moved';\n\n  /** Event type for a value change */\n  static VALUE = 'value';\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Change } from '../Change';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { PRIORITY_INDEX } from '../../snap/indexes/PriorityIndex';\nimport { NodeFilter } from './NodeFilter';\nimport { Index } from '../../snap/indexes/Index';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\nimport { Node } from '../../snap/Node';\n\n/**\n * Doesn't really filter nodes but applies an index to the node and keeps track of any changes\n *\n * @constructor\n * @implements {NodeFilter}\n * @param {!Index} index\n */\nexport class IndexedFilter implements NodeFilter {\n  constructor(private readonly index_: Index) {}\n\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    assert(\n      snap.isIndexed(this.index_),\n      'A node must be indexed if only a child is updated'\n    );\n    const oldChild = snap.getImmediateChild(key);\n    // Check if anything actually changed.\n    if (\n      oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))\n    ) {\n      // There's an edge case where a child can enter or leave the view because affectedPath was set to null.\n      // In this case, affectedPath will appear null in both the old and new snapshots.  So we need\n      // to avoid treating these cases as \"nothing changed.\"\n      if (oldChild.isEmpty() == newChild.isEmpty()) {\n        // Nothing changed.\n\n        // This assert should be valid, but it's expensive (can dominate perf testing) so don't actually do it.\n        //assert(oldChild.equals(newChild), 'Old and new snapshots should be equal.');\n        return snap;\n      }\n    }\n\n    if (optChangeAccumulator != null) {\n      if (newChild.isEmpty()) {\n        if (snap.hasChild(key)) {\n          optChangeAccumulator.trackChildChange(\n            Change.childRemovedChange(key, oldChild)\n          );\n        } else {\n          assert(\n            snap.isLeafNode(),\n            'A child remove without an old child only makes sense on a leaf node'\n          );\n        }\n      } else if (oldChild.isEmpty()) {\n        optChangeAccumulator.trackChildChange(\n          Change.childAddedChange(key, newChild)\n        );\n      } else {\n        optChangeAccumulator.trackChildChange(\n          Change.childChangedChange(key, newChild, oldChild)\n        );\n      }\n    }\n    if (snap.isLeafNode() && newChild.isEmpty()) {\n      return snap;\n    } else {\n      // Make sure the node is indexed\n      return snap.updateImmediateChild(key, newChild).withIndex(this.index_);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (optChangeAccumulator != null) {\n      if (!oldSnap.isLeafNode()) {\n        oldSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n          if (!newSnap.hasChild(key)) {\n            optChangeAccumulator.trackChildChange(\n              Change.childRemovedChange(key, childNode)\n            );\n          }\n        });\n      }\n      if (!newSnap.isLeafNode()) {\n        newSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n          if (oldSnap.hasChild(key)) {\n            const oldChild = oldSnap.getImmediateChild(key);\n            if (!oldChild.equals(childNode)) {\n              optChangeAccumulator.trackChildChange(\n                Change.childChangedChange(key, childNode, oldChild)\n              );\n            }\n          } else {\n            optChangeAccumulator.trackChildChange(\n              Change.childAddedChange(key, childNode)\n            );\n          }\n        });\n      }\n    }\n    return newSnap.withIndex(this.index_);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    if (oldSnap.isEmpty()) {\n      return ChildrenNode.EMPTY_NODE;\n    } else {\n      return oldSnap.updatePriority(newPriority);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getValues, safeGet } from '@firebase/util';\nimport { Change } from './Change';\nimport { assert, assertionError } from '@firebase/util';\n\n/**\n * @constructor\n */\nexport class ChildChangeAccumulator {\n  private changeMap_: { [k: string]: Change } = {};\n\n  /**\n   * @param {!Change} change\n   */\n  trackChildChange(change: Change) {\n    const type = change.type;\n    const childKey /** @type {!string} */ = change.childName;\n    assert(\n      type == Change.CHILD_ADDED ||\n        type == Change.CHILD_CHANGED ||\n        type == Change.CHILD_REMOVED,\n      'Only child changes supported for tracking'\n    );\n    assert(\n      childKey !== '.priority',\n      'Only non-priority child changes can be tracked.'\n    );\n    const oldChange = safeGet(this.changeMap_, childKey) as Change;\n    if (oldChange) {\n      const oldType = oldChange.type;\n      if (type == Change.CHILD_ADDED && oldType == Change.CHILD_REMOVED) {\n        this.changeMap_[childKey] = Change.childChangedChange(\n          childKey,\n          change.snapshotNode,\n          oldChange.snapshotNode\n        );\n      } else if (\n        type == Change.CHILD_REMOVED &&\n        oldType == Change.CHILD_ADDED\n      ) {\n        delete this.changeMap_[childKey];\n      } else if (\n        type == Change.CHILD_REMOVED &&\n        oldType == Change.CHILD_CHANGED\n      ) {\n        this.changeMap_[childKey] = Change.childRemovedChange(\n          childKey,\n          oldChange.oldSnap\n        );\n      } else if (\n        type == Change.CHILD_CHANGED &&\n        oldType == Change.CHILD_ADDED\n      ) {\n        this.changeMap_[childKey] = Change.childAddedChange(\n          childKey,\n          change.snapshotNode\n        );\n      } else if (\n        type == Change.CHILD_CHANGED &&\n        oldType == Change.CHILD_CHANGED\n      ) {\n        this.changeMap_[childKey] = Change.childChangedChange(\n          childKey,\n          change.snapshotNode,\n          oldChange.oldSnap\n        );\n      } else {\n        throw assertionError(\n          'Illegal combination of changes: ' +\n            change +\n            ' occurred after ' +\n            oldChange\n        );\n      }\n    } else {\n      this.changeMap_[childKey] = change;\n    }\n  }\n\n  /**\n   * @return {!Array.<!Change>}\n   */\n  getChanges(): Change[] {\n    return getValues(this.changeMap_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CacheNode } from './CacheNode';\nimport { NamedNode, Node } from '../snap/Node';\nimport { Index } from '../snap/indexes/Index';\nimport { WriteTreeRef } from '../WriteTree';\nimport { ViewCache } from './ViewCache';\n\n/**\n * Since updates to filtered nodes might require nodes to be pulled in from \"outside\" the node, this interface\n * can help to get complete children that can be pulled in.\n * A class implementing this interface takes potentially multiple sources (e.g. user writes, server data from\n * other views etc.) to try it's best to get a complete child that might be useful in pulling into the view.\n *\n * @interface\n */\nexport interface CompleteChildSource {\n  /**\n   * @param {!string} childKey\n   * @return {?Node}\n   */\n  getCompleteChild(childKey: string): Node | null;\n\n  /**\n   * @param {!Index} index\n   * @param {!NamedNode} child\n   * @param {boolean} reverse\n   * @return {?NamedNode}\n   */\n  getChildAfterChild(\n    index: Index,\n    child: NamedNode,\n    reverse: boolean\n  ): NamedNode | null;\n}\n\n/**\n * An implementation of CompleteChildSource that never returns any additional children\n *\n * @private\n * @constructor\n * @implements CompleteChildSource\n */\nexport class NoCompleteChildSource_ implements CompleteChildSource {\n  /**\n   * @inheritDoc\n   */\n  getCompleteChild(childKey?: string): Node | null {\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getChildAfterChild(\n    index?: Index,\n    child?: NamedNode,\n    reverse?: boolean\n  ): NamedNode | null {\n    return null;\n  }\n}\n\n/**\n * Singleton instance.\n * @const\n * @type {!CompleteChildSource}\n */\nexport const NO_COMPLETE_CHILD_SOURCE = new NoCompleteChildSource_();\n\n/**\n * An implementation of CompleteChildSource that uses a WriteTree in addition to any other server data or\n * old event caches available to calculate complete children.\n *\n *\n * @implements CompleteChildSource\n */\nexport class WriteTreeCompleteChildSource implements CompleteChildSource {\n  /**\n   * @param {!WriteTreeRef} writes_\n   * @param {!ViewCache} viewCache_\n   * @param {?Node} optCompleteServerCache_\n   */\n  constructor(\n    private writes_: WriteTreeRef,\n    private viewCache_: ViewCache,\n    private optCompleteServerCache_: Node | null = null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getCompleteChild(childKey: string): Node | null {\n    const node = this.viewCache_.getEventCache();\n    if (node.isCompleteForChild(childKey)) {\n      return node.getNode().getImmediateChild(childKey);\n    } else {\n      const serverNode =\n        this.optCompleteServerCache_ != null\n          ? new CacheNode(this.optCompleteServerCache_, true, false)\n          : this.viewCache_.getServerCache();\n      return this.writes_.calcCompleteChild(childKey, serverNode);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getChildAfterChild(\n    index: Index,\n    child: NamedNode,\n    reverse: boolean\n  ): NamedNode | null {\n    const completeServerData =\n      this.optCompleteServerCache_ != null\n        ? this.optCompleteServerCache_\n        : this.viewCache_.getCompleteServerSnap();\n    const nodes = this.writes_.calcIndexedSlice(\n      completeServerData,\n      child,\n      1,\n      reverse,\n      index\n    );\n    if (nodes.length === 0) {\n      return null;\n    } else {\n      return nodes[0];\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationType } from '../operation/Operation';\nimport { assert, assertionError } from '@firebase/util';\nimport { ChildChangeAccumulator } from './ChildChangeAccumulator';\nimport { Change } from './Change';\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { KEY_INDEX } from '../snap/indexes/KeyIndex';\nimport { ImmutableTree } from '../util/ImmutableTree';\nimport { Path } from '../util/Path';\nimport {\n  WriteTreeCompleteChildSource,\n  NO_COMPLETE_CHILD_SOURCE,\n  CompleteChildSource\n} from './CompleteChildSource';\nimport { ViewCache } from './ViewCache';\nimport { NodeFilter } from './filter/NodeFilter';\nimport { WriteTreeRef } from '../WriteTree';\nimport { Overwrite } from '../operation/Overwrite';\nimport { Merge } from '../operation/Merge';\nimport { AckUserWrite } from '../operation/AckUserWrite';\nimport { Node } from '../snap/Node';\n\n/**\n * @constructor\n * @struct\n */\nexport class ProcessorResult {\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Array.<!Change>} changes\n   */\n  constructor(\n    public readonly viewCache: ViewCache,\n    public readonly changes: Change[]\n  ) {}\n}\n\n/**\n * @constructor\n */\nexport class ViewProcessor {\n  /**\n   * @param {!NodeFilter} filter_\n   */\n  constructor(private readonly filter_: NodeFilter) {}\n\n  /**\n   * @param {!ViewCache} viewCache\n   */\n  assertIndexed(viewCache: ViewCache) {\n    assert(\n      viewCache\n        .getEventCache()\n        .getNode()\n        .isIndexed(this.filter_.getIndex()),\n      'Event snap not indexed'\n    );\n    assert(\n      viewCache\n        .getServerCache()\n        .getNode()\n        .isIndexed(this.filter_.getIndex()),\n      'Server snap not indexed'\n    );\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Operation} operation\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @return {!ProcessorResult}\n   */\n  applyOperation(\n    oldViewCache: ViewCache,\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null\n  ): ProcessorResult {\n    const accumulator = new ChildChangeAccumulator();\n    let newViewCache, filterServerNode;\n    if (operation.type === OperationType.OVERWRITE) {\n      const overwrite = operation as Overwrite;\n      if (overwrite.source.fromUser) {\n        newViewCache = this.applyUserOverwrite_(\n          oldViewCache,\n          overwrite.path,\n          overwrite.snap,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        assert(overwrite.source.fromServer, 'Unknown source.');\n        // We filter the node if it's a tagged update or the node has been previously filtered  and the\n        // update is not at the root in which case it is ok (and necessary) to mark the node unfiltered\n        // again\n        filterServerNode =\n          overwrite.source.tagged ||\n          (oldViewCache.getServerCache().isFiltered() &&\n            !overwrite.path.isEmpty());\n        newViewCache = this.applyServerOverwrite_(\n          oldViewCache,\n          overwrite.path,\n          overwrite.snap,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.MERGE) {\n      const merge = operation as Merge;\n      if (merge.source.fromUser) {\n        newViewCache = this.applyUserMerge_(\n          oldViewCache,\n          merge.path,\n          merge.children,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        assert(merge.source.fromServer, 'Unknown source.');\n        // We filter the node if it's a tagged update or the node has been previously filtered\n        filterServerNode =\n          merge.source.tagged || oldViewCache.getServerCache().isFiltered();\n        newViewCache = this.applyServerMerge_(\n          oldViewCache,\n          merge.path,\n          merge.children,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.ACK_USER_WRITE) {\n      const ackUserWrite = operation as AckUserWrite;\n      if (!ackUserWrite.revert) {\n        newViewCache = this.ackUserWrite_(\n          oldViewCache,\n          ackUserWrite.path,\n          ackUserWrite.affectedTree,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        newViewCache = this.revertUserWrite_(\n          oldViewCache,\n          ackUserWrite.path,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.LISTEN_COMPLETE) {\n      newViewCache = this.listenComplete_(\n        oldViewCache,\n        operation.path,\n        writesCache,\n        accumulator\n      );\n    } else {\n      throw assertionError('Unknown operation type: ' + operation.type);\n    }\n    const changes = accumulator.getChanges();\n    ViewProcessor.maybeAddValueEvent_(oldViewCache, newViewCache, changes);\n    return new ProcessorResult(newViewCache, changes);\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!ViewCache} newViewCache\n   * @param {!Array.<!Change>} accumulator\n   * @private\n   */\n  private static maybeAddValueEvent_(\n    oldViewCache: ViewCache,\n    newViewCache: ViewCache,\n    accumulator: Change[]\n  ) {\n    const eventSnap = newViewCache.getEventCache();\n    if (eventSnap.isFullyInitialized()) {\n      const isLeafOrEmpty =\n        eventSnap.getNode().isLeafNode() || eventSnap.getNode().isEmpty();\n      const oldCompleteSnap = oldViewCache.getCompleteEventSnap();\n      if (\n        accumulator.length > 0 ||\n        !oldViewCache.getEventCache().isFullyInitialized() ||\n        (isLeafOrEmpty &&\n          !eventSnap\n            .getNode()\n            .equals(/** @type {!Node} */ (oldCompleteSnap))) ||\n        !eventSnap\n          .getNode()\n          .getPriority()\n          .equals(oldCompleteSnap.getPriority())\n      ) {\n        accumulator.push(\n          Change.valueChange(\n            /** @type {!Node} */ newViewCache.getCompleteEventSnap()\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} changePath\n   * @param {!WriteTreeRef} writesCache\n   * @param {!CompleteChildSource} source\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private generateEventCacheAfterServerEvent_(\n    viewCache: ViewCache,\n    changePath: Path,\n    writesCache: WriteTreeRef,\n    source: CompleteChildSource,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldEventSnap = viewCache.getEventCache();\n    if (writesCache.shadowingWrite(changePath) != null) {\n      // we have a shadowing write, ignore changes\n      return viewCache;\n    } else {\n      let newEventCache, serverNode;\n      if (changePath.isEmpty()) {\n        // TODO: figure out how this plays with \"sliding ack windows\"\n        assert(\n          viewCache.getServerCache().isFullyInitialized(),\n          'If change path is empty, we must have complete server data'\n        );\n        if (viewCache.getServerCache().isFiltered()) {\n          // We need to special case this, because we need to only apply writes to complete children, or\n          // we might end up raising events for incomplete children. If the server data is filtered deep\n          // writes cannot be guaranteed to be complete\n          const serverCache = viewCache.getCompleteServerSnap();\n          const completeChildren =\n            serverCache instanceof ChildrenNode\n              ? serverCache\n              : ChildrenNode.EMPTY_NODE;\n          const completeEventChildren = writesCache.calcCompleteEventChildren(\n            completeChildren\n          );\n          newEventCache = this.filter_.updateFullNode(\n            viewCache.getEventCache().getNode(),\n            completeEventChildren,\n            accumulator\n          );\n        } else {\n          const completeNode = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n          newEventCache = this.filter_.updateFullNode(\n            viewCache.getEventCache().getNode(),\n            completeNode,\n            accumulator\n          );\n        }\n      } else {\n        const childKey = changePath.getFront();\n        if (childKey == '.priority') {\n          assert(\n            changePath.getLength() == 1,\n            \"Can't have a priority with additional path components\"\n          );\n          const oldEventNode = oldEventSnap.getNode();\n          serverNode = viewCache.getServerCache().getNode();\n          // we might have overwrites for this priority\n          const updatedPriority = writesCache.calcEventCacheAfterServerOverwrite(\n            changePath,\n            oldEventNode,\n            serverNode\n          );\n          if (updatedPriority != null) {\n            newEventCache = this.filter_.updatePriority(\n              oldEventNode,\n              updatedPriority\n            );\n          } else {\n            // priority didn't change, keep old node\n            newEventCache = oldEventSnap.getNode();\n          }\n        } else {\n          const childChangePath = changePath.popFront();\n          // update child\n          let newEventChild;\n          if (oldEventSnap.isCompleteForChild(childKey)) {\n            serverNode = viewCache.getServerCache().getNode();\n            const eventChildUpdate = writesCache.calcEventCacheAfterServerOverwrite(\n              changePath,\n              oldEventSnap.getNode(),\n              serverNode\n            );\n            if (eventChildUpdate != null) {\n              newEventChild = oldEventSnap\n                .getNode()\n                .getImmediateChild(childKey)\n                .updateChild(childChangePath, eventChildUpdate);\n            } else {\n              // Nothing changed, just keep the old child\n              newEventChild = oldEventSnap\n                .getNode()\n                .getImmediateChild(childKey);\n            }\n          } else {\n            newEventChild = writesCache.calcCompleteChild(\n              childKey,\n              viewCache.getServerCache()\n            );\n          }\n          if (newEventChild != null) {\n            newEventCache = this.filter_.updateChild(\n              oldEventSnap.getNode(),\n              childKey,\n              newEventChild,\n              childChangePath,\n              source,\n              accumulator\n            );\n          } else {\n            // no complete child available or no change\n            newEventCache = oldEventSnap.getNode();\n          }\n        }\n      }\n      return viewCache.updateEventSnap(\n        newEventCache,\n        oldEventSnap.isFullyInitialized() || changePath.isEmpty(),\n        this.filter_.filtersNodes()\n      );\n    }\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Path} changePath\n   * @param {!Node} changedSnap\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {boolean} filterServerNode\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  applyServerOverwrite_(\n    oldViewCache: ViewCache,\n    changePath: Path,\n    changedSnap: Node,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    filterServerNode: boolean,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldServerSnap = oldViewCache.getServerCache();\n    let newServerCache;\n    const serverFilter = filterServerNode\n      ? this.filter_\n      : this.filter_.getIndexedFilter();\n    if (changePath.isEmpty()) {\n      newServerCache = serverFilter.updateFullNode(\n        oldServerSnap.getNode(),\n        changedSnap,\n        null\n      );\n    } else if (serverFilter.filtersNodes() && !oldServerSnap.isFiltered()) {\n      // we want to filter the server node, but we didn't filter the server node yet, so simulate a full update\n      const newServerNode = oldServerSnap\n        .getNode()\n        .updateChild(changePath, changedSnap);\n      newServerCache = serverFilter.updateFullNode(\n        oldServerSnap.getNode(),\n        newServerNode,\n        null\n      );\n    } else {\n      const childKey = changePath.getFront();\n      if (\n        !oldServerSnap.isCompleteForPath(changePath) &&\n        changePath.getLength() > 1\n      ) {\n        // We don't update incomplete nodes with updates intended for other listeners\n        return oldViewCache;\n      }\n      const childChangePath = changePath.popFront();\n      const childNode = oldServerSnap.getNode().getImmediateChild(childKey);\n      const newChildNode = childNode.updateChild(childChangePath, changedSnap);\n      if (childKey == '.priority') {\n        newServerCache = serverFilter.updatePriority(\n          oldServerSnap.getNode(),\n          newChildNode\n        );\n      } else {\n        newServerCache = serverFilter.updateChild(\n          oldServerSnap.getNode(),\n          childKey,\n          newChildNode,\n          childChangePath,\n          NO_COMPLETE_CHILD_SOURCE,\n          null\n        );\n      }\n    }\n    const newViewCache = oldViewCache.updateServerSnap(\n      newServerCache,\n      oldServerSnap.isFullyInitialized() || changePath.isEmpty(),\n      serverFilter.filtersNodes()\n    );\n    const source = new WriteTreeCompleteChildSource(\n      writesCache,\n      newViewCache,\n      completeCache\n    );\n    return this.generateEventCacheAfterServerEvent_(\n      newViewCache,\n      changePath,\n      writesCache,\n      source,\n      accumulator\n    );\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Path} changePath\n   * @param {!Node} changedSnap\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  applyUserOverwrite_(\n    oldViewCache: ViewCache,\n    changePath: Path,\n    changedSnap: Node,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldEventSnap = oldViewCache.getEventCache();\n    let newViewCache, newEventCache;\n    const source = new WriteTreeCompleteChildSource(\n      writesCache,\n      oldViewCache,\n      completeCache\n    );\n    if (changePath.isEmpty()) {\n      newEventCache = this.filter_.updateFullNode(\n        oldViewCache.getEventCache().getNode(),\n        changedSnap,\n        accumulator\n      );\n      newViewCache = oldViewCache.updateEventSnap(\n        newEventCache,\n        true,\n        this.filter_.filtersNodes()\n      );\n    } else {\n      const childKey = changePath.getFront();\n      if (childKey === '.priority') {\n        newEventCache = this.filter_.updatePriority(\n          oldViewCache.getEventCache().getNode(),\n          changedSnap\n        );\n        newViewCache = oldViewCache.updateEventSnap(\n          newEventCache,\n          oldEventSnap.isFullyInitialized(),\n          oldEventSnap.isFiltered()\n        );\n      } else {\n        const childChangePath = changePath.popFront();\n        const oldChild = oldEventSnap.getNode().getImmediateChild(childKey);\n        let newChild;\n        if (childChangePath.isEmpty()) {\n          // Child overwrite, we can replace the child\n          newChild = changedSnap;\n        } else {\n          const childNode = source.getCompleteChild(childKey);\n          if (childNode != null) {\n            if (\n              childChangePath.getBack() === '.priority' &&\n              childNode.getChild(childChangePath.parent()).isEmpty()\n            ) {\n              // This is a priority update on an empty node. If this node exists on the server, the\n              // server will send down the priority in the update, so ignore for now\n              newChild = childNode;\n            } else {\n              newChild = childNode.updateChild(childChangePath, changedSnap);\n            }\n          } else {\n            // There is no complete child node available\n            newChild = ChildrenNode.EMPTY_NODE;\n          }\n        }\n        if (!oldChild.equals(newChild)) {\n          const newEventSnap = this.filter_.updateChild(\n            oldEventSnap.getNode(),\n            childKey,\n            newChild,\n            childChangePath,\n            source,\n            accumulator\n          );\n          newViewCache = oldViewCache.updateEventSnap(\n            newEventSnap,\n            oldEventSnap.isFullyInitialized(),\n            this.filter_.filtersNodes()\n          );\n        } else {\n          newViewCache = oldViewCache;\n        }\n      }\n    }\n    return newViewCache;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {string} childKey\n   * @return {boolean}\n   * @private\n   */\n  private static cacheHasChild_(\n    viewCache: ViewCache,\n    childKey: string\n  ): boolean {\n    return viewCache.getEventCache().isCompleteForChild(childKey);\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {ImmutableTree.<!Node>} changedChildren\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private applyUserMerge_(\n    viewCache: ViewCache,\n    path: Path,\n    changedChildren: ImmutableTree<Node>,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    // HACK: In the case of a limit query, there may be some changes that bump things out of the\n    // window leaving room for new items.  It's important we process these changes first, so we\n    // iterate the changes twice, first processing any that affect items currently in view.\n    // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n    // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n    // not the other.\n    let curViewCache = viewCache;\n    changedChildren.foreach((relativePath, childNode) => {\n      const writePath = path.child(relativePath);\n      if (ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n        curViewCache = this.applyUserOverwrite_(\n          curViewCache,\n          writePath,\n          childNode,\n          writesCache,\n          serverCache,\n          accumulator\n        );\n      }\n    });\n\n    changedChildren.foreach((relativePath, childNode) => {\n      const writePath = path.child(relativePath);\n      if (!ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n        curViewCache = this.applyUserOverwrite_(\n          curViewCache,\n          writePath,\n          childNode,\n          writesCache,\n          serverCache,\n          accumulator\n        );\n      }\n    });\n\n    return curViewCache;\n  }\n\n  /**\n   * @param {!Node} node\n   * @param {ImmutableTree.<!Node>} merge\n   * @return {!Node}\n   * @private\n   */\n  private applyMerge_(node: Node, merge: ImmutableTree<Node>): Node {\n    merge.foreach(function(relativePath, childNode) {\n      node = node.updateChild(relativePath, childNode);\n    });\n    return node;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!ImmutableTree.<!Node>} changedChildren\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache\n   * @param {boolean} filterServerNode\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private applyServerMerge_(\n    viewCache: ViewCache,\n    path: Path,\n    changedChildren: ImmutableTree<Node>,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    filterServerNode: boolean,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    // If we don't have a cache yet, this merge was intended for a previously listen in the same location. Ignore it and\n    // wait for the complete data update coming soon.\n    if (\n      viewCache\n        .getServerCache()\n        .getNode()\n        .isEmpty() &&\n      !viewCache.getServerCache().isFullyInitialized()\n    ) {\n      return viewCache;\n    }\n\n    // HACK: In the case of a limit query, there may be some changes that bump things out of the\n    // window leaving room for new items.  It's important we process these changes first, so we\n    // iterate the changes twice, first processing any that affect items currently in view.\n    // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n    // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n    // not the other.\n    let curViewCache = viewCache;\n    let viewMergeTree;\n    if (path.isEmpty()) {\n      viewMergeTree = changedChildren;\n    } else {\n      viewMergeTree = ImmutableTree.Empty.setTree(path, changedChildren);\n    }\n    const serverNode = viewCache.getServerCache().getNode();\n    viewMergeTree.children.inorderTraversal((childKey, childTree) => {\n      if (serverNode.hasChild(childKey)) {\n        const serverChild = viewCache\n          .getServerCache()\n          .getNode()\n          .getImmediateChild(childKey);\n        const newChild = this.applyMerge_(serverChild, childTree);\n        curViewCache = this.applyServerOverwrite_(\n          curViewCache,\n          new Path(childKey),\n          newChild,\n          writesCache,\n          serverCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    });\n    viewMergeTree.children.inorderTraversal((childKey, childMergeTree) => {\n      const isUnknownDeepMerge =\n        !viewCache.getServerCache().isCompleteForChild(childKey) &&\n        childMergeTree.value == null;\n      if (!serverNode.hasChild(childKey) && !isUnknownDeepMerge) {\n        const serverChild = viewCache\n          .getServerCache()\n          .getNode()\n          .getImmediateChild(childKey);\n        const newChild = this.applyMerge_(serverChild, childMergeTree);\n        curViewCache = this.applyServerOverwrite_(\n          curViewCache,\n          new Path(childKey),\n          newChild,\n          writesCache,\n          serverCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    });\n\n    return curViewCache;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} ackPath\n   * @param {!ImmutableTree<!boolean>} affectedTree\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private ackUserWrite_(\n    viewCache: ViewCache,\n    ackPath: Path,\n    affectedTree: ImmutableTree<boolean>,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    if (writesCache.shadowingWrite(ackPath) != null) {\n      return viewCache;\n    }\n\n    // Only filter server node if it is currently filtered\n    const filterServerNode = viewCache.getServerCache().isFiltered();\n\n    // Essentially we'll just get our existing server cache for the affected paths and re-apply it as a server update\n    // now that it won't be shadowed.\n    const serverCache = viewCache.getServerCache();\n    if (affectedTree.value != null) {\n      // This is an overwrite.\n      if (\n        (ackPath.isEmpty() && serverCache.isFullyInitialized()) ||\n        serverCache.isCompleteForPath(ackPath)\n      ) {\n        return this.applyServerOverwrite_(\n          viewCache,\n          ackPath,\n          serverCache.getNode().getChild(ackPath),\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      } else if (ackPath.isEmpty()) {\n        // This is a goofy edge case where we are acking data at this location but don't have full data.  We\n        // should just re-apply whatever we have in our cache as a merge.\n        let changedChildren = ImmutableTree.Empty;\n        serverCache.getNode().forEachChild(KEY_INDEX, function(name, node) {\n          changedChildren = changedChildren.set(new Path(name), node);\n        });\n        return this.applyServerMerge_(\n          viewCache,\n          ackPath,\n          changedChildren,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      } else {\n        return viewCache;\n      }\n    } else {\n      // This is a merge.\n      let changedChildren = ImmutableTree.Empty;\n      affectedTree.foreach(function(mergePath, value) {\n        const serverCachePath = ackPath.child(mergePath);\n        if (serverCache.isCompleteForPath(serverCachePath)) {\n          changedChildren = changedChildren.set(\n            mergePath,\n            serverCache.getNode().getChild(serverCachePath)\n          );\n        }\n      });\n      return this.applyServerMerge_(\n        viewCache,\n        ackPath,\n        changedChildren,\n        writesCache,\n        completeCache,\n        filterServerNode,\n        accumulator\n      );\n    }\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!WriteTreeRef} writesCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private listenComplete_(\n    viewCache: ViewCache,\n    path: Path,\n    writesCache: WriteTreeRef,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldServerNode = viewCache.getServerCache();\n    const newViewCache = viewCache.updateServerSnap(\n      oldServerNode.getNode(),\n      oldServerNode.isFullyInitialized() || path.isEmpty(),\n      oldServerNode.isFiltered()\n    );\n    return this.generateEventCacheAfterServerEvent_(\n      newViewCache,\n      path,\n      writesCache,\n      NO_COMPLETE_CHILD_SOURCE,\n      accumulator\n    );\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeServerCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private revertUserWrite_(\n    viewCache: ViewCache,\n    path: Path,\n    writesCache: WriteTreeRef,\n    completeServerCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    let complete;\n    if (writesCache.shadowingWrite(path) != null) {\n      return viewCache;\n    } else {\n      const source = new WriteTreeCompleteChildSource(\n        writesCache,\n        viewCache,\n        completeServerCache\n      );\n      const oldEventCache = viewCache.getEventCache().getNode();\n      let newEventCache;\n      if (path.isEmpty() || path.getFront() === '.priority') {\n        let newNode;\n        if (viewCache.getServerCache().isFullyInitialized()) {\n          newNode = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n        } else {\n          const serverChildren = viewCache.getServerCache().getNode();\n          assert(\n            serverChildren instanceof ChildrenNode,\n            'serverChildren would be complete if leaf node'\n          );\n          newNode = writesCache.calcCompleteEventChildren(\n            serverChildren as ChildrenNode\n          );\n        }\n        newNode = newNode as Node;\n        newEventCache = this.filter_.updateFullNode(\n          oldEventCache,\n          newNode,\n          accumulator\n        );\n      } else {\n        const childKey = path.getFront();\n        let newChild = writesCache.calcCompleteChild(\n          childKey,\n          viewCache.getServerCache()\n        );\n        if (\n          newChild == null &&\n          viewCache.getServerCache().isCompleteForChild(childKey)\n        ) {\n          newChild = oldEventCache.getImmediateChild(childKey);\n        }\n        if (newChild != null) {\n          newEventCache = this.filter_.updateChild(\n            oldEventCache,\n            childKey,\n            newChild,\n            path.popFront(),\n            source,\n            accumulator\n          );\n        } else if (\n          viewCache\n            .getEventCache()\n            .getNode()\n            .hasChild(childKey)\n        ) {\n          // No complete child available, delete the existing one, if any\n          newEventCache = this.filter_.updateChild(\n            oldEventCache,\n            childKey,\n            ChildrenNode.EMPTY_NODE,\n            path.popFront(),\n            source,\n            accumulator\n          );\n        } else {\n          newEventCache = oldEventCache;\n        }\n        if (\n          newEventCache.isEmpty() &&\n          viewCache.getServerCache().isFullyInitialized()\n        ) {\n          // We might have reverted all child writes. Maybe the old event was a leaf node\n          complete = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n          if (complete.isLeafNode()) {\n            newEventCache = this.filter_.updateFullNode(\n              newEventCache,\n              complete,\n              accumulator\n            );\n          }\n        }\n      }\n      complete =\n        viewCache.getServerCache().isFullyInitialized() ||\n        writesCache.shadowingWrite(Path.Empty) != null;\n      return viewCache.updateEventSnap(\n        newEventCache,\n        complete,\n        this.filter_.filtersNodes()\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NamedNode, Node } from '../snap/Node';\nimport { Change } from './Change';\nimport { assertionError } from '@firebase/util';\nimport { Query } from '../../api/Query';\nimport { Index } from '../snap/indexes/Index';\nimport { EventRegistration } from './EventRegistration';\nimport { Event } from './Event';\n\n/**\n * An EventGenerator is used to convert \"raw\" changes (Change) as computed by the\n * CacheDiffer into actual events (Event) that can be raised.  See generateEventsForChanges()\n * for details.\n *\n * @constructor\n */\nexport class EventGenerator {\n  private index_: Index;\n\n  /**\n   *\n   * @param {!Query} query_\n   */\n  constructor(private query_: Query) {\n    /**\n     * @private\n     * @type {!Index}\n     */\n    this.index_ = this.query_.getQueryParams().getIndex();\n  }\n\n  /**\n   * Given a set of raw changes (no moved events and prevName not specified yet), and a set of\n   * EventRegistrations that should be notified of these changes, generate the actual events to be raised.\n   *\n   * Notes:\n   *  - child_moved events will be synthesized at this time for any child_changed events that affect\n   *    our index.\n   *  - prevName will be calculated based on the index ordering.\n   *\n   * @param {!Array.<!Change>} changes\n   * @param {!Node} eventCache\n   * @param {!Array.<!EventRegistration>} eventRegistrations\n   * @return {!Array.<!Event>}\n   */\n  generateEventsForChanges(\n    changes: Change[],\n    eventCache: Node,\n    eventRegistrations: EventRegistration[]\n  ): Event[] {\n    const events: Event[] = [];\n    const moves: Change[] = [];\n\n    changes.forEach(change => {\n      if (\n        change.type === Change.CHILD_CHANGED &&\n        this.index_.indexedValueChanged(\n          change.oldSnap as Node,\n          change.snapshotNode\n        )\n      ) {\n        moves.push(\n          Change.childMovedChange(\n            change.childName as string,\n            change.snapshotNode\n          )\n        );\n      }\n    });\n\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_REMOVED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_ADDED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_MOVED,\n      moves,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_CHANGED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.VALUE,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n\n    return events;\n  }\n\n  /**\n   * Given changes of a single change type, generate the corresponding events.\n   *\n   * @param {!Array.<!Event>} events\n   * @param {!string} eventType\n   * @param {!Array.<!Change>} changes\n   * @param {!Array.<!EventRegistration>} registrations\n   * @param {!Node} eventCache\n   * @private\n   */\n  private generateEventsForType_(\n    events: Event[],\n    eventType: string,\n    changes: Change[],\n    registrations: EventRegistration[],\n    eventCache: Node\n  ) {\n    const filteredChanges = changes.filter(change => change.type === eventType);\n\n    filteredChanges.sort(this.compareChanges_.bind(this));\n    filteredChanges.forEach(change => {\n      const materializedChange = this.materializeSingleChange_(\n        change,\n        eventCache\n      );\n      registrations.forEach(registration => {\n        if (registration.respondsTo(change.type)) {\n          events.push(\n            registration.createEvent(materializedChange, this.query_)\n          );\n        }\n      });\n    });\n  }\n\n  /**\n   * @param {!Change} change\n   * @param {!Node} eventCache\n   * @return {!Change}\n   * @private\n   */\n  private materializeSingleChange_(change: Change, eventCache: Node): Change {\n    if (change.type === 'value' || change.type === 'child_removed') {\n      return change;\n    } else {\n      change.prevName = eventCache.getPredecessorChildName(\n        /** @type {!string} */\n        change.childName,\n        change.snapshotNode,\n        this.index_\n      );\n      return change;\n    }\n  }\n\n  /**\n   * @param {!Change} a\n   * @param {!Change} b\n   * @return {number}\n   * @private\n   */\n  private compareChanges_(a: Change, b: Change) {\n    if (a.childName == null || b.childName == null) {\n      throw assertionError('Should only compare child_ events.');\n    }\n    const aWrapped = new NamedNode(a.childName, a.snapshotNode);\n    const bWrapped = new NamedNode(b.childName, b.snapshotNode);\n    return this.index_.compare(aWrapped, bWrapped);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IndexedFilter } from './filter/IndexedFilter';\nimport { ViewProcessor } from './ViewProcessor';\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { CacheNode } from './CacheNode';\nimport { ViewCache } from './ViewCache';\nimport { EventGenerator } from './EventGenerator';\nimport { assert } from '@firebase/util';\nimport { Operation, OperationType } from '../operation/Operation';\nimport { Change } from './Change';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { Query } from '../../api/Query';\nimport { EventRegistration } from './EventRegistration';\nimport { Node } from '../snap/Node';\nimport { Path } from '../util/Path';\nimport { WriteTreeRef } from '../WriteTree';\nimport { CancelEvent, Event } from './Event';\n\n/**\n * A view represents a specific location and query that has 1 or more event registrations.\n *\n * It does several things:\n *  - Maintains the list of event registrations for this location/query.\n *  - Maintains a cache of the data visible for this location/query.\n *  - Applies new operations (via applyOperation), updates the cache, and based on the event\n *    registrations returns the set of events to be raised.\n * @constructor\n */\nexport class View {\n  private processor_: ViewProcessor;\n  private viewCache_: ViewCache;\n  private eventRegistrations_: EventRegistration[] = [];\n  private eventGenerator_: EventGenerator;\n\n  /**\n   *\n   * @param {!Query} query_\n   * @param {!ViewCache} initialViewCache\n   */\n  constructor(private query_: Query, initialViewCache: ViewCache) {\n    const params = this.query_.getQueryParams();\n\n    const indexFilter = new IndexedFilter(params.getIndex());\n    const filter = params.getNodeFilter();\n\n    /**\n     * @type {ViewProcessor}\n     * @private\n     */\n    this.processor_ = new ViewProcessor(filter);\n\n    const initialServerCache = initialViewCache.getServerCache();\n    const initialEventCache = initialViewCache.getEventCache();\n\n    // Don't filter server node with other filter than index, wait for tagged listen\n    const serverSnap = indexFilter.updateFullNode(\n      ChildrenNode.EMPTY_NODE,\n      initialServerCache.getNode(),\n      null\n    );\n    const eventSnap = filter.updateFullNode(\n      ChildrenNode.EMPTY_NODE,\n      initialEventCache.getNode(),\n      null\n    );\n    const newServerCache = new CacheNode(\n      serverSnap,\n      initialServerCache.isFullyInitialized(),\n      indexFilter.filtersNodes()\n    );\n    const newEventCache = new CacheNode(\n      eventSnap,\n      initialEventCache.isFullyInitialized(),\n      filter.filtersNodes()\n    );\n\n    /**\n     * @type {!ViewCache}\n     * @private\n     */\n    this.viewCache_ = new ViewCache(newEventCache, newServerCache);\n\n    /**\n     * @type {!EventGenerator}\n     * @private\n     */\n    this.eventGenerator_ = new EventGenerator(this.query_);\n  }\n\n  /**\n   * @return {!Query}\n   */\n  getQuery(): Query {\n    return this.query_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getServerCache(): Node | null {\n    return this.viewCache_.getServerCache().getNode();\n  }\n\n  /**\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  getCompleteServerCache(path: Path): Node | null {\n    const cache = this.viewCache_.getCompleteServerSnap();\n    if (cache) {\n      // If this isn't a \"loadsAllData\" view, then cache isn't actually a complete cache and\n      // we need to see if it contains the child we're interested in.\n      if (\n        this.query_.getQueryParams().loadsAllData() ||\n        (!path.isEmpty() && !cache.getImmediateChild(path.getFront()).isEmpty())\n      ) {\n        return cache.getChild(path);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return this.eventRegistrations_.length === 0;\n  }\n\n  /**\n   * @param {!EventRegistration} eventRegistration\n   */\n  addEventRegistration(eventRegistration: EventRegistration) {\n    this.eventRegistrations_.push(eventRegistration);\n  }\n\n  /**\n   * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n   * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return {!Array.<!Event>} Cancel events, if cancelError was provided.\n   */\n  removeEventRegistration(\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): Event[] {\n    const cancelEvents: CancelEvent[] = [];\n    if (cancelError) {\n      assert(\n        eventRegistration == null,\n        'A cancel should cancel all event registrations.'\n      );\n      const path = this.query_.path;\n      this.eventRegistrations_.forEach(function(registration) {\n        cancelError /** @type {!Error} */ = cancelError;\n        const maybeEvent = registration.createCancelEvent(cancelError, path);\n        if (maybeEvent) {\n          cancelEvents.push(maybeEvent);\n        }\n      });\n    }\n\n    if (eventRegistration) {\n      let remaining = [];\n      for (let i = 0; i < this.eventRegistrations_.length; ++i) {\n        const existing = this.eventRegistrations_[i];\n        if (!existing.matches(eventRegistration)) {\n          remaining.push(existing);\n        } else if (eventRegistration.hasAnyCallback()) {\n          // We're removing just this one\n          remaining = remaining.concat(this.eventRegistrations_.slice(i + 1));\n          break;\n        }\n      }\n      this.eventRegistrations_ = remaining;\n    } else {\n      this.eventRegistrations_ = [];\n    }\n    return cancelEvents;\n  }\n\n  /**\n   * Applies the given Operation, updates our cache, and returns the appropriate events.\n   *\n   * @param {!Operation} operation\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeServerCache\n   * @return {!Array.<!Event>}\n   */\n  applyOperation(\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    completeServerCache: Node | null\n  ): Event[] {\n    if (\n      operation.type === OperationType.MERGE &&\n      operation.source.queryId !== null\n    ) {\n      assert(\n        this.viewCache_.getCompleteServerSnap(),\n        'We should always have a full cache before handling merges'\n      );\n      assert(\n        this.viewCache_.getCompleteEventSnap(),\n        'Missing event cache, even though we have a server cache'\n      );\n    }\n\n    const oldViewCache = this.viewCache_;\n    const result = this.processor_.applyOperation(\n      oldViewCache,\n      operation,\n      writesCache,\n      completeServerCache\n    );\n    this.processor_.assertIndexed(result.viewCache);\n\n    assert(\n      result.viewCache.getServerCache().isFullyInitialized() ||\n        !oldViewCache.getServerCache().isFullyInitialized(),\n      'Once a server snap is complete, it should never go back'\n    );\n\n    this.viewCache_ = result.viewCache;\n\n    return this.generateEventsForChanges_(\n      result.changes,\n      result.viewCache.getEventCache().getNode(),\n      null\n    );\n  }\n\n  /**\n   * @param {!EventRegistration} registration\n   * @return {!Array.<!Event>}\n   */\n  getInitialEvents(registration: EventRegistration): Event[] {\n    const eventSnap = this.viewCache_.getEventCache();\n    const initialChanges: Change[] = [];\n    if (!eventSnap.getNode().isLeafNode()) {\n      const eventNode = eventSnap.getNode() as ChildrenNode;\n      eventNode.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n        initialChanges.push(Change.childAddedChange(key, childNode));\n      });\n    }\n    if (eventSnap.isFullyInitialized()) {\n      initialChanges.push(Change.valueChange(eventSnap.getNode()));\n    }\n    return this.generateEventsForChanges_(\n      initialChanges,\n      eventSnap.getNode(),\n      registration\n    );\n  }\n\n  /**\n   * @private\n   * @param {!Array.<!Change>} changes\n   * @param {!Node} eventCache\n   * @param {EventRegistration=} eventRegistration\n   * @return {!Array.<!Event>}\n   */\n  generateEventsForChanges_(\n    changes: Change[],\n    eventCache: Node,\n    eventRegistration?: EventRegistration\n  ): Event[] {\n    const registrations = eventRegistration\n      ? [eventRegistration]\n      : this.eventRegistrations_;\n    return this.eventGenerator_.generateEventsForChanges(\n      changes,\n      eventCache,\n      registrations\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CacheNode } from './view/CacheNode';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { assert } from '@firebase/util';\nimport { isEmpty, forEach, findValue, safeGet } from '@firebase/util';\nimport { ViewCache } from './view/ViewCache';\nimport { View } from './view/View';\nimport { Operation } from './operation/Operation';\nimport { WriteTreeRef } from './WriteTree';\nimport { Query } from '../api/Query';\nimport { EventRegistration } from './view/EventRegistration';\nimport { Node } from './snap/Node';\nimport { Path } from './util/Path';\nimport { Event } from './view/Event';\nimport { Reference, ReferenceConstructor } from '../api/Reference';\n\nlet __referenceConstructor: ReferenceConstructor;\n\n/**\n * SyncPoint represents a single location in a SyncTree with 1 or more event registrations, meaning we need to\n * maintain 1 or more Views at this location to cache server data and raise appropriate events for server changes\n * and user writes (set, transaction, update).\n *\n * It's responsible for:\n *  - Maintaining the set of 1 or more views necessary at this location (a SyncPoint with 0 views should be removed).\n *  - Proxying user / server operations to the views as appropriate (i.e. applyServerOverwrite,\n *    applyUserOverwrite, etc.)\n */\nexport class SyncPoint {\n  static set __referenceConstructor(val: ReferenceConstructor) {\n    assert(\n      !__referenceConstructor,\n      '__referenceConstructor has already been defined'\n    );\n    __referenceConstructor = val;\n  }\n\n  static get __referenceConstructor() {\n    assert(__referenceConstructor, 'Reference.ts has not been loaded');\n    return __referenceConstructor;\n  }\n\n  /**\n   * The Views being tracked at this location in the tree, stored as a map where the key is a\n   * queryId and the value is the View for that query.\n   *\n   * NOTE: This list will be quite small (usually 1, but perhaps 2 or 3; any more is an odd use case).\n   *\n   * @type {!Object.<!string, !View>}\n   * @private\n   */\n  private views_: { [k: string]: View } = {};\n\n  /**\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return isEmpty(this.views_);\n  }\n\n  /**\n   *\n   * @param {!Operation} operation\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} optCompleteServerCache\n   * @return {!Array.<!Event>}\n   */\n  applyOperation(\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    optCompleteServerCache: Node | null\n  ): Event[] {\n    const queryId = operation.source.queryId;\n    if (queryId !== null) {\n      const view = safeGet(this.views_, queryId);\n      assert(view != null, 'SyncTree gave us an op for an invalid query.');\n      return view.applyOperation(\n        operation,\n        writesCache,\n        optCompleteServerCache\n      );\n    } else {\n      let events: Event[] = [];\n\n      forEach(this.views_, function(key: string, view: View) {\n        events = events.concat(\n          view.applyOperation(operation, writesCache, optCompleteServerCache)\n        );\n      });\n\n      return events;\n    }\n  }\n\n  /**\n   * Add an event callback for the specified query.\n   *\n   * @param {!Query} query\n   * @param {!EventRegistration} eventRegistration\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache Complete server cache, if we have it.\n   * @param {boolean} serverCacheComplete\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  addEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    serverCacheComplete: boolean\n  ): Event[] {\n    const queryId = query.queryIdentifier();\n    let view = safeGet(this.views_, queryId);\n    if (!view) {\n      // TODO: make writesCache take flag for complete server node\n      let eventCache = writesCache.calcCompleteEventCache(\n        serverCacheComplete ? serverCache : null\n      );\n      let eventCacheComplete = false;\n      if (eventCache) {\n        eventCacheComplete = true;\n      } else if (serverCache instanceof ChildrenNode) {\n        eventCache = writesCache.calcCompleteEventChildren(serverCache);\n        eventCacheComplete = false;\n      } else {\n        eventCache = ChildrenNode.EMPTY_NODE;\n        eventCacheComplete = false;\n      }\n      const viewCache = new ViewCache(\n        new CacheNode(\n          /** @type {!Node} */ (eventCache),\n          eventCacheComplete,\n          false\n        ),\n        new CacheNode(\n          /** @type {!Node} */ (serverCache),\n          serverCacheComplete,\n          false\n        )\n      );\n      view = new View(query, viewCache);\n      this.views_[queryId] = view;\n    }\n\n    // This is guaranteed to exist now, we just created anything that was missing\n    view.addEventRegistration(eventRegistration);\n    return view.getInitialEvents(eventRegistration);\n  }\n\n  /**\n   * Remove event callback(s).  Return cancelEvents if a cancelError is specified.\n   *\n   * If query is the default query, we'll check all views for the specified eventRegistration.\n   * If eventRegistration is null, we'll remove all callbacks for the specified view(s).\n   *\n   * @param {!Query} query\n   * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n   * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return {{removed:!Array.<!Query>, events:!Array.<!Event>}} removed queries and any cancel events\n   */\n  removeEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): { removed: Query[]; events: Event[] } {\n    const queryId = query.queryIdentifier();\n    const removed: Query[] = [];\n    let cancelEvents: Event[] = [];\n    const hadCompleteView = this.hasCompleteView();\n    if (queryId === 'default') {\n      // When you do ref.off(...), we search all views for the registration to remove.\n      const self = this;\n      forEach(this.views_, function(viewQueryId: string, view: View) {\n        cancelEvents = cancelEvents.concat(\n          view.removeEventRegistration(eventRegistration, cancelError)\n        );\n        if (view.isEmpty()) {\n          delete self.views_[viewQueryId];\n\n          // We'll deal with complete views later.\n          if (\n            !view\n              .getQuery()\n              .getQueryParams()\n              .loadsAllData()\n          ) {\n            removed.push(view.getQuery());\n          }\n        }\n      });\n    } else {\n      // remove the callback from the specific view.\n      const view = safeGet(this.views_, queryId);\n      if (view) {\n        cancelEvents = cancelEvents.concat(\n          view.removeEventRegistration(eventRegistration, cancelError)\n        );\n        if (view.isEmpty()) {\n          delete this.views_[queryId];\n\n          // We'll deal with complete views later.\n          if (\n            !view\n              .getQuery()\n              .getQueryParams()\n              .loadsAllData()\n          ) {\n            removed.push(view.getQuery());\n          }\n        }\n      }\n    }\n\n    if (hadCompleteView && !this.hasCompleteView()) {\n      // We removed our last complete view.\n      removed.push(\n        new SyncPoint.__referenceConstructor(query.repo, query.path)\n      );\n    }\n\n    return { removed: removed, events: cancelEvents };\n  }\n\n  /**\n   * @return {!Array.<!View>}\n   */\n  getQueryViews(): View[] {\n    const values = Object.keys(this.views_).map(key => this.views_[key]);\n    return values.filter(function(view) {\n      return !view\n        .getQuery()\n        .getQueryParams()\n        .loadsAllData();\n    });\n  }\n\n  /**\n   *\n   * @param {!Path} path The path to the desired complete snapshot\n   * @return {?Node} A complete cache, if it exists\n   */\n  getCompleteServerCache(path: Path): Node | null {\n    let serverCache: Node | null = null;\n    forEach(this.views_, (key: string, view: View) => {\n      serverCache = serverCache || view.getCompleteServerCache(path);\n    });\n    return serverCache;\n  }\n\n  /**\n   * @param {!Query} query\n   * @return {?View}\n   */\n  viewForQuery(query: Query): View | null {\n    const params = query.getQueryParams();\n    if (params.loadsAllData()) {\n      return this.getCompleteView();\n    } else {\n      const queryId = query.queryIdentifier();\n      return safeGet(this.views_, queryId);\n    }\n  }\n\n  /**\n   * @param {!Query} query\n   * @return {boolean}\n   */\n  viewExistsForQuery(query: Query): boolean {\n    return this.viewForQuery(query) != null;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasCompleteView(): boolean {\n    return this.getCompleteView() != null;\n  }\n\n  /**\n   * @return {?View}\n   */\n  getCompleteView(): View | null {\n    const completeView = findValue(this.views_, (view: View) =>\n      view\n        .getQuery()\n        .getQueryParams()\n        .loadsAllData()\n    );\n    return completeView || null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ImmutableTree } from './util/ImmutableTree';\nimport { Path } from './util/Path';\nimport { forEach } from '@firebase/util';\nimport { Node, NamedNode } from './snap/Node';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { assert } from '@firebase/util';\nimport { ChildrenNode } from './snap/ChildrenNode';\n\n/**\n * This class holds a collection of writes that can be applied to nodes in unison. It abstracts away the logic with\n * dealing with priority writes and multiple nested writes. At any given path there is only allowed to be one write\n * modifying that path. Any write to an existing path or shadowing an existing path will modify that existing write\n * to reflect the write added.\n *\n * @constructor\n * @param {!ImmutableTree.<!Node>} writeTree\n */\nexport class CompoundWrite {\n  constructor(private writeTree_: ImmutableTree<Node>) {}\n  /**\n   * @type {!CompoundWrite}\n   */\n  static Empty = new CompoundWrite(new ImmutableTree(null));\n\n  /**\n   * @param {!Path} path\n   * @param {!Node} node\n   * @return {!CompoundWrite}\n   */\n  addWrite(path: Path, node: Node): CompoundWrite {\n    if (path.isEmpty()) {\n      return new CompoundWrite(new ImmutableTree(node));\n    } else {\n      const rootmost = this.writeTree_.findRootMostValueAndPath(path);\n      if (rootmost != null) {\n        const rootMostPath = rootmost.path;\n        let value = rootmost.value;\n        const relativePath = Path.relativePath(rootMostPath, path);\n        value = value.updateChild(relativePath, node);\n        return new CompoundWrite(this.writeTree_.set(rootMostPath, value));\n      } else {\n        const subtree = new ImmutableTree(node);\n        const newWriteTree = this.writeTree_.setTree(path, subtree);\n        return new CompoundWrite(newWriteTree);\n      }\n    }\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} updates\n   * @return {!CompoundWrite}\n   */\n  addWrites(path: Path, updates: { [name: string]: Node }): CompoundWrite {\n    let newWrite = this as CompoundWrite;\n    forEach(updates, function(childKey: string, node: Node) {\n      newWrite = newWrite.addWrite(path.child(childKey), node);\n    });\n    return newWrite;\n  }\n\n  /**\n   * Will remove a write at the given path and deeper paths. This will <em>not</em> modify a write at a higher\n   * location, which must be removed by calling this method with that path.\n   *\n   * @param {!Path} path The path at which a write and all deeper writes should be removed\n   * @return {!CompoundWrite} The new CompoundWrite with the removed path\n   */\n  removeWrite(path: Path): CompoundWrite {\n    if (path.isEmpty()) {\n      return CompoundWrite.Empty;\n    } else {\n      const newWriteTree = this.writeTree_.setTree(path, ImmutableTree.Empty);\n      return new CompoundWrite(newWriteTree);\n    }\n  }\n\n  /**\n   * Returns whether this CompoundWrite will fully overwrite a node at a given location and can therefore be\n   * considered \"complete\".\n   *\n   * @param {!Path} path The path to check for\n   * @return {boolean} Whether there is a complete write at that path\n   */\n  hasCompleteWrite(path: Path): boolean {\n    return this.getCompleteNode(path) != null;\n  }\n\n  /**\n   * Returns a node for a path if and only if the node is a \"complete\" overwrite at that path. This will not aggregate\n   * writes from deeper paths, but will return child nodes from a more shallow path.\n   *\n   * @param {!Path} path The path to get a complete write\n   * @return {?Node} The node if complete at that path, or null otherwise.\n   */\n  getCompleteNode(path: Path): Node | null {\n    const rootmost = this.writeTree_.findRootMostValueAndPath(path);\n    if (rootmost != null) {\n      return this.writeTree_\n        .get(rootmost.path)\n        .getChild(Path.relativePath(rootmost.path, path));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Returns all children that are guaranteed to be a complete overwrite.\n   *\n   * @return {!Array.<NamedNode>} A list of all complete children.\n   */\n  getCompleteChildren(): Array<NamedNode> {\n    const children: NamedNode[] = [];\n    let node = this.writeTree_.value;\n    if (node != null) {\n      // If it's a leaf node, it has no children; so nothing to do.\n      if (!node.isLeafNode()) {\n        (node as ChildrenNode).forEachChild(PRIORITY_INDEX, function(\n          childName,\n          childNode\n        ) {\n          children.push(new NamedNode(childName, childNode));\n        });\n      }\n    } else {\n      this.writeTree_.children.inorderTraversal(function(childName, childTree) {\n        if (childTree.value != null) {\n          children.push(new NamedNode(childName, childTree.value));\n        }\n      });\n    }\n    return children;\n  }\n\n  /**\n   * @param {!Path} path\n   * @return {!CompoundWrite}\n   */\n  childCompoundWrite(path: Path): CompoundWrite {\n    if (path.isEmpty()) {\n      return this;\n    } else {\n      const shadowingNode = this.getCompleteNode(path);\n      if (shadowingNode != null) {\n        return new CompoundWrite(new ImmutableTree(shadowingNode));\n      } else {\n        return new CompoundWrite(this.writeTree_.subtree(path));\n      }\n    }\n  }\n\n  /**\n   * Returns true if this CompoundWrite is empty and therefore does not modify any nodes.\n   * @return {boolean} Whether this CompoundWrite is empty\n   */\n  isEmpty(): boolean {\n    return this.writeTree_.isEmpty();\n  }\n\n  /**\n   * Applies this CompoundWrite to a node. The node is returned with all writes from this CompoundWrite applied to the\n   * node\n   * @param {!Node} node The node to apply this CompoundWrite to\n   * @return {!Node} The node with all writes applied\n   */\n  apply(node: Node): Node {\n    return CompoundWrite.applySubtreeWrite_(Path.Empty, this.writeTree_, node);\n  }\n\n  /**\n   * @param {!Path} relativePath\n   * @param {!ImmutableTree.<!Node>} writeTree\n   * @param {!Node} node\n   * @return {!Node}\n   * @private\n   */\n  private static applySubtreeWrite_ = function(\n    relativePath: Path,\n    writeTree: ImmutableTree<Node>,\n    node: Node\n  ): Node {\n    if (writeTree.value != null) {\n      // Since there a write is always a leaf, we're done here\n      return node.updateChild(relativePath, writeTree.value);\n    } else {\n      let priorityWrite = null;\n      writeTree.children.inorderTraversal(function(childKey, childTree) {\n        if (childKey === '.priority') {\n          // Apply priorities at the end so we don't update priorities for either empty nodes or forget\n          // to apply priorities to empty nodes that are later filled\n          assert(\n            childTree.value !== null,\n            'Priority writes must always be leaf nodes'\n          );\n          priorityWrite = childTree.value;\n        } else {\n          node = CompoundWrite.applySubtreeWrite_(\n            relativePath.child(childKey),\n            childTree,\n            node\n          );\n        }\n      });\n      // If there was a priority write, we only apply it if the node is not empty\n      if (!node.getChild(relativePath).isEmpty() && priorityWrite !== null) {\n        node = node.updateChild(relativePath.child('.priority'), priorityWrite);\n      }\n      return node;\n    }\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { findKey, forEach, safeGet } from '@firebase/util';\nimport { assert, assertionError } from '@firebase/util';\nimport { Path } from './util/Path';\nimport { CompoundWrite } from './CompoundWrite';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { NamedNode, Node } from './snap/Node';\nimport { CacheNode } from './view/CacheNode';\nimport { Index } from './snap/indexes/Index';\n\n/**\n * Defines a single user-initiated write operation. May be the result of a set(), transaction(), or update() call. In\n * the case of a set() or transaction, snap wil be non-null.  In the case of an update(), children will be non-null.\n */\nexport interface WriteRecord {\n  writeId: number;\n  path: Path;\n  snap?: Node | null;\n  children?: { [k: string]: Node } | null;\n  visible: boolean;\n}\n\n/**\n * WriteTree tracks all pending user-initiated writes and has methods to calculate the result of merging them\n * with underlying server data (to create \"event cache\" data).  Pending writes are added with addOverwrite()\n * and addMerge(), and removed with removeWrite().\n *\n * @constructor\n */\nexport class WriteTree {\n  /**\n   * A tree tracking the result of applying all visible writes.  This does not include transactions with\n   * applyLocally=false or writes that are completely shadowed by other writes.\n   *\n   * @type {!CompoundWrite}\n   * @private\n   */\n  private visibleWrites_: CompoundWrite = CompoundWrite.Empty;\n\n  /**\n   * A list of all pending writes, regardless of visibility and shadowed-ness.  Used to calculate arbitrary\n   * sets of the changed data, such as hidden writes (from transactions) or changes with certain writes excluded (also\n   * used by transactions).\n   *\n   * @type {!Array.<!WriteRecord>}\n   * @private\n   */\n  private allWrites_: WriteRecord[] = [];\n\n  private lastWriteId_ = -1;\n\n  /**\n   * Create a new WriteTreeRef for the given path. For use with a new sync point at the given path.\n   *\n   * @param {!Path} path\n   * @return {!WriteTreeRef}\n   */\n  childWrites(path: Path): WriteTreeRef {\n    return new WriteTreeRef(path, this);\n  }\n\n  /**\n   * Record a new overwrite from user code.\n   *\n   * @param {!Path} path\n   * @param {!Node} snap\n   * @param {!number} writeId\n   * @param {boolean=} visible This is set to false by some transactions. It should be excluded from event caches\n   */\n  addOverwrite(path: Path, snap: Node, writeId: number, visible?: boolean) {\n    assert(\n      writeId > this.lastWriteId_,\n      'Stacking an older write on top of newer ones'\n    );\n    if (visible === undefined) {\n      visible = true;\n    }\n    this.allWrites_.push({\n      path: path,\n      snap: snap,\n      writeId: writeId,\n      visible: visible\n    });\n\n    if (visible) {\n      this.visibleWrites_ = this.visibleWrites_.addWrite(path, snap);\n    }\n    this.lastWriteId_ = writeId;\n  }\n\n  /**\n   * Record a new merge from user code.\n   *\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} changedChildren\n   * @param {!number} writeId\n   */\n  addMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    writeId: number\n  ) {\n    assert(\n      writeId > this.lastWriteId_,\n      'Stacking an older merge on top of newer ones'\n    );\n    this.allWrites_.push({\n      path: path,\n      children: changedChildren,\n      writeId: writeId,\n      visible: true\n    });\n\n    this.visibleWrites_ = this.visibleWrites_.addWrites(path, changedChildren);\n    this.lastWriteId_ = writeId;\n  }\n\n  /**\n   * @param {!number} writeId\n   * @return {?WriteRecord}\n   */\n  getWrite(writeId: number): WriteRecord | null {\n    for (let i = 0; i < this.allWrites_.length; i++) {\n      const record = this.allWrites_[i];\n      if (record.writeId === writeId) {\n        return record;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Remove a write (either an overwrite or merge) that has been successfully acknowledge by the server. Recalculates\n   * the tree if necessary.  We return true if it may have been visible, meaning views need to reevaluate.\n   *\n   * @param {!number} writeId\n   * @return {boolean} true if the write may have been visible (meaning we'll need to reevaluate / raise\n   * events as a result).\n   */\n  removeWrite(writeId: number): boolean {\n    // Note: disabling this check. It could be a transaction that preempted another transaction, and thus was applied\n    // out of order.\n    //const validClear = revert || this.allWrites_.length === 0 || writeId <= this.allWrites_[0].writeId;\n    //assert(validClear, \"Either we don't have this write, or it's the first one in the queue\");\n\n    const idx = this.allWrites_.findIndex(function(s) {\n      return s.writeId === writeId;\n    });\n    assert(idx >= 0, 'removeWrite called with nonexistent writeId.');\n    const writeToRemove = this.allWrites_[idx];\n    this.allWrites_.splice(idx, 1);\n\n    let removedWriteWasVisible = writeToRemove.visible;\n    let removedWriteOverlapsWithOtherWrites = false;\n\n    let i = this.allWrites_.length - 1;\n\n    while (removedWriteWasVisible && i >= 0) {\n      const currentWrite = this.allWrites_[i];\n      if (currentWrite.visible) {\n        if (\n          i >= idx &&\n          this.recordContainsPath_(currentWrite, writeToRemove.path)\n        ) {\n          // The removed write was completely shadowed by a subsequent write.\n          removedWriteWasVisible = false;\n        } else if (writeToRemove.path.contains(currentWrite.path)) {\n          // Either we're covering some writes or they're covering part of us (depending on which came first).\n          removedWriteOverlapsWithOtherWrites = true;\n        }\n      }\n      i--;\n    }\n\n    if (!removedWriteWasVisible) {\n      return false;\n    } else if (removedWriteOverlapsWithOtherWrites) {\n      // There's some shadowing going on. Just rebuild the visible writes from scratch.\n      this.resetTree_();\n      return true;\n    } else {\n      // There's no shadowing.  We can safely just remove the write(s) from visibleWrites.\n      if (writeToRemove.snap) {\n        this.visibleWrites_ = this.visibleWrites_.removeWrite(\n          writeToRemove.path\n        );\n      } else {\n        const children = writeToRemove.children;\n        forEach(children, (childName: string) => {\n          this.visibleWrites_ = this.visibleWrites_.removeWrite(\n            writeToRemove.path.child(childName)\n          );\n        });\n      }\n      return true;\n    }\n  }\n\n  /**\n   * Return a complete snapshot for the given path if there's visible write data at that path, else null.\n   * No server data is considered.\n   *\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  getCompleteWriteData(path: Path): Node | null {\n    return this.visibleWrites_.getCompleteNode(path);\n  }\n\n  /**\n   * Given optional, underlying server data, and an optional set of constraints (exclude some sets, include hidden\n   * writes), attempt to calculate a complete snapshot for the given path\n   *\n   * @param {!Path} treePath\n   * @param {?Node} completeServerCache\n   * @param {Array.<number>=} writeIdsToExclude An optional set to be excluded\n   * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n   * @return {?Node}\n   */\n  calcCompleteEventCache(\n    treePath: Path,\n    completeServerCache: Node | null,\n    writeIdsToExclude?: number[],\n    includeHiddenWrites?: boolean\n  ): Node | null {\n    if (!writeIdsToExclude && !includeHiddenWrites) {\n      const shadowingNode = this.visibleWrites_.getCompleteNode(treePath);\n      if (shadowingNode != null) {\n        return shadowingNode;\n      } else {\n        const subMerge = this.visibleWrites_.childCompoundWrite(treePath);\n        if (subMerge.isEmpty()) {\n          return completeServerCache;\n        } else if (\n          completeServerCache == null &&\n          !subMerge.hasCompleteWrite(Path.Empty)\n        ) {\n          // We wouldn't have a complete snapshot, since there's no underlying data and no complete shadow\n          return null;\n        } else {\n          const layeredCache = completeServerCache || ChildrenNode.EMPTY_NODE;\n          return subMerge.apply(layeredCache);\n        }\n      }\n    } else {\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      if (!includeHiddenWrites && merge.isEmpty()) {\n        return completeServerCache;\n      } else {\n        // If the server cache is null, and we don't have a complete cache, we need to return null\n        if (\n          !includeHiddenWrites &&\n          completeServerCache == null &&\n          !merge.hasCompleteWrite(Path.Empty)\n        ) {\n          return null;\n        } else {\n          const filter = function(write: WriteRecord) {\n            return (\n              (write.visible || includeHiddenWrites) &&\n              (!writeIdsToExclude ||\n                !~writeIdsToExclude.indexOf(write.writeId)) &&\n              (write.path.contains(treePath) || treePath.contains(write.path))\n            );\n          };\n          const mergeAtPath = WriteTree.layerTree_(\n            this.allWrites_,\n            filter,\n            treePath\n          );\n          const layeredCache = completeServerCache || ChildrenNode.EMPTY_NODE;\n          return mergeAtPath.apply(layeredCache);\n        }\n      }\n    }\n  }\n\n  /**\n   * With optional, underlying server data, attempt to return a children node of children that we have complete data for.\n   * Used when creating new views, to pre-fill their complete event children snapshot.\n   *\n   * @param {!Path} treePath\n   * @param {?ChildrenNode} completeServerChildren\n   * @return {!ChildrenNode}\n   */\n  calcCompleteEventChildren(\n    treePath: Path,\n    completeServerChildren: ChildrenNode | null\n  ) {\n    let completeChildren = ChildrenNode.EMPTY_NODE as Node;\n    const topLevelSet = this.visibleWrites_.getCompleteNode(treePath);\n    if (topLevelSet) {\n      if (!topLevelSet.isLeafNode()) {\n        // we're shadowing everything. Return the children.\n        topLevelSet.forEachChild(PRIORITY_INDEX, function(\n          childName,\n          childSnap\n        ) {\n          completeChildren = completeChildren.updateImmediateChild(\n            childName,\n            childSnap\n          );\n        });\n      }\n      return completeChildren;\n    } else if (completeServerChildren) {\n      // Layer any children we have on top of this\n      // We know we don't have a top-level set, so just enumerate existing children\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      completeServerChildren.forEachChild(PRIORITY_INDEX, function(\n        childName,\n        childNode\n      ) {\n        const node = merge\n          .childCompoundWrite(new Path(childName))\n          .apply(childNode);\n        completeChildren = completeChildren.updateImmediateChild(\n          childName,\n          node\n        );\n      });\n      // Add any complete children we have from the set\n      merge.getCompleteChildren().forEach(function(namedNode) {\n        completeChildren = completeChildren.updateImmediateChild(\n          namedNode.name,\n          namedNode.node\n        );\n      });\n      return completeChildren;\n    } else {\n      // We don't have anything to layer on top of. Layer on any children we have\n      // Note that we can return an empty snap if we have a defined delete\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      merge.getCompleteChildren().forEach(function(namedNode) {\n        completeChildren = completeChildren.updateImmediateChild(\n          namedNode.name,\n          namedNode.node\n        );\n      });\n      return completeChildren;\n    }\n  }\n\n  /**\n   * Given that the underlying server data has updated, determine what, if anything, needs to be\n   * applied to the event cache.\n   *\n   * Possibilities:\n   *\n   * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n   *\n   * 2. Some write is completely shadowing. No events to be raised\n   *\n   * 3. Is partially shadowed. Events\n   *\n   * Either existingEventSnap or existingServerSnap must exist\n   *\n   * @param {!Path} treePath\n   * @param {!Path} childPath\n   * @param {?Node} existingEventSnap\n   * @param {?Node} existingServerSnap\n   * @return {?Node}\n   */\n  calcEventCacheAfterServerOverwrite(\n    treePath: Path,\n    childPath: Path,\n    existingEventSnap: Node | null,\n    existingServerSnap: Node | null\n  ): Node | null {\n    assert(\n      existingEventSnap || existingServerSnap,\n      'Either existingEventSnap or existingServerSnap must exist'\n    );\n    const path = treePath.child(childPath);\n    if (this.visibleWrites_.hasCompleteWrite(path)) {\n      // At this point we can probably guarantee that we're in case 2, meaning no events\n      // May need to check visibility while doing the findRootMostValueAndPath call\n      return null;\n    } else {\n      // No complete shadowing. We're either partially shadowing or not shadowing at all.\n      const childMerge = this.visibleWrites_.childCompoundWrite(path);\n      if (childMerge.isEmpty()) {\n        // We're not shadowing at all. Case 1\n        return existingServerSnap.getChild(childPath);\n      } else {\n        // This could be more efficient if the serverNode + updates doesn't change the eventSnap\n        // However this is tricky to find out, since user updates don't necessary change the server\n        // snap, e.g. priority updates on empty nodes, or deep deletes. Another special case is if the server\n        // adds nodes, but doesn't change any existing writes. It is therefore not enough to\n        // only check if the updates change the serverNode.\n        // Maybe check if the merge tree contains these special cases and only do a full overwrite in that case?\n        return childMerge.apply(existingServerSnap.getChild(childPath));\n      }\n    }\n  }\n\n  /**\n   * Returns a complete child for a given server snap after applying all user writes or null if there is no\n   * complete child for this ChildKey.\n   *\n   * @param {!Path} treePath\n   * @param {!string} childKey\n   * @param {!CacheNode} existingServerSnap\n   * @return {?Node}\n   */\n  calcCompleteChild(\n    treePath: Path,\n    childKey: string,\n    existingServerSnap: CacheNode\n  ): Node | null {\n    const path = treePath.child(childKey);\n    const shadowingNode = this.visibleWrites_.getCompleteNode(path);\n    if (shadowingNode != null) {\n      return shadowingNode;\n    } else {\n      if (existingServerSnap.isCompleteForChild(childKey)) {\n        const childMerge = this.visibleWrites_.childCompoundWrite(path);\n        return childMerge.apply(\n          existingServerSnap.getNode().getImmediateChild(childKey)\n        );\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n   * a higher path, this will return the child of that write relative to the write and this path.\n   * Returns null if there is no write at this path.\n   *\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  shadowingWrite(path: Path): Node | null {\n    return this.visibleWrites_.getCompleteNode(path);\n  }\n\n  /**\n   * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n   * the window, but may now be in the window.\n   *\n   * @param {!Path} treePath\n   * @param {?Node} completeServerData\n   * @param {!NamedNode} startPost\n   * @param {!number} count\n   * @param {boolean} reverse\n   * @param {!Index} index\n   * @return {!Array.<!NamedNode>}\n   */\n  calcIndexedSlice(\n    treePath: Path,\n    completeServerData: Node | null,\n    startPost: NamedNode,\n    count: number,\n    reverse: boolean,\n    index: Index\n  ): NamedNode[] {\n    let toIterate: Node;\n    const merge = this.visibleWrites_.childCompoundWrite(treePath);\n    const shadowingNode = merge.getCompleteNode(Path.Empty);\n    if (shadowingNode != null) {\n      toIterate = shadowingNode;\n    } else if (completeServerData != null) {\n      toIterate = merge.apply(completeServerData);\n    } else {\n      // no children to iterate on\n      return [];\n    }\n    toIterate = toIterate.withIndex(index);\n    if (!toIterate.isEmpty() && !toIterate.isLeafNode()) {\n      const nodes = [];\n      const cmp = index.getCompare();\n      const iter = reverse\n        ? (toIterate as ChildrenNode).getReverseIteratorFrom(startPost, index)\n        : (toIterate as ChildrenNode).getIteratorFrom(startPost, index);\n      let next = iter.getNext();\n      while (next && nodes.length < count) {\n        if (cmp(next, startPost) !== 0) {\n          nodes.push(next);\n        }\n        next = iter.getNext();\n      }\n      return nodes;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * @param {!WriteRecord} writeRecord\n   * @param {!Path} path\n   * @return {boolean}\n   * @private\n   */\n  private recordContainsPath_(writeRecord: WriteRecord, path: Path): boolean {\n    if (writeRecord.snap) {\n      return writeRecord.path.contains(path);\n    } else {\n      // findKey can return undefined, so use !! to coerce to boolean\n      return !!findKey(writeRecord.children, function(\n        childSnap: Node,\n        childName: string\n      ) {\n        return writeRecord.path.child(childName).contains(path);\n      });\n    }\n  }\n\n  /**\n   * Re-layer the writes and merges into a tree so we can efficiently calculate event snapshots\n   * @private\n   */\n  private resetTree_() {\n    this.visibleWrites_ = WriteTree.layerTree_(\n      this.allWrites_,\n      WriteTree.DefaultFilter_,\n      Path.Empty\n    );\n    if (this.allWrites_.length > 0) {\n      this.lastWriteId_ = this.allWrites_[this.allWrites_.length - 1].writeId;\n    } else {\n      this.lastWriteId_ = -1;\n    }\n  }\n\n  /**\n   * The default filter used when constructing the tree. Keep everything that's visible.\n   *\n   * @param {!WriteRecord} write\n   * @return {boolean}\n   * @private\n   */\n  private static DefaultFilter_(write: WriteRecord) {\n    return write.visible;\n  }\n\n  /**\n   * Static method. Given an array of WriteRecords, a filter for which ones to include, and a path, construct the tree of\n   * event data at that path.\n   *\n   * @param {!Array.<!WriteRecord>} writes\n   * @param {!function(!WriteRecord):boolean} filter\n   * @param {!Path} treeRoot\n   * @return {!CompoundWrite}\n   * @private\n   */\n  private static layerTree_(\n    writes: WriteRecord[],\n    filter: (w: WriteRecord) => boolean,\n    treeRoot: Path\n  ): CompoundWrite {\n    let compoundWrite = CompoundWrite.Empty;\n    for (let i = 0; i < writes.length; ++i) {\n      const write = writes[i];\n      // Theory, a later set will either:\n      // a) abort a relevant transaction, so no need to worry about excluding it from calculating that transaction\n      // b) not be relevant to a transaction (separate branch), so again will not affect the data for that transaction\n      if (filter(write)) {\n        const writePath = write.path;\n        let relativePath;\n        if (write.snap) {\n          if (treeRoot.contains(writePath)) {\n            relativePath = Path.relativePath(treeRoot, writePath);\n            compoundWrite = compoundWrite.addWrite(relativePath, write.snap);\n          } else if (writePath.contains(treeRoot)) {\n            relativePath = Path.relativePath(writePath, treeRoot);\n            compoundWrite = compoundWrite.addWrite(\n              Path.Empty,\n              write.snap.getChild(relativePath)\n            );\n          } else {\n            // There is no overlap between root path and write path, ignore write\n          }\n        } else if (write.children) {\n          if (treeRoot.contains(writePath)) {\n            relativePath = Path.relativePath(treeRoot, writePath);\n            compoundWrite = compoundWrite.addWrites(\n              relativePath,\n              write.children\n            );\n          } else if (writePath.contains(treeRoot)) {\n            relativePath = Path.relativePath(writePath, treeRoot);\n            if (relativePath.isEmpty()) {\n              compoundWrite = compoundWrite.addWrites(\n                Path.Empty,\n                write.children\n              );\n            } else {\n              const child = safeGet(write.children, relativePath.getFront());\n              if (child) {\n                // There exists a child in this node that matches the root path\n                const deepNode = child.getChild(relativePath.popFront());\n                compoundWrite = compoundWrite.addWrite(Path.Empty, deepNode);\n              }\n            }\n          } else {\n            // There is no overlap between root path and write path, ignore write\n          }\n        } else {\n          throw assertionError('WriteRecord should have .snap or .children');\n        }\n      }\n    }\n    return compoundWrite;\n  }\n}\n\n/**\n * A WriteTreeRef wraps a WriteTree and a path, for convenient access to a particular subtree.  All of the methods\n * just proxy to the underlying WriteTree.\n *\n * @constructor\n */\nexport class WriteTreeRef {\n  /**\n   * The path to this particular write tree ref. Used for calling methods on writeTree_ while exposing a simpler\n   * interface to callers.\n   *\n   * @type {!Path}\n   * @private\n   * @const\n   */\n  private readonly treePath_: Path;\n\n  /**\n   * * A reference to the actual tree of write data. All methods are pass-through to the tree, but with the appropriate\n   * path prefixed.\n   *\n   * This lets us make cheap references to points in the tree for sync points without having to copy and maintain all of\n   * the data.\n   *\n   * @type {!WriteTree}\n   * @private\n   * @const\n   */\n  private readonly writeTree_: WriteTree;\n\n  /**\n   * @param {!Path} path\n   * @param {!WriteTree} writeTree\n   */\n  constructor(path: Path, writeTree: WriteTree) {\n    this.treePath_ = path;\n    this.writeTree_ = writeTree;\n  }\n\n  /**\n   * If possible, returns a complete event cache, using the underlying server data if possible. In addition, can be used\n   * to get a cache that includes hidden writes, and excludes arbitrary writes. Note that customizing the returned node\n   * can lead to a more expensive calculation.\n   *\n   * @param {?Node} completeServerCache\n   * @param {Array.<number>=} writeIdsToExclude Optional writes to exclude.\n   * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n   * @return {?Node}\n   */\n  calcCompleteEventCache(\n    completeServerCache: Node | null,\n    writeIdsToExclude?: number[],\n    includeHiddenWrites?: boolean\n  ): Node | null {\n    return this.writeTree_.calcCompleteEventCache(\n      this.treePath_,\n      completeServerCache,\n      writeIdsToExclude,\n      includeHiddenWrites\n    );\n  }\n\n  /**\n   * If possible, returns a children node containing all of the complete children we have data for. The returned data is a\n   * mix of the given server data and write data.\n   *\n   * @param {?ChildrenNode} completeServerChildren\n   * @return {!ChildrenNode}\n   */\n  calcCompleteEventChildren(\n    completeServerChildren: ChildrenNode | null\n  ): ChildrenNode {\n    return this.writeTree_.calcCompleteEventChildren(\n      this.treePath_,\n      completeServerChildren\n    ) as ChildrenNode;\n  }\n\n  /**\n   * Given that either the underlying server data has updated or the outstanding writes have updated, determine what,\n   * if anything, needs to be applied to the event cache.\n   *\n   * Possibilities:\n   *\n   * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n   *\n   * 2. Some write is completely shadowing. No events to be raised\n   *\n   * 3. Is partially shadowed. Events should be raised\n   *\n   * Either existingEventSnap or existingServerSnap must exist, this is validated via an assert\n   *\n   * @param {!Path} path\n   * @param {?Node} existingEventSnap\n   * @param {?Node} existingServerSnap\n   * @return {?Node}\n   */\n  calcEventCacheAfterServerOverwrite(\n    path: Path,\n    existingEventSnap: Node | null,\n    existingServerSnap: Node | null\n  ): Node | null {\n    return this.writeTree_.calcEventCacheAfterServerOverwrite(\n      this.treePath_,\n      path,\n      existingEventSnap,\n      existingServerSnap\n    );\n  }\n\n  /**\n   * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n   * a higher path, this will return the child of that write relative to the write and this path.\n   * Returns null if there is no write at this path.\n   *\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  shadowingWrite(path: Path): Node | null {\n    return this.writeTree_.shadowingWrite(this.treePath_.child(path));\n  }\n\n  /**\n   * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n   * the window, but may now be in the window\n   *\n   * @param {?Node} completeServerData\n   * @param {!NamedNode} startPost\n   * @param {!number} count\n   * @param {boolean} reverse\n   * @param {!Index} index\n   * @return {!Array.<!NamedNode>}\n   */\n  calcIndexedSlice(\n    completeServerData: Node | null,\n    startPost: NamedNode,\n    count: number,\n    reverse: boolean,\n    index: Index\n  ): NamedNode[] {\n    return this.writeTree_.calcIndexedSlice(\n      this.treePath_,\n      completeServerData,\n      startPost,\n      count,\n      reverse,\n      index\n    );\n  }\n\n  /**\n   * Returns a complete child for a given server snap after applying all user writes or null if there is no\n   * complete child for this ChildKey.\n   *\n   * @param {!string} childKey\n   * @param {!CacheNode} existingServerCache\n   * @return {?Node}\n   */\n  calcCompleteChild(\n    childKey: string,\n    existingServerCache: CacheNode\n  ): Node | null {\n    return this.writeTree_.calcCompleteChild(\n      this.treePath_,\n      childKey,\n      existingServerCache\n    );\n  }\n\n  /**\n   * Return a WriteTreeRef for a child.\n   *\n   * @param {string} childName\n   * @return {!WriteTreeRef}\n   */\n  child(childName: string): WriteTreeRef {\n    return new WriteTreeRef(this.treePath_.child(childName), this.writeTree_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { errorForServerCode } from './util/util';\nimport { AckUserWrite } from './operation/AckUserWrite';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { forEach, safeGet } from '@firebase/util';\nimport { ImmutableTree } from './util/ImmutableTree';\nimport { ListenComplete } from './operation/ListenComplete';\nimport { Merge } from './operation/Merge';\nimport { Operation, OperationSource } from './operation/Operation';\nimport { Overwrite } from './operation/Overwrite';\nimport { Path } from './util/Path';\nimport { SyncPoint } from './SyncPoint';\nimport { WriteTree, WriteTreeRef } from './WriteTree';\nimport { Query } from '../api/Query';\nimport { Node } from './snap/Node';\nimport { Event } from './view/Event';\nimport { EventRegistration } from './view/EventRegistration';\nimport { View } from './view/View';\n\n/**\n * @typedef {{\n *   startListening: function(\n *     !Query,\n *     ?number,\n *     function():string,\n *     function(!string, *):!Array.<!Event>\n *   ):!Array.<!Event>,\n *\n *   stopListening: function(!Query, ?number)\n * }}\n */\nexport interface ListenProvider {\n  startListening(\n    query: Query,\n    tag: number | null,\n    hashFn: () => string,\n    onComplete: (a: string, b?: any) => Event[]\n  ): Event[];\n\n  stopListening(a: Query, b: number | null): void;\n}\n\n/**\n * SyncTree is the central class for managing event callback registration, data caching, views\n * (query processing), and event generation.  There are typically two SyncTree instances for\n * each Repo, one for the normal Firebase data, and one for the .info data.\n *\n * It has a number of responsibilities, including:\n *  - Tracking all user event callbacks (registered via addEventRegistration() and removeEventRegistration()).\n *  - Applying and caching data changes for user set(), transaction(), and update() calls\n *    (applyUserOverwrite(), applyUserMerge()).\n *  - Applying and caching data changes for server data changes (applyServerOverwrite(),\n *    applyServerMerge()).\n *  - Generating user-facing events for server and user changes (all of the apply* methods\n *    return the set of events that need to be raised as a result).\n *  - Maintaining the appropriate set of server listens to ensure we are always subscribed\n *    to the correct set of paths and queries to satisfy the current set of user event\n *    callbacks (listens are started/stopped using the provided listenProvider).\n *\n * NOTE: Although SyncTree tracks event callbacks and calculates events to raise, the actual\n * events are returned to the caller rather than raised synchronously.\n *\n * @constructor\n */\nexport class SyncTree {\n  /**\n   * Tree of SyncPoints.  There's a SyncPoint at any location that has 1 or more views.\n   * @type {!ImmutableTree.<!SyncPoint>}\n   * @private\n   */\n  private syncPointTree_: ImmutableTree<SyncPoint> = ImmutableTree.Empty;\n\n  /**\n   * A tree of all pending user writes (user-initiated set()'s, transaction()'s, update()'s, etc.).\n   * @type {!WriteTree}\n   * @private\n   */\n  private pendingWriteTree_ = new WriteTree();\n\n  private tagToQueryMap_: { [k: string]: string } = {};\n  private queryToTagMap_: { [k: string]: number } = {};\n\n  /**\n   * @param {!ListenProvider} listenProvider_ Used by SyncTree to start / stop listening\n   *   to server data.\n   */\n  constructor(private listenProvider_: ListenProvider) {}\n\n  /**\n   * Apply the data changes for a user-generated set() or transaction() call.\n   *\n   * @param {!Path} path\n   * @param {!Node} newData\n   * @param {number} writeId\n   * @param {boolean=} visible\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyUserOverwrite(\n    path: Path,\n    newData: Node,\n    writeId: number,\n    visible?: boolean\n  ): Event[] {\n    // Record pending write.\n    this.pendingWriteTree_.addOverwrite(path, newData, writeId, visible);\n\n    if (!visible) {\n      return [];\n    } else {\n      return this.applyOperationToSyncPoints_(\n        new Overwrite(OperationSource.User, path, newData)\n      );\n    }\n  }\n\n  /**\n   * Apply the data from a user-generated update() call\n   *\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} changedChildren\n   * @param {!number} writeId\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyUserMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    writeId: number\n  ): Event[] {\n    // Record pending merge.\n    this.pendingWriteTree_.addMerge(path, changedChildren, writeId);\n\n    const changeTree = ImmutableTree.fromObject(changedChildren);\n\n    return this.applyOperationToSyncPoints_(\n      new Merge(OperationSource.User, path, changeTree)\n    );\n  }\n\n  /**\n   * Acknowledge a pending user write that was previously registered with applyUserOverwrite() or applyUserMerge().\n   *\n   * @param {!number} writeId\n   * @param {boolean=} revert True if the given write failed and needs to be reverted\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  ackUserWrite(writeId: number, revert: boolean = false) {\n    const write = this.pendingWriteTree_.getWrite(writeId);\n    const needToReevaluate = this.pendingWriteTree_.removeWrite(writeId);\n    if (!needToReevaluate) {\n      return [];\n    } else {\n      let affectedTree = ImmutableTree.Empty;\n      if (write.snap != null) {\n        // overwrite\n        affectedTree = affectedTree.set(Path.Empty, true);\n      } else {\n        forEach(write.children, function(pathString: string, node: Node) {\n          affectedTree = affectedTree.set(new Path(pathString), node);\n        });\n      }\n      return this.applyOperationToSyncPoints_(\n        new AckUserWrite(write.path, affectedTree, revert)\n      );\n    }\n  }\n\n  /**\n   * Apply new server data for the specified path..\n   *\n   * @param {!Path} path\n   * @param {!Node} newData\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyServerOverwrite(path: Path, newData: Node): Event[] {\n    return this.applyOperationToSyncPoints_(\n      new Overwrite(OperationSource.Server, path, newData)\n    );\n  }\n\n  /**\n   * Apply new server data to be merged in at the specified path.\n   *\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} changedChildren\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyServerMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node }\n  ): Event[] {\n    const changeTree = ImmutableTree.fromObject(changedChildren);\n\n    return this.applyOperationToSyncPoints_(\n      new Merge(OperationSource.Server, path, changeTree)\n    );\n  }\n\n  /**\n   * Apply a listen complete for a query\n   *\n   * @param {!Path} path\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyListenComplete(path: Path): Event[] {\n    return this.applyOperationToSyncPoints_(\n      new ListenComplete(OperationSource.Server, path)\n    );\n  }\n\n  /**\n   * Apply new server data for the specified tagged query.\n   *\n   * @param {!Path} path\n   * @param {!Node} snap\n   * @param {!number} tag\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyTaggedQueryOverwrite(path: Path, snap: Node, tag: number): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey != null) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const op = new Overwrite(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath,\n        snap\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // Query must have been removed already\n      return [];\n    }\n  }\n\n  /**\n   * Apply server data to be merged in for the specified tagged query.\n   *\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} changedChildren\n   * @param {!number} tag\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyTaggedQueryMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    tag: number\n  ): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const changeTree = ImmutableTree.fromObject(changedChildren);\n      const op = new Merge(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath,\n        changeTree\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // We've already removed the query. No big deal, ignore the update\n      return [];\n    }\n  }\n\n  /**\n   * Apply a listen complete for a tagged query\n   *\n   * @param {!Path} path\n   * @param {!number} tag\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  applyTaggedListenComplete(path: Path, tag: number): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const op = new ListenComplete(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // We've already removed the query. No big deal, ignore the update\n      return [];\n    }\n  }\n\n  /**\n   * Add an event callback for the specified query.\n   *\n   * @param {!Query} query\n   * @param {!EventRegistration} eventRegistration\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  addEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration\n  ): Event[] {\n    const path = query.path;\n\n    let serverCache: Node | null = null;\n    let foundAncestorDefaultView = false;\n    // Any covering writes will necessarily be at the root, so really all we need to find is the server cache.\n    // Consider optimizing this once there's a better understanding of what actual behavior will be.\n    this.syncPointTree_.foreachOnPath(path, function(pathToSyncPoint, sp) {\n      const relativePath = Path.relativePath(pathToSyncPoint, path);\n      serverCache = serverCache || sp.getCompleteServerCache(relativePath);\n      foundAncestorDefaultView =\n        foundAncestorDefaultView || sp.hasCompleteView();\n    });\n    let syncPoint = this.syncPointTree_.get(path);\n    if (!syncPoint) {\n      syncPoint = new SyncPoint();\n      this.syncPointTree_ = this.syncPointTree_.set(path, syncPoint);\n    } else {\n      foundAncestorDefaultView =\n        foundAncestorDefaultView || syncPoint.hasCompleteView();\n      serverCache = serverCache || syncPoint.getCompleteServerCache(Path.Empty);\n    }\n\n    let serverCacheComplete;\n    if (serverCache != null) {\n      serverCacheComplete = true;\n    } else {\n      serverCacheComplete = false;\n      serverCache = ChildrenNode.EMPTY_NODE;\n      const subtree = this.syncPointTree_.subtree(path);\n      subtree.foreachChild(function(childName, childSyncPoint) {\n        const completeCache = childSyncPoint.getCompleteServerCache(Path.Empty);\n        if (completeCache) {\n          serverCache = serverCache.updateImmediateChild(\n            childName,\n            completeCache\n          );\n        }\n      });\n    }\n\n    const viewAlreadyExists = syncPoint.viewExistsForQuery(query);\n    if (!viewAlreadyExists && !query.getQueryParams().loadsAllData()) {\n      // We need to track a tag for this query\n      const queryKey = SyncTree.makeQueryKey_(query);\n      assert(\n        !(queryKey in this.queryToTagMap_),\n        'View does not exist, but we have a tag'\n      );\n      const tag = SyncTree.getNextQueryTag_();\n      this.queryToTagMap_[queryKey] = tag;\n      // Coerce to string to avoid sparse arrays.\n      this.tagToQueryMap_['_' + tag] = queryKey;\n    }\n    const writesCache = this.pendingWriteTree_.childWrites(path);\n    let events = syncPoint.addEventRegistration(\n      query,\n      eventRegistration,\n      writesCache,\n      serverCache,\n      serverCacheComplete\n    );\n    if (!viewAlreadyExists && !foundAncestorDefaultView) {\n      const view /** @type !View */ = syncPoint.viewForQuery(query);\n      events = events.concat(this.setupListener_(query, view));\n    }\n    return events;\n  }\n\n  /**\n   * Remove event callback(s).\n   *\n   * If query is the default query, we'll check all queries for the specified eventRegistration.\n   * If eventRegistration is null, we'll remove all callbacks for the specified query/queries.\n   *\n   * @param {!Query} query\n   * @param {?EventRegistration} eventRegistration If null, all callbacks are removed.\n   * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return {!Array.<!Event>} Cancel events, if cancelError was provided.\n   */\n  removeEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): Event[] {\n    // Find the syncPoint first. Then deal with whether or not it has matching listeners\n    const path = query.path;\n    const maybeSyncPoint = this.syncPointTree_.get(path);\n    let cancelEvents: Event[] = [];\n    // A removal on a default query affects all queries at that location. A removal on an indexed query, even one without\n    // other query constraints, does *not* affect all queries at that location. So this check must be for 'default', and\n    // not loadsAllData().\n    if (\n      maybeSyncPoint &&\n      (query.queryIdentifier() === 'default' ||\n        maybeSyncPoint.viewExistsForQuery(query))\n    ) {\n      /**\n       * @type {{removed: !Array.<!Query>, events: !Array.<!Event>}}\n       */\n      const removedAndEvents = maybeSyncPoint.removeEventRegistration(\n        query,\n        eventRegistration,\n        cancelError\n      );\n      if (maybeSyncPoint.isEmpty()) {\n        this.syncPointTree_ = this.syncPointTree_.remove(path);\n      }\n      const removed = removedAndEvents.removed;\n      cancelEvents = removedAndEvents.events;\n      // We may have just removed one of many listeners and can short-circuit this whole process\n      // We may also not have removed a default listener, in which case all of the descendant listeners should already be\n      // properly set up.\n      //\n      // Since indexed queries can shadow if they don't have other query constraints, check for loadsAllData(), instead of\n      // queryId === 'default'\n      const removingDefault =\n        -1 !==\n        removed.findIndex(function(query) {\n          return query.getQueryParams().loadsAllData();\n        });\n      const covered = this.syncPointTree_.findOnPath(path, function(\n        relativePath,\n        parentSyncPoint\n      ) {\n        return parentSyncPoint.hasCompleteView();\n      });\n\n      if (removingDefault && !covered) {\n        const subtree = this.syncPointTree_.subtree(path);\n        // There are potentially child listeners. Determine what if any listens we need to send before executing the\n        // removal\n        if (!subtree.isEmpty()) {\n          // We need to fold over our subtree and collect the listeners to send\n          const newViews = this.collectDistinctViewsForSubTree_(subtree);\n\n          // Ok, we've collected all the listens we need. Set them up.\n          for (let i = 0; i < newViews.length; ++i) {\n            const view = newViews[i],\n              newQuery = view.getQuery();\n            const listener = this.createListenerForView_(view);\n            this.listenProvider_.startListening(\n              SyncTree.queryForListening_(newQuery),\n              this.tagForQuery_(newQuery),\n              listener.hashFn,\n              listener.onComplete\n            );\n          }\n        } else {\n          // There's nothing below us, so nothing we need to start listening on\n        }\n      }\n      // If we removed anything and we're not covered by a higher up listen, we need to stop listening on this query\n      // The above block has us covered in terms of making sure we're set up on listens lower in the tree.\n      // Also, note that if we have a cancelError, it's already been removed at the provider level.\n      if (!covered && removed.length > 0 && !cancelError) {\n        // If we removed a default, then we weren't listening on any of the other queries here. Just cancel the one\n        // default. Otherwise, we need to iterate through and cancel each individual query\n        if (removingDefault) {\n          // We don't tag default listeners\n          const defaultTag: number | null = null;\n          this.listenProvider_.stopListening(\n            SyncTree.queryForListening_(query),\n            defaultTag\n          );\n        } else {\n          removed.forEach((queryToRemove: Query) => {\n            const tagToRemove = this.queryToTagMap_[\n              SyncTree.makeQueryKey_(queryToRemove)\n            ];\n            this.listenProvider_.stopListening(\n              SyncTree.queryForListening_(queryToRemove),\n              tagToRemove\n            );\n          });\n        }\n      }\n      // Now, clear all of the tags we're tracking for the removed listens\n      this.removeTags_(removed);\n    } else {\n      // No-op, this listener must've been already removed\n    }\n    return cancelEvents;\n  }\n\n  /**\n   * Returns a complete cache, if we have one, of the data at a particular path. The location must have a listener above\n   * it, but as this is only used by transaction code, that should always be the case anyways.\n   *\n   * Note: this method will *include* hidden writes from transaction with applyLocally set to false.\n   * @param {!Path} path The path to the data we want\n   * @param {Array.<number>=} writeIdsToExclude A specific set to be excluded\n   * @return {?Node}\n   */\n  calcCompleteEventCache(\n    path: Path,\n    writeIdsToExclude?: number[]\n  ): Node | null {\n    const includeHiddenSets = true;\n    const writeTree = this.pendingWriteTree_;\n    const serverCache = this.syncPointTree_.findOnPath(path, function(\n      pathSoFar,\n      syncPoint\n    ) {\n      const relativePath = Path.relativePath(pathSoFar, path);\n      const serverCache = syncPoint.getCompleteServerCache(relativePath);\n      if (serverCache) {\n        return serverCache;\n      }\n    });\n    return writeTree.calcCompleteEventCache(\n      path,\n      serverCache,\n      writeIdsToExclude,\n      includeHiddenSets\n    );\n  }\n\n  /**\n   * This collapses multiple unfiltered views into a single view, since we only need a single\n   * listener for them.\n   *\n   * @param {!ImmutableTree.<!SyncPoint>} subtree\n   * @return {!Array.<!View>}\n   * @private\n   */\n  private collectDistinctViewsForSubTree_(\n    subtree: ImmutableTree<SyncPoint>\n  ): View[] {\n    return subtree.fold<View[]>(\n      (relativePath, maybeChildSyncPoint, childMap) => {\n        if (maybeChildSyncPoint && maybeChildSyncPoint.hasCompleteView()) {\n          const completeView = maybeChildSyncPoint.getCompleteView();\n          return [completeView];\n        } else {\n          // No complete view here, flatten any deeper listens into an array\n          let views: View[] = [];\n          if (maybeChildSyncPoint) {\n            views = maybeChildSyncPoint.getQueryViews();\n          }\n          forEach(childMap, function(key: string, childViews: View[]) {\n            views = views.concat(childViews);\n          });\n          return views;\n        }\n      }\n    );\n  }\n\n  /**\n   * @param {!Array.<!Query>} queries\n   * @private\n   */\n  private removeTags_(queries: Query[]) {\n    for (let j = 0; j < queries.length; ++j) {\n      const removedQuery = queries[j];\n      if (!removedQuery.getQueryParams().loadsAllData()) {\n        // We should have a tag for this\n        const removedQueryKey = SyncTree.makeQueryKey_(removedQuery);\n        const removedQueryTag = this.queryToTagMap_[removedQueryKey];\n        delete this.queryToTagMap_[removedQueryKey];\n        delete this.tagToQueryMap_['_' + removedQueryTag];\n      }\n    }\n  }\n\n  /**\n   * Normalizes a query to a query we send the server for listening\n   * @param {!Query} query\n   * @return {!Query} The normalized query\n   * @private\n   */\n  private static queryForListening_(query: Query): Query {\n    if (\n      query.getQueryParams().loadsAllData() &&\n      !query.getQueryParams().isDefault()\n    ) {\n      // We treat queries that load all data as default queries\n      // Cast is necessary because ref() technically returns Firebase which is actually fb.api.Firebase which inherits\n      // from Query\n      return /** @type {!Query} */ query.getRef();\n    } else {\n      return query;\n    }\n  }\n\n  /**\n   * For a given new listen, manage the de-duplication of outstanding subscriptions.\n   *\n   * @param {!Query} query\n   * @param {!View} view\n   * @return {!Array.<!Event>} This method can return events to support synchronous data sources\n   * @private\n   */\n  private setupListener_(query: Query, view: View): Event[] {\n    const path = query.path;\n    const tag = this.tagForQuery_(query);\n    const listener = this.createListenerForView_(view);\n\n    const events = this.listenProvider_.startListening(\n      SyncTree.queryForListening_(query),\n      tag,\n      listener.hashFn,\n      listener.onComplete\n    );\n\n    const subtree = this.syncPointTree_.subtree(path);\n    // The root of this subtree has our query. We're here because we definitely need to send a listen for that, but we\n    // may need to shadow other listens as well.\n    if (tag) {\n      assert(\n        !subtree.value.hasCompleteView(),\n        \"If we're adding a query, it shouldn't be shadowed\"\n      );\n    } else {\n      // Shadow everything at or below this location, this is a default listener.\n      const queriesToStop = subtree.fold<Query[]>(function(\n        relativePath,\n        maybeChildSyncPoint,\n        childMap\n      ) {\n        if (\n          !relativePath.isEmpty() &&\n          maybeChildSyncPoint &&\n          maybeChildSyncPoint.hasCompleteView()\n        ) {\n          return [maybeChildSyncPoint.getCompleteView().getQuery()];\n        } else {\n          // No default listener here, flatten any deeper queries into an array\n          let queries: Query[] = [];\n          if (maybeChildSyncPoint) {\n            queries = queries.concat(\n              maybeChildSyncPoint.getQueryViews().map(view => view.getQuery())\n            );\n          }\n          forEach(childMap, function(key: string, childQueries: Query[]) {\n            queries = queries.concat(childQueries);\n          });\n          return queries;\n        }\n      });\n      for (let i = 0; i < queriesToStop.length; ++i) {\n        const queryToStop = queriesToStop[i];\n        this.listenProvider_.stopListening(\n          SyncTree.queryForListening_(queryToStop),\n          this.tagForQuery_(queryToStop)\n        );\n      }\n    }\n    return events;\n  }\n\n  /**\n   *\n   * @param {!View} view\n   * @return {{hashFn: function(), onComplete: function(!string, *)}}\n   * @private\n   */\n  private createListenerForView_(\n    view: View\n  ): { hashFn(): string; onComplete(a: string, b?: any): Event[] } {\n    const query = view.getQuery();\n    const tag = this.tagForQuery_(query);\n\n    return {\n      hashFn: () => {\n        const cache = view.getServerCache() || ChildrenNode.EMPTY_NODE;\n        return cache.hash();\n      },\n      onComplete: (status: string): Event[] => {\n        if (status === 'ok') {\n          if (tag) {\n            return this.applyTaggedListenComplete(query.path, tag);\n          } else {\n            return this.applyListenComplete(query.path);\n          }\n        } else {\n          // If a listen failed, kill all of the listeners here, not just the one that triggered the error.\n          // Note that this may need to be scoped to just this listener if we change permissions on filtered children\n          const error = errorForServerCode(status, query);\n          return this.removeEventRegistration(\n            query,\n            /*eventRegistration*/ null,\n            error\n          );\n        }\n      }\n    };\n  }\n\n  /**\n   * Given a query, computes a \"queryKey\" suitable for use in our queryToTagMap_.\n   * @private\n   * @param {!Query} query\n   * @return {string}\n   */\n  private static makeQueryKey_(query: Query): string {\n    return query.path.toString() + '$' + query.queryIdentifier();\n  }\n\n  /**\n   * Given a queryKey (created by makeQueryKey), parse it back into a path and queryId.\n   * @private\n   * @param {!string} queryKey\n   * @return {{queryId: !string, path: !Path}}\n   */\n  private static parseQueryKey_(\n    queryKey: string\n  ): { queryId: string; path: Path } {\n    const splitIndex = queryKey.indexOf('$');\n    assert(\n      splitIndex !== -1 && splitIndex < queryKey.length - 1,\n      'Bad queryKey.'\n    );\n    return {\n      queryId: queryKey.substr(splitIndex + 1),\n      path: new Path(queryKey.substr(0, splitIndex))\n    };\n  }\n\n  /**\n   * Return the query associated with the given tag, if we have one\n   * @param {!number} tag\n   * @return {?string}\n   * @private\n   */\n  private queryKeyForTag_(tag: number): string | null {\n    return this.tagToQueryMap_['_' + tag];\n  }\n\n  /**\n   * Return the tag associated with the given query.\n   * @param {!Query} query\n   * @return {?number}\n   * @private\n   */\n  private tagForQuery_(query: Query): number | null {\n    const queryKey = SyncTree.makeQueryKey_(query);\n    return safeGet(this.queryToTagMap_, queryKey);\n  }\n\n  /**\n   * Static tracker for next query tag.\n   * @type {number}\n   * @private\n   */\n  private static nextQueryTag_ = 1;\n\n  /**\n   * Static accessor for query tags.\n   * @return {number}\n   * @private\n   */\n  private static getNextQueryTag_(): number {\n    return SyncTree.nextQueryTag_++;\n  }\n\n  /**\n   * A helper method to apply tagged operations\n   *\n   * @param {!Path} queryPath\n   * @param {!Operation} operation\n   * @return {!Array.<!Event>}\n   * @private\n   */\n  private applyTaggedOperation_(\n    queryPath: Path,\n    operation: Operation\n  ): Event[] {\n    const syncPoint = this.syncPointTree_.get(queryPath);\n    assert(syncPoint, \"Missing sync point for query tag that we're tracking\");\n    const writesCache = this.pendingWriteTree_.childWrites(queryPath);\n    return syncPoint.applyOperation(\n      operation,\n      writesCache,\n      /*serverCache=*/ null\n    );\n  }\n\n  /**\n   * A helper method that visits all descendant and ancestor SyncPoints, applying the operation.\n   *\n   * NOTES:\n   * - Descendant SyncPoints will be visited first (since we raise events depth-first).\n\n   * - We call applyOperation() on each SyncPoint passing three things:\n   *   1. A version of the Operation that has been made relative to the SyncPoint location.\n   *   2. A WriteTreeRef of any writes we have cached at the SyncPoint location.\n   *   3. A snapshot Node with cached server data, if we have it.\n\n   * - We concatenate all of the events returned by each SyncPoint and return the result.\n   *\n   * @param {!Operation} operation\n   * @return {!Array.<!Event>}\n   * @private\n   */\n  private applyOperationToSyncPoints_(operation: Operation): Event[] {\n    return this.applyOperationHelper_(\n      operation,\n      this.syncPointTree_,\n      /*serverCache=*/ null,\n      this.pendingWriteTree_.childWrites(Path.Empty)\n    );\n  }\n\n  /**\n   * Recursive helper for applyOperationToSyncPoints_\n   *\n   * @private\n   * @param {!Operation} operation\n   * @param {ImmutableTree.<!SyncPoint>} syncPointTree\n   * @param {?Node} serverCache\n   * @param {!WriteTreeRef} writesCache\n   * @return {!Array.<!Event>}\n   */\n  private applyOperationHelper_(\n    operation: Operation,\n    syncPointTree: ImmutableTree<SyncPoint>,\n    serverCache: Node | null,\n    writesCache: WriteTreeRef\n  ): Event[] {\n    if (operation.path.isEmpty()) {\n      return this.applyOperationDescendantsHelper_(\n        operation,\n        syncPointTree,\n        serverCache,\n        writesCache\n      );\n    } else {\n      const syncPoint = syncPointTree.get(Path.Empty);\n\n      // If we don't have cached server data, see if we can get it from this SyncPoint.\n      if (serverCache == null && syncPoint != null) {\n        serverCache = syncPoint.getCompleteServerCache(Path.Empty);\n      }\n\n      let events: Event[] = [];\n      const childName = operation.path.getFront();\n      const childOperation = operation.operationForChild(childName);\n      const childTree = syncPointTree.children.get(childName);\n      if (childTree && childOperation) {\n        const childServerCache = serverCache\n          ? serverCache.getImmediateChild(childName)\n          : null;\n        const childWritesCache = writesCache.child(childName);\n        events = events.concat(\n          this.applyOperationHelper_(\n            childOperation,\n            childTree,\n            childServerCache,\n            childWritesCache\n          )\n        );\n      }\n\n      if (syncPoint) {\n        events = events.concat(\n          syncPoint.applyOperation(operation, writesCache, serverCache)\n        );\n      }\n\n      return events;\n    }\n  }\n\n  /**\n   * Recursive helper for applyOperationToSyncPoints_\n   *\n   * @private\n   * @param {!Operation} operation\n   * @param {ImmutableTree.<!SyncPoint>} syncPointTree\n   * @param {?Node} serverCache\n   * @param {!WriteTreeRef} writesCache\n   * @return {!Array.<!Event>}\n   */\n  private applyOperationDescendantsHelper_(\n    operation: Operation,\n    syncPointTree: ImmutableTree<SyncPoint>,\n    serverCache: Node | null,\n    writesCache: WriteTreeRef\n  ): Event[] {\n    const syncPoint = syncPointTree.get(Path.Empty);\n\n    // If we don't have cached server data, see if we can get it from this SyncPoint.\n    if (serverCache == null && syncPoint != null) {\n      serverCache = syncPoint.getCompleteServerCache(Path.Empty);\n    }\n\n    let events: Event[] = [];\n    syncPointTree.children.inorderTraversal((childName, childTree) => {\n      const childServerCache = serverCache\n        ? serverCache.getImmediateChild(childName)\n        : null;\n      const childWritesCache = writesCache.child(childName);\n      const childOperation = operation.operationForChild(childName);\n      if (childOperation) {\n        events = events.concat(\n          this.applyOperationDescendantsHelper_(\n            childOperation,\n            childTree,\n            childServerCache,\n            childWritesCache\n          )\n        );\n      }\n    });\n\n    if (syncPoint) {\n      events = events.concat(\n        syncPoint.applyOperation(operation, writesCache, serverCache)\n      );\n    }\n\n    return events;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { Path } from './util/Path';\nimport { Node } from './snap/Node';\n\n/**\n * Mutable object which basically just stores a reference to the \"latest\" immutable snapshot.\n *\n * @constructor\n */\nexport class SnapshotHolder {\n  private rootNode_: Node = ChildrenNode.EMPTY_NODE;\n\n  getNode(path: Path): Node {\n    return this.rootNode_.getChild(path);\n  }\n\n  updateSnapshot(path: Path, newSnapshotNode: Node) {\n    this.rootNode_ = this.rootNode_.updateChild(path, newSnapshotNode);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseApp } from '@firebase/app-types';\nimport { FirebaseAuthTokenData } from '@firebase/app-types/private';\nimport { log, warn } from './util/util';\n\n/**\n * Abstraction around FirebaseApp's token fetching capabilities.\n */\nexport class AuthTokenProvider {\n  /**\n   * @param {!FirebaseApp} app_\n   */\n  constructor(private app_: FirebaseApp) {}\n\n  /**\n   * @param {boolean} forceRefresh\n   * @return {!Promise<FirebaseAuthTokenData>}\n   */\n  getToken(forceRefresh: boolean): Promise<FirebaseAuthTokenData> {\n    return this.app_['INTERNAL']['getToken'](forceRefresh).then(\n      null,\n      // .catch\n      function(error) {\n        // TODO: Need to figure out all the cases this is raised and whether\n        // this makes sense.\n        if (error && error.code === 'auth/token-not-initialized') {\n          log('Got auth/token-not-initialized error.  Treating as null token.');\n          return null;\n        } else {\n          return Promise.reject(error);\n        }\n      }\n    );\n  }\n\n  addTokenChangeListener(listener: (token: string | null) => void) {\n    // TODO: We might want to wrap the listener and call it with no args to\n    // avoid a leaky abstraction, but that makes removing the listener harder.\n    this.app_['INTERNAL']['addAuthTokenListener'](listener);\n  }\n\n  removeTokenChangeListener(listener: (token: string | null) => void) {\n    this.app_['INTERNAL']['removeAuthTokenListener'](listener);\n  }\n\n  notifyForInvalidToken() {\n    let errorMessage =\n      'Provided authentication credentials for the app named \"' +\n      this.app_.name +\n      '\" are invalid. This usually indicates your app was not ' +\n      'initialized correctly. ';\n    if ('credential' in this.app_.options) {\n      errorMessage +=\n        'Make sure the \"credential\" property provided to initializeApp() ' +\n        'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n        'project.';\n    } else if ('serviceAccount' in this.app_.options) {\n      errorMessage +=\n        'Make sure the \"serviceAccount\" property provided to initializeApp() ' +\n        'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n        'project.';\n    } else {\n      errorMessage +=\n        'Make sure the \"apiKey\" and \"databaseURL\" properties provided to ' +\n        'initializeApp() match the values provided for your app at ' +\n        'https://console.firebase.google.com/.';\n    }\n    warn(errorMessage);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { deepCopy } from '@firebase/util';\nimport { contains } from '@firebase/util';\n\n/**\n * Tracks a collection of stats.\n *\n * @constructor\n */\nexport class StatsCollection {\n  private counters_: { [k: string]: number } = {};\n\n  incrementCounter(name: string, amount: number = 1) {\n    if (!contains(this.counters_, name)) this.counters_[name] = 0;\n\n    this.counters_[name] += amount;\n  }\n\n  get() {\n    return deepCopy(this.counters_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StatsCollection } from './StatsCollection';\nimport { RepoInfo } from '../RepoInfo';\n\nexport class StatsManager {\n  private static collections_: { [k: string]: StatsCollection } = {};\n  private static reporters_: { [k: string]: any } = {};\n\n  static getCollection(repoInfo: RepoInfo): StatsCollection {\n    const hashString = repoInfo.toString();\n\n    if (!this.collections_[hashString]) {\n      this.collections_[hashString] = new StatsCollection();\n    }\n\n    return this.collections_[hashString];\n  }\n\n  static getOrCreateReporter<T>(\n    repoInfo: RepoInfo,\n    creatorFunction: () => T\n  ): T {\n    const hashString = repoInfo.toString();\n\n    if (!this.reporters_[hashString]) {\n      this.reporters_[hashString] = creatorFunction();\n    }\n\n    return this.reporters_[hashString];\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clone, forEach } from '@firebase/util';\nimport { StatsCollection } from './StatsCollection';\n\n/**\n * Returns the delta from the previous call to get stats.\n *\n * @param collection_ The collection to \"listen\" to.\n * @constructor\n */\nexport class StatsListener {\n  private last_: { [k: string]: number } | null = null;\n\n  constructor(private collection_: StatsCollection) {}\n\n  get(): { [k: string]: number } {\n    const newStats = this.collection_.get();\n\n    const delta: typeof newStats = clone(newStats);\n    if (this.last_) {\n      forEach(this.last_, (stat: string, value: number) => {\n        delta[stat] = delta[stat] - value;\n      });\n    }\n    this.last_ = newStats;\n\n    return delta;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { contains, forEach } from '@firebase/util';\nimport { setTimeoutNonBlocking } from '../util/util';\nimport { StatsListener } from './StatsListener';\nimport { StatsCollection } from './StatsCollection';\nimport { ServerActions } from '../ServerActions';\n\n// Assuming some apps may have a short amount of time on page, and a bulk of firebase operations probably\n// happen on page load, we try to report our first set of stats pretty quickly, but we wait at least 10\n// seconds to try to ensure the Firebase connection is established / settled.\nconst FIRST_STATS_MIN_TIME = 10 * 1000;\nconst FIRST_STATS_MAX_TIME = 30 * 1000;\n\n// We'll continue to report stats on average every 5 minutes.\nconst REPORT_STATS_INTERVAL = 5 * 60 * 1000;\n\n/**\n * @constructor\n */\nexport class StatsReporter {\n  private statsListener_: StatsListener;\n  private statsToReport_: { [k: string]: boolean } = {};\n\n  /**\n   * @param collection\n   * @param server_\n   */\n  constructor(collection: StatsCollection, private server_: ServerActions) {\n    this.statsListener_ = new StatsListener(collection);\n\n    const timeout =\n      FIRST_STATS_MIN_TIME +\n      (FIRST_STATS_MAX_TIME - FIRST_STATS_MIN_TIME) * Math.random();\n    setTimeoutNonBlocking(this.reportStats_.bind(this), Math.floor(timeout));\n  }\n\n  includeStat(stat: string) {\n    this.statsToReport_[stat] = true;\n  }\n\n  private reportStats_() {\n    const stats = this.statsListener_.get();\n    const reportedStats: typeof stats = {};\n    let haveStatsToReport = false;\n\n    forEach(stats, (stat: string, value: number) => {\n      if (value > 0 && contains(this.statsToReport_, stat)) {\n        reportedStats[stat] = value;\n        haveStatsToReport = true;\n      }\n    });\n\n    if (haveStatsToReport) {\n      this.server_.reportStats(reportedStats);\n    }\n\n    // queue our next run.\n    setTimeoutNonBlocking(\n      this.reportStats_.bind(this),\n      Math.floor(Math.random() * 2 * REPORT_STATS_INTERVAL)\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { log, logger, exceptionGuard } from '../util/util';\nimport { Event } from './Event';\n\n/**\n * The event queue serves a few purposes:\n * 1. It ensures we maintain event order in the face of event callbacks doing operations that result in more\n *    events being queued.\n * 2. raiseQueuedEvents() handles being called reentrantly nicely.  That is, if in the course of raising events,\n *    raiseQueuedEvents() is called again, the \"inner\" call will pick up raising events where the \"outer\" call\n *    left off, ensuring that the events are still raised synchronously and in order.\n * 3. You can use raiseEventsAtPath and raiseEventsForChangedPath to ensure only relevant previously-queued\n *    events are raised synchronously.\n *\n * NOTE: This can all go away if/when we move to async events.\n *\n * @constructor\n */\nexport class EventQueue {\n  /**\n   * @private\n   * @type {!Array.<EventList>}\n   */\n  private eventLists_: EventList[] = [];\n\n  /**\n   * Tracks recursion depth of raiseQueuedEvents_, for debugging purposes.\n   * @private\n   * @type {!number}\n   */\n  private recursionDepth_ = 0;\n\n  /**\n   * @param {!Array.<Event>} eventDataList The new events to queue.\n   */\n  queueEvents(eventDataList: Event[]) {\n    // We group events by path, storing them in a single EventList, to make it easier to skip over them quickly.\n    let currList = null;\n    for (let i = 0; i < eventDataList.length; i++) {\n      const eventData = eventDataList[i];\n      const eventPath = eventData.getPath();\n      if (currList !== null && !eventPath.equals(currList.getPath())) {\n        this.eventLists_.push(currList);\n        currList = null;\n      }\n\n      if (currList === null) {\n        currList = new EventList(eventPath);\n      }\n\n      currList.add(eventData);\n    }\n    if (currList) {\n      this.eventLists_.push(currList);\n    }\n  }\n\n  /**\n   * Queues the specified events and synchronously raises all events (including previously queued ones)\n   * for the specified path.\n   *\n   * It is assumed that the new events are all for the specified path.\n   *\n   * @param {!Path} path The path to raise events for.\n   * @param {!Array.<Event>} eventDataList The new events to raise.\n   */\n  raiseEventsAtPath(path: Path, eventDataList: Event[]) {\n    this.queueEvents(eventDataList);\n    this.raiseQueuedEventsMatchingPredicate_((eventPath: Path) =>\n      eventPath.equals(path)\n    );\n  }\n\n  /**\n   * Queues the specified events and synchronously raises all events (including previously queued ones) for\n   * locations related to the specified change path (i.e. all ancestors and descendants).\n   *\n   * It is assumed that the new events are all related (ancestor or descendant) to the specified path.\n   *\n   * @param {!Path} changedPath The path to raise events for.\n   * @param {!Array.<!Event>} eventDataList The events to raise\n   */\n  raiseEventsForChangedPath(changedPath: Path, eventDataList: Event[]) {\n    this.queueEvents(eventDataList);\n\n    this.raiseQueuedEventsMatchingPredicate_((eventPath: Path) => {\n      return eventPath.contains(changedPath) || changedPath.contains(eventPath);\n    });\n  }\n\n  /**\n   * @param {!function(!Path):boolean} predicate\n   * @private\n   */\n  private raiseQueuedEventsMatchingPredicate_(\n    predicate: (path: Path) => boolean\n  ) {\n    this.recursionDepth_++;\n\n    let sentAll = true;\n    for (let i = 0; i < this.eventLists_.length; i++) {\n      const eventList = this.eventLists_[i];\n      if (eventList) {\n        const eventPath = eventList.getPath();\n        if (predicate(eventPath)) {\n          this.eventLists_[i].raise();\n          this.eventLists_[i] = null;\n        } else {\n          sentAll = false;\n        }\n      }\n    }\n\n    if (sentAll) {\n      this.eventLists_ = [];\n    }\n\n    this.recursionDepth_--;\n  }\n}\n\n/**\n * @param {!Path} path\n * @constructor\n */\nexport class EventList {\n  /**\n   * @type {!Array.<Event>}\n   * @private\n   */\n  private events_: Event[] = [];\n\n  constructor(private readonly path_: Path) {}\n\n  /**\n   * @param {!Event} eventData\n   */\n  add(eventData: Event) {\n    this.events_.push(eventData);\n  }\n\n  /**\n   * Iterates through the list and raises each event\n   */\n  raise() {\n    for (let i = 0; i < this.events_.length; i++) {\n      const eventData = this.events_[i];\n      if (eventData !== null) {\n        this.events_[i] = null;\n        const eventFn = eventData.getEventRunner();\n        if (logger) {\n          log('event: ' + eventData.toString());\n        }\n        exceptionGuard(eventFn);\n      }\n    }\n  }\n\n  /**\n   * @return {!Path}\n   */\n  getPath(): Path {\n    return this.path_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\n\n/**\n * Base class to be used if you want to emit events. Call the constructor with\n * the set of allowed event names.\n */\nexport abstract class EventEmitter {\n  private listeners_: {\n    [eventType: string]: Array<{\n      callback(...args: any[]): void;\n      context: any;\n    }>;\n  } = {};\n\n  /**\n   * @param {!Array.<string>} allowedEvents_\n   */\n  constructor(private allowedEvents_: Array<string>) {\n    assert(\n      Array.isArray(allowedEvents_) && allowedEvents_.length > 0,\n      'Requires a non-empty array'\n    );\n  }\n\n  /**\n   * To be overridden by derived classes in order to fire an initial event when\n   * somebody subscribes for data.\n   *\n   * @param {!string} eventType\n   * @return {Array.<*>} Array of parameters to trigger initial event with.\n   */\n  abstract getInitialEvent(eventType: string): any[];\n\n  /**\n   * To be called by derived classes to trigger events.\n   * @param {!string} eventType\n   * @param {...*} var_args\n   */\n  protected trigger(eventType: string, ...var_args: any[]) {\n    if (Array.isArray(this.listeners_[eventType])) {\n      // Clone the list, since callbacks could add/remove listeners.\n      const listeners = [...this.listeners_[eventType]];\n\n      for (let i = 0; i < listeners.length; i++) {\n        listeners[i].callback.apply(listeners[i].context, var_args);\n      }\n    }\n  }\n\n  on(eventType: string, callback: (a: any) => void, context: any) {\n    this.validateEventType_(eventType);\n    this.listeners_[eventType] = this.listeners_[eventType] || [];\n    this.listeners_[eventType].push({ callback, context });\n\n    const eventData = this.getInitialEvent(eventType);\n    if (eventData) {\n      callback.apply(context, eventData);\n    }\n  }\n\n  off(eventType: string, callback: (a: any) => void, context: any) {\n    this.validateEventType_(eventType);\n    const listeners = this.listeners_[eventType] || [];\n    for (let i = 0; i < listeners.length; i++) {\n      if (\n        listeners[i].callback === callback &&\n        (!context || context === listeners[i].context)\n      ) {\n        listeners.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  private validateEventType_(eventType: string) {\n    assert(\n      this.allowedEvents_.find(function(et) {\n        return et === eventType;\n      }),\n      'Unknown event: ' + eventType\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EventEmitter } from './EventEmitter';\nimport { assert } from '@firebase/util';\n\ndeclare const document: any;\n\n/**\n * @extends {EventEmitter}\n */\nexport class VisibilityMonitor extends EventEmitter {\n  private visible_: boolean;\n\n  static getInstance() {\n    return new VisibilityMonitor();\n  }\n\n  constructor() {\n    super(['visible']);\n    let hidden: string;\n    let visibilityChange: string;\n    if (\n      typeof document !== 'undefined' &&\n      typeof document.addEventListener !== 'undefined'\n    ) {\n      if (typeof document['hidden'] !== 'undefined') {\n        // Opera 12.10 and Firefox 18 and later support\n        visibilityChange = 'visibilitychange';\n        hidden = 'hidden';\n      } else if (typeof document['mozHidden'] !== 'undefined') {\n        visibilityChange = 'mozvisibilitychange';\n        hidden = 'mozHidden';\n      } else if (typeof document['msHidden'] !== 'undefined') {\n        visibilityChange = 'msvisibilitychange';\n        hidden = 'msHidden';\n      } else if (typeof document['webkitHidden'] !== 'undefined') {\n        visibilityChange = 'webkitvisibilitychange';\n        hidden = 'webkitHidden';\n      }\n    }\n\n    // Initially, we always assume we are visible. This ensures that in browsers\n    // without page visibility support or in cases where we are never visible\n    // (e.g. chrome extension), we act as if we are visible, i.e. don't delay\n    // reconnects\n    this.visible_ = true;\n\n    if (visibilityChange) {\n      document.addEventListener(\n        visibilityChange,\n        () => {\n          const visible = !document[hidden];\n          if (visible !== this.visible_) {\n            this.visible_ = visible;\n            this.trigger('visible', visible);\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   * @param {!string} eventType\n   * @return {Array.<boolean>}\n   */\n  getInitialEvent(eventType: string): boolean[] {\n    assert(eventType === 'visible', 'Unknown event type: ' + eventType);\n    return [this.visible_];\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { EventEmitter } from './EventEmitter';\nimport { isMobileCordova } from '@firebase/util';\n\n/**\n * Monitors online state (as reported by window.online/offline events).\n *\n * The expectation is that this could have many false positives (thinks we are online\n * when we're not), but no false negatives.  So we can safely use it to determine when\n * we definitely cannot reach the internet.\n *\n * @extends {EventEmitter}\n */\nexport class OnlineMonitor extends EventEmitter {\n  private online_ = true;\n\n  static getInstance() {\n    return new OnlineMonitor();\n  }\n\n  constructor() {\n    super(['online']);\n\n    // We've had repeated complaints that Cordova apps can get stuck \"offline\", e.g.\n    // https://forum.ionicframework.com/t/firebase-connection-is-lost-and-never-come-back/43810\n    // It would seem that the 'online' event does not always fire consistently. So we disable it\n    // for Cordova.\n    if (\n      typeof window !== 'undefined' &&\n      typeof window.addEventListener !== 'undefined' &&\n      !isMobileCordova()\n    ) {\n      window.addEventListener(\n        'online',\n        () => {\n          if (!this.online_) {\n            this.online_ = true;\n            this.trigger('online', true);\n          }\n        },\n        false\n      );\n\n      window.addEventListener(\n        'offline',\n        () => {\n          if (this.online_) {\n            this.online_ = false;\n            this.trigger('online', false);\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   * @param {!string} eventType\n   * @return {Array.<boolean>}\n   */\n  getInitialEvent(eventType: string): boolean[] {\n    assert(eventType === 'online', 'Unknown event type: ' + eventType);\n    return [this.online_];\n  }\n\n  /**\n   * @return {boolean}\n   */\n  currentlyOnline(): boolean {\n    return this.online_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { exceptionGuard } from '../../core/util/util';\n\n/**\n * This class ensures the packets from the server arrive in order\n * This class takes data from the server and ensures it gets passed into the callbacks in order.\n * @constructor\n */\nexport class PacketReceiver {\n  pendingResponses: any[] = [];\n  currentResponseNum = 0;\n  closeAfterResponse = -1;\n  onClose: (() => void) | null = null;\n\n  /**\n   * @param onMessage_\n   */\n  constructor(private onMessage_: (a: Object) => void) {}\n\n  closeAfter(responseNum: number, callback: () => void) {\n    this.closeAfterResponse = responseNum;\n    this.onClose = callback;\n    if (this.closeAfterResponse < this.currentResponseNum) {\n      this.onClose();\n      this.onClose = null;\n    }\n  }\n\n  /**\n   * Each message from the server comes with a response number, and an array of data. The responseNumber\n   * allows us to ensure that we process them in the right order, since we can't be guaranteed that all\n   * browsers will respond in the same order as the requests we sent\n   * @param {number} requestNum\n   * @param {Array} data\n   */\n  handleResponse(requestNum: number, data: any[]) {\n    this.pendingResponses[requestNum] = data;\n    while (this.pendingResponses[this.currentResponseNum]) {\n      const toProcess = this.pendingResponses[this.currentResponseNum];\n      delete this.pendingResponses[this.currentResponseNum];\n      for (let i = 0; i < toProcess.length; ++i) {\n        if (toProcess[i]) {\n          exceptionGuard(() => {\n            this.onMessage_(toProcess[i]);\n          });\n        }\n      }\n      if (this.currentResponseNum === this.closeAfterResponse) {\n        if (this.onClose) {\n          this.onClose();\n          this.onClose = null;\n        }\n        break;\n      }\n      this.currentResponseNum++;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  executeWhenDOMReady,\n  isChromeExtensionContentScript,\n  isWindowsStoreApp,\n  log,\n  logWrapper,\n  LUIDGenerator,\n  splitStringBySize\n} from '../core/util/util';\nimport { CountedSet } from '../core/util/CountedSet';\nimport { StatsManager } from '../core/stats/StatsManager';\nimport { PacketReceiver } from './polling/PacketReceiver';\nimport {\n  FORGE_DOMAIN,\n  FORGE_REF,\n  LAST_SESSION_PARAM,\n  LONG_POLLING,\n  PROTOCOL_VERSION,\n  REFERER_PARAM,\n  TRANSPORT_SESSION_PARAM,\n  VERSION_PARAM\n} from './Constants';\nimport { base64Encode, stringify } from '@firebase/util';\nimport { isNodeSdk } from '@firebase/util';\nimport { Transport } from './Transport';\nimport { RepoInfo } from '../core/RepoInfo';\nimport { StatsCollection } from '../core/stats/StatsCollection';\n\n// URL query parameters associated with longpolling\nexport const FIREBASE_LONGPOLL_START_PARAM = 'start';\nexport const FIREBASE_LONGPOLL_CLOSE_COMMAND = 'close';\nexport const FIREBASE_LONGPOLL_COMMAND_CB_NAME = 'pLPCommand';\nexport const FIREBASE_LONGPOLL_DATA_CB_NAME = 'pRTLPCB';\nexport const FIREBASE_LONGPOLL_ID_PARAM = 'id';\nexport const FIREBASE_LONGPOLL_PW_PARAM = 'pw';\nexport const FIREBASE_LONGPOLL_SERIAL_PARAM = 'ser';\nexport const FIREBASE_LONGPOLL_CALLBACK_ID_PARAM = 'cb';\nexport const FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM = 'seg';\nexport const FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET = 'ts';\nexport const FIREBASE_LONGPOLL_DATA_PARAM = 'd';\nexport const FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM = 'disconn';\nexport const FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM = 'dframe';\n\n//Data size constants.\n//TODO: Perf: the maximum length actually differs from browser to browser.\n// We should check what browser we're on and set accordingly.\nconst MAX_URL_DATA_SIZE = 1870;\nconst SEG_HEADER_SIZE = 30; //ie: &seg=8299234&ts=982389123&d=\nconst MAX_PAYLOAD_SIZE = MAX_URL_DATA_SIZE - SEG_HEADER_SIZE;\n\n/**\n * Keepalive period\n * send a fresh request at minimum every 25 seconds. Opera has a maximum request\n * length of 30 seconds that we can't exceed.\n * @const\n * @type {number}\n */\nconst KEEPALIVE_REQUEST_INTERVAL = 25000;\n\n/**\n * How long to wait before aborting a long-polling connection attempt.\n * @const\n * @type {number}\n */\nconst LP_CONNECT_TIMEOUT = 30000;\n\n/**\n * This class manages a single long-polling connection.\n *\n * @constructor\n * @implements {Transport}\n */\nexport class BrowserPollConnection implements Transport {\n  bytesSent = 0;\n  bytesReceived = 0;\n  urlFn: (params: object) => string;\n  scriptTagHolder: FirebaseIFrameScriptHolder;\n  myDisconnFrame: HTMLIFrameElement;\n  curSegmentNum: number;\n  myPacketOrderer: PacketReceiver;\n  id: string;\n  password: string;\n  private log_: (...a: any[]) => void;\n  private stats_: StatsCollection;\n  private everConnected_ = false;\n  private isClosed_: boolean;\n  private connectTimeoutTimer_: number | null;\n  private onDisconnect_: ((a?: boolean) => void) | null;\n\n  /**\n   * @param {string} connId An identifier for this connection, used for logging\n   * @param {RepoInfo} repoInfo The info for the endpoint to send data to.\n   * @param {string=} transportSessionId Optional transportSessionid if we are reconnecting for an existing\n   *                                         transport session\n   * @param {string=}  lastSessionId Optional lastSessionId if the PersistentConnection has already created a\n   *                                     connection previously\n   */\n  constructor(\n    public connId: string,\n    public repoInfo: RepoInfo,\n    public transportSessionId?: string,\n    public lastSessionId?: string\n  ) {\n    this.log_ = logWrapper(connId);\n    this.stats_ = StatsManager.getCollection(repoInfo);\n    this.urlFn = (params: { [k: string]: string }) =>\n      repoInfo.connectionURL(LONG_POLLING, params);\n  }\n\n  /**\n   *\n   * @param {function(Object)} onMessage Callback when messages arrive\n   * @param {function()} onDisconnect Callback with connection lost.\n   */\n  open(onMessage: (msg: Object) => void, onDisconnect: (a?: boolean) => void) {\n    this.curSegmentNum = 0;\n    this.onDisconnect_ = onDisconnect;\n    this.myPacketOrderer = new PacketReceiver(onMessage);\n    this.isClosed_ = false;\n\n    this.connectTimeoutTimer_ = setTimeout(() => {\n      this.log_('Timed out trying to connect.');\n      // Make sure we clear the host cache\n      this.onClosed_();\n      this.connectTimeoutTimer_ = null;\n    }, Math.floor(LP_CONNECT_TIMEOUT)) as any;\n\n    // Ensure we delay the creation of the iframe until the DOM is loaded.\n    executeWhenDOMReady(() => {\n      if (this.isClosed_) return;\n\n      //Set up a callback that gets triggered once a connection is set up.\n      this.scriptTagHolder = new FirebaseIFrameScriptHolder(\n        (...args) => {\n          const [command, arg1, arg2, arg3, arg4] = args;\n          this.incrementIncomingBytes_(args);\n          if (!this.scriptTagHolder) return; // we closed the connection.\n\n          if (this.connectTimeoutTimer_) {\n            clearTimeout(this.connectTimeoutTimer_);\n            this.connectTimeoutTimer_ = null;\n          }\n          this.everConnected_ = true;\n          if (command == FIREBASE_LONGPOLL_START_PARAM) {\n            this.id = arg1;\n            this.password = arg2;\n          } else if (command === FIREBASE_LONGPOLL_CLOSE_COMMAND) {\n            // Don't clear the host cache. We got a response from the server, so we know it's reachable\n            if (arg1) {\n              // We aren't expecting any more data (other than what the server's already in the process of sending us\n              // through our already open polls), so don't send any more.\n              this.scriptTagHolder.sendNewPolls = false;\n\n              // arg1 in this case is the last response number sent by the server. We should try to receive\n              // all of the responses up to this one before closing\n              this.myPacketOrderer.closeAfter(arg1, () => {\n                this.onClosed_();\n              });\n            } else {\n              this.onClosed_();\n            }\n          } else {\n            throw new Error('Unrecognized command received: ' + command);\n          }\n        },\n        (...args) => {\n          const [pN, data] = args;\n          this.incrementIncomingBytes_(args);\n          this.myPacketOrderer.handleResponse(pN, data);\n        },\n        () => {\n          this.onClosed_();\n        },\n        this.urlFn\n      );\n\n      //Send the initial request to connect. The serial number is simply to keep the browser from pulling previous results\n      //from cache.\n      const urlParams: { [k: string]: string | number } = {};\n      urlParams[FIREBASE_LONGPOLL_START_PARAM] = 't';\n      urlParams[FIREBASE_LONGPOLL_SERIAL_PARAM] = Math.floor(\n        Math.random() * 100000000\n      );\n      if (this.scriptTagHolder.uniqueCallbackIdentifier)\n        urlParams[\n          FIREBASE_LONGPOLL_CALLBACK_ID_PARAM\n        ] = this.scriptTagHolder.uniqueCallbackIdentifier;\n      urlParams[VERSION_PARAM] = PROTOCOL_VERSION;\n      if (this.transportSessionId) {\n        urlParams[TRANSPORT_SESSION_PARAM] = this.transportSessionId;\n      }\n      if (this.lastSessionId) {\n        urlParams[LAST_SESSION_PARAM] = this.lastSessionId;\n      }\n      if (\n        !isNodeSdk() &&\n        typeof location !== 'undefined' &&\n        location.href &&\n        location.href.indexOf(FORGE_DOMAIN) !== -1\n      ) {\n        urlParams[REFERER_PARAM] = FORGE_REF;\n      }\n      const connectURL = this.urlFn(urlParams);\n      this.log_('Connecting via long-poll to ' + connectURL);\n      this.scriptTagHolder.addTag(connectURL, () => {\n        /* do nothing */\n      });\n    });\n  }\n\n  /**\n   * Call this when a handshake has completed successfully and we want to consider the connection established\n   */\n  start() {\n    this.scriptTagHolder.startLongPoll(this.id, this.password);\n    this.addDisconnectPingFrame(this.id, this.password);\n  }\n\n  private static forceAllow_: boolean;\n\n  /**\n   * Forces long polling to be considered as a potential transport\n   */\n  static forceAllow() {\n    BrowserPollConnection.forceAllow_ = true;\n  }\n\n  private static forceDisallow_: boolean;\n\n  /**\n   * Forces longpolling to not be considered as a potential transport\n   */\n  static forceDisallow() {\n    BrowserPollConnection.forceDisallow_ = true;\n  }\n\n  // Static method, use string literal so it can be accessed in a generic way\n  static isAvailable() {\n    // NOTE: In React-Native there's normally no 'document', but if you debug a React-Native app in\n    // the Chrome debugger, 'document' is defined, but document.createElement is null (2015/06/08).\n    return (\n      BrowserPollConnection.forceAllow_ ||\n      (!BrowserPollConnection.forceDisallow_ &&\n        typeof document !== 'undefined' &&\n        document.createElement != null &&\n        !isChromeExtensionContentScript() &&\n        !isWindowsStoreApp() &&\n        !isNodeSdk())\n    );\n  }\n\n  /**\n   * No-op for polling\n   */\n  markConnectionHealthy() {}\n\n  /**\n   * Stops polling and cleans up the iframe\n   * @private\n   */\n  private shutdown_() {\n    this.isClosed_ = true;\n\n    if (this.scriptTagHolder) {\n      this.scriptTagHolder.close();\n      this.scriptTagHolder = null;\n    }\n\n    //remove the disconnect frame, which will trigger an XHR call to the server to tell it we're leaving.\n    if (this.myDisconnFrame) {\n      document.body.removeChild(this.myDisconnFrame);\n      this.myDisconnFrame = null;\n    }\n\n    if (this.connectTimeoutTimer_) {\n      clearTimeout(this.connectTimeoutTimer_);\n      this.connectTimeoutTimer_ = null;\n    }\n  }\n\n  /**\n   * Triggered when this transport is closed\n   * @private\n   */\n  private onClosed_() {\n    if (!this.isClosed_) {\n      this.log_('Longpoll is closing itself');\n      this.shutdown_();\n\n      if (this.onDisconnect_) {\n        this.onDisconnect_(this.everConnected_);\n        this.onDisconnect_ = null;\n      }\n    }\n  }\n\n  /**\n   * External-facing close handler. RealTime has requested we shut down. Kill our connection and tell the server\n   * that we've left.\n   */\n  close() {\n    if (!this.isClosed_) {\n      this.log_('Longpoll is being closed.');\n      this.shutdown_();\n    }\n  }\n\n  /**\n   * Send the JSON object down to the server. It will need to be stringified, base64 encoded, and then\n   * broken into chunks (since URLs have a small maximum length).\n   * @param {!Object} data The JSON data to transmit.\n   */\n  send(data: Object) {\n    const dataStr = stringify(data);\n    this.bytesSent += dataStr.length;\n    this.stats_.incrementCounter('bytes_sent', dataStr.length);\n\n    //first, lets get the base64-encoded data\n    const base64data = base64Encode(dataStr);\n\n    //We can only fit a certain amount in each URL, so we need to split this request\n    //up into multiple pieces if it doesn't fit in one request.\n    const dataSegs = splitStringBySize(base64data, MAX_PAYLOAD_SIZE);\n\n    //Enqueue each segment for transmission. We assign each chunk a sequential ID and a total number\n    //of segments so that we can reassemble the packet on the server.\n    for (let i = 0; i < dataSegs.length; i++) {\n      this.scriptTagHolder.enqueueSegment(\n        this.curSegmentNum,\n        dataSegs.length,\n        dataSegs[i]\n      );\n      this.curSegmentNum++;\n    }\n  }\n\n  /**\n   * This is how we notify the server that we're leaving.\n   * We aren't able to send requests with DHTML on a window close event, but we can\n   * trigger XHR requests in some browsers (everything but Opera basically).\n   * @param {!string} id\n   * @param {!string} pw\n   */\n  addDisconnectPingFrame(id: string, pw: string) {\n    if (isNodeSdk()) return;\n    this.myDisconnFrame = document.createElement('iframe');\n    const urlParams: { [k: string]: string } = {};\n    urlParams[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM] = 't';\n    urlParams[FIREBASE_LONGPOLL_ID_PARAM] = id;\n    urlParams[FIREBASE_LONGPOLL_PW_PARAM] = pw;\n    this.myDisconnFrame.src = this.urlFn(urlParams);\n    this.myDisconnFrame.style.display = 'none';\n\n    document.body.appendChild(this.myDisconnFrame);\n  }\n\n  /**\n   * Used to track the bytes received by this client\n   * @param {*} args\n   * @private\n   */\n  private incrementIncomingBytes_(args: any) {\n    // TODO: This is an annoying perf hit just to track the number of incoming bytes.  Maybe it should be opt-in.\n    const bytesReceived = stringify(args).length;\n    this.bytesReceived += bytesReceived;\n    this.stats_.incrementCounter('bytes_received', bytesReceived);\n  }\n}\n\nexport interface IFrameElement extends HTMLIFrameElement {\n  doc: Document;\n}\n\n/*********************************************************************************************\n * A wrapper around an iframe that is used as a long-polling script holder.\n * @constructor\n *********************************************************************************************/\nexport class FirebaseIFrameScriptHolder {\n  //We maintain a count of all of the outstanding requests, because if we have too many active at once it can cause\n  //problems in some browsers.\n  /**\n   * @type {CountedSet.<number, number>}\n   */\n  outstandingRequests = new CountedSet<number, number>();\n\n  //A queue of the pending segments waiting for transmission to the server.\n  pendingSegs: { seg: number; ts: number; d: any }[] = [];\n\n  //A serial number. We use this for two things:\n  // 1) A way to ensure the browser doesn't cache responses to polls\n  // 2) A way to make the server aware when long-polls arrive in a different order than we started them. The\n  //    server needs to release both polls in this case or it will cause problems in Opera since Opera can only execute\n  //    JSONP code in the order it was added to the iframe.\n  currentSerial = Math.floor(Math.random() * 100000000);\n\n  // This gets set to false when we're \"closing down\" the connection (e.g. we're switching transports but there's still\n  // incoming data from the server that we're waiting for).\n  sendNewPolls = true;\n\n  uniqueCallbackIdentifier: number;\n  myIFrame: IFrameElement;\n  alive: boolean;\n  myID: string;\n  myPW: string;\n  commandCB: (command: string, ...args: any[]) => void;\n  onMessageCB: (...args: any[]) => void;\n\n  /**\n   * @param commandCB - The callback to be called when control commands are recevied from the server.\n   * @param onMessageCB - The callback to be triggered when responses arrive from the server.\n   * @param onDisconnect - The callback to be triggered when this tag holder is closed\n   * @param urlFn - A function that provides the URL of the endpoint to send data to.\n   */\n  constructor(\n    commandCB: (command: string, ...args: any[]) => void,\n    onMessageCB: (...args: any[]) => void,\n    public onDisconnect: () => void,\n    public urlFn: (a: object) => string\n  ) {\n    if (!isNodeSdk()) {\n      //Each script holder registers a couple of uniquely named callbacks with the window. These are called from the\n      //iframes where we put the long-polling script tags. We have two callbacks:\n      //   1) Command Callback - Triggered for control issues, like starting a connection.\n      //   2) Message Callback - Triggered when new data arrives.\n      this.uniqueCallbackIdentifier = LUIDGenerator();\n      (window as any)[\n        FIREBASE_LONGPOLL_COMMAND_CB_NAME + this.uniqueCallbackIdentifier\n      ] = commandCB;\n      (window as any)[\n        FIREBASE_LONGPOLL_DATA_CB_NAME + this.uniqueCallbackIdentifier\n      ] = onMessageCB;\n\n      //Create an iframe for us to add script tags to.\n      this.myIFrame = FirebaseIFrameScriptHolder.createIFrame_();\n\n      // Set the iframe's contents.\n      let script = '';\n      // if we set a javascript url, it's IE and we need to set the document domain. The javascript url is sufficient\n      // for ie9, but ie8 needs to do it again in the document itself.\n      if (\n        this.myIFrame.src &&\n        this.myIFrame.src.substr(0, 'javascript:'.length) === 'javascript:'\n      ) {\n        const currentDomain = document.domain;\n        script = '<script>document.domain=\"' + currentDomain + '\";</script>';\n      }\n      const iframeContents = '<html><body>' + script + '</body></html>';\n      try {\n        this.myIFrame.doc.open();\n        this.myIFrame.doc.write(iframeContents);\n        this.myIFrame.doc.close();\n      } catch (e) {\n        log('frame writing exception');\n        if (e.stack) {\n          log(e.stack);\n        }\n        log(e);\n      }\n    } else {\n      this.commandCB = commandCB;\n      this.onMessageCB = onMessageCB;\n    }\n  }\n\n  /**\n   * Each browser has its own funny way to handle iframes. Here we mush them all together into one object that I can\n   * actually use.\n   * @private\n   * @return {Element}\n   */\n  private static createIFrame_(): IFrameElement {\n    const iframe = document.createElement('iframe') as IFrameElement;\n    iframe.style.display = 'none';\n\n    // This is necessary in order to initialize the document inside the iframe\n    if (document.body) {\n      document.body.appendChild(iframe);\n      try {\n        // If document.domain has been modified in IE, this will throw an error, and we need to set the\n        // domain of the iframe's document manually. We can do this via a javascript: url as the src attribute\n        // Also note that we must do this *after* the iframe has been appended to the page. Otherwise it doesn't work.\n        const a = iframe.contentWindow.document;\n        if (!a) {\n          // Apologies for the log-spam, I need to do something to keep closure from optimizing out the assignment above.\n          log('No IE domain setting required');\n        }\n      } catch (e) {\n        const domain = document.domain;\n        iframe.src =\n          \"javascript:void((function(){document.open();document.domain='\" +\n          domain +\n          \"';document.close();})())\";\n      }\n    } else {\n      // LongPollConnection attempts to delay initialization until the document is ready, so hopefully this\n      // never gets hit.\n      throw 'Document body has not initialized. Wait to initialize Firebase until after the document is ready.';\n    }\n\n    // Get the document of the iframe in a browser-specific way.\n    if (iframe.contentDocument) {\n      (iframe as any).doc = iframe.contentDocument; // Firefox, Opera, Safari\n    } else if (iframe.contentWindow) {\n      (iframe as any).doc = iframe.contentWindow.document; // Internet Explorer\n    } else if ((iframe as any).document) {\n      (iframe as any).doc = (iframe as any).document; //others?\n    }\n\n    return iframe;\n  }\n\n  /**\n   * Cancel all outstanding queries and remove the frame.\n   */\n  close() {\n    //Mark this iframe as dead, so no new requests are sent.\n    this.alive = false;\n\n    if (this.myIFrame) {\n      //We have to actually remove all of the html inside this iframe before removing it from the\n      //window, or IE will continue loading and executing the script tags we've already added, which\n      //can lead to some errors being thrown. Setting innerHTML seems to be the easiest way to do this.\n      this.myIFrame.doc.body.innerHTML = '';\n      setTimeout(() => {\n        if (this.myIFrame !== null) {\n          document.body.removeChild(this.myIFrame);\n          this.myIFrame = null;\n        }\n      }, Math.floor(0));\n    }\n\n    if (isNodeSdk() && this.myID) {\n      const urlParams: { [k: string]: string } = {};\n      urlParams[FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM] = 't';\n      urlParams[FIREBASE_LONGPOLL_ID_PARAM] = this.myID;\n      urlParams[FIREBASE_LONGPOLL_PW_PARAM] = this.myPW;\n      const theURL = this.urlFn(urlParams);\n      (FirebaseIFrameScriptHolder as any).nodeRestRequest(theURL);\n    }\n\n    // Protect from being called recursively.\n    const onDisconnect = this.onDisconnect;\n    if (onDisconnect) {\n      this.onDisconnect = null;\n      onDisconnect();\n    }\n  }\n\n  /**\n   * Actually start the long-polling session by adding the first script tag(s) to the iframe.\n   * @param {!string} id - The ID of this connection\n   * @param {!string} pw - The password for this connection\n   */\n  startLongPoll(id: string, pw: string) {\n    this.myID = id;\n    this.myPW = pw;\n    this.alive = true;\n\n    //send the initial request. If there are requests queued, make sure that we transmit as many as we are currently able to.\n    while (this.newRequest_()) {}\n  }\n\n  /**\n   * This is called any time someone might want a script tag to be added. It adds a script tag when there aren't\n   * too many outstanding requests and we are still alive.\n   *\n   * If there are outstanding packet segments to send, it sends one. If there aren't, it sends a long-poll anyways if\n   * needed.\n   */\n  private newRequest_() {\n    // We keep one outstanding request open all the time to receive data, but if we need to send data\n    // (pendingSegs.length > 0) then we create a new request to send the data.  The server will automatically\n    // close the old request.\n    if (\n      this.alive &&\n      this.sendNewPolls &&\n      this.outstandingRequests.count() < (this.pendingSegs.length > 0 ? 2 : 1)\n    ) {\n      //construct our url\n      this.currentSerial++;\n      const urlParams: { [k: string]: string | number } = {};\n      urlParams[FIREBASE_LONGPOLL_ID_PARAM] = this.myID;\n      urlParams[FIREBASE_LONGPOLL_PW_PARAM] = this.myPW;\n      urlParams[FIREBASE_LONGPOLL_SERIAL_PARAM] = this.currentSerial;\n      let theURL = this.urlFn(urlParams);\n      //Now add as much data as we can.\n      let curDataString = '';\n      let i = 0;\n\n      while (this.pendingSegs.length > 0) {\n        //first, lets see if the next segment will fit.\n        const nextSeg = this.pendingSegs[0];\n        if (\n          nextSeg.d.length + SEG_HEADER_SIZE + curDataString.length <=\n          MAX_URL_DATA_SIZE\n        ) {\n          //great, the segment will fit. Lets append it.\n          const theSeg = this.pendingSegs.shift();\n          curDataString =\n            curDataString +\n            '&' +\n            FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM +\n            i +\n            '=' +\n            theSeg.seg +\n            '&' +\n            FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET +\n            i +\n            '=' +\n            theSeg.ts +\n            '&' +\n            FIREBASE_LONGPOLL_DATA_PARAM +\n            i +\n            '=' +\n            theSeg.d;\n          i++;\n        } else {\n          break;\n        }\n      }\n\n      theURL = theURL + curDataString;\n      this.addLongPollTag_(theURL, this.currentSerial);\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Queue a packet for transmission to the server.\n   * @param segnum - A sequential id for this packet segment used for reassembly\n   * @param totalsegs - The total number of segments in this packet\n   * @param data - The data for this segment.\n   */\n  enqueueSegment(segnum: number, totalsegs: number, data: any) {\n    //add this to the queue of segments to send.\n    this.pendingSegs.push({ seg: segnum, ts: totalsegs, d: data });\n\n    //send the data immediately if there isn't already data being transmitted, unless\n    //startLongPoll hasn't been called yet.\n    if (this.alive) {\n      this.newRequest_();\n    }\n  }\n\n  /**\n   * Add a script tag for a regular long-poll request.\n   * @param {!string} url - The URL of the script tag.\n   * @param {!number} serial - The serial number of the request.\n   * @private\n   */\n  private addLongPollTag_(url: string, serial: number) {\n    //remember that we sent this request.\n    this.outstandingRequests.add(serial, 1);\n\n    const doNewRequest = () => {\n      this.outstandingRequests.remove(serial);\n      this.newRequest_();\n    };\n\n    // If this request doesn't return on its own accord (by the server sending us some data), we'll\n    // create a new one after the KEEPALIVE interval to make sure we always keep a fresh request open.\n    const keepaliveTimeout = setTimeout(\n      doNewRequest,\n      Math.floor(KEEPALIVE_REQUEST_INTERVAL)\n    );\n\n    const readyStateCB = () => {\n      // Request completed.  Cancel the keepalive.\n      clearTimeout(keepaliveTimeout);\n\n      // Trigger a new request so we can continue receiving data.\n      doNewRequest();\n    };\n\n    this.addTag(url, readyStateCB);\n  }\n\n  /**\n   * Add an arbitrary script tag to the iframe.\n   * @param {!string} url - The URL for the script tag source.\n   * @param {!function()} loadCB - A callback to be triggered once the script has loaded.\n   */\n  addTag(url: string, loadCB: () => void) {\n    if (isNodeSdk()) {\n      (this as any).doNodeLongPoll(url, loadCB);\n    } else {\n      setTimeout(() => {\n        try {\n          // if we're already closed, don't add this poll\n          if (!this.sendNewPolls) return;\n          const newScript = this.myIFrame.doc.createElement('script');\n          newScript.type = 'text/javascript';\n          newScript.async = true;\n          newScript.src = url;\n          newScript.onload = (newScript as any).onreadystatechange = function() {\n            const rstate = (newScript as any).readyState;\n            if (!rstate || rstate === 'loaded' || rstate === 'complete') {\n              newScript.onload = (newScript as any).onreadystatechange = null;\n              if (newScript.parentNode) {\n                newScript.parentNode.removeChild(newScript);\n              }\n              loadCB();\n            }\n          };\n          newScript.onerror = () => {\n            log('Long-poll script failed to load: ' + url);\n            this.sendNewPolls = false;\n            this.close();\n          };\n          this.myIFrame.doc.body.appendChild(newScript);\n        } catch (e) {\n          // TODO: we should make this error visible somehow\n        }\n      }, Math.floor(1));\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RepoInfo } from '../core/RepoInfo';\n\ndeclare const MozWebSocket: any;\n\nimport firebase from '@firebase/app';\nimport { assert } from '@firebase/util';\nimport { logWrapper, splitStringBySize } from '../core/util/util';\nimport { StatsManager } from '../core/stats/StatsManager';\nimport {\n  FORGE_DOMAIN,\n  FORGE_REF,\n  LAST_SESSION_PARAM,\n  PROTOCOL_VERSION,\n  REFERER_PARAM,\n  TRANSPORT_SESSION_PARAM,\n  VERSION_PARAM,\n  WEBSOCKET\n} from './Constants';\nimport { CONSTANTS as ENV_CONSTANTS } from '@firebase/util';\nimport { PersistentStorage } from '../core/storage/storage';\nimport { jsonEval, stringify } from '@firebase/util';\nimport { isNodeSdk } from '@firebase/util';\nimport { Transport } from './Transport';\nimport { StatsCollection } from '../core/stats/StatsCollection';\n\nconst WEBSOCKET_MAX_FRAME_SIZE = 16384;\nconst WEBSOCKET_KEEPALIVE_INTERVAL = 45000;\n\nlet WebSocketImpl = null;\nif (typeof MozWebSocket !== 'undefined') {\n  WebSocketImpl = MozWebSocket;\n} else if (typeof WebSocket !== 'undefined') {\n  WebSocketImpl = WebSocket;\n}\n\nexport function setWebSocketImpl(impl) {\n  WebSocketImpl = impl;\n}\n\n/**\n * Create a new websocket connection with the given callbacks.\n * @constructor\n * @implements {Transport}\n */\nexport class WebSocketConnection implements Transport {\n  keepaliveTimer: number | null = null;\n  frames: string[] | null = null;\n  totalFrames = 0;\n  bytesSent = 0;\n  bytesReceived = 0;\n  connURL: string;\n  onDisconnect: (a?: boolean) => void;\n  onMessage: (msg: Object) => void;\n  mySock: any | null;\n  private log_: (...a: any[]) => void;\n  private stats_: StatsCollection;\n  private everConnected_: boolean;\n  private isClosed_: boolean;\n\n  /**\n   * @param {string} connId identifier for this transport\n   * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n   * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n   *                                         session\n   * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n   */\n  constructor(\n    public connId: string,\n    repoInfo: RepoInfo,\n    transportSessionId?: string,\n    lastSessionId?: string\n  ) {\n    this.log_ = logWrapper(this.connId);\n    this.stats_ = StatsManager.getCollection(repoInfo);\n    this.connURL = WebSocketConnection.connectionURL_(\n      repoInfo,\n      transportSessionId,\n      lastSessionId\n    );\n  }\n\n  /**\n   * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n   * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n   *                                         session\n   * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n   * @return {string} connection url\n   * @private\n   */\n  private static connectionURL_(\n    repoInfo: RepoInfo,\n    transportSessionId?: string,\n    lastSessionId?: string\n  ): string {\n    const urlParams: { [k: string]: string } = {};\n    urlParams[VERSION_PARAM] = PROTOCOL_VERSION;\n\n    if (\n      !isNodeSdk() &&\n      typeof location !== 'undefined' &&\n      location.href &&\n      location.href.indexOf(FORGE_DOMAIN) !== -1\n    ) {\n      urlParams[REFERER_PARAM] = FORGE_REF;\n    }\n    if (transportSessionId) {\n      urlParams[TRANSPORT_SESSION_PARAM] = transportSessionId;\n    }\n    if (lastSessionId) {\n      urlParams[LAST_SESSION_PARAM] = lastSessionId;\n    }\n    return repoInfo.connectionURL(WEBSOCKET, urlParams);\n  }\n\n  /**\n   *\n   * @param onMessage Callback when messages arrive\n   * @param onDisconnect Callback with connection lost.\n   */\n  open(onMessage: (msg: Object) => void, onDisconnect: (a?: boolean) => void) {\n    this.onDisconnect = onDisconnect;\n    this.onMessage = onMessage;\n\n    this.log_('Websocket connecting to ' + this.connURL);\n\n    this.everConnected_ = false;\n    // Assume failure until proven otherwise.\n    PersistentStorage.set('previous_websocket_failure', true);\n\n    try {\n      if (isNodeSdk()) {\n        const device = ENV_CONSTANTS.NODE_ADMIN ? 'AdminNode' : 'Node';\n        // UA Format: Firebase/<wire_protocol>/<sdk_version>/<platform>/<device>\n        const options: { [k: string]: object } = {\n          headers: {\n            'User-Agent': `Firebase/${PROTOCOL_VERSION}/${\n              firebase.SDK_VERSION\n            }/${process.platform}/${device}`\n          }\n        };\n\n        // Plumb appropriate http_proxy environment variable into faye-websocket if it exists.\n        const env = process['env'];\n        const proxy =\n          this.connURL.indexOf('wss://') == 0\n            ? env['HTTPS_PROXY'] || env['https_proxy']\n            : env['HTTP_PROXY'] || env['http_proxy'];\n\n        if (proxy) {\n          options['proxy'] = { origin: proxy };\n        }\n\n        this.mySock = new WebSocketImpl(this.connURL, [], options);\n      } else {\n        this.mySock = new WebSocketImpl(this.connURL);\n      }\n    } catch (e) {\n      this.log_('Error instantiating WebSocket.');\n      const error = e.message || e.data;\n      if (error) {\n        this.log_(error);\n      }\n      this.onClosed_();\n      return;\n    }\n\n    this.mySock.onopen = () => {\n      this.log_('Websocket connected.');\n      this.everConnected_ = true;\n    };\n\n    this.mySock.onclose = () => {\n      this.log_('Websocket connection was disconnected.');\n      this.mySock = null;\n      this.onClosed_();\n    };\n\n    this.mySock.onmessage = (m: object) => {\n      this.handleIncomingFrame(m);\n    };\n\n    this.mySock.onerror = (e: any) => {\n      this.log_('WebSocket error.  Closing connection.');\n      const error = e.message || e.data;\n      if (error) {\n        this.log_(error);\n      }\n      this.onClosed_();\n    };\n  }\n\n  /**\n   * No-op for websockets, we don't need to do anything once the connection is confirmed as open\n   */\n  start() {}\n\n  static forceDisallow_: Boolean;\n\n  static forceDisallow() {\n    WebSocketConnection.forceDisallow_ = true;\n  }\n\n  static isAvailable(): boolean {\n    let isOldAndroid = false;\n    if (typeof navigator !== 'undefined' && navigator.userAgent) {\n      const oldAndroidRegex = /Android ([0-9]{0,}\\.[0-9]{0,})/;\n      const oldAndroidMatch = navigator.userAgent.match(oldAndroidRegex);\n      if (oldAndroidMatch && oldAndroidMatch.length > 1) {\n        if (parseFloat(oldAndroidMatch[1]) < 4.4) {\n          isOldAndroid = true;\n        }\n      }\n    }\n\n    return (\n      !isOldAndroid &&\n      WebSocketImpl !== null &&\n      !WebSocketConnection.forceDisallow_\n    );\n  }\n\n  /**\n   * Number of response before we consider the connection \"healthy.\"\n   * @type {number}\n   */\n  static responsesRequiredToBeHealthy = 2;\n\n  /**\n   * Time to wait for the connection te become healthy before giving up.\n   * @type {number}\n   */\n  static healthyTimeout = 30000;\n\n  /**\n   * Returns true if we previously failed to connect with this transport.\n   * @return {boolean}\n   */\n  static previouslyFailed(): boolean {\n    // If our persistent storage is actually only in-memory storage,\n    // we default to assuming that it previously failed to be safe.\n    return (\n      PersistentStorage.isInMemoryStorage ||\n      PersistentStorage.get('previous_websocket_failure') === true\n    );\n  }\n\n  markConnectionHealthy() {\n    PersistentStorage.remove('previous_websocket_failure');\n  }\n\n  private appendFrame_(data: string) {\n    this.frames.push(data);\n    if (this.frames.length == this.totalFrames) {\n      const fullMess = this.frames.join('');\n      this.frames = null;\n      const jsonMess = jsonEval(fullMess) as object;\n\n      //handle the message\n      this.onMessage(jsonMess);\n    }\n  }\n\n  /**\n   * @param {number} frameCount The number of frames we are expecting from the server\n   * @private\n   */\n  private handleNewFrameCount_(frameCount: number) {\n    this.totalFrames = frameCount;\n    this.frames = [];\n  }\n\n  /**\n   * Attempts to parse a frame count out of some text. If it can't, assumes a value of 1\n   * @param {!String} data\n   * @return {?String} Any remaining data to be process, or null if there is none\n   * @private\n   */\n  private extractFrameCount_(data: string): string | null {\n    assert(this.frames === null, 'We already have a frame buffer');\n    // TODO: The server is only supposed to send up to 9999 frames (i.e. length <= 4), but that isn't being enforced\n    // currently.  So allowing larger frame counts (length <= 6).  See https://app.asana.com/0/search/8688598998380/8237608042508\n    if (data.length <= 6) {\n      const frameCount = Number(data);\n      if (!isNaN(frameCount)) {\n        this.handleNewFrameCount_(frameCount);\n        return null;\n      }\n    }\n    this.handleNewFrameCount_(1);\n    return data;\n  }\n\n  /**\n   * Process a websocket frame that has arrived from the server.\n   * @param mess The frame data\n   */\n  handleIncomingFrame(mess: { [k: string]: any }) {\n    if (this.mySock === null) return; // Chrome apparently delivers incoming packets even after we .close() the connection sometimes.\n    const data = mess['data'] as string;\n    this.bytesReceived += data.length;\n    this.stats_.incrementCounter('bytes_received', data.length);\n\n    this.resetKeepAlive();\n\n    if (this.frames !== null) {\n      // we're buffering\n      this.appendFrame_(data);\n    } else {\n      // try to parse out a frame count, otherwise, assume 1 and process it\n      const remainingData = this.extractFrameCount_(data);\n      if (remainingData !== null) {\n        this.appendFrame_(remainingData);\n      }\n    }\n  }\n\n  /**\n   * Send a message to the server\n   * @param {Object} data The JSON object to transmit\n   */\n  send(data: Object) {\n    this.resetKeepAlive();\n\n    const dataStr = stringify(data);\n    this.bytesSent += dataStr.length;\n    this.stats_.incrementCounter('bytes_sent', dataStr.length);\n\n    //We can only fit a certain amount in each websocket frame, so we need to split this request\n    //up into multiple pieces if it doesn't fit in one request.\n\n    const dataSegs = splitStringBySize(dataStr, WEBSOCKET_MAX_FRAME_SIZE);\n\n    //Send the length header\n    if (dataSegs.length > 1) {\n      this.sendString_(String(dataSegs.length));\n    }\n\n    //Send the actual data in segments.\n    for (let i = 0; i < dataSegs.length; i++) {\n      this.sendString_(dataSegs[i]);\n    }\n  }\n\n  private shutdown_() {\n    this.isClosed_ = true;\n    if (this.keepaliveTimer) {\n      clearInterval(this.keepaliveTimer);\n      this.keepaliveTimer = null;\n    }\n\n    if (this.mySock) {\n      this.mySock.close();\n      this.mySock = null;\n    }\n  }\n\n  private onClosed_() {\n    if (!this.isClosed_) {\n      this.log_('WebSocket is closing itself');\n      this.shutdown_();\n\n      // since this is an internal close, trigger the close listener\n      if (this.onDisconnect) {\n        this.onDisconnect(this.everConnected_);\n        this.onDisconnect = null;\n      }\n    }\n  }\n\n  /**\n   * External-facing close handler.\n   * Close the websocket and kill the connection.\n   */\n  close() {\n    if (!this.isClosed_) {\n      this.log_('WebSocket is being closed');\n      this.shutdown_();\n    }\n  }\n\n  /**\n   * Kill the current keepalive timer and start a new one, to ensure that it always fires N seconds after\n   * the last activity.\n   */\n  resetKeepAlive() {\n    clearInterval(this.keepaliveTimer);\n    this.keepaliveTimer = setInterval(() => {\n      //If there has been no websocket activity for a while, send a no-op\n      if (this.mySock) {\n        this.sendString_('0');\n      }\n      this.resetKeepAlive();\n    }, Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL)) as any;\n  }\n\n  /**\n   * Send a string over the websocket.\n   *\n   * @param {string} str String to send.\n   * @private\n   */\n  private sendString_(str: string) {\n    // Firefox seems to sometimes throw exceptions (NS_ERROR_UNEXPECTED) from websocket .send()\n    // calls for some unknown reason.  We treat these as an error and disconnect.\n    // See https://app.asana.com/0/58926111402292/68021340250410\n    try {\n      this.mySock.send(str);\n    } catch (e) {\n      this.log_(\n        'Exception thrown from WebSocket.send():',\n        e.message || e.data,\n        'Closing connection.'\n      );\n      setTimeout(this.onClosed_.bind(this), 0);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BrowserPollConnection } from './BrowserPollConnection';\nimport { WebSocketConnection } from './WebSocketConnection';\nimport { warn, each } from '../core/util/util';\nimport { TransportConstructor } from './Transport';\nimport { RepoInfo } from '../core/RepoInfo';\n\n/**\n * Currently simplistic, this class manages what transport a Connection should use at various stages of its\n * lifecycle.\n *\n * It starts with longpolling in a browser, and httppolling on node. It then upgrades to websockets if\n * they are available.\n * @constructor\n */\nexport class TransportManager {\n  private transports_: TransportConstructor[];\n\n  /**\n   * @const\n   * @type {!Array.<function(new:Transport, string, RepoInfo, string=)>}\n   */\n  static get ALL_TRANSPORTS() {\n    return [BrowserPollConnection, WebSocketConnection];\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo Metadata around the namespace we're connecting to\n   */\n  constructor(repoInfo: RepoInfo) {\n    this.initTransports_(repoInfo);\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo\n   * @private\n   */\n  private initTransports_(repoInfo: RepoInfo) {\n    const isWebSocketsAvailable: boolean =\n      WebSocketConnection && WebSocketConnection['isAvailable']();\n    let isSkipPollConnection =\n      isWebSocketsAvailable && !WebSocketConnection.previouslyFailed();\n\n    if (repoInfo.webSocketOnly) {\n      if (!isWebSocketsAvailable)\n        warn(\n          \"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\"\n        );\n\n      isSkipPollConnection = true;\n    }\n\n    if (isSkipPollConnection) {\n      this.transports_ = [WebSocketConnection];\n    } else {\n      const transports = (this.transports_ = [] as TransportConstructor[]);\n      each(\n        TransportManager.ALL_TRANSPORTS,\n        (i: number, transport: TransportConstructor) => {\n          if (transport && transport['isAvailable']()) {\n            transports.push(transport);\n          }\n        }\n      );\n    }\n  }\n\n  /**\n   * @return {function(new:Transport, !string, !RepoInfo, string=, string=)} The constructor for the\n   * initial transport to use\n   */\n  initialTransport(): TransportConstructor {\n    if (this.transports_.length > 0) {\n      return this.transports_[0];\n    } else {\n      throw new Error('No transports available');\n    }\n  }\n\n  /**\n   * @return {?function(new:Transport, function(),function(), string=)} The constructor for the next\n   * transport, or null\n   */\n  upgradeTransport(): TransportConstructor | null {\n    if (this.transports_.length > 1) {\n      return this.transports_[1];\n    } else {\n      return null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  error,\n  logWrapper,\n  requireKey,\n  setTimeoutNonBlocking,\n  warn\n} from '../core/util/util';\nimport { PersistentStorage } from '../core/storage/storage';\nimport { PROTOCOL_VERSION } from './Constants';\nimport { TransportManager } from './TransportManager';\nimport { RepoInfo } from '../core/RepoInfo';\nimport { Transport, TransportConstructor } from './Transport';\n\n// Abort upgrade attempt if it takes longer than 60s.\nconst UPGRADE_TIMEOUT = 60000;\n\n// For some transports (WebSockets), we need to \"validate\" the transport by exchanging a few requests and responses.\n// If we haven't sent enough requests within 5s, we'll start sending noop ping requests.\nconst DELAY_BEFORE_SENDING_EXTRA_REQUESTS = 5000;\n\n// If the initial data sent triggers a lot of bandwidth (i.e. it's a large put or a listen for a large amount of data)\n// then we may not be able to exchange our ping/pong requests within the healthy timeout.  So if we reach the timeout\n// but we've sent/received enough bytes, we don't cancel the connection.\nconst BYTES_SENT_HEALTHY_OVERRIDE = 10 * 1024;\nconst BYTES_RECEIVED_HEALTHY_OVERRIDE = 100 * 1024;\n\nconst enum RealtimeState {\n  CONNECTING,\n  CONNECTED,\n  DISCONNECTED\n}\n\nconst MESSAGE_TYPE = 't';\nconst MESSAGE_DATA = 'd';\nconst CONTROL_SHUTDOWN = 's';\nconst CONTROL_RESET = 'r';\nconst CONTROL_ERROR = 'e';\nconst CONTROL_PONG = 'o';\nconst SWITCH_ACK = 'a';\nconst END_TRANSMISSION = 'n';\nconst PING = 'p';\n\nconst SERVER_HELLO = 'h';\n\n/**\n * Creates a new real-time connection to the server using whichever method works\n * best in the current browser.\n *\n * @constructor\n */\nexport class Connection {\n  connectionCount = 0;\n  pendingDataMessages: any[] = [];\n  sessionId: string;\n\n  private conn_: Transport;\n  private healthyTimeout_: number;\n  private isHealthy_: boolean;\n  private log_: (...args: any[]) => void;\n  private primaryResponsesRequired_: number;\n  private rx_: Transport;\n  private secondaryConn_: Transport;\n  private secondaryResponsesRequired_: number;\n  private state_ = RealtimeState.CONNECTING;\n  private transportManager_: TransportManager;\n  private tx_: Transport;\n\n  /**\n   * @param {!string} id - an id for this connection\n   * @param {!RepoInfo} repoInfo_ - the info for the endpoint to connect to\n   * @param {function(Object)} onMessage_ - the callback to be triggered when a server-push message arrives\n   * @param {function(number, string)} onReady_ - the callback to be triggered when this connection is ready to send messages.\n   * @param {function()} onDisconnect_ - the callback to be triggered when a connection was lost\n   * @param {function(string)} onKill_ - the callback to be triggered when this connection has permanently shut down.\n   * @param {string=} lastSessionId - last session id in persistent connection. is used to clean up old session in real-time server\n   */\n  constructor(\n    public id: string,\n    private repoInfo_: RepoInfo,\n    private onMessage_: (a: Object) => void,\n    private onReady_: (a: number, b: string) => void,\n    private onDisconnect_: () => void,\n    private onKill_: (a: string) => void,\n    public lastSessionId?: string\n  ) {\n    this.log_ = logWrapper('c:' + this.id + ':');\n    this.transportManager_ = new TransportManager(repoInfo_);\n    this.log_('Connection created');\n    this.start_();\n  }\n\n  /**\n   * Starts a connection attempt\n   * @private\n   */\n  private start_() {\n    const conn = this.transportManager_.initialTransport();\n    this.conn_ = new conn(\n      this.nextTransportId_(),\n      this.repoInfo_,\n      undefined,\n      this.lastSessionId\n    );\n\n    // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n    // can consider the transport healthy.\n    this.primaryResponsesRequired_ = conn['responsesRequiredToBeHealthy'] || 0;\n\n    const onMessageReceived = this.connReceiver_(this.conn_);\n    const onConnectionLost = this.disconnReceiver_(this.conn_);\n    this.tx_ = this.conn_;\n    this.rx_ = this.conn_;\n    this.secondaryConn_ = null;\n    this.isHealthy_ = false;\n\n    /*\n     * Firefox doesn't like when code from one iframe tries to create another iframe by way of the parent frame.\n     * This can occur in the case of a redirect, i.e. we guessed wrong on what server to connect to and received a reset.\n     * Somehow, setTimeout seems to make this ok. That doesn't make sense from a security perspective, since you should\n     * still have the context of your originating frame.\n     */\n    setTimeout(() => {\n      // this.conn_ gets set to null in some of the tests. Check to make sure it still exists before using it\n      this.conn_ && this.conn_.open(onMessageReceived, onConnectionLost);\n    }, Math.floor(0));\n\n    const healthyTimeout_ms = conn['healthyTimeout'] || 0;\n    if (healthyTimeout_ms > 0) {\n      this.healthyTimeout_ = setTimeoutNonBlocking(() => {\n        this.healthyTimeout_ = null;\n        if (!this.isHealthy_) {\n          if (\n            this.conn_ &&\n            this.conn_.bytesReceived > BYTES_RECEIVED_HEALTHY_OVERRIDE\n          ) {\n            this.log_(\n              'Connection exceeded healthy timeout but has received ' +\n                this.conn_.bytesReceived +\n                ' bytes.  Marking connection healthy.'\n            );\n            this.isHealthy_ = true;\n            this.conn_.markConnectionHealthy();\n          } else if (\n            this.conn_ &&\n            this.conn_.bytesSent > BYTES_SENT_HEALTHY_OVERRIDE\n          ) {\n            this.log_(\n              'Connection exceeded healthy timeout but has sent ' +\n                this.conn_.bytesSent +\n                ' bytes.  Leaving connection alive.'\n            );\n            // NOTE: We don't want to mark it healthy, since we have no guarantee that the bytes have made it to\n            // the server.\n          } else {\n            this.log_('Closing unhealthy connection after timeout.');\n            this.close();\n          }\n        }\n      }, Math.floor(healthyTimeout_ms)) as any;\n    }\n  }\n\n  /**\n   * @return {!string}\n   * @private\n   */\n  private nextTransportId_(): string {\n    return 'c:' + this.id + ':' + this.connectionCount++;\n  }\n\n  private disconnReceiver_(conn) {\n    return everConnected => {\n      if (conn === this.conn_) {\n        this.onConnectionLost_(everConnected);\n      } else if (conn === this.secondaryConn_) {\n        this.log_('Secondary connection lost.');\n        this.onSecondaryConnectionLost_();\n      } else {\n        this.log_('closing an old connection');\n      }\n    };\n  }\n\n  private connReceiver_(conn: Transport) {\n    return (message: object) => {\n      if (this.state_ != RealtimeState.DISCONNECTED) {\n        if (conn === this.rx_) {\n          this.onPrimaryMessageReceived_(message);\n        } else if (conn === this.secondaryConn_) {\n          this.onSecondaryMessageReceived_(message);\n        } else {\n          this.log_('message on old connection');\n        }\n      }\n    };\n  }\n\n  /**\n   *\n   * @param {Object} dataMsg An arbitrary data message to be sent to the server\n   */\n  sendRequest(dataMsg: object) {\n    // wrap in a data message envelope and send it on\n    const msg = { t: 'd', d: dataMsg };\n    this.sendData_(msg);\n  }\n\n  tryCleanupConnection() {\n    if (this.tx_ === this.secondaryConn_ && this.rx_ === this.secondaryConn_) {\n      this.log_(\n        'cleaning up and promoting a connection: ' + this.secondaryConn_.connId\n      );\n      this.conn_ = this.secondaryConn_;\n      this.secondaryConn_ = null;\n      // the server will shutdown the old connection\n    }\n  }\n\n  private onSecondaryControl_(controlData: { [k: string]: any }) {\n    if (MESSAGE_TYPE in controlData) {\n      const cmd = controlData[MESSAGE_TYPE] as string;\n      if (cmd === SWITCH_ACK) {\n        this.upgradeIfSecondaryHealthy_();\n      } else if (cmd === CONTROL_RESET) {\n        // Most likely the session wasn't valid. Abandon the switch attempt\n        this.log_('Got a reset on secondary, closing it');\n        this.secondaryConn_.close();\n        // If we were already using this connection for something, than we need to fully close\n        if (\n          this.tx_ === this.secondaryConn_ ||\n          this.rx_ === this.secondaryConn_\n        ) {\n          this.close();\n        }\n      } else if (cmd === CONTROL_PONG) {\n        this.log_('got pong on secondary.');\n        this.secondaryResponsesRequired_--;\n        this.upgradeIfSecondaryHealthy_();\n      }\n    }\n  }\n\n  private onSecondaryMessageReceived_(parsedData: object) {\n    const layer: string = requireKey('t', parsedData);\n    const data: any = requireKey('d', parsedData);\n    if (layer == 'c') {\n      this.onSecondaryControl_(data);\n    } else if (layer == 'd') {\n      // got a data message, but we're still second connection. Need to buffer it up\n      this.pendingDataMessages.push(data);\n    } else {\n      throw new Error('Unknown protocol layer: ' + layer);\n    }\n  }\n\n  private upgradeIfSecondaryHealthy_() {\n    if (this.secondaryResponsesRequired_ <= 0) {\n      this.log_('Secondary connection is healthy.');\n      this.isHealthy_ = true;\n      this.secondaryConn_.markConnectionHealthy();\n      this.proceedWithUpgrade_();\n    } else {\n      // Send a ping to make sure the connection is healthy.\n      this.log_('sending ping on secondary.');\n      this.secondaryConn_.send({ t: 'c', d: { t: PING, d: {} } });\n    }\n  }\n\n  private proceedWithUpgrade_() {\n    // tell this connection to consider itself open\n    this.secondaryConn_.start();\n    // send ack\n    this.log_('sending client ack on secondary');\n    this.secondaryConn_.send({ t: 'c', d: { t: SWITCH_ACK, d: {} } });\n\n    // send end packet on primary transport, switch to sending on this one\n    // can receive on this one, buffer responses until end received on primary transport\n    this.log_('Ending transmission on primary');\n    this.conn_.send({ t: 'c', d: { t: END_TRANSMISSION, d: {} } });\n    this.tx_ = this.secondaryConn_;\n\n    this.tryCleanupConnection();\n  }\n\n  private onPrimaryMessageReceived_(parsedData: { [k: string]: any }) {\n    // Must refer to parsedData properties in quotes, so closure doesn't touch them.\n    const layer: string = requireKey('t', parsedData);\n    const data: any = requireKey('d', parsedData);\n    if (layer == 'c') {\n      this.onControl_(data);\n    } else if (layer == 'd') {\n      this.onDataMessage_(data);\n    }\n  }\n\n  private onDataMessage_(message: any) {\n    this.onPrimaryResponse_();\n\n    // We don't do anything with data messages, just kick them up a level\n    this.onMessage_(message);\n  }\n\n  private onPrimaryResponse_() {\n    if (!this.isHealthy_) {\n      this.primaryResponsesRequired_--;\n      if (this.primaryResponsesRequired_ <= 0) {\n        this.log_('Primary connection is healthy.');\n        this.isHealthy_ = true;\n        this.conn_.markConnectionHealthy();\n      }\n    }\n  }\n\n  private onControl_(controlData: { [k: string]: any }) {\n    const cmd: string = requireKey(MESSAGE_TYPE, controlData);\n    if (MESSAGE_DATA in controlData) {\n      const payload = controlData[MESSAGE_DATA];\n      if (cmd === SERVER_HELLO) {\n        this.onHandshake_(payload);\n      } else if (cmd === END_TRANSMISSION) {\n        this.log_('recvd end transmission on primary');\n        this.rx_ = this.secondaryConn_;\n        for (let i = 0; i < this.pendingDataMessages.length; ++i) {\n          this.onDataMessage_(this.pendingDataMessages[i]);\n        }\n        this.pendingDataMessages = [];\n        this.tryCleanupConnection();\n      } else if (cmd === CONTROL_SHUTDOWN) {\n        // This was previously the 'onKill' callback passed to the lower-level connection\n        // payload in this case is the reason for the shutdown. Generally a human-readable error\n        this.onConnectionShutdown_(payload);\n      } else if (cmd === CONTROL_RESET) {\n        // payload in this case is the host we should contact\n        this.onReset_(payload);\n      } else if (cmd === CONTROL_ERROR) {\n        error('Server Error: ' + payload);\n      } else if (cmd === CONTROL_PONG) {\n        this.log_('got pong on primary.');\n        this.onPrimaryResponse_();\n        this.sendPingOnPrimaryIfNecessary_();\n      } else {\n        error('Unknown control packet command: ' + cmd);\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {Object} handshake The handshake data returned from the server\n   * @private\n   */\n  private onHandshake_(handshake: {\n    ts: number;\n    v: string;\n    h: string;\n    s: string;\n  }) {\n    const timestamp = handshake.ts;\n    const version = handshake.v;\n    const host = handshake.h;\n    this.sessionId = handshake.s;\n    this.repoInfo_.updateHost(host);\n    // if we've already closed the connection, then don't bother trying to progress further\n    if (this.state_ == RealtimeState.CONNECTING) {\n      this.conn_.start();\n      this.onConnectionEstablished_(this.conn_, timestamp);\n      if (PROTOCOL_VERSION !== version) {\n        warn('Protocol version mismatch detected');\n      }\n      // TODO: do we want to upgrade? when? maybe a delay?\n      this.tryStartUpgrade_();\n    }\n  }\n\n  private tryStartUpgrade_() {\n    const conn = this.transportManager_.upgradeTransport();\n    if (conn) {\n      this.startUpgrade_(conn);\n    }\n  }\n\n  private startUpgrade_(conn: TransportConstructor) {\n    this.secondaryConn_ = new conn(\n      this.nextTransportId_(),\n      this.repoInfo_,\n      this.sessionId\n    );\n    // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n    // can consider the transport healthy.\n    this.secondaryResponsesRequired_ =\n      conn['responsesRequiredToBeHealthy'] || 0;\n\n    const onMessage = this.connReceiver_(this.secondaryConn_);\n    const onDisconnect = this.disconnReceiver_(this.secondaryConn_);\n    this.secondaryConn_.open(onMessage, onDisconnect);\n\n    // If we haven't successfully upgraded after UPGRADE_TIMEOUT, give up and kill the secondary.\n    setTimeoutNonBlocking(() => {\n      if (this.secondaryConn_) {\n        this.log_('Timed out trying to upgrade.');\n        this.secondaryConn_.close();\n      }\n    }, Math.floor(UPGRADE_TIMEOUT));\n  }\n\n  private onReset_(host: string) {\n    this.log_('Reset packet received.  New host: ' + host);\n    this.repoInfo_.updateHost(host);\n    // TODO: if we're already \"connected\", we need to trigger a disconnect at the next layer up.\n    // We don't currently support resets after the connection has already been established\n    if (this.state_ === RealtimeState.CONNECTED) {\n      this.close();\n    } else {\n      // Close whatever connections we have open and start again.\n      this.closeConnections_();\n      this.start_();\n    }\n  }\n\n  private onConnectionEstablished_(conn: Transport, timestamp: number) {\n    this.log_('Realtime connection established.');\n    this.conn_ = conn;\n    this.state_ = RealtimeState.CONNECTED;\n\n    if (this.onReady_) {\n      this.onReady_(timestamp, this.sessionId);\n      this.onReady_ = null;\n    }\n\n    // If after 5 seconds we haven't sent enough requests to the server to get the connection healthy,\n    // send some pings.\n    if (this.primaryResponsesRequired_ === 0) {\n      this.log_('Primary connection is healthy.');\n      this.isHealthy_ = true;\n    } else {\n      setTimeoutNonBlocking(() => {\n        this.sendPingOnPrimaryIfNecessary_();\n      }, Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS));\n    }\n  }\n\n  private sendPingOnPrimaryIfNecessary_() {\n    // If the connection isn't considered healthy yet, we'll send a noop ping packet request.\n    if (!this.isHealthy_ && this.state_ === RealtimeState.CONNECTED) {\n      this.log_('sending ping on primary.');\n      this.sendData_({ t: 'c', d: { t: PING, d: {} } });\n    }\n  }\n\n  private onSecondaryConnectionLost_() {\n    const conn = this.secondaryConn_;\n    this.secondaryConn_ = null;\n    if (this.tx_ === conn || this.rx_ === conn) {\n      // we are relying on this connection already in some capacity. Therefore, a failure is real\n      this.close();\n    }\n  }\n\n  /**\n   *\n   * @param {boolean} everConnected Whether or not the connection ever reached a server. Used to determine if\n   * we should flush the host cache\n   * @private\n   */\n  private onConnectionLost_(everConnected: boolean) {\n    this.conn_ = null;\n\n    // NOTE: IF you're seeing a Firefox error for this line, I think it might be because it's getting\n    // called on window close and RealtimeState.CONNECTING is no longer defined.  Just a guess.\n    if (!everConnected && this.state_ === RealtimeState.CONNECTING) {\n      this.log_('Realtime connection failed.');\n      // Since we failed to connect at all, clear any cached entry for this namespace in case the machine went away\n      if (this.repoInfo_.isCacheableHost()) {\n        PersistentStorage.remove('host:' + this.repoInfo_.host);\n        // reset the internal host to what we would show the user, i.e. <ns>.firebaseio.com\n        this.repoInfo_.internalHost = this.repoInfo_.host;\n      }\n    } else if (this.state_ === RealtimeState.CONNECTED) {\n      this.log_('Realtime connection lost.');\n    }\n\n    this.close();\n  }\n\n  /**\n   *\n   * @param {string} reason\n   * @private\n   */\n  private onConnectionShutdown_(reason: string) {\n    this.log_('Connection shutdown command received. Shutting down...');\n\n    if (this.onKill_) {\n      this.onKill_(reason);\n      this.onKill_ = null;\n    }\n\n    // We intentionally don't want to fire onDisconnect (kill is a different case),\n    // so clear the callback.\n    this.onDisconnect_ = null;\n\n    this.close();\n  }\n\n  private sendData_(data: object) {\n    if (this.state_ !== RealtimeState.CONNECTED) {\n      throw 'Connection is not connected';\n    } else {\n      this.tx_.send(data);\n    }\n  }\n\n  /**\n   * Cleans up this connection, calling the appropriate callbacks\n   */\n  close() {\n    if (this.state_ !== RealtimeState.DISCONNECTED) {\n      this.log_('Closing realtime connection.');\n      this.state_ = RealtimeState.DISCONNECTED;\n\n      this.closeConnections_();\n\n      if (this.onDisconnect_) {\n        this.onDisconnect_();\n        this.onDisconnect_ = null;\n      }\n    }\n  }\n\n  /**\n   *\n   * @private\n   */\n  private closeConnections_() {\n    this.log_('Shutting down all connections');\n    if (this.conn_) {\n      this.conn_.close();\n      this.conn_ = null;\n    }\n\n    if (this.secondaryConn_) {\n      this.secondaryConn_.close();\n      this.secondaryConn_ = null;\n    }\n\n    if (this.healthyTimeout_) {\n      clearTimeout(this.healthyTimeout_);\n      this.healthyTimeout_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Query } from '../api/Query';\n\n/**\n * Interface defining the set of actions that can be performed against the Firebase server\n * (basically corresponds to our wire protocol).\n *\n * @interface\n */\nexport abstract class ServerActions {\n  /**\n   * @param {!Query} query\n   * @param {function():string} currentHashFn\n   * @param {?number} tag\n   * @param {function(string, *)} onComplete\n   */\n  abstract listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ): void;\n\n  /**\n   * Remove a listen.\n   *\n   * @param {!Query} query\n   * @param {?number} tag\n   */\n  abstract unlisten(query: Query, tag: number | null): void;\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   * @param {string=} hash\n   */\n  put(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void,\n    hash?: string\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, ?string)} onComplete\n   * @param {string=} hash\n   */\n  merge(\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {}\n\n  /**\n   * Refreshes the auth token for the current connection.\n   * @param {string} token The authentication token\n   */\n  refreshAuthToken(token: string) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectPut(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectMerge(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectCancel(\n    pathString: string,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {Object.<string, *>} stats\n   */\n  reportStats(stats: { [k: string]: any }) {}\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from '@firebase/app';\nimport { forEach, contains, isEmpty, getCount, safeGet } from '@firebase/util';\nimport { stringify } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { error, log, logWrapper, warn, ObjectToUniqueKey } from './util/util';\nimport { Path } from './util/Path';\nimport { VisibilityMonitor } from './util/VisibilityMonitor';\nimport { OnlineMonitor } from './util/OnlineMonitor';\nimport { isAdmin, isValidFormat } from '@firebase/util';\nimport { Connection } from '../realtime/Connection';\nimport { CONSTANTS } from '@firebase/util';\nimport { isMobileCordova, isReactNative, isNodeSdk } from '@firebase/util';\nimport { ServerActions } from './ServerActions';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { RepoInfo } from './RepoInfo';\nimport { Query } from '../api/Query';\n\nconst RECONNECT_MIN_DELAY = 1000;\nconst RECONNECT_MAX_DELAY_DEFAULT = 60 * 5 * 1000; // 5 minutes in milliseconds (Case: 1858)\nconst RECONNECT_MAX_DELAY_FOR_ADMINS = 30 * 1000; // 30 seconds for admin clients (likely to be a backend server)\nconst RECONNECT_DELAY_MULTIPLIER = 1.3;\nconst RECONNECT_DELAY_RESET_TIMEOUT = 30000; // Reset delay back to MIN_DELAY after being connected for 30sec.\nconst SERVER_KILL_INTERRUPT_REASON = 'server_kill';\n\n// If auth fails repeatedly, we'll assume something is wrong and log a warning / back off.\nconst INVALID_AUTH_TOKEN_THRESHOLD = 3;\n\ninterface ListenSpec {\n  onComplete(s: string, p?: any): void;\n\n  hashFn(): string;\n\n  query: Query;\n  tag: number | null;\n}\n\ninterface OnDisconnectRequest {\n  pathString: string;\n  action: string;\n  data: any;\n  onComplete?: (a: string, b: string) => void;\n}\n\ninterface OutstandingPut {\n  action: string;\n  request: Object;\n  queued?: boolean;\n  onComplete: (a: string, b?: string) => void;\n}\n\n/**\n * Firebase connection.  Abstracts wire protocol and handles reconnecting.\n *\n * NOTE: All JSON objects sent to the realtime connection must have property names enclosed\n * in quotes to make sure the closure compiler does not minify them.\n */\nexport class PersistentConnection extends ServerActions {\n  // Used for diagnostic logging.\n  id = PersistentConnection.nextPersistentConnectionId_++;\n  private log_ = logWrapper('p:' + this.id + ':');\n\n  /** @private {Object} */\n  private interruptReasons_: { [reason: string]: boolean } = {};\n  private listens_: { [path: string]: { [queryId: string]: ListenSpec } } = {};\n  private outstandingPuts_: OutstandingPut[] = [];\n  private outstandingPutCount_ = 0;\n  private onDisconnectRequestQueue_: OnDisconnectRequest[] = [];\n  private connected_ = false;\n  private reconnectDelay_ = RECONNECT_MIN_DELAY;\n  private maxReconnectDelay_ = RECONNECT_MAX_DELAY_DEFAULT;\n  private securityDebugCallback_: ((a: Object) => void) | null = null;\n  lastSessionId: string | null = null;\n\n  /** @private {number|null} */\n  private establishConnectionTimer_: number | null = null;\n\n  /** @private {boolean} */\n  private visible_: boolean = false;\n\n  // Before we get connected, we keep a queue of pending messages to send.\n  private requestCBHash_: { [k: number]: (a: any) => void } = {};\n  private requestNumber_ = 0;\n\n  /** @private {?{\n   *   sendRequest(Object),\n   *   close()\n   * }} */\n  private realtime_: {\n    sendRequest(a: Object): void;\n    close(): void;\n  } | null = null;\n\n  /** @private {string|null} */\n  private authToken_: string | null = null;\n  private forceTokenRefresh_ = false;\n  private invalidAuthTokenCount_ = 0;\n\n  private firstConnection_ = true;\n  private lastConnectionAttemptTime_: number | null = null;\n  private lastConnectionEstablishedTime_: number | null = null;\n\n  /**\n   * @private\n   */\n  private static nextPersistentConnectionId_ = 0;\n\n  /**\n   * Counter for number of connections created. Mainly used for tagging in the logs\n   * @type {number}\n   * @private\n   */\n  private static nextConnectionId_ = 0;\n\n  /**\n   * @implements {ServerActions}\n   * @param {!RepoInfo} repoInfo_ Data about the namespace we are connecting to\n   * @param {function(string, *, boolean, ?number)} onDataUpdate_ A callback for new data from the server\n   * @param onConnectStatus_\n   * @param onServerInfoUpdate_\n   * @param authTokenProvider_\n   * @param authOverride_\n   */\n  constructor(\n    private repoInfo_: RepoInfo,\n    private onDataUpdate_: (\n      a: string,\n      b: any,\n      c: boolean,\n      d: number | null\n    ) => void,\n    private onConnectStatus_: (a: boolean) => void,\n    private onServerInfoUpdate_: (a: any) => void,\n    private authTokenProvider_: AuthTokenProvider,\n    private authOverride_?: Object | null\n  ) {\n    super();\n\n    if (authOverride_ && !isNodeSdk()) {\n      throw new Error(\n        'Auth override specified in options, but not supported on non Node.js platforms'\n      );\n    }\n    this.scheduleConnect_(0);\n\n    VisibilityMonitor.getInstance().on('visible', this.onVisible_, this);\n\n    if (repoInfo_.host.indexOf('fblocal') === -1) {\n      OnlineMonitor.getInstance().on('online', this.onOnline_, this);\n    }\n  }\n\n  /**\n   * @param {!string} action\n   * @param {*} body\n   * @param {function(*)=} onResponse\n   * @protected\n   */\n  protected sendRequest(\n    action: string,\n    body: any,\n    onResponse?: (a: any) => void\n  ) {\n    const curReqNum = ++this.requestNumber_;\n\n    const msg = { r: curReqNum, a: action, b: body };\n    this.log_(stringify(msg));\n    assert(\n      this.connected_,\n      \"sendRequest call when we're not connected not allowed.\"\n    );\n    this.realtime_.sendRequest(msg);\n    if (onResponse) {\n      this.requestCBHash_[curReqNum] = onResponse;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ) {\n    const queryId = query.queryIdentifier();\n    const pathString = query.path.toString();\n    this.log_('Listen called for ' + pathString + ' ' + queryId);\n    this.listens_[pathString] = this.listens_[pathString] || {};\n    assert(\n      query.getQueryParams().isDefault() ||\n        !query.getQueryParams().loadsAllData(),\n      'listen() called for non-default but complete query'\n    );\n    assert(\n      !this.listens_[pathString][queryId],\n      'listen() called twice for same path/queryId.'\n    );\n    const listenSpec: ListenSpec = {\n      onComplete: onComplete,\n      hashFn: currentHashFn,\n      query: query,\n      tag: tag\n    };\n    this.listens_[pathString][queryId] = listenSpec;\n\n    if (this.connected_) {\n      this.sendListen_(listenSpec);\n    }\n  }\n\n  /**\n   * @param {!{onComplete(),\n   *           hashFn():!string,\n   *           query: !Query,\n   *           tag: ?number}} listenSpec\n   * @private\n   */\n  private sendListen_(listenSpec: ListenSpec) {\n    const query = listenSpec.query;\n    const pathString = query.path.toString();\n    const queryId = query.queryIdentifier();\n    this.log_('Listen on ' + pathString + ' for ' + queryId);\n    const req: { [k: string]: any } = { /*path*/ p: pathString };\n\n    const action = 'q';\n\n    // Only bother to send query if it's non-default.\n    if (listenSpec.tag) {\n      req['q'] = query.queryObject();\n      req['t'] = listenSpec.tag;\n    }\n\n    req[/*hash*/ 'h'] = listenSpec.hashFn();\n\n    this.sendRequest(action, req, (message: { [k: string]: any }) => {\n      const payload: any = message[/*data*/ 'd'];\n      const status: string = message[/*status*/ 's'];\n\n      // print warnings in any case...\n      PersistentConnection.warnOnListenWarnings_(payload, query);\n\n      const currentListenSpec =\n        this.listens_[pathString] && this.listens_[pathString][queryId];\n      // only trigger actions if the listen hasn't been removed and readded\n      if (currentListenSpec === listenSpec) {\n        this.log_('listen response', message);\n\n        if (status !== 'ok') {\n          this.removeListen_(pathString, queryId);\n        }\n\n        if (listenSpec.onComplete) {\n          listenSpec.onComplete(status, payload);\n        }\n      }\n    });\n  }\n\n  /**\n   * @param {*} payload\n   * @param {!Query} query\n   * @private\n   */\n  private static warnOnListenWarnings_(payload: any, query: Query) {\n    if (payload && typeof payload === 'object' && contains(payload, 'w')) {\n      const warnings = safeGet(payload, 'w');\n      if (Array.isArray(warnings) && ~warnings.indexOf('no_index')) {\n        const indexSpec =\n          '\".indexOn\": \"' +\n          query\n            .getQueryParams()\n            .getIndex()\n            .toString() +\n          '\"';\n        const indexPath = query.path.toString();\n        warn(\n          `Using an unspecified index. Your data will be downloaded and ` +\n            `filtered on the client. Consider adding ${indexSpec} at ` +\n            `${indexPath} to your security rules for better performance.`\n        );\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  refreshAuthToken(token: string) {\n    this.authToken_ = token;\n    this.log_('Auth token refreshed');\n    if (this.authToken_) {\n      this.tryAuth();\n    } else {\n      //If we're connected we want to let the server know to unauthenticate us. If we're not connected, simply delete\n      //the credential so we dont become authenticated next time we connect.\n      if (this.connected_) {\n        this.sendRequest('unauth', {}, () => {});\n      }\n    }\n\n    this.reduceReconnectDelayIfAdminCredential_(token);\n  }\n\n  /**\n   * @param {!string} credential\n   * @private\n   */\n  private reduceReconnectDelayIfAdminCredential_(credential: string) {\n    // NOTE: This isn't intended to be bulletproof (a malicious developer can always just modify the client).\n    // Additionally, we don't bother resetting the max delay back to the default if auth fails / expires.\n    const isFirebaseSecret = credential && credential.length === 40;\n    if (isFirebaseSecret || isAdmin(credential)) {\n      this.log_(\n        'Admin auth credential detected.  Reducing max reconnect time.'\n      );\n      this.maxReconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n    }\n  }\n\n  /**\n   * Attempts to authenticate with the given credentials. If the authentication attempt fails, it's triggered like\n   * a auth revoked (the connection is closed).\n   */\n  tryAuth() {\n    if (this.connected_ && this.authToken_) {\n      const token = this.authToken_;\n      const authMethod = isValidFormat(token) ? 'auth' : 'gauth';\n      const requestData: { [k: string]: any } = { cred: token };\n      if (this.authOverride_ === null) {\n        requestData['noauth'] = true;\n      } else if (typeof this.authOverride_ === 'object') {\n        requestData['authvar'] = this.authOverride_;\n      }\n      this.sendRequest(authMethod, requestData, (res: { [k: string]: any }) => {\n        const status: string = res[/*status*/ 's'];\n        const data: string = res[/*data*/ 'd'] || 'error';\n\n        if (this.authToken_ === token) {\n          if (status === 'ok') {\n            this.invalidAuthTokenCount_ = 0;\n          } else {\n            // Triggers reconnect and force refresh for auth token\n            this.onAuthRevoked_(status, data);\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  unlisten(query: Query, tag: number | null) {\n    const pathString = query.path.toString();\n    const queryId = query.queryIdentifier();\n\n    this.log_('Unlisten called for ' + pathString + ' ' + queryId);\n\n    assert(\n      query.getQueryParams().isDefault() ||\n        !query.getQueryParams().loadsAllData(),\n      'unlisten() called for non-default but complete query'\n    );\n    const listen = this.removeListen_(pathString, queryId);\n    if (listen && this.connected_) {\n      this.sendUnlisten_(pathString, queryId, query.queryObject(), tag);\n    }\n  }\n\n  private sendUnlisten_(\n    pathString: string,\n    queryId: string,\n    queryObj: Object,\n    tag: number | null\n  ) {\n    this.log_('Unlisten on ' + pathString + ' for ' + queryId);\n\n    const req: { [k: string]: any } = { /*path*/ p: pathString };\n    const action = 'n';\n    // Only bother sending queryId if it's non-default.\n    if (tag) {\n      req['q'] = queryObj;\n      req['t'] = tag;\n    }\n\n    this.sendRequest(action, req);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectPut(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('o', pathString, data, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'o',\n        data,\n        onComplete\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectMerge(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('om', pathString, data, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'om',\n        data,\n        onComplete\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectCancel(\n    pathString: string,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('oc', pathString, null, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'oc',\n        data: null,\n        onComplete\n      });\n    }\n  }\n\n  private sendOnDisconnect_(\n    action: string,\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string) => void\n  ) {\n    const request = { /*path*/ p: pathString, /*data*/ d: data };\n    this.log_('onDisconnect ' + action, request);\n    this.sendRequest(action, request, (response: { [k: string]: any }) => {\n      if (onComplete) {\n        setTimeout(function() {\n          onComplete(response[/*status*/ 's'], response[/* data */ 'd']);\n        }, Math.floor(0));\n      }\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  put(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void,\n    hash?: string\n  ) {\n    this.putInternal('p', pathString, data, onComplete, hash);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  merge(\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {\n    this.putInternal('m', pathString, data, onComplete, hash);\n  }\n\n  putInternal(\n    action: string,\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {\n    const request: { [k: string]: any } = {\n      /*path*/ p: pathString,\n      /*data*/ d: data\n    };\n\n    if (hash !== undefined) request[/*hash*/ 'h'] = hash;\n\n    // TODO: Only keep track of the most recent put for a given path?\n    this.outstandingPuts_.push({\n      action,\n      request,\n      onComplete\n    });\n\n    this.outstandingPutCount_++;\n    const index = this.outstandingPuts_.length - 1;\n\n    if (this.connected_) {\n      this.sendPut_(index);\n    } else {\n      this.log_('Buffering put: ' + pathString);\n    }\n  }\n\n  private sendPut_(index: number) {\n    const action = this.outstandingPuts_[index].action;\n    const request = this.outstandingPuts_[index].request;\n    const onComplete = this.outstandingPuts_[index].onComplete;\n    this.outstandingPuts_[index].queued = this.connected_;\n\n    this.sendRequest(action, request, (message: { [k: string]: any }) => {\n      this.log_(action + ' response', message);\n\n      delete this.outstandingPuts_[index];\n      this.outstandingPutCount_--;\n\n      // Clean up array occasionally.\n      if (this.outstandingPutCount_ === 0) {\n        this.outstandingPuts_ = [];\n      }\n\n      if (onComplete)\n        onComplete(message[/*status*/ 's'], message[/* data */ 'd']);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  reportStats(stats: { [k: string]: any }) {\n    // If we're not connected, we just drop the stats.\n    if (this.connected_) {\n      const request = { /*counters*/ c: stats };\n      this.log_('reportStats', request);\n\n      this.sendRequest(/*stats*/ 's', request, result => {\n        const status = result[/*status*/ 's'];\n        if (status !== 'ok') {\n          const errorReason = result[/* data */ 'd'];\n          this.log_('reportStats', 'Error sending stats: ' + errorReason);\n        }\n      });\n    }\n  }\n\n  /**\n   * @param {*} message\n   * @private\n   */\n  private onDataMessage_(message: { [k: string]: any }) {\n    if ('r' in message) {\n      // this is a response\n      this.log_('from server: ' + stringify(message));\n      const reqNum = message['r'];\n      const onResponse = this.requestCBHash_[reqNum];\n      if (onResponse) {\n        delete this.requestCBHash_[reqNum];\n        onResponse(message[/*body*/ 'b']);\n      }\n    } else if ('error' in message) {\n      throw 'A server-side error has occurred: ' + message['error'];\n    } else if ('a' in message) {\n      // a and b are action and body, respectively\n      this.onDataPush_(message['a'], message['b']);\n    }\n  }\n\n  private onDataPush_(action: string, body: { [k: string]: any }) {\n    this.log_('handleServerMessage', action, body);\n    if (action === 'd')\n      this.onDataUpdate_(\n        body[/*path*/ 'p'],\n        body[/*data*/ 'd'],\n        /*isMerge*/ false,\n        body['t']\n      );\n    else if (action === 'm')\n      this.onDataUpdate_(\n        body[/*path*/ 'p'],\n        body[/*data*/ 'd'],\n        /*isMerge=*/ true,\n        body['t']\n      );\n    else if (action === 'c')\n      this.onListenRevoked_(body[/*path*/ 'p'], body[/*query*/ 'q']);\n    else if (action === 'ac')\n      this.onAuthRevoked_(\n        body[/*status code*/ 's'],\n        body[/* explanation */ 'd']\n      );\n    else if (action === 'sd') this.onSecurityDebugPacket_(body);\n    else\n      error(\n        'Unrecognized action received from server: ' +\n          stringify(action) +\n          '\\nAre you using the latest client?'\n      );\n  }\n\n  private onReady_(timestamp: number, sessionId: string) {\n    this.log_('connection ready');\n    this.connected_ = true;\n    this.lastConnectionEstablishedTime_ = new Date().getTime();\n    this.handleTimestamp_(timestamp);\n    this.lastSessionId = sessionId;\n    if (this.firstConnection_) {\n      this.sendConnectStats_();\n    }\n    this.restoreState_();\n    this.firstConnection_ = false;\n    this.onConnectStatus_(true);\n  }\n\n  private scheduleConnect_(timeout: number) {\n    assert(\n      !this.realtime_,\n      \"Scheduling a connect when we're already connected/ing?\"\n    );\n\n    if (this.establishConnectionTimer_) {\n      clearTimeout(this.establishConnectionTimer_);\n    }\n\n    // NOTE: Even when timeout is 0, it's important to do a setTimeout to work around an infuriating \"Security Error\" in\n    // Firefox when trying to write to our long-polling iframe in some scenarios (e.g. Forge or our unit tests).\n\n    this.establishConnectionTimer_ = setTimeout(() => {\n      this.establishConnectionTimer_ = null;\n      this.establishConnection_();\n    }, Math.floor(timeout)) as any;\n  }\n\n  /**\n   * @param {boolean} visible\n   * @private\n   */\n  private onVisible_(visible: boolean) {\n    // NOTE: Tabbing away and back to a window will defeat our reconnect backoff, but I think that's fine.\n    if (\n      visible &&\n      !this.visible_ &&\n      this.reconnectDelay_ === this.maxReconnectDelay_\n    ) {\n      this.log_('Window became visible.  Reducing delay.');\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    }\n    this.visible_ = visible;\n  }\n\n  private onOnline_(online: boolean) {\n    if (online) {\n      this.log_('Browser went online.');\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    } else {\n      this.log_('Browser went offline.  Killing connection.');\n      if (this.realtime_) {\n        this.realtime_.close();\n      }\n    }\n  }\n\n  private onRealtimeDisconnect_() {\n    this.log_('data client disconnected');\n    this.connected_ = false;\n    this.realtime_ = null;\n\n    // Since we don't know if our sent transactions succeeded or not, we need to cancel them.\n    this.cancelSentTransactions_();\n\n    // Clear out the pending requests.\n    this.requestCBHash_ = {};\n\n    if (this.shouldReconnect_()) {\n      if (!this.visible_) {\n        this.log_(\"Window isn't visible.  Delaying reconnect.\");\n        this.reconnectDelay_ = this.maxReconnectDelay_;\n        this.lastConnectionAttemptTime_ = new Date().getTime();\n      } else if (this.lastConnectionEstablishedTime_) {\n        // If we've been connected long enough, reset reconnect delay to minimum.\n        const timeSinceLastConnectSucceeded =\n          new Date().getTime() - this.lastConnectionEstablishedTime_;\n        if (timeSinceLastConnectSucceeded > RECONNECT_DELAY_RESET_TIMEOUT)\n          this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n        this.lastConnectionEstablishedTime_ = null;\n      }\n\n      const timeSinceLastConnectAttempt =\n        new Date().getTime() - this.lastConnectionAttemptTime_;\n      let reconnectDelay = Math.max(\n        0,\n        this.reconnectDelay_ - timeSinceLastConnectAttempt\n      );\n      reconnectDelay = Math.random() * reconnectDelay;\n\n      this.log_('Trying to reconnect in ' + reconnectDelay + 'ms');\n      this.scheduleConnect_(reconnectDelay);\n\n      // Adjust reconnect delay for next time.\n      this.reconnectDelay_ = Math.min(\n        this.maxReconnectDelay_,\n        this.reconnectDelay_ * RECONNECT_DELAY_MULTIPLIER\n      );\n    }\n    this.onConnectStatus_(false);\n  }\n\n  private establishConnection_() {\n    if (this.shouldReconnect_()) {\n      this.log_('Making a connection attempt');\n      this.lastConnectionAttemptTime_ = new Date().getTime();\n      this.lastConnectionEstablishedTime_ = null;\n      const onDataMessage = this.onDataMessage_.bind(this);\n      const onReady = this.onReady_.bind(this);\n      const onDisconnect = this.onRealtimeDisconnect_.bind(this);\n      const connId = this.id + ':' + PersistentConnection.nextConnectionId_++;\n      const self = this;\n      const lastSessionId = this.lastSessionId;\n      let canceled = false;\n      let connection: Connection | null = null;\n      const closeFn = function() {\n        if (connection) {\n          connection.close();\n        } else {\n          canceled = true;\n          onDisconnect();\n        }\n      };\n      const sendRequestFn = function(msg: Object) {\n        assert(\n          connection,\n          \"sendRequest call when we're not connected not allowed.\"\n        );\n        connection.sendRequest(msg);\n      };\n\n      this.realtime_ = {\n        close: closeFn,\n        sendRequest: sendRequestFn\n      };\n\n      const forceRefresh = this.forceTokenRefresh_;\n      this.forceTokenRefresh_ = false;\n\n      // First fetch auth token, and establish connection after fetching the token was successful\n      this.authTokenProvider_\n        .getToken(forceRefresh)\n        .then(function(result) {\n          if (!canceled) {\n            log('getToken() completed. Creating connection.');\n            self.authToken_ = result && result.accessToken;\n            connection = new Connection(\n              connId,\n              self.repoInfo_,\n              onDataMessage,\n              onReady,\n              onDisconnect,\n              /* onKill= */ function(reason) {\n                warn(reason + ' (' + self.repoInfo_.toString() + ')');\n                self.interrupt(SERVER_KILL_INTERRUPT_REASON);\n              },\n              lastSessionId\n            );\n          } else {\n            log('getToken() completed but was canceled');\n          }\n        })\n        .then(null, function(error) {\n          self.log_('Failed to get token: ' + error);\n          if (!canceled) {\n            if (CONSTANTS.NODE_ADMIN) {\n              // This may be a critical error for the Admin Node.js SDK, so log a warning.\n              // But getToken() may also just have temporarily failed, so we still want to\n              // continue retrying.\n              warn(error);\n            }\n            closeFn();\n          }\n        });\n    }\n  }\n\n  /**\n   * @param {string} reason\n   */\n  interrupt(reason: string) {\n    log('Interrupting connection for reason: ' + reason);\n    this.interruptReasons_[reason] = true;\n    if (this.realtime_) {\n      this.realtime_.close();\n    } else {\n      if (this.establishConnectionTimer_) {\n        clearTimeout(this.establishConnectionTimer_);\n        this.establishConnectionTimer_ = null;\n      }\n      if (this.connected_) {\n        this.onRealtimeDisconnect_();\n      }\n    }\n  }\n\n  /**\n   * @param {string} reason\n   */\n  resume(reason: string) {\n    log('Resuming connection for reason: ' + reason);\n    delete this.interruptReasons_[reason];\n    if (isEmpty(this.interruptReasons_)) {\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    }\n  }\n\n  private handleTimestamp_(timestamp: number) {\n    const delta = timestamp - new Date().getTime();\n    this.onServerInfoUpdate_({ serverTimeOffset: delta });\n  }\n\n  private cancelSentTransactions_() {\n    for (let i = 0; i < this.outstandingPuts_.length; i++) {\n      const put = this.outstandingPuts_[i];\n      if (put && /*hash*/ 'h' in put.request && put.queued) {\n        if (put.onComplete) put.onComplete('disconnect');\n\n        delete this.outstandingPuts_[i];\n        this.outstandingPutCount_--;\n      }\n    }\n\n    // Clean up array occasionally.\n    if (this.outstandingPutCount_ === 0) this.outstandingPuts_ = [];\n  }\n\n  /**\n   * @param {!string} pathString\n   * @param {Array.<*>=} query\n   * @private\n   */\n  private onListenRevoked_(pathString: string, query?: any[]) {\n    // Remove the listen and manufacture a \"permission_denied\" error for the failed listen.\n    let queryId;\n    if (!query) {\n      queryId = 'default';\n    } else {\n      queryId = query.map(q => ObjectToUniqueKey(q)).join('$');\n    }\n    const listen = this.removeListen_(pathString, queryId);\n    if (listen && listen.onComplete) listen.onComplete('permission_denied');\n  }\n\n  /**\n   * @param {!string} pathString\n   * @param {!string} queryId\n   * @return {{queries:Array.<Query>, onComplete:function(string)}}\n   * @private\n   */\n  private removeListen_(pathString: string, queryId: string): ListenSpec {\n    const normalizedPathString = new Path(pathString).toString(); // normalize path.\n    let listen;\n    if (this.listens_[normalizedPathString] !== undefined) {\n      listen = this.listens_[normalizedPathString][queryId];\n      delete this.listens_[normalizedPathString][queryId];\n      if (getCount(this.listens_[normalizedPathString]) === 0) {\n        delete this.listens_[normalizedPathString];\n      }\n    } else {\n      // all listens for this path has already been removed\n      listen = undefined;\n    }\n    return listen;\n  }\n\n  private onAuthRevoked_(statusCode: string, explanation: string) {\n    log('Auth token revoked: ' + statusCode + '/' + explanation);\n    this.authToken_ = null;\n    this.forceTokenRefresh_ = true;\n    this.realtime_.close();\n    if (statusCode === 'invalid_token' || statusCode === 'permission_denied') {\n      // We'll wait a couple times before logging the warning / increasing the\n      // retry period since oauth tokens will report as \"invalid\" if they're\n      // just expired. Plus there may be transient issues that resolve themselves.\n      this.invalidAuthTokenCount_++;\n      if (this.invalidAuthTokenCount_ >= INVALID_AUTH_TOKEN_THRESHOLD) {\n        // Set a long reconnect delay because recovery is unlikely\n        this.reconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n\n        // Notify the auth token provider that the token is invalid, which will log\n        // a warning\n        this.authTokenProvider_.notifyForInvalidToken();\n      }\n    }\n  }\n\n  private onSecurityDebugPacket_(body: { [k: string]: any }) {\n    if (this.securityDebugCallback_) {\n      this.securityDebugCallback_(body);\n    } else {\n      if ('msg' in body) {\n        console.log('FIREBASE: ' + body['msg'].replace('\\n', '\\nFIREBASE: '));\n      }\n    }\n  }\n\n  private restoreState_() {\n    //Re-authenticate ourselves if we have a credential stored.\n    this.tryAuth();\n\n    // Puts depend on having received the corresponding data update from the server before they complete, so we must\n    // make sure to send listens before puts.\n    forEach(\n      this.listens_,\n      (pathString: string, queries: { [key: string]: ListenSpec }) => {\n        forEach(queries, (key: string, listenSpec: ListenSpec) => {\n          this.sendListen_(listenSpec);\n        });\n      }\n    );\n\n    for (let i = 0; i < this.outstandingPuts_.length; i++) {\n      if (this.outstandingPuts_[i]) this.sendPut_(i);\n    }\n\n    while (this.onDisconnectRequestQueue_.length) {\n      const request = this.onDisconnectRequestQueue_.shift();\n      this.sendOnDisconnect_(\n        request.action,\n        request.pathString,\n        request.data,\n        request.onComplete\n      );\n    }\n  }\n\n  /**\n   * Sends client stats for first connection\n   * @private\n   */\n  private sendConnectStats_() {\n    const stats: { [k: string]: number } = {};\n\n    let clientName = 'js';\n    if (CONSTANTS.NODE_ADMIN) {\n      clientName = 'admin_node';\n    } else if (CONSTANTS.NODE_CLIENT) {\n      clientName = 'node';\n    }\n\n    stats[\n      'sdk.' + clientName + '.' + firebase.SDK_VERSION.replace(/\\./g, '-')\n    ] = 1;\n\n    if (isMobileCordova()) {\n      stats['framework.cordova'] = 1;\n    } else if (isReactNative()) {\n      stats['framework.reactnative'] = 1;\n    }\n    this.reportStats(stats);\n  }\n\n  /**\n   * @return {boolean}\n   * @private\n   */\n  private shouldReconnect_(): boolean {\n    const online = OnlineMonitor.getInstance().currentlyOnline();\n    return isEmpty(this.interruptReasons_) && online;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { logWrapper, warn } from './util/util';\nimport { jsonEval } from '@firebase/util';\nimport { safeGet } from '@firebase/util';\nimport { querystring } from '@firebase/util';\nimport { ServerActions } from './ServerActions';\nimport { RepoInfo } from './RepoInfo';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { Query } from '../api/Query';\n\n/**\n * An implementation of ServerActions that communicates with the server via REST requests.\n * This is mostly useful for compatibility with crawlers, where we don't want to spin up a full\n * persistent connection (using WebSockets or long-polling)\n */\nexport class ReadonlyRestClient extends ServerActions {\n  reportStats(stats: { [k: string]: any }): void {\n    throw new Error('Method not implemented.');\n  }\n\n  /** @private {function(...[*])} */\n  private log_: (...args: any[]) => void = logWrapper('p:rest:');\n\n  /**\n   * We don't actually need to track listens, except to prevent us calling an onComplete for a listen\n   * that's been removed. :-/\n   *\n   * @private {!Object.<string, !Object>}\n   */\n  private listens_: { [k: string]: Object } = {};\n\n  /**\n   * @param {!Query} query\n   * @param {?number=} tag\n   * @return {string}\n   * @private\n   */\n  static getListenId_(query: Query, tag?: number | null): string {\n    if (tag !== undefined) {\n      return 'tag$' + tag;\n    } else {\n      assert(\n        query.getQueryParams().isDefault(),\n        \"should have a tag if it's not a default query.\"\n      );\n      return query.path.toString();\n    }\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo_ Data about the namespace we are connecting to\n   * @param {function(string, *, boolean, ?number)} onDataUpdate_ A callback for new data from the server\n   * @param {AuthTokenProvider} authTokenProvider_\n   * @implements {ServerActions}\n   */\n  constructor(\n    private repoInfo_: RepoInfo,\n    private onDataUpdate_: (\n      a: string,\n      b: any,\n      c: boolean,\n      d: number | null\n    ) => void,\n    private authTokenProvider_: AuthTokenProvider\n  ) {\n    super();\n  }\n\n  /** @inheritDoc */\n  listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ) {\n    const pathString = query.path.toString();\n    this.log_(\n      'Listen called for ' + pathString + ' ' + query.queryIdentifier()\n    );\n\n    // Mark this listener so we can tell if it's removed.\n    const listenId = ReadonlyRestClient.getListenId_(query, tag);\n    const thisListen = {};\n    this.listens_[listenId] = thisListen;\n\n    const queryStringParameters = query\n      .getQueryParams()\n      .toRestQueryStringParameters();\n\n    this.restRequest_(\n      pathString + '.json',\n      queryStringParameters,\n      (error, result) => {\n        let data = result;\n\n        if (error === 404) {\n          data = null;\n          error = null;\n        }\n\n        if (error === null) {\n          this.onDataUpdate_(pathString, data, /*isMerge=*/ false, tag);\n        }\n\n        if (safeGet(this.listens_, listenId) === thisListen) {\n          let status;\n          if (!error) {\n            status = 'ok';\n          } else if (error == 401) {\n            status = 'permission_denied';\n          } else {\n            status = 'rest_error:' + error;\n          }\n\n          onComplete(status, null);\n        }\n      }\n    );\n  }\n\n  /** @inheritDoc */\n  unlisten(query: Query, tag: number | null) {\n    const listenId = ReadonlyRestClient.getListenId_(query, tag);\n    delete this.listens_[listenId];\n  }\n\n  /** @inheritDoc */\n  refreshAuthToken(token: string) {\n    // no-op since we just always call getToken.\n  }\n\n  /**\n   * Performs a REST request to the given path, with the provided query string parameters,\n   * and any auth credentials we have.\n   *\n   * @param {!string} pathString\n   * @param {!Object.<string, *>} queryStringParameters\n   * @param {?function(?number, *=)} callback\n   * @private\n   */\n  private restRequest_(\n    pathString: string,\n    queryStringParameters: { [k: string]: any } = {},\n    callback: ((a: number | null, b?: any) => void) | null\n  ) {\n    queryStringParameters['format'] = 'export';\n\n    this.authTokenProvider_\n      .getToken(/*forceRefresh=*/ false)\n      .then(authTokenData => {\n        const authToken = authTokenData && authTokenData.accessToken;\n        if (authToken) {\n          queryStringParameters['auth'] = authToken;\n        }\n\n        const url =\n          (this.repoInfo_.secure ? 'https://' : 'http://') +\n          this.repoInfo_.host +\n          pathString +\n          '?' +\n          'ns=' +\n          this.repoInfo_.namespace +\n          querystring(queryStringParameters);\n\n        this.log_('Sending REST request for ' + url);\n        const xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => {\n          if (callback && xhr.readyState === 4) {\n            this.log_(\n              'REST Response for ' + url + ' received. status:',\n              xhr.status,\n              'response:',\n              xhr.responseText\n            );\n            let res = null;\n            if (xhr.status >= 200 && xhr.status < 300) {\n              try {\n                res = jsonEval(xhr.responseText);\n              } catch (e) {\n                warn(\n                  'Failed to parse JSON response for ' +\n                    url +\n                    ': ' +\n                    xhr.responseText\n                );\n              }\n              callback(null, res);\n            } else {\n              // 401 and 404 are expected.\n              if (xhr.status !== 401 && xhr.status !== 404) {\n                warn(\n                  'Got unsuccessful REST response for ' +\n                    url +\n                    ' Status: ' +\n                    xhr.status\n                );\n              }\n              callback(xhr.status);\n            }\n            callback = null;\n          }\n        };\n\n        xhr.open('GET', url, /*asynchronous=*/ true);\n        xhr.send();\n      });\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  generateWithValues,\n  resolveDeferredValueSnapshot,\n  resolveDeferredValueTree\n} from './util/ServerValues';\nimport { nodeFromJSON } from './snap/nodeFromJSON';\nimport { Path } from './util/Path';\nimport { SparseSnapshotTree } from './SparseSnapshotTree';\nimport { SyncTree } from './SyncTree';\nimport { SnapshotHolder } from './SnapshotHolder';\nimport { stringify } from '@firebase/util';\nimport { beingCrawled, each, exceptionGuard, warn, log } from './util/util';\nimport { map, forEach, isEmpty } from '@firebase/util';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { StatsManager } from './stats/StatsManager';\nimport { StatsReporter } from './stats/StatsReporter';\nimport { StatsListener } from './stats/StatsListener';\nimport { EventQueue } from './view/EventQueue';\nimport { PersistentConnection } from './PersistentConnection';\nimport { ReadonlyRestClient } from './ReadonlyRestClient';\nimport { FirebaseApp } from '@firebase/app-types';\nimport { RepoInfo } from './RepoInfo';\nimport { Database } from '../api/Database';\nimport { ServerActions } from './ServerActions';\nimport { Query } from '../api/Query';\nimport { EventRegistration } from './view/EventRegistration';\nimport { StatsCollection } from './stats/StatsCollection';\nimport { Event } from './view/Event';\nimport { Node } from './snap/Node';\n\nconst INTERRUPT_REASON = 'repo_interrupt';\n\n/**\n * A connection to a single data repository.\n */\nexport class Repo {\n  dataUpdateCount = 0;\n  private infoSyncTree_: SyncTree;\n  private serverSyncTree_: SyncTree;\n\n  private stats_: StatsCollection;\n  private statsListener_: StatsListener | null = null;\n  private eventQueue_ = new EventQueue();\n  private nextWriteId_ = 1;\n  private server_: ServerActions;\n  private statsReporter_: StatsReporter;\n  private transactions_init_: () => void;\n  private infoData_: SnapshotHolder;\n  private abortTransactions_: (path: Path) => Path;\n  private rerunTransactions_: (changedPath: Path) => Path;\n  private interceptServerDataCallback_:\n    | ((a: string, b: any) => void)\n    | null = null;\n  private __database: Database;\n\n  // A list of data pieces and paths to be set when this client disconnects.\n  private onDisconnect_ = new SparseSnapshotTree();\n\n  /**\n   * TODO: This should be @private but it's used by test_access.js and internal.js\n   * @type {?PersistentConnection}\n   */\n  persistentConnection_: PersistentConnection | null = null;\n\n  /**\n   * @param {!RepoInfo} repoInfo_\n   * @param {boolean} forceRestClient\n   * @param {!FirebaseApp} app\n   */\n  constructor(\n    public repoInfo_: RepoInfo,\n    forceRestClient: boolean,\n    public app: FirebaseApp\n  ) {\n    /** @type {!AuthTokenProvider} */\n    const authTokenProvider = new AuthTokenProvider(app);\n\n    this.stats_ = StatsManager.getCollection(repoInfo_);\n\n    if (forceRestClient || beingCrawled()) {\n      this.server_ = new ReadonlyRestClient(\n        this.repoInfo_,\n        this.onDataUpdate_.bind(this),\n        authTokenProvider\n      );\n\n      // Minor hack: Fire onConnect immediately, since there's no actual connection.\n      setTimeout(this.onConnectStatus_.bind(this, true), 0);\n    } else {\n      const authOverride = app.options['databaseAuthVariableOverride'];\n      // Validate authOverride\n      if (typeof authOverride !== 'undefined' && authOverride !== null) {\n        if (typeof authOverride !== 'object') {\n          throw new Error(\n            'Only objects are supported for option databaseAuthVariableOverride'\n          );\n        }\n        try {\n          stringify(authOverride);\n        } catch (e) {\n          throw new Error('Invalid authOverride provided: ' + e);\n        }\n      }\n\n      this.persistentConnection_ = new PersistentConnection(\n        this.repoInfo_,\n        this.onDataUpdate_.bind(this),\n        this.onConnectStatus_.bind(this),\n        this.onServerInfoUpdate_.bind(this),\n        authTokenProvider,\n        authOverride\n      );\n\n      this.server_ = this.persistentConnection_;\n    }\n\n    authTokenProvider.addTokenChangeListener(token => {\n      this.server_.refreshAuthToken(token);\n    });\n\n    // In the case of multiple Repos for the same repoInfo (i.e. there are multiple Firebase.Contexts being used),\n    // we only want to create one StatsReporter.  As such, we'll report stats over the first Repo created.\n    this.statsReporter_ = StatsManager.getOrCreateReporter(\n      repoInfo_,\n      () => new StatsReporter(this.stats_, this.server_)\n    );\n\n    this.transactions_init_();\n\n    // Used for .info.\n    this.infoData_ = new SnapshotHolder();\n    this.infoSyncTree_ = new SyncTree({\n      startListening: (query, tag, currentHashFn, onComplete) => {\n        let infoEvents: Event[] = [];\n        const node = this.infoData_.getNode(query.path);\n        // This is possibly a hack, but we have different semantics for .info endpoints. We don't raise null events\n        // on initial data...\n        if (!node.isEmpty()) {\n          infoEvents = this.infoSyncTree_.applyServerOverwrite(\n            query.path,\n            node\n          );\n          setTimeout(() => {\n            onComplete('ok');\n          }, 0);\n        }\n        return infoEvents;\n      },\n      stopListening: () => {}\n    });\n    this.updateInfo_('connected', false);\n\n    this.serverSyncTree_ = new SyncTree({\n      startListening: (query, tag, currentHashFn, onComplete) => {\n        this.server_.listen(query, currentHashFn, tag, (status, data) => {\n          const events = onComplete(status, data);\n          this.eventQueue_.raiseEventsForChangedPath(query.path, events);\n        });\n        // No synchronous events for network-backed sync trees\n        return [];\n      },\n      stopListening: (query, tag) => {\n        this.server_.unlisten(query, tag);\n      }\n    });\n  }\n\n  /**\n   * @return {string}  The URL corresponding to the root of this Firebase.\n   */\n  toString(): string {\n    return (\n      (this.repoInfo_.secure ? 'https://' : 'http://') + this.repoInfo_.host\n    );\n  }\n\n  /**\n   * @return {!string} The namespace represented by the repo.\n   */\n  name(): string {\n    return this.repoInfo_.namespace;\n  }\n\n  /**\n   * @return {!number} The time in milliseconds, taking the server offset into account if we have one.\n   */\n  serverTime(): number {\n    const offsetNode = this.infoData_.getNode(\n      new Path('.info/serverTimeOffset')\n    );\n    const offset = (offsetNode.val() as number) || 0;\n    return new Date().getTime() + offset;\n  }\n\n  /**\n   * Generate ServerValues using some variables from the repo object.\n   * @return {!Object}\n   */\n  generateServerValues(): Object {\n    return generateWithValues({\n      timestamp: this.serverTime()\n    });\n  }\n\n  /**\n   * Called by realtime when we get new messages from the server.\n   *\n   * @private\n   * @param {string} pathString\n   * @param {*} data\n   * @param {boolean} isMerge\n   * @param {?number} tag\n   */\n  private onDataUpdate_(\n    pathString: string,\n    data: any,\n    isMerge: boolean,\n    tag: number | null\n  ) {\n    // For testing.\n    this.dataUpdateCount++;\n    const path = new Path(pathString);\n    data = this.interceptServerDataCallback_\n      ? this.interceptServerDataCallback_(pathString, data)\n      : data;\n    let events = [];\n    if (tag) {\n      if (isMerge) {\n        const taggedChildren = map(data as { [k: string]: any }, (raw: any) =>\n          nodeFromJSON(raw)\n        );\n        events = this.serverSyncTree_.applyTaggedQueryMerge(\n          path,\n          taggedChildren,\n          tag\n        );\n      } else {\n        const taggedSnap = nodeFromJSON(data);\n        events = this.serverSyncTree_.applyTaggedQueryOverwrite(\n          path,\n          taggedSnap,\n          tag\n        );\n      }\n    } else if (isMerge) {\n      const changedChildren = map(data as { [k: string]: any }, (raw: any) =>\n        nodeFromJSON(raw)\n      );\n      events = this.serverSyncTree_.applyServerMerge(path, changedChildren);\n    } else {\n      const snap = nodeFromJSON(data);\n      events = this.serverSyncTree_.applyServerOverwrite(path, snap);\n    }\n    let affectedPath = path;\n    if (events.length > 0) {\n      // Since we have a listener outstanding for each transaction, receiving any events\n      // is a proxy for some change having occurred.\n      affectedPath = this.rerunTransactions_(path);\n    }\n    this.eventQueue_.raiseEventsForChangedPath(affectedPath, events);\n  }\n\n  /**\n   * TODO: This should be @private but it's used by test_access.js and internal.js\n   * @param {?function(!string, *):*} callback\n   * @private\n   */\n  interceptServerData_(callback: ((a: string, b: any) => any) | null) {\n    this.interceptServerDataCallback_ = callback;\n  }\n\n  /**\n   * @param {!boolean} connectStatus\n   * @private\n   */\n  private onConnectStatus_(connectStatus: boolean) {\n    this.updateInfo_('connected', connectStatus);\n    if (connectStatus === false) {\n      this.runOnDisconnectEvents_();\n    }\n  }\n\n  /**\n   * @param {!Object} updates\n   * @private\n   */\n  private onServerInfoUpdate_(updates: Object) {\n    each(updates, (value: any, key: string) => {\n      this.updateInfo_(key, value);\n    });\n  }\n\n  /**\n   *\n   * @param {!string} pathString\n   * @param {*} value\n   * @private\n   */\n  private updateInfo_(pathString: string, value: any) {\n    const path = new Path('/.info/' + pathString);\n    const newNode = nodeFromJSON(value);\n    this.infoData_.updateSnapshot(path, newNode);\n    const events = this.infoSyncTree_.applyServerOverwrite(path, newNode);\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n  }\n\n  /**\n   * @return {!number}\n   * @private\n   */\n  private getNextWriteId_(): number {\n    return this.nextWriteId_++;\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {*} newVal\n   * @param {number|string|null} newPriority\n   * @param {?function(?Error, *=)} onComplete\n   */\n  setWithPriority(\n    path: Path,\n    newVal: any,\n    newPriority: number | string | null,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.log_('set', {\n      path: path.toString(),\n      value: newVal,\n      priority: newPriority\n    });\n\n    // TODO: Optimize this behavior to either (a) store flag to skip resolving where possible and / or\n    // (b) store unresolved paths on JSON parse\n    const serverValues = this.generateServerValues();\n    const newNodeUnresolved = nodeFromJSON(newVal, newPriority);\n    const newNode = resolveDeferredValueSnapshot(\n      newNodeUnresolved,\n      serverValues\n    );\n\n    const writeId = this.getNextWriteId_();\n    const events = this.serverSyncTree_.applyUserOverwrite(\n      path,\n      newNode,\n      writeId,\n      true\n    );\n    this.eventQueue_.queueEvents(events);\n    this.server_.put(\n      path.toString(),\n      newNodeUnresolved.val(/*export=*/ true),\n      (status, errorReason) => {\n        const success = status === 'ok';\n        if (!success) {\n          warn('set at ' + path + ' failed: ' + status);\n        }\n\n        const clearEvents = this.serverSyncTree_.ackUserWrite(\n          writeId,\n          !success\n        );\n        this.eventQueue_.raiseEventsForChangedPath(path, clearEvents);\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n    const affectedPath = this.abortTransactions_(path);\n    this.rerunTransactions_(affectedPath);\n    // We queued the events above, so just flush the queue here\n    this.eventQueue_.raiseEventsForChangedPath(affectedPath, []);\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {!Object} childrenToMerge\n   * @param {?function(?Error, *=)} onComplete\n   */\n  update(\n    path: Path,\n    childrenToMerge: { [k: string]: any },\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.log_('update', { path: path.toString(), value: childrenToMerge });\n\n    // Start with our existing data and merge each child into it.\n    let empty = true;\n    const serverValues = this.generateServerValues();\n    const changedChildren: { [k: string]: Node } = {};\n    forEach(childrenToMerge, (changedKey: string, changedValue: any) => {\n      empty = false;\n      const newNodeUnresolved = nodeFromJSON(changedValue);\n      changedChildren[changedKey] = resolveDeferredValueSnapshot(\n        newNodeUnresolved,\n        serverValues\n      );\n    });\n\n    if (!empty) {\n      const writeId = this.getNextWriteId_();\n      const events = this.serverSyncTree_.applyUserMerge(\n        path,\n        changedChildren,\n        writeId\n      );\n      this.eventQueue_.queueEvents(events);\n      this.server_.merge(\n        path.toString(),\n        childrenToMerge,\n        (status, errorReason) => {\n          const success = status === 'ok';\n          if (!success) {\n            warn('update at ' + path + ' failed: ' + status);\n          }\n\n          const clearEvents = this.serverSyncTree_.ackUserWrite(\n            writeId,\n            !success\n          );\n          const affectedPath =\n            clearEvents.length > 0 ? this.rerunTransactions_(path) : path;\n          this.eventQueue_.raiseEventsForChangedPath(affectedPath, clearEvents);\n          this.callOnCompleteCallback(onComplete, status, errorReason);\n        }\n      );\n\n      forEach(childrenToMerge, (changedPath: string) => {\n        const affectedPath = this.abortTransactions_(path.child(changedPath));\n        this.rerunTransactions_(affectedPath);\n      });\n\n      // We queued the events above, so just flush the queue here\n      this.eventQueue_.raiseEventsForChangedPath(path, []);\n    } else {\n      log(\"update() called with empty data.  Don't do anything.\");\n      this.callOnCompleteCallback(onComplete, 'ok');\n    }\n  }\n\n  /**\n   * Applies all of the changes stored up in the onDisconnect_ tree.\n   * @private\n   */\n  private runOnDisconnectEvents_() {\n    this.log_('onDisconnectEvents');\n\n    const serverValues = this.generateServerValues();\n    const resolvedOnDisconnectTree = resolveDeferredValueTree(\n      this.onDisconnect_,\n      serverValues\n    );\n    let events: Event[] = [];\n\n    resolvedOnDisconnectTree.forEachTree(Path.Empty, (path, snap) => {\n      events = events.concat(\n        this.serverSyncTree_.applyServerOverwrite(path, snap)\n      );\n      const affectedPath = this.abortTransactions_(path);\n      this.rerunTransactions_(affectedPath);\n    });\n\n    this.onDisconnect_ = new SparseSnapshotTree();\n    this.eventQueue_.raiseEventsForChangedPath(Path.Empty, events);\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {?function(?Error, *=)} onComplete\n   */\n  onDisconnectCancel(\n    path: Path,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.server_.onDisconnectCancel(path.toString(), (status, errorReason) => {\n      if (status === 'ok') {\n        this.onDisconnect_.forget(path);\n      }\n      this.callOnCompleteCallback(onComplete, status, errorReason);\n    });\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {*} value\n   * @param {?function(?Error, *=)} onComplete\n   */\n  onDisconnectSet(\n    path: Path,\n    value: any,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    const newNode = nodeFromJSON(value);\n    this.server_.onDisconnectPut(\n      path.toString(),\n      newNode.val(/*export=*/ true),\n      (status, errorReason) => {\n        if (status === 'ok') {\n          this.onDisconnect_.remember(path, newNode);\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {*} value\n   * @param {*} priority\n   * @param {?function(?Error, *=)} onComplete\n   */\n  onDisconnectSetWithPriority(\n    path: Path,\n    value: any,\n    priority: any,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    const newNode = nodeFromJSON(value, priority);\n    this.server_.onDisconnectPut(\n      path.toString(),\n      newNode.val(/*export=*/ true),\n      (status, errorReason) => {\n        if (status === 'ok') {\n          this.onDisconnect_.remember(path, newNode);\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  /**\n   * @param {!Path} path\n   * @param {*} childrenToMerge\n   * @param {?function(?Error, *=)} onComplete\n   */\n  onDisconnectUpdate(\n    path: Path,\n    childrenToMerge: { [k: string]: any },\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    if (isEmpty(childrenToMerge)) {\n      log(\n        \"onDisconnect().update() called with empty data.  Don't do anything.\"\n      );\n      this.callOnCompleteCallback(onComplete, 'ok');\n      return;\n    }\n\n    this.server_.onDisconnectMerge(\n      path.toString(),\n      childrenToMerge,\n      (status, errorReason) => {\n        if (status === 'ok') {\n          forEach(childrenToMerge, (childName: string, childNode: any) => {\n            const newChildNode = nodeFromJSON(childNode);\n            this.onDisconnect_.remember(path.child(childName), newChildNode);\n          });\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  /**\n   * @param {!Query} query\n   * @param {!EventRegistration} eventRegistration\n   */\n  addEventCallbackForQuery(query: Query, eventRegistration: EventRegistration) {\n    let events;\n    if (query.path.getFront() === '.info') {\n      events = this.infoSyncTree_.addEventRegistration(\n        query,\n        eventRegistration\n      );\n    } else {\n      events = this.serverSyncTree_.addEventRegistration(\n        query,\n        eventRegistration\n      );\n    }\n    this.eventQueue_.raiseEventsAtPath(query.path, events);\n  }\n\n  /**\n   * @param {!Query} query\n   * @param {?EventRegistration} eventRegistration\n   */\n  removeEventCallbackForQuery(\n    query: Query,\n    eventRegistration: EventRegistration\n  ) {\n    // These are guaranteed not to raise events, since we're not passing in a cancelError. However, we can future-proof\n    // a little bit by handling the return values anyways.\n    let events;\n    if (query.path.getFront() === '.info') {\n      events = this.infoSyncTree_.removeEventRegistration(\n        query,\n        eventRegistration\n      );\n    } else {\n      events = this.serverSyncTree_.removeEventRegistration(\n        query,\n        eventRegistration\n      );\n    }\n    this.eventQueue_.raiseEventsAtPath(query.path, events);\n  }\n\n  interrupt() {\n    if (this.persistentConnection_) {\n      this.persistentConnection_.interrupt(INTERRUPT_REASON);\n    }\n  }\n\n  resume() {\n    if (this.persistentConnection_) {\n      this.persistentConnection_.resume(INTERRUPT_REASON);\n    }\n  }\n\n  stats(showDelta: boolean = false) {\n    if (typeof console === 'undefined') return;\n\n    let stats: { [k: string]: any };\n    if (showDelta) {\n      if (!this.statsListener_)\n        this.statsListener_ = new StatsListener(this.stats_);\n      stats = this.statsListener_.get();\n    } else {\n      stats = this.stats_.get();\n    }\n\n    const longestName = Object.keys(stats).reduce(\n      (previousValue, currentValue) =>\n        Math.max(currentValue.length, previousValue),\n      0\n    );\n\n    forEach(stats, (stat: string, value: any) => {\n      // pad stat names to be the same length (plus 2 extra spaces).\n      for (let i = stat.length; i < longestName + 2; i++) stat += ' ';\n      console.log(stat + value);\n    });\n  }\n\n  statsIncrementCounter(metric: string) {\n    this.stats_.incrementCounter(metric);\n    this.statsReporter_.includeStat(metric);\n  }\n\n  /**\n   * @param {...*} var_args\n   * @private\n   */\n  private log_(...var_args: any[]) {\n    let prefix = '';\n    if (this.persistentConnection_) {\n      prefix = this.persistentConnection_.id + ':';\n    }\n    log(prefix, ...var_args);\n  }\n\n  /**\n   * @param {?function(?Error, *=)} callback\n   * @param {!string} status\n   * @param {?string=} errorReason\n   */\n  callOnCompleteCallback(\n    callback: ((status: Error | null, errorReason?: string) => void) | null,\n    status: string,\n    errorReason?: string | null\n  ) {\n    if (callback) {\n      exceptionGuard(function() {\n        if (status == 'ok') {\n          callback(null);\n        } else {\n          const code = (status || 'error').toUpperCase();\n          let message = code;\n          if (errorReason) message += ': ' + errorReason;\n\n          const error = new Error(message);\n          (error as any).code = code;\n          callback(error);\n        }\n      });\n    }\n  }\n\n  get database(): Database {\n    return this.__database || (this.__database = new Database(this));\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IndexedFilter } from './IndexedFilter';\nimport { PRIORITY_INDEX } from '../../snap/indexes/PriorityIndex';\nimport { NamedNode, Node } from '../../../core/snap/Node';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { NodeFilter } from './NodeFilter';\nimport { QueryParams } from '../QueryParams';\nimport { Index } from '../../snap/indexes/Index';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\n\n/**\n * Filters nodes by range and uses an IndexFilter to track any changes after filtering the node\n *\n * @constructor\n * @implements {NodeFilter}\n */\nexport class RangedFilter implements NodeFilter {\n  /**\n   * @type {!IndexedFilter}\n   * @const\n   * @private\n   */\n  private indexedFilter_: IndexedFilter;\n\n  /**\n   * @const\n   * @type {!Index}\n   * @private\n   */\n  private index_: Index;\n\n  /**\n   * @const\n   * @type {!NamedNode}\n   * @private\n   */\n  private startPost_: NamedNode;\n\n  /**\n   * @const\n   * @type {!NamedNode}\n   * @private\n   */\n  private endPost_: NamedNode;\n\n  /**\n   * @param {!QueryParams} params\n   */\n  constructor(params: QueryParams) {\n    this.indexedFilter_ = new IndexedFilter(params.getIndex());\n    this.index_ = params.getIndex();\n    this.startPost_ = RangedFilter.getStartPost_(params);\n    this.endPost_ = RangedFilter.getEndPost_(params);\n  }\n\n  /**\n   * @return {!NamedNode}\n   */\n  getStartPost(): NamedNode {\n    return this.startPost_;\n  }\n\n  /**\n   * @return {!NamedNode}\n   */\n  getEndPost(): NamedNode {\n    return this.endPost_;\n  }\n\n  /**\n   * @param {!NamedNode} node\n   * @return {boolean}\n   */\n  matches(node: NamedNode): boolean {\n    return (\n      this.index_.compare(this.getStartPost(), node) <= 0 &&\n      this.index_.compare(node, this.getEndPost()) <= 0\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (!this.matches(new NamedNode(key, newChild))) {\n      newChild = ChildrenNode.EMPTY_NODE;\n    }\n    return this.indexedFilter_.updateChild(\n      snap,\n      key,\n      newChild,\n      affectedPath,\n      source,\n      optChangeAccumulator\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (newSnap.isLeafNode()) {\n      // Make sure we have a children node with the correct index, not a leaf node;\n      newSnap = ChildrenNode.EMPTY_NODE;\n    }\n    let filtered = newSnap.withIndex(this.index_);\n    // Don't support priorities on queries\n    filtered = filtered.updatePriority(ChildrenNode.EMPTY_NODE);\n    const self = this;\n    newSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n      if (!self.matches(new NamedNode(key, childNode))) {\n        filtered = filtered.updateImmediateChild(key, ChildrenNode.EMPTY_NODE);\n      }\n    });\n    return this.indexedFilter_.updateFullNode(\n      oldSnap,\n      filtered,\n      optChangeAccumulator\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    // Don't support priorities on queries\n    return oldSnap;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this.indexedFilter_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @param {!QueryParams} params\n   * @return {!NamedNode}\n   * @private\n   */\n  private static getStartPost_(params: QueryParams): NamedNode {\n    if (params.hasStart()) {\n      const startName = params.getIndexStartName();\n      return params.getIndex().makePost(params.getIndexStartValue(), startName);\n    } else {\n      return params.getIndex().minPost();\n    }\n  }\n\n  /**\n   * @param {!QueryParams} params\n   * @return {!NamedNode}\n   * @private\n   */\n  private static getEndPost_(params: QueryParams): NamedNode {\n    if (params.hasEnd()) {\n      const endName = params.getIndexEndName();\n      return params.getIndex().makePost(params.getIndexEndValue(), endName);\n    } else {\n      return params.getIndex().maxPost();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RangedFilter } from './RangedFilter';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { Node, NamedNode } from '../../snap/Node';\nimport { assert } from '@firebase/util';\nimport { Change } from '../Change';\nimport { NodeFilter } from './NodeFilter';\nimport { Index } from '../../snap/indexes/Index';\nimport { IndexedFilter } from './IndexedFilter';\nimport { QueryParams } from '../QueryParams';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\n\n/**\n * Applies a limit and a range to a node and uses RangedFilter to do the heavy lifting where possible\n *\n * @constructor\n * @implements {NodeFilter}\n */\nexport class LimitedFilter implements NodeFilter {\n  /**\n   * @const\n   * @type {RangedFilter}\n   * @private\n   */\n  private readonly rangedFilter_: RangedFilter;\n\n  /**\n   * @const\n   * @type {!Index}\n   * @private\n   */\n  private readonly index_: Index;\n\n  /**\n   * @const\n   * @type {number}\n   * @private\n   */\n  private readonly limit_: number;\n\n  /**\n   * @const\n   * @type {boolean}\n   * @private\n   */\n  private readonly reverse_: boolean;\n\n  /**\n   * @param {!QueryParams} params\n   */\n  constructor(params: QueryParams) {\n    this.rangedFilter_ = new RangedFilter(params);\n    this.index_ = params.getIndex();\n    this.limit_ = params.getLimit();\n    this.reverse_ = !params.isViewFromLeft();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (!this.rangedFilter_.matches(new NamedNode(key, newChild))) {\n      newChild = ChildrenNode.EMPTY_NODE;\n    }\n    if (snap.getImmediateChild(key).equals(newChild)) {\n      // No change\n      return snap;\n    } else if (snap.numChildren() < this.limit_) {\n      return this.rangedFilter_\n        .getIndexedFilter()\n        .updateChild(\n          snap,\n          key,\n          newChild,\n          affectedPath,\n          source,\n          optChangeAccumulator\n        );\n    } else {\n      return this.fullLimitUpdateChild_(\n        snap,\n        key,\n        newChild,\n        source,\n        optChangeAccumulator\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    let filtered;\n    if (newSnap.isLeafNode() || newSnap.isEmpty()) {\n      // Make sure we have a children node with the correct index, not a leaf node;\n      filtered = ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n    } else {\n      if (\n        this.limit_ * 2 < newSnap.numChildren() &&\n        newSnap.isIndexed(this.index_)\n      ) {\n        // Easier to build up a snapshot, since what we're given has more than twice the elements we want\n        filtered = ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n        // anchor to the startPost, endPost, or last element as appropriate\n        let iterator;\n        if (this.reverse_) {\n          iterator = (newSnap as ChildrenNode).getReverseIteratorFrom(\n            this.rangedFilter_.getEndPost(),\n            this.index_\n          );\n        } else {\n          iterator = (newSnap as ChildrenNode).getIteratorFrom(\n            this.rangedFilter_.getStartPost(),\n            this.index_\n          );\n        }\n        let count = 0;\n        while (iterator.hasNext() && count < this.limit_) {\n          const next = iterator.getNext();\n          let inRange;\n          if (this.reverse_) {\n            inRange =\n              this.index_.compare(this.rangedFilter_.getStartPost(), next) <= 0;\n          } else {\n            inRange =\n              this.index_.compare(next, this.rangedFilter_.getEndPost()) <= 0;\n          }\n          if (inRange) {\n            filtered = filtered.updateImmediateChild(next.name, next.node);\n            count++;\n          } else {\n            // if we have reached the end post, we cannot keep adding elemments\n            break;\n          }\n        }\n      } else {\n        // The snap contains less than twice the limit. Faster to delete from the snap than build up a new one\n        filtered = newSnap.withIndex(this.index_);\n        // Don't support priorities on queries\n        filtered = filtered.updatePriority(\n          ChildrenNode.EMPTY_NODE\n        ) as ChildrenNode;\n        let startPost;\n        let endPost;\n        let cmp;\n        let iterator;\n        if (this.reverse_) {\n          iterator = filtered.getReverseIterator(this.index_);\n          startPost = this.rangedFilter_.getEndPost();\n          endPost = this.rangedFilter_.getStartPost();\n          const indexCompare = this.index_.getCompare();\n          cmp = (a: NamedNode, b: NamedNode) => indexCompare(b, a);\n        } else {\n          iterator = filtered.getIterator(this.index_);\n          startPost = this.rangedFilter_.getStartPost();\n          endPost = this.rangedFilter_.getEndPost();\n          cmp = this.index_.getCompare();\n        }\n\n        let count = 0;\n        let foundStartPost = false;\n        while (iterator.hasNext()) {\n          let next = iterator.getNext();\n          if (!foundStartPost && cmp(startPost, next) <= 0) {\n            // start adding\n            foundStartPost = true;\n          }\n          let inRange =\n            foundStartPost && count < this.limit_ && cmp(next, endPost) <= 0;\n          if (inRange) {\n            count++;\n          } else {\n            filtered = filtered.updateImmediateChild(\n              next.name,\n              ChildrenNode.EMPTY_NODE\n            );\n          }\n        }\n      }\n    }\n    return this.rangedFilter_\n      .getIndexedFilter()\n      .updateFullNode(oldSnap, filtered, optChangeAccumulator);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    // Don't support priorities on queries\n    return oldSnap;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this.rangedFilter_.getIndexedFilter();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @param {!Node} snap\n   * @param {string} childKey\n   * @param {!Node} childSnap\n   * @param {!CompleteChildSource} source\n   * @param {?ChildChangeAccumulator} changeAccumulator\n   * @return {!Node}\n   * @private\n   */\n  private fullLimitUpdateChild_(\n    snap: Node,\n    childKey: string,\n    childSnap: Node,\n    source: CompleteChildSource,\n    changeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    // TODO: rename all cache stuff etc to general snap terminology\n    let cmp;\n    if (this.reverse_) {\n      const indexCmp = this.index_.getCompare();\n      cmp = (a: NamedNode, b: NamedNode) => indexCmp(b, a);\n    } else {\n      cmp = this.index_.getCompare();\n    }\n    const oldEventCache = snap as ChildrenNode;\n    assert(oldEventCache.numChildren() == this.limit_, '');\n    const newChildNamedNode = new NamedNode(childKey, childSnap);\n    const windowBoundary = this.reverse_\n      ? oldEventCache.getFirstChild(this.index_)\n      : (oldEventCache.getLastChild(this.index_) as NamedNode);\n    const inRange = this.rangedFilter_.matches(newChildNamedNode);\n    if (oldEventCache.hasChild(childKey)) {\n      const oldChildSnap = oldEventCache.getImmediateChild(childKey);\n      let nextChild = source.getChildAfterChild(\n        this.index_,\n        windowBoundary,\n        this.reverse_\n      );\n      while (\n        nextChild != null &&\n        (nextChild.name == childKey || oldEventCache.hasChild(nextChild.name))\n      ) {\n        // There is a weird edge case where a node is updated as part of a merge in the write tree, but hasn't\n        // been applied to the limited filter yet. Ignore this next child which will be updated later in\n        // the limited filter...\n        nextChild = source.getChildAfterChild(\n          this.index_,\n          nextChild,\n          this.reverse_\n        );\n      }\n      const compareNext =\n        nextChild == null ? 1 : cmp(nextChild, newChildNamedNode);\n      const remainsInWindow =\n        inRange && !childSnap.isEmpty() && compareNext >= 0;\n      if (remainsInWindow) {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childChangedChange(childKey, childSnap, oldChildSnap)\n          );\n        }\n        return oldEventCache.updateImmediateChild(childKey, childSnap);\n      } else {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childRemovedChange(childKey, oldChildSnap)\n          );\n        }\n        const newEventCache = oldEventCache.updateImmediateChild(\n          childKey,\n          ChildrenNode.EMPTY_NODE\n        );\n        const nextChildInRange =\n          nextChild != null && this.rangedFilter_.matches(nextChild);\n        if (nextChildInRange) {\n          if (changeAccumulator != null) {\n            changeAccumulator.trackChildChange(\n              Change.childAddedChange(nextChild.name, nextChild.node)\n            );\n          }\n          return newEventCache.updateImmediateChild(\n            nextChild.name,\n            nextChild.node\n          );\n        } else {\n          return newEventCache;\n        }\n      }\n    } else if (childSnap.isEmpty()) {\n      // we're deleting a node, but it was not in the window, so ignore it\n      return snap;\n    } else if (inRange) {\n      if (cmp(windowBoundary, newChildNamedNode) >= 0) {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childRemovedChange(windowBoundary.name, windowBoundary.node)\n          );\n          changeAccumulator.trackChildChange(\n            Change.childAddedChange(childKey, childSnap)\n          );\n        }\n        return oldEventCache\n          .updateImmediateChild(childKey, childSnap)\n          .updateImmediateChild(windowBoundary.name, ChildrenNode.EMPTY_NODE);\n      } else {\n        return snap;\n      }\n    } else {\n      return snap;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { MIN_NAME, MAX_NAME } from '../util/util';\nimport { KEY_INDEX } from '../snap/indexes/KeyIndex';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { VALUE_INDEX } from '../snap/indexes/ValueIndex';\nimport { PathIndex } from '../snap/indexes/PathIndex';\nimport { IndexedFilter } from './filter/IndexedFilter';\nimport { LimitedFilter } from './filter/LimitedFilter';\nimport { RangedFilter } from './filter/RangedFilter';\nimport { stringify } from '@firebase/util';\nimport { NodeFilter } from './filter/NodeFilter';\nimport { Index } from '../snap/indexes/Index';\n\n/**\n * This class is an immutable-from-the-public-api struct containing a set of query parameters defining a\n * range to be returned for a particular location. It is assumed that validation of parameters is done at the\n * user-facing API level, so it is not done here.\n * @constructor\n */\nexport class QueryParams {\n  private limitSet_ = false;\n  private startSet_ = false;\n  private startNameSet_ = false;\n  private endSet_ = false;\n  private endNameSet_ = false;\n\n  private limit_ = 0;\n  private viewFrom_ = '';\n  private indexStartValue_: any | null = null;\n  private indexStartName_ = '';\n  private indexEndValue_: any | null = null;\n  private indexEndName_ = '';\n\n  private index_ = PRIORITY_INDEX;\n\n  /**\n   * Wire Protocol Constants\n   * @const\n   * @enum {string}\n   * @private\n   */\n  private static readonly WIRE_PROTOCOL_CONSTANTS_ = {\n    INDEX_START_VALUE: 'sp',\n    INDEX_START_NAME: 'sn',\n    INDEX_END_VALUE: 'ep',\n    INDEX_END_NAME: 'en',\n    LIMIT: 'l',\n    VIEW_FROM: 'vf',\n    VIEW_FROM_LEFT: 'l',\n    VIEW_FROM_RIGHT: 'r',\n    INDEX: 'i'\n  };\n\n  /**\n   * REST Query Constants\n   * @const\n   * @enum {string}\n   * @private\n   */\n  private static readonly REST_QUERY_CONSTANTS_ = {\n    ORDER_BY: 'orderBy',\n    PRIORITY_INDEX: '$priority',\n    VALUE_INDEX: '$value',\n    KEY_INDEX: '$key',\n    START_AT: 'startAt',\n    END_AT: 'endAt',\n    LIMIT_TO_FIRST: 'limitToFirst',\n    LIMIT_TO_LAST: 'limitToLast'\n  };\n\n  /**\n   * Default, empty query parameters\n   * @type {!QueryParams}\n   * @const\n   */\n  static readonly DEFAULT = new QueryParams();\n\n  /**\n   * @return {boolean}\n   */\n  hasStart(): boolean {\n    return this.startSet_;\n  }\n\n  /**\n   * @return {boolean} True if it would return from left.\n   */\n  isViewFromLeft(): boolean {\n    if (this.viewFrom_ === '') {\n      // limit(), rather than limitToFirst or limitToLast was called.\n      // This means that only one of startSet_ and endSet_ is true. Use them\n      // to calculate which side of the view to anchor to. If neither is set,\n      // anchor to the end.\n      return this.startSet_;\n    } else {\n      return (\n        this.viewFrom_ === QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT\n      );\n    }\n  }\n\n  /**\n   * Only valid to call if hasStart() returns true\n   * @return {*}\n   */\n  getIndexStartValue(): any {\n    assert(this.startSet_, 'Only valid if start has been set');\n    return this.indexStartValue_;\n  }\n\n  /**\n   * Only valid to call if hasStart() returns true.\n   * Returns the starting key name for the range defined by these query parameters\n   * @return {!string}\n   */\n  getIndexStartName(): string {\n    assert(this.startSet_, 'Only valid if start has been set');\n    if (this.startNameSet_) {\n      return this.indexStartName_;\n    } else {\n      return MIN_NAME;\n    }\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasEnd(): boolean {\n    return this.endSet_;\n  }\n\n  /**\n   * Only valid to call if hasEnd() returns true.\n   * @return {*}\n   */\n  getIndexEndValue(): any {\n    assert(this.endSet_, 'Only valid if end has been set');\n    return this.indexEndValue_;\n  }\n\n  /**\n   * Only valid to call if hasEnd() returns true.\n   * Returns the end key name for the range defined by these query parameters\n   * @return {!string}\n   */\n  getIndexEndName(): string {\n    assert(this.endSet_, 'Only valid if end has been set');\n    if (this.endNameSet_) {\n      return this.indexEndName_;\n    } else {\n      return MAX_NAME;\n    }\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasLimit(): boolean {\n    return this.limitSet_;\n  }\n\n  /**\n   * @return {boolean} True if a limit has been set and it has been explicitly anchored\n   */\n  hasAnchoredLimit(): boolean {\n    return this.limitSet_ && this.viewFrom_ !== '';\n  }\n\n  /**\n   * Only valid to call if hasLimit() returns true\n   * @return {!number}\n   */\n  getLimit(): number {\n    assert(this.limitSet_, 'Only valid if limit has been set');\n    return this.limit_;\n  }\n\n  /**\n   * @return {!Index}\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @return {!QueryParams}\n   * @private\n   */\n  private copy_(): QueryParams {\n    const copy = new QueryParams();\n    copy.limitSet_ = this.limitSet_;\n    copy.limit_ = this.limit_;\n    copy.startSet_ = this.startSet_;\n    copy.indexStartValue_ = this.indexStartValue_;\n    copy.startNameSet_ = this.startNameSet_;\n    copy.indexStartName_ = this.indexStartName_;\n    copy.endSet_ = this.endSet_;\n    copy.indexEndValue_ = this.indexEndValue_;\n    copy.endNameSet_ = this.endNameSet_;\n    copy.indexEndName_ = this.indexEndName_;\n    copy.index_ = this.index_;\n    copy.viewFrom_ = this.viewFrom_;\n    return copy;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limit(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = '';\n    return newParams;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limitToFirst(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT;\n    return newParams;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limitToLast(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT;\n    return newParams;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {?string=} key\n   * @return {!QueryParams}\n   */\n  startAt(indexValue: any, key?: string | null): QueryParams {\n    const newParams = this.copy_();\n    newParams.startSet_ = true;\n    if (indexValue === undefined) {\n      indexValue = null;\n    }\n    newParams.indexStartValue_ = indexValue;\n    if (key != null) {\n      newParams.startNameSet_ = true;\n      newParams.indexStartName_ = key;\n    } else {\n      newParams.startNameSet_ = false;\n      newParams.indexStartName_ = '';\n    }\n    return newParams;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {?string=} key\n   * @return {!QueryParams}\n   */\n  endAt(indexValue: any, key?: string | null): QueryParams {\n    const newParams = this.copy_();\n    newParams.endSet_ = true;\n    if (indexValue === undefined) {\n      indexValue = null;\n    }\n    newParams.indexEndValue_ = indexValue;\n    if (key !== undefined) {\n      newParams.endNameSet_ = true;\n      newParams.indexEndName_ = key;\n    } else {\n      newParams.endNameSet_ = false;\n      newParams.indexEndName_ = '';\n    }\n    return newParams;\n  }\n\n  /**\n   * @param {!Index} index\n   * @return {!QueryParams}\n   */\n  orderBy(index: Index): QueryParams {\n    const newParams = this.copy_();\n    newParams.index_ = index;\n    return newParams;\n  }\n\n  /**\n   * @return {!Object}\n   */\n  getQueryObject(): Object {\n    const WIRE_PROTOCOL_CONSTANTS = QueryParams.WIRE_PROTOCOL_CONSTANTS_;\n    const obj: { [k: string]: any } = {};\n    if (this.startSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE] = this.indexStartValue_;\n      if (this.startNameSet_) {\n        obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME] = this.indexStartName_;\n      }\n    }\n    if (this.endSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE] = this.indexEndValue_;\n      if (this.endNameSet_) {\n        obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME] = this.indexEndName_;\n      }\n    }\n    if (this.limitSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.LIMIT] = this.limit_;\n      let viewFrom = this.viewFrom_;\n      if (viewFrom === '') {\n        if (this.isViewFromLeft()) {\n          viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT;\n        } else {\n          viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT;\n        }\n      }\n      obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM] = viewFrom;\n    }\n    // For now, priority index is the default, so we only specify if it's some other index\n    if (this.index_ !== PRIORITY_INDEX) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX] = this.index_.toString();\n    }\n    return obj;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  loadsAllData(): boolean {\n    return !(this.startSet_ || this.endSet_ || this.limitSet_);\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isDefault(): boolean {\n    return this.loadsAllData() && this.index_ == PRIORITY_INDEX;\n  }\n\n  /**\n   * @return {!NodeFilter}\n   */\n  getNodeFilter(): NodeFilter {\n    if (this.loadsAllData()) {\n      return new IndexedFilter(this.getIndex());\n    } else if (this.hasLimit()) {\n      return new LimitedFilter(this);\n    } else {\n      return new RangedFilter(this);\n    }\n  }\n\n  /**\n   * Returns a set of REST query string parameters representing this query.\n   *\n   * @return {!Object.<string,*>} query string parameters\n   */\n  toRestQueryStringParameters(): { [k: string]: any } {\n    const REST_CONSTANTS = QueryParams.REST_QUERY_CONSTANTS_;\n    const qs: { [k: string]: string | number } = {};\n\n    if (this.isDefault()) {\n      return qs;\n    }\n\n    let orderBy;\n    if (this.index_ === PRIORITY_INDEX) {\n      orderBy = REST_CONSTANTS.PRIORITY_INDEX;\n    } else if (this.index_ === VALUE_INDEX) {\n      orderBy = REST_CONSTANTS.VALUE_INDEX;\n    } else if (this.index_ === KEY_INDEX) {\n      orderBy = REST_CONSTANTS.KEY_INDEX;\n    } else {\n      assert(this.index_ instanceof PathIndex, 'Unrecognized index type!');\n      orderBy = this.index_.toString();\n    }\n    qs[REST_CONSTANTS.ORDER_BY] = stringify(orderBy);\n\n    if (this.startSet_) {\n      qs[REST_CONSTANTS.START_AT] = stringify(this.indexStartValue_);\n      if (this.startNameSet_) {\n        qs[REST_CONSTANTS.START_AT] += ',' + stringify(this.indexStartName_);\n      }\n    }\n\n    if (this.endSet_) {\n      qs[REST_CONSTANTS.END_AT] = stringify(this.indexEndValue_);\n      if (this.endNameSet_) {\n        qs[REST_CONSTANTS.END_AT] += ',' + stringify(this.indexEndName_);\n      }\n    }\n\n    if (this.limitSet_) {\n      if (this.isViewFromLeft()) {\n        qs[REST_CONSTANTS.LIMIT_TO_FIRST] = this.limit_;\n      } else {\n        qs[REST_CONSTANTS.LIMIT_TO_LAST] = this.limit_;\n      }\n    }\n\n    return qs;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OnDisconnect } from './onDisconnect';\nimport { TransactionResult } from './TransactionResult';\nimport { warn } from '../core/util/util';\nimport { nextPushId } from '../core/util/NextPushId';\nimport { Query } from './Query';\nimport { Repo } from '../core/Repo';\nimport { Path } from '../core/util/Path';\nimport { QueryParams } from '../core/view/QueryParams';\nimport {\n  validateRootPathString,\n  validatePathString,\n  validateFirebaseMergeDataArg,\n  validateBoolean,\n  validatePriority,\n  validateFirebaseDataArg,\n  validateWritablePath\n} from '../core/util/validation';\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport { Deferred } from '@firebase/util';\nimport { SyncPoint } from '../core/SyncPoint';\nimport { Database } from './Database';\nimport { DataSnapshot } from './DataSnapshot';\n\nexport interface ReferenceConstructor {\n  new (repo: Repo, path: Path): Reference;\n}\n\nexport class Reference extends Query {\n  public then: (a?: any) => Promise<any>;\n  public catch: (a?: Error) => Promise<any>;\n\n  /**\n   * Call options:\n   *   new Reference(Repo, Path) or\n   *   new Reference(url: string, string|RepoManager)\n   *\n   * Externally - this is the firebase.database.Reference type.\n   *\n   * @param {!Repo} repo\n   * @param {(!Path)} path\n   * @extends {Query}\n   */\n  constructor(repo: Repo, path: Path) {\n    if (!(repo instanceof Repo)) {\n      throw new Error(\n        'new Reference() no longer supported - use app.database().'\n      );\n    }\n\n    // call Query's constructor, passing in the repo and path.\n    super(repo, path, QueryParams.DEFAULT, false);\n  }\n\n  /** @return {?string} */\n  getKey(): string | null {\n    validateArgCount('Reference.key', 0, 0, arguments.length);\n\n    if (this.path.isEmpty()) return null;\n    else return this.path.getBack();\n  }\n\n  /**\n   * @param {!(string|Path)} pathString\n   * @return {!Reference}\n   */\n  child(pathString: string | Path): Reference {\n    validateArgCount('Reference.child', 1, 1, arguments.length);\n    if (typeof pathString === 'number') {\n      pathString = String(pathString);\n    } else if (!(pathString instanceof Path)) {\n      if (this.path.getFront() === null)\n        validateRootPathString('Reference.child', 1, pathString, false);\n      else validatePathString('Reference.child', 1, pathString, false);\n    }\n\n    return new Reference(this.repo, this.path.child(pathString));\n  }\n\n  /** @return {?Reference} */\n  getParent(): Reference | null {\n    validateArgCount('Reference.parent', 0, 0, arguments.length);\n\n    const parentPath = this.path.parent();\n    return parentPath === null ? null : new Reference(this.repo, parentPath);\n  }\n\n  /** @return {!Reference} */\n  getRoot(): Reference {\n    validateArgCount('Reference.root', 0, 0, arguments.length);\n\n    let ref = this as any;\n    while (ref.getParent() !== null) {\n      ref = ref.getParent();\n    }\n    return ref;\n  }\n\n  /** @return {!Database} */\n  databaseProp(): Database {\n    return this.repo.database;\n  }\n\n  /**\n   * @param {*} newVal\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  set(newVal: any, onComplete?: (a: Error | null) => void): Promise<any> {\n    validateArgCount('Reference.set', 1, 2, arguments.length);\n    validateWritablePath('Reference.set', this.path);\n    validateFirebaseDataArg('Reference.set', 1, newVal, this.path, false);\n    validateCallback('Reference.set', 2, onComplete, true);\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path,\n      newVal,\n      /*priority=*/ null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {!Object} objectToMerge\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  update(\n    objectToMerge: Object,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.update', 1, 2, arguments.length);\n    validateWritablePath('Reference.update', this.path);\n\n    if (Array.isArray(objectToMerge)) {\n      const newObjectToMerge: { [k: string]: any } = {};\n      for (let i = 0; i < objectToMerge.length; ++i) {\n        newObjectToMerge['' + i] = objectToMerge[i];\n      }\n      objectToMerge = newObjectToMerge;\n      warn(\n        'Passing an Array to Firebase.update() is deprecated. ' +\n          'Use set() if you want to overwrite the existing data, or ' +\n          'an Object with integer keys if you really do want to ' +\n          'only update some of the children.'\n      );\n    }\n    validateFirebaseMergeDataArg(\n      'Reference.update',\n      1,\n      objectToMerge,\n      this.path,\n      false\n    );\n    validateCallback('Reference.update', 2, onComplete, true);\n    const deferred = new Deferred();\n    this.repo.update(\n      this.path,\n      objectToMerge,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} newVal\n   * @param {string|number|null} newPriority\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  setWithPriority(\n    newVal: any,\n    newPriority: string | number | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.setWithPriority', 2, 3, arguments.length);\n    validateWritablePath('Reference.setWithPriority', this.path);\n    validateFirebaseDataArg(\n      'Reference.setWithPriority',\n      1,\n      newVal,\n      this.path,\n      false\n    );\n    validatePriority('Reference.setWithPriority', 2, newPriority, false);\n    validateCallback('Reference.setWithPriority', 3, onComplete, true);\n\n    if (this.getKey() === '.length' || this.getKey() === '.keys')\n      throw 'Reference.setWithPriority failed: ' +\n        this.getKey() +\n        ' is a read-only object.';\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path,\n      newVal,\n      newPriority,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  remove(onComplete?: (a: Error | null) => void): Promise<any> {\n    validateArgCount('Reference.remove', 0, 1, arguments.length);\n    validateWritablePath('Reference.remove', this.path);\n    validateCallback('Reference.remove', 1, onComplete, true);\n\n    return this.set(null, onComplete);\n  }\n\n  /**\n   * @param {function(*):*} transactionUpdate\n   * @param {(function(?Error, boolean, ?DataSnapshot))=} onComplete\n   * @param {boolean=} applyLocally\n   * @return {!Promise}\n   */\n  transaction(\n    transactionUpdate: (a: any) => any,\n    onComplete?: (a: Error | null, b: boolean, c: DataSnapshot | null) => void,\n    applyLocally?: boolean\n  ): Promise<TransactionResult> {\n    validateArgCount('Reference.transaction', 1, 3, arguments.length);\n    validateWritablePath('Reference.transaction', this.path);\n    validateCallback('Reference.transaction', 1, transactionUpdate, false);\n    validateCallback('Reference.transaction', 2, onComplete, true);\n    // NOTE: applyLocally is an internal-only option for now.  We need to decide if we want to keep it and how\n    // to expose it.\n    validateBoolean('Reference.transaction', 3, applyLocally, true);\n\n    if (this.getKey() === '.length' || this.getKey() === '.keys')\n      throw 'Reference.transaction failed: ' +\n        this.getKey() +\n        ' is a read-only object.';\n\n    if (applyLocally === undefined) applyLocally = true;\n\n    const deferred = new Deferred<TransactionResult>();\n    if (typeof onComplete === 'function') {\n      deferred.promise.catch(() => {});\n    }\n\n    const promiseComplete = function(\n      error: Error,\n      committed: boolean,\n      snapshot: DataSnapshot\n    ) {\n      if (error) {\n        deferred.reject(error);\n      } else {\n        deferred.resolve(new TransactionResult(committed, snapshot));\n      }\n      if (typeof onComplete === 'function') {\n        onComplete(error, committed, snapshot);\n      }\n    };\n    this.repo.startTransaction(\n      this.path,\n      transactionUpdate,\n      promiseComplete,\n      applyLocally\n    );\n\n    return deferred.promise;\n  }\n\n  /**\n   * @param {string|number|null} priority\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  setPriority(\n    priority: string | number | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.setPriority', 1, 2, arguments.length);\n    validateWritablePath('Reference.setPriority', this.path);\n    validatePriority('Reference.setPriority', 1, priority, false);\n    validateCallback('Reference.setPriority', 2, onComplete, true);\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path.child('.priority'),\n      priority,\n      null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*=} value\n   * @param {function(?Error)=} onComplete\n   * @return {!Reference}\n   */\n  push(value?: any, onComplete?: (a: Error | null) => void): Reference {\n    validateArgCount('Reference.push', 0, 2, arguments.length);\n    validateWritablePath('Reference.push', this.path);\n    validateFirebaseDataArg('Reference.push', 1, value, this.path, true);\n    validateCallback('Reference.push', 2, onComplete, true);\n\n    const now = this.repo.serverTime();\n    const name = nextPushId(now);\n\n    // push() returns a ThennableReference whose promise is fulfilled with a regular Reference.\n    // We use child() to create handles to two different references. The first is turned into a\n    // ThennableReference below by adding then() and catch() methods and is used as the\n    // return value of push(). The second remains a regular Reference and is used as the fulfilled\n    // value of the first ThennableReference.\n    const thennablePushRef = this.child(name);\n    const pushRef = this.child(name);\n\n    let promise;\n    if (value != null) {\n      promise = thennablePushRef.set(value, onComplete).then(() => pushRef);\n    } else {\n      promise = Promise.resolve(pushRef);\n    }\n\n    thennablePushRef.then = promise.then.bind(promise);\n    thennablePushRef.catch = promise.then.bind(promise, undefined);\n\n    if (typeof onComplete === 'function') {\n      promise.catch(() => {});\n    }\n\n    return thennablePushRef;\n  }\n\n  /**\n   * @return {!OnDisconnect}\n   */\n  onDisconnect(): OnDisconnect {\n    validateWritablePath('Reference.onDisconnect', this.path);\n    return new OnDisconnect(this.repo, this.path);\n  }\n\n  get database(): Database {\n    return this.databaseProp();\n  }\n\n  get key(): string | null {\n    return this.getKey();\n  }\n\n  get parent(): Reference | null {\n    return this.getParent();\n  }\n\n  get root(): Reference {\n    return this.getRoot();\n  }\n}\n\n/**\n * Define reference constructor in various modules\n *\n * We are doing this here to avoid several circular\n * dependency issues\n */\nQuery.__referenceConstructor = Reference;\nSyncPoint.__referenceConstructor = Reference;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from './Path';\nimport { forEach, contains, safeGet } from '@firebase/util';\n\n/**\n * Node in a Tree.\n */\nexport class TreeNode<T> {\n  // TODO: Consider making accessors that create children and value lazily or\n  // separate Internal / Leaf 'types'.\n  children: { [name: string]: TreeNode<T> } = {};\n  childCount = 0;\n  value: T | null = null;\n}\n\n/**\n * A light-weight tree, traversable by path.  Nodes can have both values and children.\n * Nodes are not enumerated (by forEachChild) unless they have a value or non-empty\n * children.\n */\nexport class Tree<T> {\n  /**\n   * @template T\n   * @param {string=} name_ Optional name of the node.\n   * @param {Tree=} parent_ Optional parent node.\n   * @param {TreeNode=} node_ Optional node to wrap.\n   */\n  constructor(\n    private name_: string = '',\n    private parent_: Tree<T> | null = null,\n    private node_: TreeNode<T> = new TreeNode<T>()\n  ) {}\n\n  /**\n   * Returns a sub-Tree for the given path.\n   *\n   * @param {!(string|Path)} pathObj Path to look up.\n   * @return {!Tree.<T>} Tree for path.\n   */\n  subTree(pathObj: string | Path): Tree<T> {\n    // TODO: Require pathObj to be Path?\n    let path = pathObj instanceof Path ? pathObj : new Path(pathObj);\n    let child = this as Tree<T>,\n      next;\n    while ((next = path.getFront()) !== null) {\n      const childNode = safeGet(child.node_.children, next) || new TreeNode();\n      child = new Tree(next, child, childNode);\n      path = path.popFront();\n    }\n\n    return child;\n  }\n\n  /**\n   * Returns the data associated with this tree node.\n   *\n   * @return {?T} The data or null if no data exists.\n   */\n  getValue(): T | null {\n    return this.node_.value;\n  }\n\n  /**\n   * Sets data to this tree node.\n   *\n   * @param {!T} value Value to set.\n   */\n  setValue(value: T) {\n    assert(typeof value !== 'undefined', 'Cannot set value to undefined');\n    this.node_.value = value;\n    this.updateParents_();\n  }\n\n  /**\n   * Clears the contents of the tree node (its value and all children).\n   */\n  clear() {\n    this.node_.value = null;\n    this.node_.children = {};\n    this.node_.childCount = 0;\n    this.updateParents_();\n  }\n\n  /**\n   * @return {boolean} Whether the tree has any children.\n   */\n  hasChildren(): boolean {\n    return this.node_.childCount > 0;\n  }\n\n  /**\n   * @return {boolean} Whether the tree is empty (no value or children).\n   */\n  isEmpty(): boolean {\n    return this.getValue() === null && !this.hasChildren();\n  }\n\n  /**\n   * Calls action for each child of this tree node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   */\n  forEachChild(action: (tree: Tree<T>) => void) {\n    forEach(this.node_.children, (child: string, childTree: TreeNode<T>) => {\n      action(new Tree<T>(child, this, childTree));\n    });\n  }\n\n  /**\n   * Does a depth-first traversal of this node's descendants, calling action for each one.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   * @param {boolean=} includeSelf Whether to call action on this node as well. Defaults to\n   *   false.\n   * @param {boolean=} childrenFirst Whether to call action on children before calling it on\n   *   parent.\n   */\n  forEachDescendant(\n    action: (tree: Tree<T>) => void,\n    includeSelf?: boolean,\n    childrenFirst?: boolean\n  ) {\n    if (includeSelf && !childrenFirst) action(this);\n\n    this.forEachChild(function(child) {\n      child.forEachDescendant(action, /*includeSelf=*/ true, childrenFirst);\n    });\n\n    if (includeSelf && childrenFirst) action(this);\n  }\n\n  /**\n   * Calls action on each ancestor node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called on each parent; return\n   *   true to abort.\n   * @param {boolean=} includeSelf Whether to call action on this node as well.\n   * @return {boolean} true if the action callback returned true.\n   */\n  forEachAncestor(\n    action: (tree: Tree<T>) => unknown,\n    includeSelf?: boolean\n  ): boolean {\n    let node = includeSelf ? this : this.parent();\n    while (node !== null) {\n      if (action(node)) {\n        return true;\n      }\n      node = node.parent();\n    }\n    return false;\n  }\n\n  /**\n   * Does a depth-first traversal of this node's descendants.  When a descendant with a value\n   * is found, action is called on it and traversal does not continue inside the node.\n   * Action is *not* called on this node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   */\n  forEachImmediateDescendantWithValue(action: (tree: Tree<T>) => void) {\n    this.forEachChild(function(child) {\n      if (child.getValue() !== null) action(child);\n      else child.forEachImmediateDescendantWithValue(action);\n    });\n  }\n\n  /**\n   * @return {!Path} The path of this tree node, as a Path.\n   */\n  path(): Path {\n    return new Path(\n      this.parent_ === null\n        ? this.name_\n        : this.parent_.path() + '/' + this.name_\n    );\n  }\n\n  /**\n   * @return {string} The name of the tree node.\n   */\n  name(): string {\n    return this.name_;\n  }\n\n  /**\n   * @return {?Tree} The parent tree node, or null if this is the root of the tree.\n   */\n  parent(): Tree<T> | null {\n    return this.parent_;\n  }\n\n  /**\n   * Adds or removes this child from its parent based on whether it's empty or not.\n   *\n   * @private\n   */\n  private updateParents_() {\n    if (this.parent_ !== null) this.parent_.updateChild_(this.name_, this);\n  }\n\n  /**\n   * Adds or removes the passed child to this tree node, depending on whether it's empty.\n   *\n   * @param {string} childName The name of the child to update.\n   * @param {!Tree.<T>} child The child to update.\n   * @private\n   */\n  private updateChild_(childName: string, child: Tree<T>) {\n    const childEmpty = child.isEmpty();\n    const childExists = contains(this.node_.children, childName);\n    if (childEmpty && childExists) {\n      delete this.node_.children[childName];\n      this.node_.childCount--;\n      this.updateParents_();\n    } else if (!childEmpty && !childExists) {\n      this.node_.children[childName] = child.node_;\n      this.node_.childCount++;\n      this.updateParents_();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Reference } from '../api/Reference';\nimport { DataSnapshot } from '../api/DataSnapshot';\nimport { Path } from './util/Path';\nimport { Tree } from './util/Tree';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { Node } from './snap/Node';\nimport { LUIDGenerator, warn, exceptionGuard } from './util/util';\nimport { resolveDeferredValueSnapshot } from './util/ServerValues';\nimport { isValidPriority, validateFirebaseData } from './util/validation';\nimport { contains, safeGet } from '@firebase/util';\nimport { nodeFromJSON } from './snap/nodeFromJSON';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { Repo } from './Repo';\nimport { Event } from './view/Event';\n\n// TODO: This is pretty messy.  Ideally, a lot of this would move into FirebaseData, or a transaction-specific\n// component used by FirebaseData, but it has ties to user callbacks (transaction update and onComplete) as well\n// as the realtime connection (to send transactions to the server).  So that all needs to be decoupled first.\n// For now it's part of Repo, but in its own file.\n\n/**\n * @enum {number}\n */\nexport enum TransactionStatus {\n  // We've run the transaction and updated transactionResultData_ with the result, but it isn't currently sent to the\n  // server. A transaction will go from RUN -> SENT -> RUN if it comes back from the server as rejected due to\n  // mismatched hash.\n  RUN,\n\n  // We've run the transaction and sent it to the server and it's currently outstanding (hasn't come back as accepted\n  // or rejected yet).\n  SENT,\n\n  // Temporary state used to mark completed transactions (whether successful or aborted).  The transaction will be\n  // removed when we get a chance to prune completed ones.\n  COMPLETED,\n\n  // Used when an already-sent transaction needs to be aborted (e.g. due to a conflicting set() call that was made).\n  // If it comes back as unsuccessful, we'll abort it.\n  SENT_NEEDS_ABORT,\n\n  // Temporary state used to mark transactions that need to be aborted.\n  NEEDS_ABORT\n}\n\n/**\n * If a transaction does not succeed after 25 retries, we abort it.  Among other things this ensure that if there's\n * ever a bug causing a mismatch between client / server hashes for some data, we won't retry indefinitely.\n * @type {number}\n * @const\n * @private\n */\n(Repo as any).MAX_TRANSACTION_RETRIES_ = 25;\n\n/**\n * @typedef {{\n *   path: !Path,\n *   update: function(*):*,\n *   onComplete: ?function(?Error, boolean, ?DataSnapshot),\n *   status: ?TransactionStatus,\n *   order: !number,\n *   applyLocally: boolean,\n *   retryCount: !number,\n *   unwatcher: function(),\n *   abortReason: ?string,\n *   currentWriteId: !number,\n *   currentInputSnapshot: ?Node,\n *   currentOutputSnapshotRaw: ?Node,\n *   currentOutputSnapshotResolved: ?Node\n * }}\n */\ntype Transaction = {\n  path: Path;\n  update: (a: any) => any;\n  onComplete: (a: Error | null, b: boolean, c: DataSnapshot | null) => void;\n  status: TransactionStatus;\n  order: number;\n  applyLocally: boolean;\n  retryCount: number;\n  unwatcher: () => void;\n  abortReason: string | null;\n  currentWriteId: number;\n  currentInputSnapshot: Node | null;\n  currentOutputSnapshotRaw: Node | null;\n  currentOutputSnapshotResolved: Node | null;\n};\n\n/**\n * Setup the transaction data structures\n * @private\n */\n(Repo.prototype as any).transactions_init_ = function() {\n  /**\n   * Stores queues of outstanding transactions for Firebase locations.\n   *\n   * @type {!Tree.<Array.<!Transaction>>}\n   * @private\n   */\n  this.transactionQueueTree_ = new Tree<Transaction[]>();\n};\n\ndeclare module './Repo' {\n  interface Repo {\n    startTransaction(\n      path: Path,\n      transactionUpdate: (a: any) => void,\n      onComplete: ((a: Error, b: boolean, c: DataSnapshot) => void) | null,\n      applyLocally: boolean\n    ): void;\n  }\n}\n\n/**\n * Creates a new transaction, adds it to the transactions we're tracking, and sends it to the server if possible.\n *\n * @param {!Path} path Path at which to do transaction.\n * @param {function(*):*} transactionUpdate Update callback.\n * @param {?function(?Error, boolean, ?DataSnapshot)} onComplete Completion callback.\n * @param {boolean} applyLocally Whether or not to make intermediate results visible\n */\nRepo.prototype.startTransaction = function(\n  path: Path,\n  transactionUpdate: (a: any) => any,\n  onComplete: ((a: Error, b: boolean, c: DataSnapshot) => void) | null,\n  applyLocally: boolean\n) {\n  this.log_('transaction on ' + path);\n\n  // Add a watch to make sure we get server updates.\n  const valueCallback = function() {};\n  const watchRef = new Reference(this, path);\n  watchRef.on('value', valueCallback);\n  const unwatcher = function() {\n    watchRef.off('value', valueCallback);\n  };\n\n  // Initialize transaction.\n  const transaction: Transaction = {\n    path,\n    update: transactionUpdate,\n    onComplete,\n\n    // One of TransactionStatus enums.\n    status: null,\n\n    // Used when combining transactions at different locations to figure out which one goes first.\n    order: LUIDGenerator(),\n\n    // Whether to raise local events for this transaction.\n    applyLocally: applyLocally,\n\n    // Count of how many times we've retried the transaction.\n    retryCount: 0,\n\n    // Function to call to clean up our .on() listener.\n    unwatcher,\n\n    // Stores why a transaction was aborted.\n    abortReason: null,\n\n    currentWriteId: null,\n\n    currentInputSnapshot: null,\n\n    currentOutputSnapshotRaw: null,\n\n    currentOutputSnapshotResolved: null\n  };\n\n  // Run transaction initially.\n  const currentState = this.getLatestState_(path);\n  transaction.currentInputSnapshot = currentState;\n  const newVal = transaction.update(currentState.val());\n  if (newVal === undefined) {\n    // Abort transaction.\n    transaction.unwatcher();\n    transaction.currentOutputSnapshotRaw = null;\n    transaction.currentOutputSnapshotResolved = null;\n    if (transaction.onComplete) {\n      // We just set the input snapshot, so this cast should be safe\n      const snapshot = new DataSnapshot(\n        transaction.currentInputSnapshot,\n        new Reference(this, transaction.path),\n        PRIORITY_INDEX\n      );\n      transaction.onComplete(null, false, snapshot);\n    }\n  } else {\n    validateFirebaseData(\n      'transaction failed: Data returned ',\n      newVal,\n      transaction.path\n    );\n\n    // Mark as run and add to our queue.\n    transaction.status = TransactionStatus.RUN;\n    const queueNode = this.transactionQueueTree_.subTree(path);\n    const nodeQueue = queueNode.getValue() || [];\n    nodeQueue.push(transaction);\n\n    queueNode.setValue(nodeQueue);\n\n    // Update visibleData and raise events\n    // Note: We intentionally raise events after updating all of our transaction state, since the user could\n    // start new transactions from the event callbacks.\n    let priorityForNode;\n    if (\n      typeof newVal === 'object' &&\n      newVal !== null &&\n      contains(newVal, '.priority')\n    ) {\n      priorityForNode = safeGet(newVal, '.priority');\n      assert(\n        isValidPriority(priorityForNode),\n        'Invalid priority returned by transaction. ' +\n          'Priority must be a valid string, finite number, server value, or null.'\n      );\n    } else {\n      const currentNode =\n        this.serverSyncTree_.calcCompleteEventCache(path) ||\n        ChildrenNode.EMPTY_NODE;\n      priorityForNode = currentNode.getPriority().val();\n    }\n    priorityForNode /** @type {null|number|string} */ = priorityForNode;\n\n    const serverValues = this.generateServerValues();\n    const newNodeUnresolved = nodeFromJSON(newVal, priorityForNode);\n    const newNode = resolveDeferredValueSnapshot(\n      newNodeUnresolved,\n      serverValues\n    );\n    transaction.currentOutputSnapshotRaw = newNodeUnresolved;\n    transaction.currentOutputSnapshotResolved = newNode;\n    transaction.currentWriteId = this.getNextWriteId_();\n\n    const events = this.serverSyncTree_.applyUserOverwrite(\n      path,\n      newNode,\n      transaction.currentWriteId,\n      transaction.applyLocally\n    );\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n\n    this.sendReadyTransactions_();\n  }\n};\n\n/**\n * @param {!Path} path\n * @param {Array.<number>=} excludeSets A specific set to exclude\n * @return {Node}\n * @private\n */\n(Repo.prototype as any).getLatestState_ = function(\n  path: Path,\n  excludeSets?: number[]\n): Node {\n  return (\n    this.serverSyncTree_.calcCompleteEventCache(path, excludeSets) ||\n    ChildrenNode.EMPTY_NODE\n  );\n};\n\n/**\n * Sends any already-run transactions that aren't waiting for outstanding transactions to\n * complete.\n *\n * Externally it's called with no arguments, but it calls itself recursively with a particular\n * transactionQueueTree node to recurse through the tree.\n *\n * @param {Tree.<Array.<Transaction>>=} node  transactionQueueTree node to start at.\n * @private\n */\n(Repo.prototype as any).sendReadyTransactions_ = function(\n  node: Tree<Transaction[]> = this.transactionQueueTree_\n) {\n  // Before recursing, make sure any completed transactions are removed.\n  if (!node) {\n    this.pruneCompletedTransactionsBelowNode_(node);\n  }\n\n  if (node.getValue() !== null) {\n    const queue = this.buildTransactionQueue_(node);\n    assert(queue.length > 0, 'Sending zero length transaction queue');\n\n    const allRun = queue.every(\n      (transaction: Transaction) => transaction.status === TransactionStatus.RUN\n    );\n\n    // If they're all run (and not sent), we can send them.  Else, we must wait.\n    if (allRun) {\n      this.sendTransactionQueue_(node.path(), queue);\n    }\n  } else if (node.hasChildren()) {\n    node.forEachChild(childNode => {\n      this.sendReadyTransactions_(childNode);\n    });\n  }\n};\n\n/**\n * Given a list of run transactions, send them to the server and then handle the result (success or failure).\n *\n * @param {!Path} path The location of the queue.\n * @param {!Array.<Transaction>} queue Queue of transactions under the specified location.\n * @private\n */\n(Repo.prototype as any).sendTransactionQueue_ = function(\n  path: Path,\n  queue: Array<Transaction>\n) {\n  // Mark transactions as sent and increment retry count!\n  const setsToIgnore = queue.map(function(txn) {\n    return txn.currentWriteId;\n  });\n  const latestState = this.getLatestState_(path, setsToIgnore);\n  let snapToSend = latestState;\n  const latestHash = latestState.hash();\n  for (let i = 0; i < queue.length; i++) {\n    const txn = queue[i];\n    assert(\n      txn.status === TransactionStatus.RUN,\n      'tryToSendTransactionQueue_: items in queue should all be run.'\n    );\n    txn.status = TransactionStatus.SENT;\n    txn.retryCount++;\n    const relativePath = Path.relativePath(path, txn.path);\n    // If we've gotten to this point, the output snapshot must be defined.\n    snapToSend = snapToSend.updateChild(\n      relativePath /**@type {!Node} */,\n      txn.currentOutputSnapshotRaw\n    );\n  }\n\n  const dataToSend = snapToSend.val(true);\n  const pathToSend = path;\n\n  // Send the put.\n  this.server_.put(\n    pathToSend.toString(),\n    dataToSend,\n    (status: string) => {\n      this.log_('transaction put response', {\n        path: pathToSend.toString(),\n        status\n      });\n\n      let events: Event[] = [];\n      if (status === 'ok') {\n        // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n        // the callback could trigger more transactions or sets.\n        const callbacks = [];\n        for (let i = 0; i < queue.length; i++) {\n          queue[i].status = TransactionStatus.COMPLETED;\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId)\n          );\n          if (queue[i].onComplete) {\n            // We never unset the output snapshot, and given that this transaction is complete, it should be set\n            const node = queue[i].currentOutputSnapshotResolved as Node;\n            const ref = new Reference(this, queue[i].path);\n            const snapshot = new DataSnapshot(node, ref, PRIORITY_INDEX);\n            callbacks.push(\n              queue[i].onComplete.bind(null, null, true, snapshot)\n            );\n          }\n          queue[i].unwatcher();\n        }\n\n        // Now remove the completed transactions.\n        this.pruneCompletedTransactionsBelowNode_(\n          this.transactionQueueTree_.subTree(path)\n        );\n        // There may be pending transactions that we can now send.\n        this.sendReadyTransactions_();\n\n        this.eventQueue_.raiseEventsForChangedPath(path, events);\n\n        // Finally, trigger onComplete callbacks.\n        for (let i = 0; i < callbacks.length; i++) {\n          exceptionGuard(callbacks[i]);\n        }\n      } else {\n        // transactions are no longer sent.  Update their status appropriately.\n        if (status === 'datastale') {\n          for (let i = 0; i < queue.length; i++) {\n            if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT)\n              queue[i].status = TransactionStatus.NEEDS_ABORT;\n            else queue[i].status = TransactionStatus.RUN;\n          }\n        } else {\n          warn(\n            'transaction at ' + pathToSend.toString() + ' failed: ' + status\n          );\n          for (let i = 0; i < queue.length; i++) {\n            queue[i].status = TransactionStatus.NEEDS_ABORT;\n            queue[i].abortReason = status;\n          }\n        }\n\n        this.rerunTransactions_(path);\n      }\n    },\n    latestHash\n  );\n};\n\n/**\n * Finds all transactions dependent on the data at changedPath and reruns them.\n *\n * Should be called any time cached data changes.\n *\n * Return the highest path that was affected by rerunning transactions.  This is the path at which events need to\n * be raised for.\n *\n * @param {!Path} changedPath The path in mergedData that changed.\n * @return {!Path} The rootmost path that was affected by rerunning transactions.\n * @private\n */\n(Repo.prototype as any).rerunTransactions_ = function(changedPath: Path): Path {\n  const rootMostTransactionNode = this.getAncestorTransactionNode_(changedPath);\n  const path = rootMostTransactionNode.path();\n\n  const queue = this.buildTransactionQueue_(rootMostTransactionNode);\n  this.rerunTransactionQueue_(queue, path);\n\n  return path;\n};\n\n/**\n * Does all the work of rerunning transactions (as well as cleans up aborted transactions and whatnot).\n *\n * @param {Array.<Transaction>} queue The queue of transactions to run.\n * @param {!Path} path The path the queue is for.\n * @private\n */\n(Repo.prototype as any).rerunTransactionQueue_ = function(\n  queue: Array<Transaction>,\n  path: Path\n) {\n  if (queue.length === 0) {\n    return; // Nothing to do!\n  }\n\n  // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n  // the callback could trigger more transactions or sets.\n  const callbacks = [];\n  let events: Event[] = [];\n  // Ignore all of the sets we're going to re-run.\n  const txnsToRerun = queue.filter(function(q) {\n    return q.status === TransactionStatus.RUN;\n  });\n  const setsToIgnore = txnsToRerun.map(function(q) {\n    return q.currentWriteId;\n  });\n  for (let i = 0; i < queue.length; i++) {\n    const transaction = queue[i];\n    const relativePath = Path.relativePath(path, transaction.path);\n    let abortTransaction = false,\n      abortReason;\n    assert(\n      relativePath !== null,\n      'rerunTransactionsUnderNode_: relativePath should not be null.'\n    );\n\n    if (transaction.status === TransactionStatus.NEEDS_ABORT) {\n      abortTransaction = true;\n      abortReason = transaction.abortReason;\n      events = events.concat(\n        this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n      );\n    } else if (transaction.status === TransactionStatus.RUN) {\n      if (transaction.retryCount >= (Repo as any).MAX_TRANSACTION_RETRIES_) {\n        abortTransaction = true;\n        abortReason = 'maxretry';\n        events = events.concat(\n          this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n        );\n      } else {\n        // This code reruns a transaction\n        const currentNode = this.getLatestState_(\n          transaction.path,\n          setsToIgnore\n        );\n        transaction.currentInputSnapshot = currentNode;\n        const newData = queue[i].update(currentNode.val());\n        if (newData !== undefined) {\n          validateFirebaseData(\n            'transaction failed: Data returned ',\n            newData,\n            transaction.path\n          );\n          let newDataNode = nodeFromJSON(newData);\n          const hasExplicitPriority =\n            typeof newData === 'object' &&\n            newData != null &&\n            contains(newData, '.priority');\n          if (!hasExplicitPriority) {\n            // Keep the old priority if there wasn't a priority explicitly specified.\n            newDataNode = newDataNode.updatePriority(currentNode.getPriority());\n          }\n\n          const oldWriteId = transaction.currentWriteId;\n          const serverValues = this.generateServerValues();\n          const newNodeResolved = resolveDeferredValueSnapshot(\n            newDataNode,\n            serverValues\n          );\n\n          transaction.currentOutputSnapshotRaw = newDataNode;\n          transaction.currentOutputSnapshotResolved = newNodeResolved;\n          transaction.currentWriteId = this.getNextWriteId_();\n          // Mutates setsToIgnore in place\n          setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId), 1);\n          events = events.concat(\n            this.serverSyncTree_.applyUserOverwrite(\n              transaction.path,\n              newNodeResolved,\n              transaction.currentWriteId,\n              transaction.applyLocally\n            )\n          );\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(oldWriteId, true)\n          );\n        } else {\n          abortTransaction = true;\n          abortReason = 'nodata';\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n          );\n        }\n      }\n    }\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n    events = [];\n    if (abortTransaction) {\n      // Abort.\n      queue[i].status = TransactionStatus.COMPLETED;\n\n      // Removing a listener can trigger pruning which can muck with mergedData/visibleData (as it prunes data).\n      // So defer the unwatcher until we're done.\n      (function(unwatcher) {\n        setTimeout(unwatcher, Math.floor(0));\n      })(queue[i].unwatcher);\n\n      if (queue[i].onComplete) {\n        if (abortReason === 'nodata') {\n          const ref = new Reference(this, queue[i].path);\n          // We set this field immediately, so it's safe to cast to an actual snapshot\n          const lastInput /** @type {!Node} */ = queue[i].currentInputSnapshot;\n          const snapshot = new DataSnapshot(lastInput, ref, PRIORITY_INDEX);\n          callbacks.push(queue[i].onComplete.bind(null, null, false, snapshot));\n        } else {\n          callbacks.push(\n            queue[i].onComplete.bind(null, new Error(abortReason), false, null)\n          );\n        }\n      }\n    }\n  }\n\n  // Clean up completed transactions.\n  this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);\n\n  // Now fire callbacks, now that we're in a good, known state.\n  for (let i = 0; i < callbacks.length; i++) {\n    exceptionGuard(callbacks[i]);\n  }\n\n  // Try to send the transaction result to the server.\n  this.sendReadyTransactions_();\n};\n\n/**\n * Returns the rootmost ancestor node of the specified path that has a pending transaction on it, or just returns\n * the node for the given path if there are no pending transactions on any ancestor.\n *\n * @param {!Path} path The location to start at.\n * @return {!Tree.<Array.<!Transaction>>} The rootmost node with a transaction.\n * @private\n */\n(Repo.prototype as any).getAncestorTransactionNode_ = function(\n  path: Path\n): Tree<Transaction[]> {\n  let front;\n\n  // Start at the root and walk deeper into the tree towards path until we find a node with pending transactions.\n  let transactionNode = this.transactionQueueTree_;\n  while (\n    (front = path.getFront()) !== null &&\n    transactionNode.getValue() === null\n  ) {\n    transactionNode = transactionNode.subTree(front);\n    path = path.popFront();\n  }\n\n  return transactionNode;\n};\n\n/**\n * Builds the queue of all transactions at or below the specified transactionNode.\n *\n * @param {!Tree.<Array.<Transaction>>} transactionNode\n * @return {Array.<Transaction>} The generated queue.\n * @private\n */\n(Repo.prototype as any).buildTransactionQueue_ = function(\n  transactionNode: Tree<Transaction[]>\n): Array<Transaction> {\n  // Walk any child transaction queues and aggregate them into a single queue.\n  const transactionQueue: Transaction[] = [];\n  this.aggregateTransactionQueuesForNode_(transactionNode, transactionQueue);\n\n  // Sort them by the order the transactions were created.\n  transactionQueue.sort(function(a, b) {\n    return a.order - b.order;\n  });\n\n  return transactionQueue;\n};\n\n/**\n * @param {!Tree.<Array.<Transaction>>} node\n * @param {Array.<Transaction>} queue\n * @private\n */\n(Repo.prototype as any).aggregateTransactionQueuesForNode_ = function(\n  node: Tree<Transaction[]>,\n  queue: Array<Transaction>\n) {\n  const nodeQueue = node.getValue();\n  if (nodeQueue !== null) {\n    for (let i = 0; i < nodeQueue.length; i++) {\n      queue.push(nodeQueue[i]);\n    }\n  }\n\n  node.forEachChild(child => {\n    this.aggregateTransactionQueuesForNode_(child, queue);\n  });\n};\n\n/**\n * Remove COMPLETED transactions at or below this node in the transactionQueueTree_.\n *\n * @param {!Tree.<Array.<!Transaction>>} node\n * @private\n */\n(Repo.prototype as any).pruneCompletedTransactionsBelowNode_ = function(\n  node: Tree<Transaction[]>\n) {\n  const queue = node.getValue();\n  if (queue) {\n    let to = 0;\n    for (let from = 0; from < queue.length; from++) {\n      if (queue[from].status !== TransactionStatus.COMPLETED) {\n        queue[to] = queue[from];\n        to++;\n      }\n    }\n    queue.length = to;\n    node.setValue(queue.length > 0 ? queue : null);\n  }\n\n  node.forEachChild(childNode => {\n    this.pruneCompletedTransactionsBelowNode_(childNode);\n  });\n};\n\n/**\n * Aborts all transactions on ancestors or descendants of the specified path.  Called when doing a set() or update()\n * since we consider them incompatible with transactions.\n *\n * @param {!Path} path Path for which we want to abort related transactions.\n * @return {!Path}\n * @private\n */\n(Repo.prototype as any).abortTransactions_ = function(path: Path): Path {\n  const affectedPath = this.getAncestorTransactionNode_(path).path();\n\n  const transactionNode = this.transactionQueueTree_.subTree(path);\n\n  transactionNode.forEachAncestor((node: Tree<Transaction[]>) => {\n    this.abortTransactionsOnNode_(node);\n  });\n\n  this.abortTransactionsOnNode_(transactionNode);\n\n  transactionNode.forEachDescendant((node: Tree<Transaction[]>) => {\n    this.abortTransactionsOnNode_(node);\n  });\n\n  return affectedPath;\n};\n\n/**\n * Abort transactions stored in this transaction queue node.\n *\n * @param {!Tree.<Array.<Transaction>>} node Node to abort transactions for.\n * @private\n */\n(Repo.prototype as any).abortTransactionsOnNode_ = function(\n  node: Tree<Transaction[]>\n) {\n  const queue = node.getValue();\n  if (queue !== null) {\n    // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n    // the callback could trigger more transactions or sets.\n    const callbacks = [];\n\n    // Go through queue.  Any already-sent transactions must be marked for abort, while the unsent ones\n    // can be immediately aborted and removed.\n    let events: Event[] = [];\n    let lastSent = -1;\n    for (let i = 0; i < queue.length; i++) {\n      if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT) {\n        // Already marked.  No action needed.\n      } else if (queue[i].status === TransactionStatus.SENT) {\n        assert(\n          lastSent === i - 1,\n          'All SENT items should be at beginning of queue.'\n        );\n        lastSent = i;\n        // Mark transaction for abort when it comes back.\n        queue[i].status = TransactionStatus.SENT_NEEDS_ABORT;\n        queue[i].abortReason = 'set';\n      } else {\n        assert(\n          queue[i].status === TransactionStatus.RUN,\n          'Unexpected transaction status in abort'\n        );\n        // We can abort it immediately.\n        queue[i].unwatcher();\n        events = events.concat(\n          this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId, true)\n        );\n        if (queue[i].onComplete) {\n          const snapshot: DataSnapshot | null = null;\n          callbacks.push(\n            queue[i].onComplete.bind(null, new Error('set'), false, snapshot)\n          );\n        }\n      }\n    }\n    if (lastSent === -1) {\n      // We're not waiting for any sent transactions.  We can clear the queue.\n      node.setValue(null);\n    } else {\n      // Remove the transactions we aborted.\n      queue.length = lastSent + 1;\n    }\n\n    // Now fire the callbacks.\n    this.eventQueue_.raiseEventsForChangedPath(node.path(), events);\n    for (let i = 0; i < callbacks.length; i++) {\n      exceptionGuard(callbacks[i]);\n    }\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseApp } from '@firebase/app-types';\nimport { safeGet } from '@firebase/util';\nimport { Repo } from './Repo';\nimport { fatal } from './util/util';\nimport { parseRepoInfo } from './util/libs/parser';\nimport { validateUrl } from './util/validation';\nimport './Repo_transaction';\nimport { Database } from '../api/Database';\nimport { RepoInfo } from './RepoInfo';\n\n/** @const {string} */\nconst DATABASE_URL_OPTION = 'databaseURL';\n\nlet _staticInstance: RepoManager;\n\n/**\n * Creates and caches Repo instances.\n */\nexport class RepoManager {\n  /**\n   * @private {!Object.<string, Object<string, !fb.core.Repo>>}\n   */\n  private repos_: {\n    [appName: string]: {\n      [dbUrl: string]: Repo;\n    };\n  } = {};\n\n  /**\n   * If true, new Repos will be created to use ReadonlyRestClient (for testing purposes).\n   * @private {boolean}\n   */\n  private useRestClient_: boolean = false;\n\n  static getInstance(): RepoManager {\n    if (!_staticInstance) {\n      _staticInstance = new RepoManager();\n    }\n    return _staticInstance;\n  }\n\n  // TODO(koss): Remove these functions unless used in tests?\n  interrupt() {\n    for (const appName in this.repos_) {\n      for (const dbUrl in this.repos_[appName]) {\n        this.repos_[appName][dbUrl].interrupt();\n      }\n    }\n  }\n\n  resume() {\n    for (const appName in this.repos_) {\n      for (const dbUrl in this.repos_[appName]) {\n        this.repos_[appName][dbUrl].resume();\n      }\n    }\n  }\n\n  /**\n   * This function should only ever be called to CREATE a new database instance.\n   *\n   * @param {!FirebaseApp} app\n   * @return {!Database}\n   */\n  databaseFromApp(app: FirebaseApp, url?: string): Database {\n    const dbUrl: string = url || app.options[DATABASE_URL_OPTION];\n    if (dbUrl === undefined) {\n      fatal(\n        \"Can't determine Firebase Database URL.  Be sure to include \" +\n          DATABASE_URL_OPTION +\n          ' option when calling firebase.initializeApp().'\n      );\n    }\n\n    const parsedUrl = parseRepoInfo(dbUrl);\n    const repoInfo = parsedUrl.repoInfo;\n\n    validateUrl('Invalid Firebase Database URL', 1, parsedUrl);\n    if (!parsedUrl.path.isEmpty()) {\n      fatal(\n        'Database URL must point to the root of a Firebase Database ' +\n          '(not including a child path).'\n      );\n    }\n\n    const repo = this.createRepo(repoInfo, app);\n\n    return repo.database;\n  }\n\n  /**\n   * Remove the repo and make sure it is disconnected.\n   *\n   * @param {!Repo} repo\n   */\n  deleteRepo(repo: Repo) {\n    const appRepos = safeGet(this.repos_, repo.app.name);\n    // This should never happen...\n    if (!appRepos || safeGet(appRepos, repo.repoInfo_.toURLString()) !== repo) {\n      fatal(\n        `Database ${repo.app.name}(${repo.repoInfo_}) has already been deleted.`\n      );\n    }\n    repo.interrupt();\n    delete appRepos[repo.repoInfo_.toURLString()];\n  }\n\n  /**\n   * Ensures a repo doesn't already exist and then creates one using the\n   * provided app.\n   *\n   * @param {!RepoInfo} repoInfo The metadata about the Repo\n   * @param {!FirebaseApp} app\n   * @return {!Repo} The Repo object for the specified server / repoName.\n   */\n  createRepo(repoInfo: RepoInfo, app: FirebaseApp): Repo {\n    let appRepos = safeGet(this.repos_, app.name);\n\n    if (!appRepos) {\n      appRepos = {};\n      this.repos_[app.name] = appRepos;\n    }\n\n    let repo = safeGet(appRepos, repoInfo.toURLString());\n    if (repo) {\n      fatal(\n        'Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.'\n      );\n    }\n    repo = new Repo(repoInfo, this.useRestClient_, app);\n    appRepos[repoInfo.toURLString()] = repo;\n\n    return repo;\n  }\n\n  /**\n   * Forces us to use ReadonlyRestClient instead of PersistentConnection for new Repos.\n   * @param {boolean} forceRestClient\n   */\n  forceRestClient(forceRestClient: boolean) {\n    this.useRestClient_ = forceRestClient;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { fatal } from '../core/util/util';\nimport { parseRepoInfo } from '../core/util/libs/parser';\nimport { Path } from '../core/util/Path';\nimport { Reference } from './Reference';\nimport { Repo } from '../core/Repo';\nimport { RepoManager } from '../core/RepoManager';\nimport { validateArgCount } from '@firebase/util';\nimport { validateUrl } from '../core/util/validation';\nimport { FirebaseApp } from '@firebase/app-types';\nimport { FirebaseService } from '@firebase/app-types/private';\nimport { RepoInfo } from '../core/RepoInfo';\n\n/**\n * Class representing a firebase database.\n * @implements {FirebaseService}\n */\nexport class Database implements FirebaseService {\n  INTERNAL: DatabaseInternals;\n  private root_: Reference;\n\n  static readonly ServerValue = {\n    TIMESTAMP: {\n      '.sv': 'timestamp'\n    }\n  };\n\n  /**\n   * The constructor should not be called by users of our public API.\n   * @param {!Repo} repo_\n   */\n  constructor(private repo_: Repo) {\n    if (!(repo_ instanceof Repo)) {\n      fatal(\n        \"Don't call new Database() directly - please use firebase.database().\"\n      );\n    }\n\n    /** @type {Reference} */\n    this.root_ = new Reference(repo_, Path.Empty);\n\n    this.INTERNAL = new DatabaseInternals(this);\n  }\n\n  get app(): FirebaseApp {\n    return this.repo_.app;\n  }\n\n  /**\n   * Returns a reference to the root or to the path specified in the provided\n   * argument.\n\n   * @param {string|Reference=} path The relative string path or an existing\n   * Reference to a database location.\n   * @throws If a Reference is provided, throws if it does not belong to the\n   * same project.\n   * @return {!Reference} Firebase reference.\n   **/\n  ref(path?: string): Reference;\n  ref(path?: Reference): Reference;\n  ref(path?: string | Reference): Reference {\n    this.checkDeleted_('ref');\n    validateArgCount('database.ref', 0, 1, arguments.length);\n\n    if (path instanceof Reference) {\n      return this.refFromURL(path.toString());\n    }\n\n    return path !== undefined ? this.root_.child(path) : this.root_;\n  }\n\n  /**\n   * Returns a reference to the root or the path specified in url.\n   * We throw a exception if the url is not in the same domain as the\n   * current repo.\n   * @param {string} url\n   * @return {!Reference} Firebase reference.\n   */\n  refFromURL(url: string): Reference {\n    /** @const {string} */\n    const apiName = 'database.refFromURL';\n    this.checkDeleted_(apiName);\n    validateArgCount(apiName, 1, 1, arguments.length);\n    const parsedURL = parseRepoInfo(url);\n    validateUrl(apiName, 1, parsedURL);\n\n    const repoInfo = parsedURL.repoInfo;\n    if (repoInfo.host !== ((this.repo_ as any).repoInfo_ as RepoInfo).host) {\n      fatal(\n        apiName +\n          ': Host name does not match the current database: ' +\n          '(found ' +\n          repoInfo.host +\n          ' but expected ' +\n          ((this.repo_ as any).repoInfo_ as RepoInfo).host +\n          ')'\n      );\n    }\n\n    return this.ref(parsedURL.path.toString());\n  }\n\n  /**\n   * @param {string} apiName\n   */\n  private checkDeleted_(apiName: string) {\n    if (this.repo_ === null) {\n      fatal('Cannot call ' + apiName + ' on a deleted database.');\n    }\n  }\n\n  // Make individual repo go offline.\n  goOffline() {\n    validateArgCount('database.goOffline', 0, 0, arguments.length);\n    this.checkDeleted_('goOffline');\n    this.repo_.interrupt();\n  }\n\n  goOnline() {\n    validateArgCount('database.goOnline', 0, 0, arguments.length);\n    this.checkDeleted_('goOnline');\n    this.repo_.resume();\n  }\n}\n\nexport class DatabaseInternals {\n  /** @param {!Database} database */\n  constructor(public database: Database) {}\n\n  /** @return {Promise<void>} */\n  async delete(): Promise<void> {\n    (this.database as any).checkDeleted_('delete');\n    RepoManager.getInstance().deleteRepo((this.database as any).repo_ as Repo);\n\n    (this.database as any).repo_ = null;\n    (this.database as any).root_ = null;\n    this.database.INTERNAL = null;\n    this.database = null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WebSocketConnection } from '../realtime/WebSocketConnection';\nimport { BrowserPollConnection } from '../realtime/BrowserPollConnection';\nimport { Reference } from './Reference';\n\n/**\n * INTERNAL methods for internal-use only (tests, etc.).\n *\n * Customers shouldn't use these or else should be aware that they could break at any time.\n *\n * @const\n */\n\nexport const forceLongPolling = function() {\n  WebSocketConnection.forceDisallow();\n  BrowserPollConnection.forceAllow();\n};\n\nexport const forceWebSockets = function() {\n  BrowserPollConnection.forceDisallow();\n};\n\n/* Used by App Manager */\nexport const isWebSocketsAvailable = function(): boolean {\n  return WebSocketConnection['isAvailable']();\n};\n\nexport const setSecurityDebugCallback = function(\n  ref: Reference,\n  callback: (a: Object) => void\n) {\n  (ref.repo.persistentConnection_ as any).securityDebugCallback_ = callback;\n};\n\nexport const stats = function(ref: Reference, showDelta?: boolean) {\n  ref.repo.stats(showDelta);\n};\n\nexport const statsIncrementCounter = function(ref: Reference, metric: string) {\n  ref.repo.statsIncrementCounter(metric);\n};\n\nexport const dataUpdateCount = function(ref: Reference): number {\n  return ref.repo.dataUpdateCount;\n};\n\nexport const interceptServerData = function(\n  ref: Reference,\n  callback: ((a: string, b: any) => void) | null\n) {\n  return ref.repo.interceptServerData_(callback);\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RepoInfo } from '../core/RepoInfo';\nimport { PersistentConnection } from '../core/PersistentConnection';\nimport { RepoManager } from '../core/RepoManager';\nimport { Connection } from '../realtime/Connection';\nimport { Query } from './Query';\n\nexport const DataConnection = PersistentConnection;\n\n/**\n * @param {!string} pathString\n * @param {function(*)} onComplete\n */\n(PersistentConnection.prototype as any).simpleListen = function(\n  pathString: string,\n  onComplete: (a: any) => void\n) {\n  this.sendRequest('q', { p: pathString }, onComplete);\n};\n\n/**\n * @param {*} data\n * @param {function(*)} onEcho\n */\n(PersistentConnection.prototype as any).echo = function(\n  data: any,\n  onEcho: (a: any) => void\n) {\n  this.sendRequest('echo', { d: data }, onEcho);\n};\n\n// RealTimeConnection properties that we use in tests.\nexport const RealTimeConnection = Connection;\n\n/**\n * @param {function(): string} newHash\n * @return {function()}\n */\nexport const hijackHash = function(newHash: () => string) {\n  const oldPut = PersistentConnection.prototype.put;\n  PersistentConnection.prototype.put = function(\n    pathString,\n    data,\n    opt_onComplete,\n    opt_hash\n  ) {\n    if (opt_hash !== undefined) {\n      opt_hash = newHash();\n    }\n    oldPut.call(this, pathString, data, opt_onComplete, opt_hash);\n  };\n  return function() {\n    PersistentConnection.prototype.put = oldPut;\n  };\n};\n\n/**\n * @type {function(new:RepoInfo, !string, boolean, !string, boolean): undefined}\n */\nexport const ConnectionTarget = RepoInfo;\n\n/**\n * @param {!Query} query\n * @return {!string}\n */\nexport const queryIdentifier = function(query: Query) {\n  return query.queryIdentifier();\n};\n\n/**\n * @param {!Query} firebaseRef\n * @return {!Object}\n */\nexport const listens = function(firebaseRef: Query) {\n  return (firebaseRef.repo.persistentConnection_ as any).listens_;\n};\n\n/**\n * Forces the RepoManager to create Repos that use ReadonlyRestClient instead of PersistentConnection.\n *\n * @param {boolean} forceRestClient\n */\nexport const forceRestClient = function(forceRestClient: boolean) {\n  RepoManager.getInstance().forceRestClient(forceRestClient);\n};\n","import firebase from './firebase'\nimport 'firebase/database'\n\nexport default firebase.database()","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var Vue // late bind\nvar version\nvar map = Object.create(null)\nif (typeof window !== 'undefined') {\n  window.__VUE_HOT_MAP__ = map\n}\nvar installed = false\nvar isBrowserify = false\nvar initHookName = 'beforeCreate'\n\nexports.install = function (vue, browserify) {\n  if (installed) { return }\n  installed = true\n\n  Vue = vue.__esModule ? vue.default : vue\n  version = Vue.version.split('.').map(Number)\n  isBrowserify = browserify\n\n  // compat with < 2.0.0-alpha.7\n  if (Vue.config._lifecycleHooks.indexOf('init') > -1) {\n    initHookName = 'init'\n  }\n\n  exports.compatible = version[0] >= 2\n  if (!exports.compatible) {\n    console.warn(\n      '[HMR] You are using a version of vue-hot-reload-api that is ' +\n        'only compatible with Vue.js core ^2.0.0.'\n    )\n    return\n  }\n}\n\n/**\n * Create a record for a hot module, which keeps track of its constructor\n * and instances\n *\n * @param {String} id\n * @param {Object} options\n */\n\nexports.createRecord = function (id, options) {\n  if(map[id]) { return }\n\n  var Ctor = null\n  if (typeof options === 'function') {\n    Ctor = options\n    options = Ctor.options\n  }\n  makeOptionsHot(id, options)\n  map[id] = {\n    Ctor: Ctor,\n    options: options,\n    instances: []\n  }\n}\n\n/**\n * Check if module is recorded\n *\n * @param {String} id\n */\n\nexports.isRecorded = function (id) {\n  return typeof map[id] !== 'undefined'\n}\n\n/**\n * Make a Component options object hot.\n *\n * @param {String} id\n * @param {Object} options\n */\n\nfunction makeOptionsHot(id, options) {\n  if (options.functional) {\n    var render = options.render\n    options.render = function (h, ctx) {\n      var instances = map[id].instances\n      if (ctx && instances.indexOf(ctx.parent) < 0) {\n        instances.push(ctx.parent)\n      }\n      return render(h, ctx)\n    }\n  } else {\n    injectHook(options, initHookName, function() {\n      var record = map[id]\n      if (!record.Ctor) {\n        record.Ctor = this.constructor\n      }\n      record.instances.push(this)\n    })\n    injectHook(options, 'beforeDestroy', function() {\n      var instances = map[id].instances\n      instances.splice(instances.indexOf(this), 1)\n    })\n  }\n}\n\n/**\n * Inject a hook to a hot reloadable component so that\n * we can keep track of it.\n *\n * @param {Object} options\n * @param {String} name\n * @param {Function} hook\n */\n\nfunction injectHook(options, name, hook) {\n  var existing = options[name]\n  options[name] = existing\n    ? Array.isArray(existing) ? existing.concat(hook) : [existing, hook]\n    : [hook]\n}\n\nfunction tryWrap(fn) {\n  return function (id, arg) {\n    try {\n      fn(id, arg)\n    } catch (e) {\n      console.error(e)\n      console.warn(\n        'Something went wrong during Vue component hot-reload. Full reload required.'\n      )\n    }\n  }\n}\n\nfunction updateOptions (oldOptions, newOptions) {\n  for (var key in oldOptions) {\n    if (!(key in newOptions)) {\n      delete oldOptions[key]\n    }\n  }\n  for (var key$1 in newOptions) {\n    oldOptions[key$1] = newOptions[key$1]\n  }\n}\n\nexports.rerender = tryWrap(function (id, options) {\n  var record = map[id]\n  if (!options) {\n    record.instances.slice().forEach(function (instance) {\n      instance.$forceUpdate()\n    })\n    return\n  }\n  if (typeof options === 'function') {\n    options = options.options\n  }\n  if (record.Ctor) {\n    record.Ctor.options.render = options.render\n    record.Ctor.options.staticRenderFns = options.staticRenderFns\n    record.instances.slice().forEach(function (instance) {\n      instance.$options.render = options.render\n      instance.$options.staticRenderFns = options.staticRenderFns\n      // reset static trees\n      // pre 2.5, all static trees are cached together on the instance\n      if (instance._staticTrees) {\n        instance._staticTrees = []\n      }\n      // 2.5.0\n      if (Array.isArray(record.Ctor.options.cached)) {\n        record.Ctor.options.cached = []\n      }\n      // 2.5.3\n      if (Array.isArray(instance.$options.cached)) {\n        instance.$options.cached = []\n      }\n\n      // post 2.5.4: v-once trees are cached on instance._staticTrees.\n      // Pure static trees are cached on the staticRenderFns array\n      // (both already reset above)\n\n      // 2.6: temporarily mark rendered scoped slots as unstable so that\n      // child components can be forced to update\n      var restore = patchScopedSlots(instance)\n      instance.$forceUpdate()\n      instance.$nextTick(restore)\n    })\n  } else {\n    // functional or no instance created yet\n    record.options.render = options.render\n    record.options.staticRenderFns = options.staticRenderFns\n\n    // handle functional component re-render\n    if (record.options.functional) {\n      // rerender with full options\n      if (Object.keys(options).length > 2) {\n        updateOptions(record.options, options)\n      } else {\n        // template-only rerender.\n        // need to inject the style injection code for CSS modules\n        // to work properly.\n        var injectStyles = record.options._injectStyles\n        if (injectStyles) {\n          var render = options.render\n          record.options.render = function (h, ctx) {\n            injectStyles.call(ctx)\n            return render(h, ctx)\n          }\n        }\n      }\n      record.options._Ctor = null\n      // 2.5.3\n      if (Array.isArray(record.options.cached)) {\n        record.options.cached = []\n      }\n      record.instances.slice().forEach(function (instance) {\n        instance.$forceUpdate()\n      })\n    }\n  }\n})\n\nexports.reload = tryWrap(function (id, options) {\n  var record = map[id]\n  if (options) {\n    if (typeof options === 'function') {\n      options = options.options\n    }\n    makeOptionsHot(id, options)\n    if (record.Ctor) {\n      if (version[1] < 2) {\n        // preserve pre 2.2 behavior for global mixin handling\n        record.Ctor.extendOptions = options\n      }\n      var newCtor = record.Ctor.super.extend(options)\n      record.Ctor.options = newCtor.options\n      record.Ctor.cid = newCtor.cid\n      record.Ctor.prototype = newCtor.prototype\n      if (newCtor.release) {\n        // temporary global mixin strategy used in < 2.0.0-alpha.6\n        newCtor.release()\n      }\n    } else {\n      updateOptions(record.options, options)\n    }\n  }\n  record.instances.slice().forEach(function (instance) {\n    if (instance.$vnode && instance.$vnode.context) {\n      instance.$vnode.context.$forceUpdate()\n    } else {\n      console.warn(\n        'Root or manually mounted instance modified. Full reload required.'\n      )\n    }\n  })\n})\n\n// 2.6 optimizes template-compiled scoped slots and skips updates if child\n// only uses scoped slots. We need to patch the scoped slots resolving helper\n// to temporarily mark all scoped slots as unstable in order to force child\n// updates.\nfunction patchScopedSlots (instance) {\n  if (!instance._u) { return }\n  // https://github.com/vuejs/vue/blob/dev/src/core/instance/render-helpers/resolve-scoped-slots.js\n  var original = instance._u\n  instance._u = function (slots) {\n    try {\n      // 2.6.4 ~ 2.6.6\n      return original(slots, true)\n    } catch (e) {\n      // 2.5 / >= 2.6.7\n      return original(slots, null, true)\n    }\n  }\n  return function () {\n    instance._u = original\n  }\n}\n","<script>\n  export default {\n    name: 'Slider',\n    \n    props: {\n      config: Object,\n      precision: {\n        type: Number,\n        default: 10000\n      }\n    },\n\n    computed: {\n      value: {\n        get () {\n          return Math.round(this.config.value * this.precision)\n        },\n\n        set (value) {\n          this.config.value = Math.round(Number(value)) / this.precision\n        }\n      },\n\n      min: {\n        get () {\n          return this.config.min\n        },\n\n        set (value) {\n          this.config.min = Number(value)\n        }\n      },\n\n      max: {\n        get () {\n          return this.config.max\n        },\n\n        set (value) {\n          this.config.max = Number(value)\n        }\n      }\n    },\n\n    methods: {\n      output (event) {\n        var value = Number(event.target.value)\n        this.config.value = Math.round(value) / this.precision\n      }\n    }\n  }\n</script>\n\n<template>\n  <tr :class=\"$style.module\">\n    <td>\n      <label :class=\"$style.name\">{{ config.name }}</label>\n    </td>\n\n    <td>\n      <input :class=\"$style.text\" type=\"number\" v-model=\"min\"/>\n      <input :class=\"$style.slider\" type=\"range\" v-model=\"value\" min=\"0\" :max=\"precision\" />\n      <input :class=\"$style.text\" type=\"number\" v-model=\"max\"/>\n    </td>\n  </tr>\n</template>\n\n<style module>\n  .module {\n    color: inherit;\n    /* display: flex; */\n    /* align-items: center; */\n  }\n\n  .name {\n    padding-right: 1rem;\n  }\n\n  .text::-webkit-inner-spin-button,\n  .text::-webkit-inner-spin-button {\n    -webkit-appearance: none; \n    margin: 0;\n  }\n  \n  .text {\n    width: 6ch;\n    color: inherit;\n    text-align: center;\n    background: transparent;\n    border: 1px solid grey;\n    border-radius: 4px;\n    padding: 2px 0;\n  }\n\n  .slider {\n    margin: auto 10px;\n    max-width: 80px;\n    vertical-align: sub;\n  }\n</style>\n","var baseMerge = require('./_baseMerge'),\n    createAssigner = require('./_createAssigner');\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nmodule.exports = merge;\n","<script>\n  import defaultsDeep from 'lodash/defaultsDeep'\n  import database from '../firebase/database.js'\n  import config from '../config.js'\n  import slider from './slider.vue'\n  import merge from 'lodash/merge'\n  import Vue from 'vue'\n\n  export default {\n    name: 'Editor',\n\n    components: {\n      slider\n    },\n\n    data () {\n      return {\n        name: null,\n        configs: {},\n        visible: true,\n        selection: null,\n      }\n    },\n    \n    computed: {\n      config () {\n        return (\n          this.selection && \n          this.configs[this.selection] &&\n          config.use(this.configs[this.selection].config)\n        )\n      }\n    },\n\n    created () {\n      this.model = database.ref('animation')\n      this.model.on('child_added', this.add)\n      this.model.on('child_removed', this.remove)\n    },\n\n    methods: {\n      toggle () {\n        this.visible = !this.visible\n      },\n\n      add (snap) {\n        Vue.set(this.configs, snap.key, snap.val())\n        snap.ref.on('value', this.update)\n\n        if (!this.selection) {\n          this.selection = snap.key\n        }\n      },\n\n      remove (snap) {\n        Vue.delete(this.configs, snap.key)\n        snap.ref.off('value', this.update)\n\n        if (this.selection === snap.key) {\n          this.selection = Object.keys(this.configs)[0]\n        }\n      },\n\n      update (snap) {\n        this.configs[snap.key] = snap.val()\n      },\n\n      create () {\n        this.selection = this.model.push({\n          name: 'Untitled',\n          config: config.default()\n        }).key\n      },\n\n      copy () {\n        this.selection = this.model.push(\n          this.configs[this.selection]\n        ).key\n      },\n\n      save () {\n        this.model.child(this.selection).child('config').set(this.config)\n      },\n\n      rename () {\n        if (this.name) {\n          this.model.child(this.selection).child('name').set(this.name)\n          this.blur()\n        } else {\n          this.name = this.configs[this.selection].name\n        }\n      },\n\n      destroy () {\n        this.model.child(this.selection).set(null)\n      },\n\n      blur () {\n        this.name = null\n      }\n    }\n  }\n</script>\n\n<template>\n  <div :class=\"$style.module\">\n    <div >\n      <span v-if=\"visible\" :class=\"$style.button\" @click=\"toggle\">hide</span>\n      <span v-else :class=\"$style.button\" @click=\"toggle\">edit</span>\n    </div>\n\n    <table v-if=\"visible\">\n      <tr>\n        <td>Config</td>\n        <td>\n          <select v-if=\"name === null\" v-model=\"selection\">\n            <option disabled value=\"\">Please select one</option>\n            <option\n              v-for=\"(config, key) in configs\"\n              v-text=\"config.name\"\n              :value=\"key\"\n              :key=\"key\"\n            />\n          </select>\n          \n          <input v-else type=\"text\" v-model=\"name\" @keydown.enter=\"rename\" @blur=\"blur\">\n        </td>\n      </tr>\n\n      <tr>\n        <td></td>\n        <td>\n          <span :class=\"$style.button\" @click=\"create\">new</span>\n          <template v-if=\"config\">\n            <span :class=\"$style.button\" @click=\"copy\">copy</span>\n            <span :class=\"$style.button\" @click=\"rename\">rename</span>\n            <span :class=\"$style.button\" @click=\"save\">save</span>\n            <span :class=\"$style.button\" @click=\"destroy\">delete</span>\n          </template>\n        </td>\n      </tr>\n\n      <template v-if=\"config\">\n        <slider v-for=\"(value, key) in config\" v-bind:config=\"value\" :name=\"key\" :key=\"key\" />\n      </template>\n    </table>\n  </div>\n</template>\n\n<style module>\n  .module {\n    top: 0;\n    left: 0;\n    z-index: 10;\n    padding: 10px;\n    position: absolute;\n    background: rgba(50,50,50,0.7);\n    font-size: 12px;\n  }\n\n  .button {\n    cursor: pointer;\n    padding: 4px;\n  }\n</style>\n\n\n","import Vue from 'vue'\nimport editor from './views/editor'\n\nexport default new Vue({\n  el: document.body.appendChild(\n    document.createElement('div')\n  ),\n\n  render (h) {\n    return h(editor)\n  }\n})","import './animation/animation.js';\nimport './editor/editor.js';\n\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}